(this["webpackJsonp@kiali/kiali-ui"]=this["webpackJsonp@kiali/kiali-ui"]||[]).push([[0],{1082:function(e,t,a){},1148:function(e,t,a){},1150:function(e,t,a){},1151:function(e,t,a){},1308:function(e,t,a){},1320:function(e,t,a){},1330:function(e,t,a){},1331:function(e,t,a){"use strict";a.r(t);a(886);var n,r=a(0),i=a.n(r),o=a(75),s=a(2),l=a(3),c=a(4),u=a(5),p=a(278),d=a.n(p),m=a(744),h=a(20),f=a(126),g=a(594),v=a(12);!function(e){e.INCREMENT_LOADING_COUNTER="INCREMENT_LOADING_COUNTER",e.DECREMENT_LOADING_COUNTER="DECREMENT_LOADING_COUNTER",e.SET_PAGE_VISIBILITY_HIDDEN="SET_PAGE_VISIBILITY_HIDDEN",e.SET_PAGE_VISIBILITY_VISIBLE="SET_PAGE_VISIBILITY_VISIBLE",e.GRAPH_ON_NAMESPACE_CHANGE="GRAPH_ON_NAMESPACE_CHANGE",e.GRAPH_SET_DEFINITION="GRAPH_SET_DEFINITION",e.GRAPH_SET_UPDATE_TIME="GRAPH_SET_UPDATE_TIME",e.GRAPH_SET_LAYOUT="GRAPH_SET_LAYOUT",e.GRAPH_SET_NODE="GRAPH_SET_NODE",e.GRAPH_UPDATE_SUMMARY="GRAPH_UPDATE_SUMMARY",e.GRAPH_TOOLBAR_SET_EDGE_LABELS="GRAPH_TOOLBAR_SET_EDGE_LABEL_MODE",e.GRAPH_TOOLBAR_SET_FIND_VALUE="GRAPH_TOOLBAR_SET_FIND_VALUE",e.GRAPH_TOOLBAR_SET_GRAPH_TYPE="GRAPH_TOOLBAR_SET_GRAPH_TYPE",e.GRAPH_TOOLBAR_SET_HIDE_VALUE="GRAPH_TOOLBAR_SET_HIDE_VALUE",e.GRAPH_TOOLBAR_SET_IDLE_NODES="GRAPH_TOOLBAR_SET_IDLE_NODES",e.GRAPH_TOOLBAR_SET_TRAFFIC_RATES="GRAPH_TOOLBAR_SET_TRAFFIC_RATES",e.GRAPH_TOOLBAR_TOGGLE_BOX_BY_CLUSTER="GRAPH_TOOLBAR_TOGGLE_BOX_BY_CLUSTER",e.GRAPH_TOOLBAR_TOGGLE_BOX_BY_NAMESPACE="GRAPH_TOOLBAR_TOGGLE_BOX_BY_NAMESPACE",e.GRAPH_TOOLBAR_TOGGLE_COMPRESS_ON_HIDE="GRAPH_TOOLBAR_TOGGLE_COMPRESS_ON_HIDE",e.GRAPH_TOOLBAR_TOGGLE_GRAPH_VIRTUAL_SERVICES="GRAPH_TOOLBAR_TOGGLE_GRAPH_VIRTUAL_SERVICES",e.GRAPH_TOOLBAR_TOGGLE_GRAPH_MISSING_SIDECARS="GRAPH_TOOLBAR_TOGGLE_GRAPH_MISSING_SIDECARS",e.GRAPH_TOOLBAR_TOGGLE_GRAPH_SECURITY="GRAPH_TOOLBAR_TOGGLE_GRAPH_SECURITY",e.GRAPH_TOOLBAR_TOGGLE_LEGEND="GRAPH_TOOLBAR_TOGGLE_LEGEND",e.GRAPH_TOOLBAR_TOGGLE_FIND_HELP="GRAPH_TOOLBAR_TOGGLE_FIND_HELP",e.GRAPH_TOOLBAR_TOGGLE_IDLE_EDGES="GRAPH_TOOLBAR_TOGGLE_IDLE_EDGES",e.GRAPH_TOOLBAR_TOGGLE_IDLE_NODES="GRAPH_TOOLBAR_TOGGLE_IDLE_NODES",e.GRAPH_TOOLBAR_TOGGLE_OPERATION_NODES="GRAPH_TOOLBAR_TOGGLE_OPERATION_NODES",e.GRAPH_TOOLBAR_TOGGLE_SERVICE_NODES="GRAPH_TOOLBAR_TOGGLE_SERVICE_NODES",e.GRAPH_TOOLBAR_TOGGLE_TRAFFIC_ANIMATION="GRAPH_TOOLBAR_TOGGLE_TRAFFIC_ANIMATION",e.ENABLE_GRAPH_FILTERS="ENABLE_GRAPH_FILTERS",e.HELP_STATUS_REFRESH="HELP_STATUS_REFRESH",e.JAEGER_SET_URL="JAEGER_SET_URL",e.JAEGER_SET_ENABLED="JAEGER_SET_ENABLED",e.JAEGER_SET_INFO="JAEGER_SET_INFO",e.JAEGER_SET_TRACE_ID="JAEGER_SET_TRACE_ID",e.JAEGER_SET_TRACE="JAEGER_SET_TRACE",e.LOGIN_REQUEST="LOGIN_REQUEST",e.LOGIN_EXTEND="LOGIN_EXTEND",e.LOGIN_SUCCESS="LOGIN_SUCCESS",e.LOGIN_FAILURE="LOGIN_FAILURE",e.LOGOUT_SUCCESS="LOGOUT_SUCCESS",e.SESSION_EXPIRED="SESSION_EXPIRED",e.SET_LANDING_ROUTE="SET_LANDING_ROUTE",e.MTLS_SET_INFO="MTLS_SET_INFO",e.ISTIO_STATUS_SET_INFO="ISTIO_STATUS_SET_INFO",e.MC_ADD_MESSAGE="MC_ADD_MESSAGE",e.MC_REMOVE_MESSAGE="MC_REMOVE_MESSAGE",e.MC_MARK_MESSAGE_AS_READ="MC_MARK_MESSAGE_AS_READ",e.MC_TOGGLE_MESSAGE_DETAIL="MC_TOGGLE_MESSAGE_DETAIL",e.MC_SHOW="MC_SHOW",e.MC_HIDE="MC_HIDE",e.MC_TOGGLE_EXPAND="MC_TOGGLE_EXPAND",e.MC_TOGGLE_GROUP="MC_TOGGLE_GROUP",e.MC_HIDE_NOTIFICATION="MC_HIDE_NOTIFICATION",e.MC_EXPAND_GROUP="MC_EXPAND_GROUP",e.METRICS_STATS_SET="METRICS_STATS_SET",e.NAMESPACE_REQUEST_STARTED="NAMESPACE_REQUEST_STARTED",e.NAMESPACE_SUCCESS="NAMESPACE_SUCCESS",e.NAMESPACE_FAILED="NAMESPACE_FAILED",e.TOGGLE_ACTIVE_NAMESPACE="TOGGLE_ACTIVE_NAMESPACE",e.SET_ACTIVE_NAMESPACES="SET_ACTIVE_NAMESPACES",e.NAMESPACE_SET_FILTER="NAMESPACE_SET_FILTER",e.NAV_COLLAPSE="NAV_COLLAPSE",e.SET_DURATION="SET_DURATION",e.SET_LAST_REFRESH="SET_LAST_REFRESH",e.SET_REFRESH_INTERVAL="SET_REFRESH_INTERVAL",e.SET_REPLAY_WINDOW="SET_REPLAY_WINDOW",e.SET_REPLAY_QUERY_TIME="SET_REPLAY_QUERY_TIME",e.SET_TIME_RANGE="SET_TIME_RANGE",e.TOGGLE_REPLAY_ACTIVE="TOGGLE_REPLAY_ACTIVE",e.TOUR_END="TOUR_END",e.TOUR_SET_STOP="TOUR_SET_STOP",e.TOUR_START="TOUR_START"}(n||(n={}));var E={unknown:Object(v.createAction)("KIALI_UNKNOWN"),incrementLoadingCounter:Object(v.createAction)(n.INCREMENT_LOADING_COUNTER),decrementLoadingCounter:Object(v.createAction)(n.DECREMENT_LOADING_COUNTER),setPageVisibilityHidden:Object(v.createAction)(n.SET_PAGE_VISIBILITY_HIDDEN),setPageVisibilityVisible:Object(v.createAction)(n.SET_PAGE_VISIBILITY_VISIBLE),setLastRefreshAt:Object(v.createStandardAction)(n.SET_LAST_REFRESH)()},b=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).show=void 0,n.state={hasError:!1},n.show=!1,n}return Object(l.a)(a,[{key:"componentDidCatch",value:function(e,t){this.props.onError&&this.props.onError(e,t),this.setState({hasError:!0})}},{key:"componentDidUpdate",value:function(){this.state.hasError&&(this.show&&this.setState({hasError:!1}),this.show=!this.show)}},{key:"render",value:function(){return r.createElement(f.e,null,this.state.hasError&&r.createElement(f.c,{component:this.props.fallBackComponent}),this.props.children)}}]),a}(r.Component),y=a(128),C=a(9),S=a(24),A=a.n(S),T=a(31),O=new RegExp(".*"),I=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e){if("string"===typeof e&&""!==e){var a=e.replace("\\\\","\\");return new RegExp(t?w(a):a)}if("object"===typeof e&&"/(?:)/"!==e.toString())return e}return O},w=function(e){return e.replace(/x|X/g,"\\d")},R=function(e,t,a){return A.a.mapValues(e.durations,(function(e){return A.a.reject([t,e,a],A.a.isEmpty).join(" ")}))},k=[[60,"1m"],[300,"5m"],[600,"10m"],[1800,"30m"],[3600,"1h"],[10800,"3h"],[21600,"6h"],[43200,"12h"],[86400,"1d"],[604800,"7d"],[2592e3,"30d"]],x=function(e){var t=k;e.prometheus.storageTsdbRetention&&(t=e.prometheus.storageTsdbRetention<=k[0][0]?[k[0]]:k.filter((function(t){return t[0]<=e.prometheus.storageTsdbRetention}))),e.durations=function(e){var t={};return e.forEach((function(e){t[e[0]]=e[1]})),t}(t)},N={clusters:{},durations:{},healthConfig:{rate:[]},installationTag:"Kiali Console",istioAnnotations:{istioInjectionAnnotation:"sidecar.istio.io/inject"},istioCanaryRevision:{current:"",upgrade:""},istioIdentityDomain:"svc.cluster.local",istioNamespace:"istio-system",istioLabels:{appLabelName:"app",injectionLabelName:"istio-injection",injectionLabelRev:"istio.io/rev",versionLabelName:"version"},kialiFeatureFlags:{istioInjectionAction:!0,istioUpgradeAction:!1},prometheus:{globalScrapeInterval:15,storageTsdbRetention:21600}},j=N;x(j);var P,L,D=function(e){if(j.durations[e])return e;for(var t=k.length-1;t>=0;t--)if(e>k[t][0])return k[t][0];return k[0][0]},F=function(e){(j=Object(C.a)(Object(C.a)({},N),e)).healthConfig=e.healthConfig?function(e){for(var t=0,a=Object.entries(e.rate);t<a.length;t++){var n=Object(T.a)(a[t],2),r=n[0],i=n[1];e.rate[r].namespace=I(e.rate[r].namespace),e.rate[r].name=I(e.rate[r].name),e.rate[r].kind=I(e.rate[r].kind);for(var o=0,s=Object.values(i.tolerance);o<s.length;o++){var l=s[o];l.code=I(l.code,!0),l.direction=I(l.direction),l.protocol=I(l.protocol)}}return e}(e.healthConfig):j.healthConfig,x(j)},_=function(e){return e===j.istioNamespace},M=window.WEB_ROOT?window.WEB_ROOT:void 0,H=M&&"/"!==M?M+"/console":"/console",G=window.HISTORY_MODE?window.HISTORY_MODE:"browser",V=Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_VERSION:"1.39.0",REACT_APP_KIALI_DOC_URL:"https://www.kiali.io/documentation/",REACT_APP_IS_UPSTREAM:"true",REACT_APP_NAME:"@kiali/kiali-ui",REACT_APP_GIT_HASH:"8472ae9bffc67f697342f368f1a722f2d52f323c"}).TEST_RUNNER?Object(y.d)():"hash"===G?Object(y.b)():Object(y.a)({basename:H}),U=V;!function(e){e.AGGREGATOR="aggregator",e.BY_LABELS="bylbl",e.DIRECTION="direction",e.DISPLAY_MODE="displayMode",e.DURATION="duration",e.FOCUS_SELECTOR="focusSelector",e.FROM="from",e.GRAPH_EDGES="edges",e.GRAPH_IDLE_EDGES="idleEdges",e.GRAPH_IDLE_NODES="idleNodes",e.GRAPH_LAYOUT="layout",e.GRAPH_SERVICE_NODES="injectServiceNodes",e.GRAPH_TRAFFIC="traffic",e.GRAPH_TYPE="graphType",e.JAEGER_ERRORS_ONLY="errs",e.JAEGER_LIMIT_TRACES="limit",e.JAEGER_PERCENTILE="percentile",e.JAEGER_SHOW_SPANS_AVG="showSpansAvg",e.JAEGER_TRACE_ID="traceId",e.JAEGER_SPAN_ID="spanId",e.NAMESPACES="namespaces",e.OPERATION_NODES="operationNodes",e.OVERVIEW_TYPE="otype",e.QUANTILES="quantiles",e.RANGE_DURATION="rangeDuration",e.REFRESH_INTERVAL="refresh",e.REPORTER="reporter",e.SHOW_AVERAGE="avg",e.SHOW_SPANS="spans",e.SORT="sort",e.TO="to",e.EXPERIMENTAL_FLAGS="xflags"}(P||(P={})),function(e){e[e.APPEND=0]="APPEND",e[e.SET=1]="SET"}(L||(L={}));var B,W,q=function e(){Object(s.a)(this,e)};q.setParam=function(e,t){var a=new URLSearchParams(V.location.search);a.set(e,t),V.replace(V.location.pathname+"?"+a.toString())},q.getParam=function(e,t){t||(t=new URLSearchParams(V.location.search));var a=t.get(e);return null!==a?a:void 0},q.getNumericParam=function(e,t){var a=q.getParam(e,t);return void 0!==a?Number(a):void 0},q.getBooleanParam=function(e,t){var a=q.getParam(e,t);return void 0!==a?"true"===a:void 0},q.deleteParam=function(e,t){var a=new URLSearchParams(V.location.search);a.delete(e),t?V.replace(V.location.pathname+"?"+a.toString()):V.push(V.location.pathname+"?"+a.toString())},q.setParams=function(e,t,a){var n=new URLSearchParams(V.location.search);e.length>0&&t===L.APPEND&&e.forEach((function(e){return n.delete(e.name)})),e.forEach((function(e){""===e.value?n.delete(e.name):t===L.APPEND?n.append(e.name,e.value):n.set(e.name,e.value)})),a?V.replace(V.location.pathname+"?"+n.toString()):V.push(V.location.pathname+"?"+n.toString())},q.getDuration=function(e){var t=q.getNumericParam(P.DURATION,e);if(t)return D(Number(t))},q.getRangeDuration=function(e){var t=q.getNumericParam(P.RANGE_DURATION,e);if(t)return D(Number(t))},q.getTimeBounds=function(e){var t=q.getNumericParam(P.FROM,e);if(t)return{from:t,to:q.getNumericParam(P.TO,e)}},function(e){e.anonymous="anonymous",e.openshift="openshift",e.token="token",e.openid="openid",e.header="header"}(B||(B={})),function(e){e.HOLD="hold",e.CONTINUE="continue",e.SUCCESS="success",e.FAILURE="failure"}(W||(W={}));var K,z={strategy:B.token},Y=function(){return z.strategy===B.openshift||z.strategy===B.openid},Q=z,X=a(211),J=a.n(X),Z=function(e,t,a){var n=t||50;n<2&&(n=50);var r=j&&j.prometheus.globalScrapeInterval,i=2*(a||r||15),o=Math.floor(e/n);return{step:o=o<i?i:o,rateInterval:o+"s"}},$={DC:{code:"500",help:"Downstream connection termination",short:"Downstream cx term"},DI:{help:"Delayed via fault injection"},DPE:{help:" Downstream request had an HTTP protocol error (is port type correct?)",short:"Downstream invalid HTTP"},FI:{help:"Aborted via fault injection"},IH:{code:"400",help:"Invalid value for a strictly-checked header",short:"Invalid header value"},LH:{code:"503",help:"Local service failed health check request",short:"Failed health check"},LR:{code:"503",help:"Connection local reset"},NR:{code:"404",help:"No route configured (check DestinationRule or VirtualService)",short:"No route"},RL:{code:"429",help:"Ratelimited locally by the HTTP rate limit filter",short:"Rate limit"},RLSE:{help:"Rate limited service error"},SI:{code:"408",help:"Stream idle timeout"},UAEX:{help:"Unauthorized external service"},UC:{code:"503",help:"Upstream connection termination",short:"Upstream cx term"},UF:{code:"503",help:"Upstream connection failure (check for mutual TLS configuration conflict)",short:"Upstream cx failure"},UH:{code:"503",help:"No healthy upstream hosts in upstream cluster",short:"No healthy upstream"},UMSDR:{help:"Upstream request reached max stream duration"},UO:{code:"503",help:"Upstream overflow (circuit breaker open)",short:"Circuit breaker open"},UR:{code:"503",help:"Upstream remote reset"},URX:{code:"503",help:"Upstream retry limit (HTTP) or Max connect attempts (TCP) exceeded",short:"Upstream retry/connect limit"},UT:{code:"504",help:"Upstream request timeout"}},ee=function(e,t){var a=new Map;return e.forEach((function(e,n){var r={},i=t.get(n);Object.entries(e.values).forEach((function(e){r[e[0]]=(!i||!1!==i.defaultValue)&&e[1]})),i&&(e.checked=i.checked,Object.entries(i.values).forEach((function(e){r[e[0]]=e[1]}))),a.set(n,Object(C.a)(Object(C.a)({},e),{},{values:r}))})),a},te=function(e,t){var a=new Map;return e.aggregations.forEach((function(e){return a.set(e.label,{checked:!1,displayName:e.displayName,values:{},defaultValue:!0,singleSelection:e.singleSelection})})),e.charts.forEach((function(t){return n=t.metrics,r=e.aggregations,i=a,void n.forEach((function(e){Object.keys(e.labels).forEach((function(t){var a=r.find((function(e){return e.label===t}));if(a){var n=e.labels[t],o=i.get(a.label);o?o.checked=!0:(o={checked:!0,displayName:a.displayName,values:{},defaultValue:!0,singleSelection:a.singleSelection},i.set(a.label,o)),o.values.hasOwnProperty(n)||(a.singleSelection&&Object.keys(o.values).length>0?o.values[n]=!1:o.values[n]=!0)}}))}));var n,r,i})),ee(a,t)},ae=function(e){var t=new Map;return e.forEach((function(e,a){t.set(a,e.values)})),t},ne=function(e,t,a){t.avg=e.showAverage,t.quantiles=e.showQuantiles;var n=a;e.labelsSettings.size>0&&(n=[],e.labelsSettings.forEach((function(e,t){e.checked&&n.push(t)}))),t.byLabels=n},re=function(e,t){delete t.queryTime,t.duration=le(e,(function(e){return e}),(function(e){return t.queryTime=e.to&&Math.floor(e.to/1e3),pe(e)}));var a=Z(t.duration);t.step=a.step,t.rateInterval=a.rateInterval},ie=function(){var e=new URLSearchParams(U.location.search),t={showSpans:!1,showAverage:!0,showQuantiles:[],labelsSettings:new Map},a=e.get(P.SHOW_AVERAGE);null!==a&&(t.showAverage="true"===a);var n=e.get(P.SHOW_SPANS);null!==n&&(t.showSpans="true"===n);var r=e.get(P.QUANTILES);null!==r&&(0!==r.trim().length?t.showQuantiles=r.split(" ").map((function(e){return e.trim()})):t.showQuantiles=[]);var i=e.getAll(P.BY_LABELS);return 0!==i.length&&i.forEach((function(e){var a=e.split("=",2),n={displayName:"",checked:!0,values:{},defaultValue:!0,singleSelection:!1};a[1]&&(a[1].split(",").forEach((function(e){n.values[e]=!0})),n.defaultValue=!1),t.labelsSettings.set(a[0],n)})),t},oe=function(e,t){if("response_flags"===e){if("-"===t)return"None";var a=$[t];if(a){var n=a.short?a.short:a.help;return"".concat(n," (").concat(t,")")}}return t};!function(e){e.DELETE="DELETE",e.GET="get",e.PATCH="patch",e.POST="post",e.PUT="put"}(K||(K={}));var se=60;function le(e,t,a){if(e.from){var n={from:e.from};return e.to&&(n.to=e.to),a(n)}return e.rangeDuration?t(e.rangeDuration):t(600)}var ce,ue=function(e){var t=le(e,de,(function(e){return e}));return[t.from?new Date(t.from):new Date,t.to?new Date(t.to):new Date]},pe=function(e){return Math.floor(((e.to||(new Date).getTime())-(e.from||(new Date).getTime()))/1e3)},de=function(e){return{from:(new Date).getTime()-1e3*e}},me=function(e,t){return(!e.from||!t.from||e.from===t.from)&&((!e.to||!t.to||e.to===t.to)&&(!e.rangeDuration||!t.rangeDuration||e.rangeDuration===t.rangeDuration))},he={session:{timeOutforWarningUser:1*se*1e3},toolbar:{defaultDuration:1*se,defaultRefreshInterval:15e3,defaultTimeRange:{rangeDuration:10*se},refreshInterval:{0:"Pause",1e4:"Every 10s",15e3:"Every 15s",3e4:"Every 30s",6e4:"Every 1m",3e5:"Every 5m",9e5:"Every 15m"},graphLayouts:{cola:"Cola","cose-bilkent":"Cose",dagre:"Dagre"}},tracing:{configuration:{limitResults:{20:20,50:50,100:100,200:200,300:300,400:400,500:500},statusCode:{none:"none",200:"200",400:"400",401:"401",403:"403",404:"404",405:"405",408:"408",500:"500",502:"502",503:"503",504:"504"}}},about:{project:{url:"https://github.com/kiali",icon:"RepositoryIcon",linkText:"Find us on GitHub"},website:{url:"https://www.kiali.io",icon:"HomeIcon",linkText:"Visit our web page"}},documentation:{url:"https://www.kiali.io/documentation/"},login:{headers:{"X-Auth-Type-Kiali-UI":"1"}},api:{urls:{aggregateGraphElements:function(e,t,a){return"api/namespaces/".concat(e,"/aggregates/").concat(t,"/").concat(a,"/graph")},aggregateByServiceGraphElements:function(e,t,a,n){return"api/namespaces/".concat(e,"/aggregates/").concat(t,"/").concat(a,"/").concat(n,"/graph")},aggregateMetrics:function(e,t,a){return"api/namespaces/".concat(e,"/aggregates/").concat(t,"/").concat(a,"/metrics")},authenticate:"api/authenticate",authInfo:"api/auth/info",apps:function(e){return"api/namespaces/".concat(e,"/apps")},app:function(e,t){return"api/namespaces/".concat(e,"/apps/").concat(t)},appGraphElements:function(e,t,a){var n="api/namespaces/".concat(e,"/applications/").concat(t),r=a&&"unknown"!==a?"".concat(n,"/versions/").concat(a):n;return"".concat(r,"/graph")},appHealth:function(e,t){return"api/namespaces/".concat(e,"/apps/").concat(t,"/health")},appMetrics:function(e,t){return"api/namespaces/".concat(e,"/apps/").concat(t,"/metrics")},appDashboard:function(e,t){return"api/namespaces/".concat(e,"/apps/").concat(t,"/dashboard")},appSpans:function(e,t){return"api/namespaces/".concat(e,"/apps/").concat(t,"/spans")},clusters:"api/clusters",serviceSpans:function(e,t){return"api/namespaces/".concat(e,"/services/").concat(t,"/spans")},workloadSpans:function(e,t){return"api/namespaces/".concat(e,"/workloads/").concat(t,"/spans")},customDashboard:function(e,t){return"api/namespaces/".concat(e,"/customdashboard/").concat(t)},grafana:"api/grafana",istioConfig:function(e){return"api/namespaces/".concat(e,"/istio")},istioConfigCreate:function(e,t){return"api/namespaces/".concat(e,"/istio/").concat(t)},istioConfigDetail:function(e,t,a){return"api/namespaces/".concat(e,"/istio/").concat(t,"/").concat(a)},iter8:"api/iter8",iter8Metrics:"api/iter8/metrics",iter8Experiments:"api/iter8/experiments",iter8ExperimentsByNamespace:function(e){return"api/iter8/namespaces/".concat(e,"/experiments")},iter8Experiment:function(e,t){return"api/iter8/namespaces/".concat(e,"/experiments/").concat(t)},iter8ExperimentYAML:function(e,t){return"api/iter8/namespaces/".concat(e,"/experiments/").concat(t,"/yaml")},iter8ExperimentUpdate:function(e,t){return"api/iter8/namespaces/".concat(e,"/experiments/").concat(t)},istioPermissions:"api/istio/permissions",jaeger:"api/jaeger",appTraces:function(e,t){return"api/namespaces/".concat(e,"/apps/").concat(t,"/traces")},serviceTraces:function(e,t){return"api/namespaces/".concat(e,"/services/").concat(t,"/traces")},workloadTraces:function(e,t){return"api/namespaces/".concat(e,"/workloads/").concat(t,"/traces")},jaegerErrorTraces:function(e,t){return"api/namespaces/".concat(e,"/apps/").concat(t,"/errortraces")},jaegerTrace:function(e){return"api/traces/".concat(e)},logout:"api/logout",metricsStats:"api/stats/metrics",namespaces:"api/namespaces",namespace:function(e){return"api/namespaces/".concat(e)},namespacesGraphElements:"api/namespaces/graph",namespaceHealth:function(e){return"api/namespaces/".concat(e,"/health")},namespaceMetrics:function(e){return"api/namespaces/".concat(e,"/metrics")},namespaceTls:function(e){return"api/namespaces/".concat(e,"/tls")},namespaceValidations:function(e){return"api/namespaces/".concat(e,"/validations")},meshTls:function(){return"api/mesh/tls"},istioStatus:function(){return"api/istio/status"},pod:function(e,t){return"api/namespaces/".concat(e,"/pods/").concat(t)},podLogs:function(e,t){return"api/namespaces/".concat(e,"/pods/").concat(t,"/logs")},podEnvoyProxy:function(e,t){return"api/namespaces/".concat(e,"/pods/").concat(t,"/config_dump")},podEnvoyProxyResourceEntries:function(e,t,a){return"api/namespaces/".concat(e,"/pods/").concat(t,"/config_dump/").concat(a)},serverConfig:"api/config",services:function(e){return"api/namespaces/".concat(e,"/services")},service:function(e,t){return"api/namespaces/".concat(e,"/services/").concat(t)},serviceGraphElements:function(e,t){return"api/namespaces/".concat(e,"/services/").concat(t,"/graph")},serviceHealth:function(e,t){return"api/namespaces/".concat(e,"/services/").concat(t,"/health")},serviceMetrics:function(e,t){return"api/namespaces/".concat(e,"/services/").concat(t,"/metrics")},serviceDashboard:function(e,t){return"api/namespaces/".concat(e,"/services/").concat(t,"/dashboard")},status:"api/status",workloads:function(e){return"api/namespaces/".concat(e,"/workloads")},workload:function(e,t){return"api/namespaces/".concat(e,"/workloads/").concat(t)},workloadGraphElements:function(e,t){return"api/namespaces/".concat(e,"/workloads/").concat(t,"/graph")},workloadHealth:function(e,t){return"api/namespaces/".concat(e,"/workloads/").concat(t,"/health")},workloadMetrics:function(e,t){return"api/namespaces/".concat(e,"/workloads/").concat(t,"/metrics")},workloadDashboard:function(e,t){return"api/namespaces/".concat(e,"/workloads/").concat(t,"/dashboard")}}},graph:{maxHosts:5}},fe=J()(he),ge=(a(634),a(635),a(1378)),ve=a(1379),Ee={istio:{circuitBreaker:{className:"fa fa-bolt",type:"fa",name:"bolt",ascii:"\uf0e7 "},missingLabel:{icon:ge.a,className:"fa fa-wrench",type:"fa",name:"wrench",ascii:"\ue932",color:"red"},disabledMtls:{className:"pf-icon pf-icon-unlocked",type:"fa",name:"unlock",ascii:"\ue065 "},faultInjection:{className:"fa fa-ban",type:"fa",name:"ban",ascii:"\uf05e "},gateway:{className:"pf-icon pf-icon-globe-route",type:"pf",name:"globe-route"},missingSidecar:{icon:ve.a,className:"pf-icon pf-icon-blueprint",type:"pf",name:"blueprint",ascii:"\ue915 ",color:"red"},mtls:{className:"pf-icon pf-icon-locked",type:"pf",name:"locked",ascii:"\ue02a "},requestRouting:{className:"fa fa-code-branch",type:"fa",name:"code-fork",ascii:"\uf126 "},requestTimeout:{className:"fa fa-clock",type:"fa",name:"clock",ascii:"\uf017 "},root:{className:"fa fa-arrow-alt-circle-right",type:"fa",name:"arrow-alt-circle-right",ascii:"\uf35a "},trafficShifting:{className:"fa fa-share-alt",type:"fa",name:"share-alt",ascii:"\uf1e0 "},virtualService:{className:"fa fa-code-branch",type:"fa",name:"code-fork",ascii:"\uf126 "}}},be=J()(Ee),ye=a(636),Ce=a.n(ye);!function(e){e.AGGREGATES="aggregates",e.APPLICATIONS="applications",e.ISTIO="istio",e.ITER8="iter8",e.JAEGER="jaeger",e.MESH="mesh",e.SERVICES="services",e.SERVICEENTRIES="istio/serviceentries",e.WORKLOADS="workloads"}(ce||(ce={}));var Se,Ae=a(1337);!function(e){e.typeAhead="typeahead",e.select="select",e.label="label",e.nsLabel="nsLabel"}(Se||(Se={}));var Te,Oe=Object(C.a)(Object(C.a)({},Ae.c),Se),Ie=a(26),we=a(277),Re=a(748);!function(e){e.ERROR="error",e.WARNING="warning",e.SUCCESS="success",e.INFO="info"}(Te||(Te={}));var ke,xe=Te.ERROR,Ne=function(e){return Array.isArray(e)?e:[e]},je={addMessage:Object(v.createAction)(n.MC_ADD_MESSAGE,(function(e){return function(t,a){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"default",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:xe,i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];return e({content:t,detail:a,groupId:n,messageType:r,showNotification:i})}})),removeMessage:Object(v.createAction)(n.MC_REMOVE_MESSAGE,(function(e){return function(t){return e({messageId:Ne(t)})}})),toggleMessageDetail:Object(v.createAction)(n.MC_TOGGLE_MESSAGE_DETAIL,(function(e){return function(t){return e({messageId:Ne(t)})}})),markAsRead:Object(v.createAction)(n.MC_MARK_MESSAGE_AS_READ,(function(e){return function(t){return e({messageId:Ne(t)})}})),toggleGroup:Object(v.createAction)(n.MC_TOGGLE_GROUP,(function(e){return function(t){return e({groupId:t})}})),expandGroup:Object(v.createAction)(n.MC_EXPAND_GROUP,(function(e){return function(t){return e({groupId:t})}})),hideNotification:Object(v.createAction)(n.MC_HIDE_NOTIFICATION,(function(e){return function(t){return e({messageId:Ne(t)})}})),showMessageCenter:Object(v.createAction)(n.MC_SHOW),hideMessageCenter:Object(v.createAction)(n.MC_HIDE),toggleExpandedMessageCenter:Object(v.createAction)(n.MC_TOGGLE_EXPAND)},Pe=function(e,t){return Object(C.a)(Object(C.a)({},e),t)};!function(e){e[e.logging=0]="logging",e[e.loggedIn=1]="loggedIn",e[e.loggedOut=2]="loggedOut",e[e.error=3]="error",e[e.expired=4]="expired"}(ke||(ke={}));var Le,De,Fe={loginRequest:Object(v.createAction)(n.LOGIN_REQUEST),loginExtend:Object(v.createAction)(n.LOGIN_EXTEND,(function(e){return function(t){return e({status:ke.loggedIn,session:t,error:void 0})}})),loginSuccess:Object(v.createAction)(n.LOGIN_SUCCESS,(function(e){return function(t){return e({status:ke.loggedIn,session:t,error:void 0,uiExpiresOn:t.expiresOn})}})),loginFailure:Object(v.createAction)(n.LOGIN_FAILURE,(function(e){return function(t){return e({status:ke.error,session:void 0,error:t})}})),logoutSuccess:Object(v.createAction)(n.LOGOUT_SUCCESS,(function(e){return function(){return e({status:ke.loggedOut,session:void 0,error:void 0})}})),sessionExpired:Object(v.createAction)(n.SESSION_EXPIRED),setLandingRoute:Object(v.createStandardAction)(n.SET_LANDING_ROUTE)()},_e={nextId:0,groups:[{id:"systemErrors",title:"Open issues",messages:[],showActions:!1,hideIfEmpty:!0},{id:"default",title:"Notifications",messages:[],showActions:!0,hideIfEmpty:!1}],hidden:!0,expanded:!1,expandedGroupId:"default"},Me=function(e,t,a,n,r,i,o,s,l){return{id:e,content:t,detail:a,type:n,count:r,show_notification:i,seen:!1,created:o,showDetail:s,firstTriggered:l}},He=function(e,t,a){var n=e.groups.map((function(e){return e=Object(C.a)(Object(C.a)({},e),{},{messages:e.messages.map((function(e){return t.includes(e.id)&&(e=a(e)),e}))})}));return Pe(e,{groups:n})},Ge=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_e,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Object(v.getType)(je.addMessage):var a=t.payload,n=a.content,r=a.detail,i=a.groupId,o=a.messageType,s=a.showNotification,l=e.groups.map((function(t){if(t.id===i){var a,l=t.messages.find((function(e){return e.content===n}));if(l){var c=l.firstTriggered?l.firstTriggered:l.created;a=Me(e.nextId,l.content,l.detail,o,l.count+1,l.show_notification,new Date,l.showDetail,c);var u=A.a.remove(t.messages,(function(e){return e.content!==n}));t=Object(C.a)(Object(C.a)({},t),{},{messages:u.concat(a)})}else a=Me(e.nextId,n,r,o,1,s,new Date,!1,void 0),t=Object(C.a)(Object(C.a)({},t),{},{messages:t.messages.concat(a)});return t}return t}));return Pe(e,{groups:l,nextId:e.nextId+1});case Object(v.getType)(je.removeMessage):var c=t.payload.messageId,u=e.groups.map((function(e){return e=Object(C.a)(Object(C.a)({},e),{},{messages:e.messages.filter((function(e){return!c.includes(e.id)}))})}));return Pe(e,{groups:u});case Object(v.getType)(je.toggleMessageDetail):return He(e,t.payload.messageId,(function(e){return Object(C.a)(Object(C.a)({},e),{},{showDetail:!e.showDetail})}));case Object(v.getType)(je.markAsRead):return He(e,t.payload.messageId,(function(e){return Object(C.a)(Object(C.a)({},e),{},{seen:!0,show_notification:!1})}));case Object(v.getType)(je.hideNotification):return He(e,t.payload.messageId,(function(e){return Object(C.a)(Object(C.a)({},e),{},{show_notification:!1})}));case Object(v.getType)(je.showMessageCenter):return e.hidden?Pe(e,{hidden:!1}):e;case Object(v.getType)(je.hideMessageCenter):return e.hidden?e:Pe(e,{hidden:!0});case Object(v.getType)(je.toggleExpandedMessageCenter):return Pe(e,{expanded:!e.expanded});case Object(v.getType)(je.toggleGroup):var p=t.payload.groupId;return e.expandedGroupId===p?Pe(e,{expandedGroupId:void 0}):Pe(e,{expandedGroupId:p});case Object(v.getType)(je.expandGroup):var d=t.payload.groupId;return Pe(e,{expandedGroupId:d});case Object(v.getType)(Fe.loginRequest):return _e;default:return e}},Ve={landingRoute:void 0,message:"",session:void 0,status:ke.loggedOut},Ue=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ve,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Object(v.getType)(Fe.loginRequest):return Object(C.a)(Object(C.a)({},Ve),{},{landingRoute:e.landingRoute,status:ke.logging});case Object(v.getType)(Fe.loginSuccess):return Object(C.a)(Object(C.a)(Object(C.a)({},Ve),t.payload),{},{landingRoute:e.landingRoute});case Object(v.getType)(Fe.loginExtend):return Object(C.a)(Object(C.a)({},Ve),{},{landingRoute:e.landingRoute,status:ke.loggedIn,session:t.payload.session});case Object(v.getType)(Fe.loginFailure):var a="Error connecting to Kiali",n=t.payload.error.response.data;return n&&"string"==typeof n.error&&n.error.length>0?a="Login unsuccessful: ".concat(n.error):401===t.payload.error.response.status&&(a="Unauthorized. The provided credentials are not valid to access Kiali. Please check your credentials and try again."),Object(C.a)(Object(C.a)({},Ve),{},{landingRoute:e.landingRoute,message:a,status:ke.error});case Object(v.getType)(Fe.logoutSuccess):return Ve;case Object(v.getType)(Fe.sessionExpired):return Object(C.a)(Object(C.a)({},Ve),{},{status:ke.expired,message:"Your session has expired or was terminated in another window."});case Object(v.getType)(Fe.setLandingRoute):return Pe(e,{landingRoute:t.payload});default:return e}},Be={statusRefresh:Object(v.createAction)(n.HELP_STATUS_REFRESH,(function(e){return function(t,a,n){return e({status:t,components:a,warningMessages:n})}}))},We={status:{},components:[],warningMessages:[]},qe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:We,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Object(v.getType)(Be.statusRefresh):return Object(C.a)(Object(C.a)({},We),{},{status:t.payload.status,components:t.payload.components,warningMessages:t.payload.warningMessages});default:return e}},Ke={onNamespaceChange:Object(v.createAction)(n.GRAPH_ON_NAMESPACE_CHANGE),setGraphDefinition:Object(v.createStandardAction)(n.GRAPH_SET_DEFINITION)(),setLayout:Object(v.createStandardAction)(n.GRAPH_SET_LAYOUT)(),setNode:Object(v.createStandardAction)(n.GRAPH_SET_NODE)(),setUpdateTime:Object(v.createStandardAction)(n.GRAPH_SET_UPDATE_TIME)(),updateSummary:Object(v.createStandardAction)(n.GRAPH_UPDATE_SUMMARY)()};!function(e){e.GRPC="grpc",e.HTTP="http",e.TCP="tcp"}(Le||(Le={})),function(e){e.RESPONSE_TIME_GROUP="responseTime",e.RESPONSE_TIME_AVERAGE="avg",e.RESPONSE_TIME_P50="rt50",e.RESPONSE_TIME_P95="rt95",e.RESPONSE_TIME_P99="rt99",e.THROUGHPUT_GROUP="throughput",e.THROUGHPUT_REQUEST="throughputRequest",e.THROUGHPUT_RESPONSE="throughputResponse",e.TRAFFIC_DISTRIBUTION="trafficDistribution",e.TRAFFIC_RATE="trafficRate"}(De||(De={}));var ze,Ye=function(e){return e===De.RESPONSE_TIME_GROUP||e===De.RESPONSE_TIME_AVERAGE||e===De.RESPONSE_TIME_P50||e===De.RESPONSE_TIME_P95||e===De.RESPONSE_TIME_P99},Qe=function(e){return e===De.THROUGHPUT_GROUP||e===De.THROUGHPUT_REQUEST||e===De.THROUGHPUT_RESPONSE};!function(e){e.GRPC_GROUP="grpc",e.GRPC_RECEIVED="grpcReceived",e.GRPC_REQUEST="grpcRequest",e.GRPC_SENT="grpcSent",e.GRPC_TOTAL="grpcTotal",e.HTTP_GROUP="http",e.HTTP_REQUEST="httpRequest",e.TCP_GROUP="tcp",e.TCP_RECEIVED="tcpReceived",e.TCP_SENT="tcpSent",e.TCP_TOTAL="tcpTotal"}(ze||(ze={}));var Xe,Je,Ze,$e=[ze.GRPC_GROUP,ze.GRPC_REQUEST,ze.HTTP_GROUP,ze.HTTP_REQUEST,ze.TCP_GROUP,ze.TCP_SENT],et=function(e){return e===ze.GRPC_GROUP||e===ze.GRPC_RECEIVED||e===ze.GRPC_REQUEST||e===ze.GRPC_SENT||e===ze.GRPC_TOTAL},tt=function(e){return e===ze.HTTP_GROUP||e===ze.HTTP_REQUEST},at=function(e){return e===ze.TCP_GROUP||e===ze.TCP_RECEIVED||e===ze.TCP_SENT||e===ze.TCP_TOTAL};!function(e){e.APP="app",e.SERVICE="service",e.VERSIONED_APP="versionedApp",e.WORKLOAD="workload"}(Xe||(Xe={})),function(e){e.APP="app",e.CLUSTER="cluster",e.NAMESPACE="namespace"}(Je||(Je={})),function(e){e.AGGREGATE="aggregate",e.APP="app",e.BOX="box",e.SERVICE="service",e.UNKNOWN="unknown",e.WORKLOAD="workload"}(Ze||(Ze={}));var nt,rt,it="unknown",ot=function(e){return void 0!==e.rates&&void 0!==e.responses},st={setEdgeLabels:Object(v.createStandardAction)(n.GRAPH_TOOLBAR_SET_EDGE_LABELS)(),setFindValue:Object(v.createStandardAction)(n.GRAPH_TOOLBAR_SET_FIND_VALUE)(),setGraphType:Object(v.createStandardAction)(n.GRAPH_TOOLBAR_SET_GRAPH_TYPE)(),setHideValue:Object(v.createStandardAction)(n.GRAPH_TOOLBAR_SET_HIDE_VALUE)(),setIdleNodes:Object(v.createStandardAction)(n.GRAPH_TOOLBAR_SET_IDLE_NODES)(),setTrafficRates:Object(v.createStandardAction)(n.GRAPH_TOOLBAR_SET_TRAFFIC_RATES)(),toggleBoxByCluster:Object(v.createAction)(n.GRAPH_TOOLBAR_TOGGLE_BOX_BY_CLUSTER),toggleBoxByNamespace:Object(v.createAction)(n.GRAPH_TOOLBAR_TOGGLE_BOX_BY_NAMESPACE),toggleCompressOnHide:Object(v.createAction)(n.GRAPH_TOOLBAR_TOGGLE_COMPRESS_ON_HIDE),toggleLegend:Object(v.createAction)(n.GRAPH_TOOLBAR_TOGGLE_LEGEND),toggleGraphVirtualServices:Object(v.createAction)(n.GRAPH_TOOLBAR_TOGGLE_GRAPH_VIRTUAL_SERVICES),toggleGraphMissingSidecars:Object(v.createAction)(n.GRAPH_TOOLBAR_TOGGLE_GRAPH_MISSING_SIDECARS),toggleGraphSecurity:Object(v.createAction)(n.GRAPH_TOOLBAR_TOGGLE_GRAPH_SECURITY),toggleFindHelp:Object(v.createAction)(n.GRAPH_TOOLBAR_TOGGLE_FIND_HELP),toggleIdleEdges:Object(v.createAction)(n.GRAPH_TOOLBAR_TOGGLE_IDLE_EDGES),toggleIdleNodes:Object(v.createAction)(n.GRAPH_TOOLBAR_TOGGLE_IDLE_NODES),toggleOperationNodes:Object(v.createAction)(n.GRAPH_TOOLBAR_TOGGLE_OPERATION_NODES),toggleServiceNodes:Object(v.createAction)(n.GRAPH_TOOLBAR_TOGGLE_SERVICE_NODES),toggleTrafficAnimation:Object(v.createAction)(n.GRAPH_TOOLBAR_TOGGLE_TRAFFIC_ANIMATION)},lt=function(){function e(){Object(s.a)(this,e)}return Object(l.a)(e,null,[{key:"getLayout",value:function(){return{name:"dagre",fit:!1,nodeDimensionsIncludeLabels:!0,rankDir:"LR"}}}]),e}(),ct={graphDefinition:null,layout:lt.getLayout(),node:void 0,summaryData:null,toolbarState:{boxByCluster:!1,boxByNamespace:!1,compressOnHide:!0,edgeLabels:[],findValue:"",graphType:Xe.VERSIONED_APP,hideValue:"",showFindHelp:!1,showIdleEdges:!1,showIdleNodes:!1,showLegend:!1,showMissingSidecars:!0,showOperationNodes:!1,showSecurity:!1,showServiceNodes:!0,showTrafficAnimation:!1,showVirtualServices:!0,trafficRates:[ze.GRPC_GROUP,ze.GRPC_REQUEST,ze.HTTP_GROUP,ze.HTTP_REQUEST,ze.TCP_GROUP,ze.TCP_SENT]},updateTime:0},ut=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ct,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Object(v.getType)(Ke.onNamespaceChange):return Pe(e,{summaryData:ct.summaryData});case Object(v.getType)(Ke.setGraphDefinition):return Pe(e,{graphDefinition:t.payload});case Object(v.getType)(Ke.setLayout):return Pe(e,{layout:t.payload});case Object(v.getType)(Ke.setNode):return Pe(e,{node:t.payload,summaryData:ct.summaryData});case Object(v.getType)(Ke.setUpdateTime):return Pe(e,{updateTime:t.payload});case Object(v.getType)(Ke.updateSummary):return Pe(e,{summaryData:Pe(e.summaryData,{summaryType:t.payload.summaryType,summaryTarget:t.payload.summaryTarget})});case Object(v.getType)(st.setEdgeLabels):return Pe(e,{toolbarState:Pe(e.toolbarState,{edgeLabels:t.payload})});case Object(v.getType)(st.setFindValue):return Pe(e,{toolbarState:Pe(e.toolbarState,{findValue:t.payload})});case Object(v.getType)(st.setGraphType):var a=t.payload===Xe.SERVICE,n=!a&&e.toolbarState.showOperationNodes,r=!a&&e.toolbarState.showServiceNodes;return Pe(e,{toolbarState:Pe(e.toolbarState,{graphType:t.payload,showOperationNodes:n,showServiceNodes:r}),summaryData:ct.summaryData});case Object(v.getType)(st.setHideValue):return Pe(e,{toolbarState:Pe(e.toolbarState,{hideValue:t.payload})});case Object(v.getType)(st.setIdleNodes):return Pe(e,{toolbarState:Pe(e.toolbarState,{showIdleNodes:t.payload})});case Object(v.getType)(st.setTrafficRates):return Pe(e,{toolbarState:Pe(e.toolbarState,{trafficRates:t.payload})});case Object(v.getType)(st.toggleBoxByCluster):return Pe(e,{toolbarState:Pe(e.toolbarState,{boxByCluster:!e.toolbarState.boxByCluster})});case Object(v.getType)(st.toggleBoxByNamespace):return Pe(e,{toolbarState:Pe(e.toolbarState,{boxByNamespace:!e.toolbarState.boxByNamespace})});case Object(v.getType)(st.toggleCompressOnHide):return Pe(e,{toolbarState:Pe(e.toolbarState,{compressOnHide:!e.toolbarState.compressOnHide})});case Object(v.getType)(st.toggleFindHelp):return Pe(e,{toolbarState:Pe(e.toolbarState,{showFindHelp:!e.toolbarState.showFindHelp})});case Object(v.getType)(st.toggleGraphVirtualServices):return Pe(e,{toolbarState:Pe(e.toolbarState,{showVirtualServices:!e.toolbarState.showVirtualServices})});case Object(v.getType)(st.toggleGraphMissingSidecars):return Pe(e,{toolbarState:Pe(e.toolbarState,{showMissingSidecars:!e.toolbarState.showMissingSidecars})});case Object(v.getType)(st.toggleGraphSecurity):return Pe(e,{toolbarState:Pe(e.toolbarState,{showSecurity:!e.toolbarState.showSecurity})});case Object(v.getType)(st.toggleIdleEdges):return Pe(e,{toolbarState:Pe(e.toolbarState,{showIdleEdges:!e.toolbarState.showIdleEdges})});case Object(v.getType)(st.toggleIdleNodes):return Pe(e,{toolbarState:Pe(e.toolbarState,{showIdleNodes:!e.toolbarState.showIdleNodes})});case Object(v.getType)(st.toggleLegend):return Pe(e,{toolbarState:Pe(e.toolbarState,{showLegend:!e.toolbarState.showLegend})});case Object(v.getType)(st.toggleOperationNodes):return Pe(e,{toolbarState:Pe(e.toolbarState,{showOperationNodes:!e.toolbarState.showOperationNodes}),summaryData:ct.summaryData});case Object(v.getType)(st.toggleServiceNodes):return Pe(e,{toolbarState:Pe(e.toolbarState,{showServiceNodes:!e.toolbarState.showServiceNodes}),summaryData:ct.summaryData});case Object(v.getType)(st.toggleTrafficAnimation):return Pe(e,{toolbarState:Pe(e.toolbarState,{showTrafficAnimation:!e.toolbarState.showTrafficAnimation})});default:return e}},pt={loadingCounter:0,isPageVisible:!0,lastRefreshAt:0},dt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Object(v.getType)(E.incrementLoadingCounter):return Pe(e,{loadingCounter:e.loadingCounter+1});case Object(v.getType)(E.decrementLoadingCounter):return Pe(e,{loadingCounter:Math.max(0,e.loadingCounter-1)});case Object(v.getType)(E.setPageVisibilityHidden):return Pe(e,{isPageVisible:!1});case Object(v.getType)(E.setPageVisibilityVisible):return Pe(e,{isPageVisible:!0});case Object(v.getType)(E.setLastRefreshAt):return Pe(e,{lastRefreshAt:t.payload});default:return e}},mt=a(22),ht={toggleActiveNamespace:Object(v.createStandardAction)(n.TOGGLE_ACTIVE_NAMESPACE)(),setActiveNamespaces:Object(v.createStandardAction)(n.SET_ACTIVE_NAMESPACES)(),setFilter:Object(v.createStandardAction)(n.NAMESPACE_SET_FILTER)(),requestStarted:Object(v.createAction)(n.NAMESPACE_REQUEST_STARTED),requestFailed:Object(v.createAction)(n.NAMESPACE_FAILED),receiveList:Object(v.createAction)(n.NAMESPACE_SUCCESS,(function(e){return function(t,a){return e({list:t,receivedAt:a})}}))},ft={activeNamespaces:[],isFetching:!1,items:[],lastUpdated:void 0,filter:""},gt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ft,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Object(v.getType)(ht.toggleActiveNamespace):var a=e.activeNamespaces.findIndex((function(e){return e.name===t.payload.name}));if(-1===a)return Pe(e,{activeNamespaces:[].concat(Object(mt.a)(e.activeNamespaces),[{name:t.payload.name}])});var n=Object(mt.a)(e.activeNamespaces);return n.splice(a,1),Pe(e,{activeNamespaces:n});case Object(v.getType)(ht.setActiveNamespaces):return Pe(e,{activeNamespaces:t.payload});case Object(v.getType)(ht.setFilter):return Pe(e,{filter:t.payload});case Object(v.getType)(ht.requestStarted):return Pe(e,{isFetching:!0});case Object(v.getType)(ht.receiveList):var r=t.payload.list.map((function(e){return e.name})),i=e.activeNamespaces.filter((function(e){return r.includes(e.name)})),o={};return e.activeNamespaces.length!==i.length&&(o={activeNamespaces:i}),Pe(e,Object(C.a)({isFetching:!1,items:t.payload.list,lastUpdated:t.payload.receivedAt},o));case Object(v.getType)(ht.requestFailed):return Pe(e,{isFetching:!1});default:return e}},vt={navCollapse:Object(v.createAction)(n.NAV_COLLAPSE,(function(e){return function(t){return e({collapse:t})}})),setDuration:Object(v.createStandardAction)(n.SET_DURATION)(),setTimeRange:Object(v.createStandardAction)(n.SET_TIME_RANGE)(),setRefreshInterval:Object(v.createStandardAction)(n.SET_REFRESH_INTERVAL)(),setReplayWindow:Object(v.createStandardAction)(n.SET_REPLAY_WINDOW)(),setReplayQueryTime:Object(v.createStandardAction)(n.SET_REPLAY_QUERY_TIME)(),toggleReplayActive:Object(v.createAction)(n.TOGGLE_REPLAY_ACTIVE)},Et={duration:fe.toolbar.defaultDuration,timeRange:fe.toolbar.defaultTimeRange,interface:{navCollapse:!1},refreshInterval:fe.toolbar.defaultRefreshInterval,replayActive:!1,replayQueryTime:0,replayWindow:{interval:0,startTime:0}},bt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Et,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Object(v.getType)(vt.navCollapse):return Pe(e,{interface:{navCollapse:t.payload.collapse}});case Object(v.getType)(vt.setDuration):return Pe(e,{duration:t.payload});case Object(v.getType)(vt.setRefreshInterval):return Pe(e,{refreshInterval:t.payload});case Object(v.getType)(vt.setReplayQueryTime):return Pe(e,{replayQueryTime:t.payload});case Object(v.getType)(vt.setReplayWindow):return Pe(e,{replayWindow:t.payload,replayQueryTime:0});case Object(v.getType)(vt.setTimeRange):return Pe(e,{timeRange:t.payload});case Object(v.getType)(vt.toggleReplayActive):return Pe(e,{replayActive:!e.replayActive,replayWindow:{interval:0,startTime:0},replayQueryTime:0});default:return e}},yt={endTour:Object(v.createAction)(n.TOUR_END),setStop:Object(v.createStandardAction)(n.TOUR_SET_STOP)(),startTour:Object(v.createStandardAction)(n.TOUR_START)()},Ct={activeTour:void 0,activeStop:void 0},St=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ct,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Object(v.getType)(yt.endTour):return Pe(e,{activeTour:void 0,activeStop:void 0});case Object(v.getType)(yt.setStop):return Pe(e,{activeStop:t.payload});case Object(v.getType)(yt.startTour):return Pe(e,{activeTour:t.payload.info,activeStop:t.payload.stop});default:return e}},At={setinfo:Object(v.createStandardAction)(n.MTLS_SET_INFO)()},Tt={status:""},Ot=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Tt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Object(v.getType)(At.setinfo):return Object(C.a)(Object(C.a)({},Tt),{},{status:t.payload.status});default:return e}},It={setinfo:Object(v.createStandardAction)(n.ISTIO_STATUS_SET_INFO)()},wt=[],Rt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:wt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Object(v.getType)(It.setinfo):return t.payload;default:return e}},kt={setInfo:Object(v.createStandardAction)(n.JAEGER_SET_INFO)(),setTrace:Object(v.createAction)(n.JAEGER_SET_TRACE,(function(e){return function(t){return e({selectedTrace:t})}}))},xt={},Nt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:xt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Object(v.getType)(kt.setInfo):return Pe(e,{info:t.payload?t.payload:void 0});case Object(v.getType)(kt.setTrace):return Pe(e,{selectedTrace:t.payload.selectedTrace});default:return e}},jt={setStats:Object(v.createAction)(n.METRICS_STATS_SET,(function(e){return function(t){return e({metricsStats:t})}}))},Pt={data:new Map},Lt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Pt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Object(v.getType)(jt.setStats):return Pe(e,{data:t.payload.metricsStats});default:return e}},Dt=Object(Ie.c)({authentication:Ue,globalState:dt,graph:ut,messageCenter:Ge,namespaces:gt,statusState:qe,userSettings:bt,jaegerState:Nt,meshTLSStatus:Ot,istioStatus:Rt,tourState:St,metricsStats:Lt}),Ft=a(749),_t=a(750),Mt=a.n(_t),Ht=window.WEB_ROOT?window.WEB_ROOT:void 0,Gt="kiali-"+(Ht&&"/"!==Ht?Ht.substring(1):"root"),Vt=function(e,t,a){return Object(we.createTransform)((function(e){return Object(Re.persistFilter)(e,t,"whitelist")}),(function(e){return Object(C.a)(Object(C.a)({},a),e)}),{whitelist:[e]})},Ut=Vt("authentication",["landingRoute"],Ve),Bt=Vt("namespaces",["activeNamespaces"],ft),Wt=Vt("graph",["filterState","layout"],ct),qt=Vt("userSettings",["duration","refreshInterval","timeRange"],Et),Kt={key:Gt,storage:Mt.a,whitelist:["authentication","graph","jaegerState","namespaces","statusState","userSettings"],transforms:[Ut,Wt,Bt,qt]},zt=Ie.d,Yt=function(e){var t=[Ft.a],a=zt(Ie.a.apply(void 0,t)),n=Object(we.persistReducer)(Kt,Dt);return Object(Ie.e)(n,e,a)}({globalState:pt,statusState:We,namespaces:ft,authentication:Ve,messageCenter:_e,graph:ct,userSettings:Et,jaegerState:xt,meshTLSStatus:Tt,metricsStats:Pt,istioStatus:wt,tourState:Ct}),Qt=Object(we.persistStore)(Yt),Xt=a(33),Jt=a.n(Xt),Zt=a(58),$t=a(41),ea=a(1380),ta=a(1381),aa=a(1382),na=a(1383),ra=a(1384),ia=function(e){var t=j.durations[e];return t||e+" seconds"};!function(e){e.Black100="var(--pf-global--palette--black-100)",e.Black150="var(--pf-global--palette--black-150)",e.Black200="var(--pf-global--palette--black-200)",e.Black600="var(--pf-global--palette--black-600)",e.Black700="var(--pf-global--palette--black-700)",e.Black800="var(--pf-global--palette--black-800)",e.Black1000="var(--pf-global--palette--black-1000)",e.Blue200="var(--pf-global--palette--blue-200)",e.Blue300="var(--pf-global--palette--blue-300)",e.Blue400="var(--pf-global--palette--blue-400)",e.Blue500="var(--pf-global--palette--blue-500)",e.Cyan300="var(--pf-global--palette--cyan-300)",e.Gold400="var(--pf-global--palette--gold-400)",e.Green400="var(--pf-global--palette--green-400)",e.Green500="var(--pf-global--palette--green-500)",e.LightBlue400="var(--pf-global--palette--light-blue-400)",e.LightGreen400="var(--pf-global--palette--light-green-400)",e.Orange400="var(--pf-global--palette--orange-400)",e.Purple100="var(--pf-global--palette--purple-100)",e.Purple400="var(--pf-global--palette--purple-400)",e.Red100="var(--pf-global--palette--red-100)",e.Red200="var(--pf-global--palette--red-200)",e.Red500="var(--pf-global--palette--red-500)",e.White="var(--pf-global--palette--white)",e.Active="var(--pf-global--active-color--400)",e.ActiveText="var(--pf-global--primary-color--200)",e.Badge="var(--pf-global--palette--blue-200)",e.Replay="var(--pf-global--active-color--300)",e.Danger="var(--pf-global--danger-color--100)",e.Info="var(--pf-global--info-color--100)",e.InfoBackground="var(--pf-global--info-color--200)",e.Success="#3e8635",e.SuccessBackground="var(--pf-global--success-color--200)",e.Warning="var(--pf-global--warning-color--100)",e.ChartDanger="var(--pf-global--danger-color--300)",e.ChartOther="var(--pf-global--palette-black-1000)",e.ChartWarning="var(--pf-global--danger-color--100)"}(nt||(nt={}));var oa;!function(e){e.HEALTH_RATE="health.kiali.io/rate"}(oa||(oa={}));var sa=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).annotation=void 0,n.isValid=void 0,n.toleranceConfig=void 0,n.validate=function(){return!n.annotation.split(";").some((function(e){return n.isNotValidAnnotation(e)}))},n.getToleranceConfig=function(){var e=[];return n.isValid&&n.annotation.split(";").forEach((function(t){var a=t.split(",");e.push({code:n.convertRegex(a[0],!0),degraded:Number(a[1]),failure:Number(a[2]),protocol:n.convertRegex(a[3]),direction:n.convertRegex(a[4])})})),e},n.convertRegex=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t?new RegExp(e.replace(/x|X/g,"\\d")):new RegExp(e)},n.isNotValidAnnotation=function(e){var t=e.split(",");return 5!==t.length||(!la(t[1])||!la(t[2])||Number(t[1])>Number(t[2]))},n.annotation=e[oa.HEALTH_RATE],n.annotation&&n.annotation.length>0?(n.isValid=n.validate(),n.toleranceConfig=n.isValid?n.getToleranceConfig():void 0):n.isValid=!1,n}return a}((function e(t){Object(s.a)(this,e),this.healthAnnotations=void 0,this.healthAnnotations=t})),la=function(e){return!isNaN(Number(e))},ca=function(e,t){for(var a={},n=0,r=Object.entries(e);n<r.length;n++){var i=Object(T.a)(r[n],2),o=i[0],s=i[1];a[o]={};for(var l=0,c=Object.entries(s);l<c.length;l++){var u=Object(T.a)(c[l],2),p=u[0],d=u[1];a[o][p]=d}}for(var m=0,h=Object.entries(t);m<h.length;m++){var f=Object(T.a)(h[m],2),g=f[0],v=f[1];Object.keys(a).includes(g)||(a[g]={});for(var E=0,b=Object.entries(v);E<b.length;E++){var y=Object(T.a)(b[E],2),C=y[0],S=y[1];Object.keys(a[g]).includes(C)||(a[g][C]=0),a[g][C]+=S}}return a},ua=function(e,t,a,n){var r=new sa(n.healthAnnotations).toleranceConfig||Aa(e,t,a).tolerance,i=function(e,t){var a=t.filter((function(e){return Ca(e.direction,"inbound")})),n=t.filter((function(e){return Ca(e.direction,"outbound")}));return{global:ma(ca(e.inbound,e.outbound),t),inbound:ma(e.inbound,a),outbound:ma(e.outbound,n)}}(n,r),o=pa(i.global);if(o.status.status!==xa)return{errorRatio:{global:o,inbound:pa(i.inbound),outbound:pa(i.outbound)},config:r};var s={errorRatio:{global:o,inbound:pa(i.inbound),outbound:pa(i.outbound)},config:r};if(s.errorRatio.inbound.status.status===xa||s.errorRatio.outbound.status.status===xa){var l=ya(n);s.errorRatio.inbound.status.value=s.errorRatio.inbound.status.status===xa?l.inbound:s.errorRatio.inbound.status.value,s.errorRatio.outbound.status.value=s.errorRatio.outbound.status.status===xa?l.outbound:s.errorRatio.outbound.status.value}return s},pa=function(e){for(var t={status:{value:ja,status:Na},protocol:"",toleranceConfig:void 0},a=0,n=Object.values(e);a<n.length;a++)for(var r=n[a],i=0,o=Object.entries(r.requests);i<o.length;i++){var s=Object(T.a)(o[i],2),l=s[0],c=s[1],u=r.tolerance&&Ca(r.tolerance.protocol,l)?r.tolerance:void 0,p=Ma(c.errorRatio,u);p.status.priority>t.status.status.priority&&(t.status=p,t.protocol=l,t.toleranceConfig=r.tolerance)}return t},da=function(e,t){for(var a=0,n=Object.entries(t);a<n.length;a++){var r=Object(T.a)(n[a],2),i=r[0],o=r[1];if(Ca(e.tolerance.protocol,i))for(var s=0,l=Object.entries(o);s<l.length;s++){var c=Object(T.a)(l[s],2),u=c[0],p=c[1];Object.keys(e.requests).includes(i)||(e.requests[i]=va()),e.requests[i].requestRate+=Number(p),Ca(e.tolerance.code,u)&&(e.requests[i].errorRate+=Number(p))}Object.keys(e.requests).includes(i)&&(0===e.requests[i].requestRate?e.requests[i].errorRatio=-1:e.requests[i].errorRatio=e.requests[i].errorRate/e.requests[i].requestRate)}},ma=function(e,t){var a=[];if(e&&t)for(var n=0,r=Object.values(t);n<r.length;n++){var i={tolerance:r[n],requests:{}};da(i,e),a.push(i)}return a},ha=function(e,t){if(e.tolerance)for(var a=0,n=Object.entries(t);a<n.length;a++){var r=Object(T.a)(n[a],2),i=r[0],o=r[1];if(Ca(e.tolerance.protocol,i))for(var s=0,l=Object.entries(o);s<l.length;s++){var c=Object(T.a)(l[s],2),u=c[0],p=c[1];Ca(e.tolerance.code,u)&&(e.requests[i]=e.requests[i]?e.requests[i]+p:p)}}},fa=function(e,t){for(var a={status:{value:ja,status:Na},protocol:"",toleranceConfig:void 0},n=0,r=Object.values(e);n<r.length;n++)for(var i=r[n],o=0,s=Object.entries(i.requests);o<s.length;o++){var l=Object(T.a)(s[o],2),c=l[0],u=l[1],p=i.tolerance&&Ca(i.tolerance.protocol,c)?i.tolerance:void 0,d={degraded:p.degraded,failure:p.failure,unit:"%"},m=u/ga(t),h=_a(100*m,d);h.status.priority>a.status.status.priority&&(a.status=h,a.protocol=c,a.toleranceConfig=i.tolerance)}return a.status.status===Na&&Object.keys(t).length>0&&(a.status.status=xa,a.status.value=0),a},ga=function(e){var t=0;return Object.values(e).forEach((function(e){Object.values(e.flags).forEach((function(e){return t+=Number(e)}))})),t},va=function(){return{requestRate:0,errorRate:0,errorRatio:0}},Ea={http:new RegExp("^[4|5]\\d\\d$"),grpc:new RegExp("^[1-9]$|^1[0-6]$")},ba=function(e){for(var t=va(),a=0,n=Object.entries(e);a<n.length;a++)for(var r=Object(T.a)(n[a],2),i=r[0],o=r[1],s=0,l=Object.entries(o);s<l.length;s++){var c=Object(T.a)(l[s],2),u=c[0],p=c[1];t.requestRate+=p,Object.keys(Ea).includes(i)&&Ea[i].test(u)&&(t.errorRate+=p)}return 0===t.requestRate?-1:t.errorRate/t.requestRate*100},ya=function(e){return{inbound:ba(e.inbound),outbound:ba(e.outbound)}},Ca=function(e,t){var a=e;return!a||("string"===typeof e&&(a=new RegExp(e)),a.test(t))},Sa={},Aa=function(e,t,a){var n=e+"_"+a+"_"+t;if(Sa[n])return Sa[n];if(j.healthConfig&&j.healthConfig.rate){var r,i=Object($t.a)(j.healthConfig.rate);try{for(i.s();!(r=i.n()).done;){var o=r.value;if(Ca(o.namespace,e)&&Ca(o.name,t)&&Ca(o.kind,a))return Sa[n]=o,o}}catch(s){i.e(s)}finally{i.f()}}return j.healthConfig.rate[j.healthConfig.rate.length-1]},Ta=function(e,t){var a={};a[t]={};for(var n=0,r=Object.entries(e);n<r.length;n++){var i=Object(T.a)(r[n],2),o=i[0],s=i[1],l=Object.values(s.flags).reduce((function(e,t){return String(Number(e)+Number(t))}));a[t][o]=Number(l)}return a},Oa=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=[];if(e&&t)for(var r=0,i=Object.values(t);r<i.length;r++){var o=i[r],s={tolerance:o,requests:{}};a?ha(s,e):da(s,e),n.push(s)}return n},Ia=function(e){return"Traffic Status (Last "+e+")"},wa={name:"Failure",color:nt.Danger,priority:4,icon:ea.a,class:"icon-failure"},Ra={name:"Degraded",color:nt.Warning,priority:3,icon:ta.a,class:"icon-degraded"},ka={name:"Not Ready",color:nt.InfoBackground,priority:2,icon:aa.a,class:"icon-idle"},xa={name:"Healthy",color:nt.Success,priority:1,icon:na.a,class:"icon-healthy"},Na={name:"No health information",color:nt.Black600,priority:0,icon:ra.a,class:"icon-na"},ja=-1,Pa=function(e,t,a,n){return 0===a?ka:a>0&&t>0&&e>0&&(t<a||e<a)?Ra:a>0&&0===e||a===e&&e!==t?wa:n>=0&&n<a?Ra:a===t&&t===e&&e===a?xa:Ra},La=function(e){return Da(e.CDS)&&Da(e.EDS)&&Da(e.LDS)&&Da(e.RDS)},Da=function(e){return"Synced"===e},Fa=function(e,t){return e.priority>t.priority?e:t},_a=function(e,t){if(e>0){if(e>=t.failure)return{value:e,status:wa,violation:e.toFixed(2)+t.unit+">="+t.failure+t.unit};if(e>=t.degraded)return{value:e,status:Ra,violation:e.toFixed(2)+t.unit+">="+t.degraded+t.unit}}return{value:e,status:xa}},Ma=function(e,t){if(t&&e>=0){var a={degraded:t.degraded,failure:t.failure,unit:"%"};return _a(100*e,a)}return{value:ja,status:Na}},Ha=function(e,t){return{status:e.status,text:t+": "+(e.status===Na?"No requests":e.value.toFixed(2)+"%"),value:e.status===Na?0:e.value}},Ga=function(){function e(t){Object(s.a)(this,e),this.health=t}return Object(l.a)(e,[{key:"getGlobalStatus",value:function(){return this.health.items.map((function(e){return e.status})).reduce((function(e,t){return Fa(e,t)}),Na)}},{key:"getStatusConfig",value:function(){var e,t,a=j.healthConfig.rate[j.healthConfig.rate.length-1].tolerance,n=Object($t.a)(a);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(this.health.statusConfig&&r===this.health.statusConfig.threshold)return}}catch(i){n.e(i)}finally{n.f()}return null===(e=this.health.statusConfig)||void 0===e?void 0:e.threshold}},{key:"getTrafficStatus",value:function(){for(var e=0;e<this.health.items.length;e++){var t=this.health.items[e];if(t.title.startsWith("Traffic Status"))return t}}},{key:"getWorkloadStatus",value:function(){for(var e=0;e<this.health.items.length;e++){var t=this.health.items[e];if(t.title.startsWith("Pod Status"))return t}}}]),e}(),Va=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e,n,r,i){var o;return Object(s.a)(this,a),(o=t.call(this,a.computeItems(e,n,r,i))).requests=r,o}return Object(l.a)(a,null,[{key:"computeItems",value:function(e,t,a,n){var r=[],i=void 0;if(n.hasSidecar){var o=ua(e,t,"service",a),s=o.errorRatio.global.status.status===Na?"No requests":o.errorRatio.global.status.value.toFixed(2)+"%",l={title:Ia(ia(n.rateInterval).toLowerCase()),status:o.errorRatio.global.status.status,children:[{text:"Inbound: "+s,status:o.errorRatio.global.status.status,value:o.errorRatio.global.status.value}]};r.push(l),i={title:Ia(ia(n.rateInterval).toLowerCase()),status:o.errorRatio.global.status.status,threshold:o.errorRatio.global.toleranceConfig,value:o.errorRatio.global.status.value}}else r.push({title:"Traffic Status",status:Na,text:"No Istio sidecar"});return{items:r,statusConfig:i}}}]),a}(Ga);Va.fromJson=function(e,t,a,n){return new Va(e,t,a.requests,n)};var Ua=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e,n,r,i,o){var l;return Object(s.a)(this,a),(l=t.call(this,a.computeItems(e,n,r,i,o))).requests=i,l}return Object(l.a)(a,null,[{key:"computeItems",value:function(e,t,a,n,r){var i=[],o=void 0,s=a.map((function(e){var t=Pa(e.availableReplicas,e.currentReplicas,e.desiredReplicas,e.syncedProxies),a="";return e.syncedProxies>=0&&(a=function(e,t){var a="";if(e<t){var n=t-e;a=" ("+n,a+=1!==n?" proxies":" proxy",a+=" unsynced)"}return a}(e.syncedProxies,e.desiredReplicas)),{text:e.name+": "+e.availableReplicas+" / "+e.desiredReplicas+a,status:t}})),l={title:"Pod Status",status:s.map((function(e){return e.status})).reduce((function(e,t){return Fa(e,t)}),Na),children:s};if(i.push(l),r.hasSidecar){var c=ua(e,t,"app",n),u=c.errorRatio.inbound.status,p=c.errorRatio.outbound.status,d=Fa(u.status,p.status),m={title:Ia(ia(r.rateInterval).toLowerCase()),status:d,children:[Ha(u,"Inbound"),Ha(p,"Outbound")]};o={title:Ia(ia(r.rateInterval).toLowerCase()),status:c.errorRatio.global.status.status,threshold:c.errorRatio.global.toleranceConfig,value:c.errorRatio.global.status.value},i.push(m)}return{items:i,statusConfig:o}}}]),a}(Ga);Ua.fromJson=function(e,t,a,n){return new Ua(e,t,a.workloadStatuses,a.requests,n)};var Ba=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e,n,r,i,o){var l;return Object(s.a)(this,a),(l=t.call(this,a.computeItems(e,n,r,i,o))).requests=i,l}return Object(l.a)(a,null,[{key:"computeItems",value:function(e,t,a,n,r){var i=[],o=void 0,s=Pa(a.availableReplicas,a.currentReplicas,a.desiredReplicas,a.syncedProxies),l={title:"Pod Status",status:s,children:[{text:a.name+": "+a.availableReplicas+" / "+a.desiredReplicas,status:s}]};if(s!==Na&&s!==xa&&(l.children=[{status:s,text:String(a.desiredReplicas+" desired pod"+(1!==a.desiredReplicas?"s":""))},{status:s,text:String(a.currentReplicas+" current pod"+(1!==a.currentReplicas?"s":""))},{status:s,text:String(a.availableReplicas+" available pod"+(1!==a.availableReplicas?"s":""))}],a.syncedProxies>=0&&l.children.push({status:s,text:String(a.syncedProxies+" synced prox"+(1!==a.availableReplicas?"ies":"y"))})),i.push(l),r.hasSidecar){var c=ua(e,t,"workload",n),u=c.errorRatio.inbound.status,p=c.errorRatio.outbound.status,d=Fa(u.status,p.status),m={title:Ia(ia(r.rateInterval).toLowerCase()),status:d,children:[Ha(u,"Inbound"),Ha(p,"Outbound")]};i.push(m),o={title:Ia(ia(r.rateInterval).toLowerCase()),status:c.errorRatio.global.status.status,threshold:c.errorRatio.global.toleranceConfig,value:c.errorRatio.global.status.value}}return{items:i,statusConfig:o}}}]),a}(Ga);Ba.fromJson=function(e,t,a,n){return new Ba(e,t,a.workloadStatus,a.requests,n)};var Wa=function(e){return!!e.health},qa=fe.api.urls,Ka=fe.login.headers,za=function(){return Object(C.a)({},Ka)},Ya=function(e){var t=za();return e===K.PATCH&&(t["Content-Type"]="application/json"),t},Qa=function(e,t){return{username:e,password:t}},Xa=function(e,t,a,n){return d.a.request({method:e,url:t,data:n,headers:Ya(e),params:a})},Ja=function(){var e=Object(Zt.a)(Jt.a.mark((function e(){var t,a,n=arguments;return Jt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:{username:"anonymous",password:"anonymous",token:""},(a=new URLSearchParams).append("token",t.token),e.abrupt("return",d()({method:K.POST,url:qa.authenticate,headers:za(),auth:Qa(t.username,t.password),data:a}));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Za=function(){return Xa(K.GET,qa.logout,{},{})},$a=function(){var e=Object(Zt.a)(Jt.a.mark((function e(){return Jt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Xa(K.GET,qa.authInfo,{},{}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),en=function(){var e=Object(Zt.a)(Jt.a.mark((function e(t){return Jt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Xa(K.POST,qa.authenticate,{},t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),tn=function(){return Xa(K.GET,qa.namespaces,{},{})},an=function(e,t){return Xa(K.GET,qa.namespaceMetrics(e),t,{})},nn=function(){return Xa(K.GET,qa.meshTls(),{},{})},rn=function(){return Xa(K.GET,qa.istioStatus(),{},{})},on=function(e){return Xa(K.GET,qa.namespaceValidations(e),{},{})},sn=function(e,t){return Xa(K.PATCH,qa.namespace(e),{},t)},ln=function(e,t,a,n,r){var i=t&&t.length>0?{objects:t.join(",")}:{};return a&&(i.validate=a),n&&(i.labelSelector=n),r&&(i.workloadSelector=r),Xa(K.GET,qa.istioConfig(e),i,{})},cn=function(e,t,a){return Xa(K.DELETE,qa.istioConfigDetail(e,t,a),{},{})},un=function(e,t,a,n){return Xa(K.PATCH,qa.istioConfigDetail(e,t,a),{},n)},pn=function(e,t,a){return Xa(K.POST,qa.istioConfigCreate(e,t),{},a)},dn=function(e){return Xa(K.GET,qa.services(e),{},{})},mn=function(e,t,a,n){var r=a?{rateInterval:String(a)+"s"}:{};return Xa(K.GET,qa.serviceHealth(e,t),r,{}).then((function(r){return Va.fromJson(e,t,r.data,{rateInterval:a,hasSidecar:n})}))},hn=function(e,t,a,n){var r=a?{rateInterval:String(a)+"s"}:{};return Xa(K.GET,qa.appHealth(e,t),r,{}).then((function(r){return Ua.fromJson(e,t,r.data,{rateInterval:a,hasSidecar:n})}))},fn=function(e,t,a,n,r){var i=n?{rateInterval:String(n)+"s"}:{};return i.type=a,Xa(K.GET,qa.workloadHealth(e,t),i,{}).then((function(a){return Ba.fromJson(e,t,a.data,{rateInterval:n,hasSidecar:r})}))},gn=function(e,t,a){var n={type:"app"};return t&&(n.rateInterval=String(t)+"s"),a&&(n.queryTime=String(a)),Xa(K.GET,qa.namespaceHealth(e),n,{}).then((function(a){var n={};return Object.keys(a.data).forEach((function(r){n[r]=Ua.fromJson(e,r,a.data[r],{rateInterval:t,hasSidecar:!0})})),n}))},vn=function(e,t,a){var n={type:"service"};return t&&(n.rateInterval=String(t)+"s"),a&&(n.queryTime=String(a)),Xa(K.GET,qa.namespaceHealth(e),n,{}).then((function(a){var n={};return Object.keys(a.data).forEach((function(r){n[r]=Va.fromJson(e,r,a.data[r],{rateInterval:t,hasSidecar:!0})})),n}))},En=function(e,t,a){var n={type:"workload"};return t&&(n.rateInterval=String(t)+"s"),a&&(n.queryTime=String(a)),Xa(K.GET,qa.namespaceHealth(e),n,{}).then((function(a){var n={};return Object.keys(a.data).forEach((function(r){n[r]=Ba.fromJson(e,r,a.data[r],{rateInterval:t,hasSidecar:!0})})),n}))},bn=function(){return Xa(K.GET,qa.grafana,{},{})},yn=function(e,t,a){return Xa(K.GET,qa.appTraces(e,t),a,{})},Cn=function(e,t,a){return Xa(K.GET,qa.serviceTraces(e,t),a,{})},Sn=function(e,t,a){return Xa(K.GET,qa.workloadTraces(e,t),a,{})},An=function(e){return Xa(K.GET,qa.namespacesGraphElements,e,{})},Tn=function(e,t,a,n){var r={};return a&&(r.validate=!0),n&&(r.rateInterval="".concat(n,"s")),Xa(K.GET,qa.service(e,t),r,{}).then((function(a){var r=a.data;return r.health&&(r.health=Va.fromJson(e,t,r.health,{rateInterval:n||600,hasSidecar:r.istioSidecar})),r}))},On=function(e){if(e&&e.response){if(e.response.data&&e.response.data.error)return e.response.data.error;if(e.response.statusText){var t=e.response.statusText;return 401===e.response.status&&(t+=": Has your session expired? Try logging in again."),t}}return""},In=function(e,t,a){return Xa(K.GET,qa.appSpans(e,t),a,{})},wn=function(e,t,a){return Xa(K.GET,qa.serviceSpans(e,t),a,{})},Rn=function(e,t,a){return Xa(K.GET,qa.workloadSpans(e,t),a,{})},kn=function(e){return Xa(K.GET,qa.istioPermissions,{namespaces:e.join(",")},{})},xn=function(){return Xa(K.GET,qa.iter8,{},{})},Nn=function(e,t){return Xa(K.GET,qa.iter8Experiment(e,t),{},{})},jn=function(e,t,a){return Xa(K.POST,qa.iter8ExperimentsByNamespace(e),a,t)},Pn=function(e){return Xa(K.POST,qa.metricsStats,{},{queries:e})},Ln=function(){return Xa(K.GET,qa.clusters,{},{})},Dn=function(e,t,a){Yt.dispatch(je.addMessage(e,"",t,a))},Fn=function(e){Yt.dispatch(je.addMessage(e.content,e.detail||"",e.group,e.type,e.showNotification))},_n=function(e,t,a,n,r){if(t){var i=n||Te.ERROR,o=Mn(e,t);Fn(Object(C.a)(Object(C.a)({},o),{},{group:a,type:i}))}else Yt.dispatch(je.addMessage(e,r||"",a,Te.ERROR))},Mn=function(e,t){var a=On(t),n=function(e){return e&&e.response&&e.response.data&&e.response.data.detail?e.response.data.detail:""}(t);return e?a&&n?{content:e,detail:"".concat(a,"\nAdditional Detail:\n").concat(n)}:n?{content:e,detail:n}:{content:e,detail:a}:{content:a,detail:n}},Hn=function(e,t,a,n){Yt.dispatch(je.addMessage(e,n||"",a,Te.INFO,t))},Gn=function(e,t,a,n){Yt.dispatch(je.addMessage(e,n||"",a,Te.SUCCESS,t))},Vn=function(e,t,a,n){Yt.dispatch(je.addMessage(e,n||"",a,Te.WARNING,t))},Un=(fe.toolbar.defaultRefreshInterval,function(e){Dn(e)}),Bn=function(e){var t=new URLSearchParams(U.location.search),a=[];return e.forEach((function(e){t.getAll(e.id).forEach((function(t){a.push({id:e.id,title:e.title,value:t})}))})),{filters:a,op:t.get("opLabel")||"or"}},Wn=function(e,t){var a=new URLSearchParams(U.location.search);e.forEach((function(e){a.delete(e.id)})),a.delete("opLabel");var n=[];return t.filters.forEach((function(t){var r=e.find((function(e){return e.id===t.id}));r&&(n.push(t),a.append(r.id,t.value))})),a.append("opLabel",t.op),U.push(U.location.pathname+"?"+a.toString()),{filters:n,op:t.op||"or"}},qn=function(e,t){var a=new Map;t.filters.forEach((function(e){var t=a.get(e.id)||[];a.set(e.id,t.concat(e.value))}));var n=new Map,r=new URLSearchParams(U.location.search);if(e.forEach((function(e){var t=r.getAll(e.id);if(t.length>0){var a=n.get(e.id)||[];n.set(e.id,a.concat(t))}})),a.size!==n.size)return!1;var i=!0;return a.forEach((function(e,t){var a=n.get(t)||[];i=i&&e.every((function(e){return a.includes(e)}))&&e.length===a.length})),i},Kn=function(){return"asc"===(q.getParam(P.DIRECTION)||"asc")},zn=function(){return q.getDuration()||600},Yn=function(e){var t=q.getParam(P.SORT)||e[0].param;return e.find((function(e){return e.param===t}))||e[0]},Qn=function(e,t,a){return t.reduce((function(e,t){return Xn(e,t,a)}),e)},Xn=function(e,t,a){var n={filters:a.filters.filter((function(e){return e.id===t.id})),op:a.op};return n.filters.length?e.filter((function(e){return t.run(e,n)})):e},Jn=a(7),Zn=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).updateWindowDimensions=function(){n.setState({height:window.innerHeight-194},(function(){n.props.onResize&&n.props.onResize(n.state.height)}))},n.state={height:0},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.updateWindowDimensions(),window.addEventListener("resize",this.updateWindowDimensions)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.updateWindowDimensions)}},{key:"render",value:function(){return i.a.createElement("div",{style:{height:this.state.height,overflowY:"auto",padding:"20px"},className:this.props.className?this.props.className:void 0},this.props.children)}}]),a}(i.a.Component),$n=Object(Jn.a)({padding:"30px 20px 0 20px"}),er=Object(Jn.a)({backgroundColor:nt.White}),tr=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){return i.a.createElement(Zn,{className:$n},i.a.createElement("div",{className:er},this.props.children))}}]),a}(i.a.Component),ar=a(38),nr=a(1438),rr=a(1439),ir=a(1431),or=a(1432),sr=a(1556),lr=a(32),cr=a(313),ur=a(1338),pr=a(1434),dr=a(1435),mr=a(1436),hr=a(752),fr=a(1437),gr=a(753),vr=a(289),Er=function(){function e(t){var a=this;Object(s.a)(this,e),this.promise=void 0,this.next=void 0,this.hasCanceled=!1,this.promise=new Promise((function(e,n){t.then((function(t){return a.hasCanceled?n({isCanceled:!0}):e(t)}),(function(e){return a.hasCanceled?n({isCanceled:!0}):n(e)}))}))}return Object(l.a)(e,[{key:"cancel",value:function(){this.hasCanceled=!0,this.next&&this.next.cancel()}},{key:"chain",value:function(t){for(var a=this,n=this;n.next;)n=n.next;return n.next=new e(this.promise.then((function(e){return a.hasCanceled?e:t(e)}))),this.promise=n.next.promise,n.next}}]),e}(),br=function(e){return new Er(e)},yr=function(){function e(){Object(s.a)(this,e),this.promises=new Map}return Object(l.a)(e,[{key:"register",value:function(e,t){var a=this.promises.get(e);a&&a.cancel();var n=br(t);return this.promises.set(e,n),n.promise}},{key:"registerChained",value:function(e,t,a){var n=this.promises.get(e);if(n)return n.chain(a),n.promise;var r=new Er(a(t));return this.promises.set(e,r),r.promise}},{key:"registerAll",value:function(e,t){return this.register(e,Promise.all(t))}},{key:"cancelAll",value:function(){this.promises.forEach((function(e){return e.cancel()})),this.promises.clear()}},{key:"cancel",value:function(e){var t=this.promises.get(e);t&&(t.cancel(),this.promises.delete(e))}},{key:"has",value:function(e){return this.promises.has(e)}}]),e}(),Cr=a(1554),Sr=a(1385),Ar=a(1386),Tr=a(1387),Or=a(1388),Ir=a(1389),wr=a(1390),Rr=a(1391),kr=a(1392),xr=a(1393),Nr=a(1394),jr=a(1395),Pr=a(1396),Lr=a(1397),Dr=a(1398),Fr=a(1399),_r=a(1400),Mr=a(1401),Hr=a(1402),Gr=a(1403),Vr=a(1404),Ur=a(1405),Br=a(1406),Wr=a(1407),qr=a(1408),Kr=a(1409),zr=a(1410),Yr=a(1411),Qr=a(1412),Xr=a(1413),Jr=a(1414),Zr=a(1415),$r=a(1416),ei=a(1417),ti=a(1418),ai=a(1419),ni=a(1420),ri=a(1421),ii=a(1422),oi=a(1423),si=a(1424),li=a(1425),ci=a(1426),ui=a(1427),pi=a(1428),di=a(1429),mi=Object(Jn.a)({}),hi=Object(Jn.a)({width:"10px"}),fi={AngleDoubleDown:function(e){return r.createElement(Sr.a,{className:e.className})},AngleDoubleLeft:function(e){return r.createElement(Ar.a,{className:e.className})},AngleDoubleRight:function(e){return r.createElement(Tr.a,{className:e.className})},AngleDoubleUp:function(e){return r.createElement(Or.a,{className:e.className})},AngleDown:function(e){return r.createElement(Ir.a,{className:e.className})},AngleLeft:function(e){return r.createElement(wr.a,{className:e.className})},AngleRight:function(e){return r.createElement(Rr.a,{className:e.className})},Applications:function(e){return r.createElement(kr.a,{className:e.className})},Back:function(e){return r.createElement(xr.a,{className:e.className})},Bell:function(e){return r.createElement(Nr.a,{className:e.className})},CircuitBreaker:function(e){return r.createElement(jr.a,{className:e.className})},Clock:function(e){return r.createElement(Pr.a,{className:e.className})},Close:function(e){return r.createElement(Lr.a,{className:e.className})},Compress:function(e){return r.createElement(Dr.a,{className:e.className})},Copy:function(e){return r.createElement(Fr.a,{className:e.className})},Error:function(e){return r.createElement(_r.a,{className:e.className,color:e.color||nt.Danger})},Expand:function(e){return r.createElement(Mr.a,{className:e.className})},FaultInjection:function(e){return r.createElement(Hr.a,{className:e.className})},Gateway:function(e){return r.createElement(Gr.a,{className:e.className})},Help:function(e){return r.createElement(Vr.a,{className:e.className})},History:function(e){return r.createElement(Ur.a,{className:e.className})},Info:function(e){return r.createElement(Br.a,{className:e.className,color:e.color||nt.Info})},IstioConfig:function(e){return r.createElement(Wr.a,{className:e.className})},LocalTime:function(e){return r.createElement(qr.a,{className:e.className})},MissingSidecar:function(e){return r.createElement(ve.a,{className:e.className})},MoreLegend:function(e){return r.createElement(Kr.a,{className:e.className})},MtlsLock:function(e){return r.createElement(zr.a,{className:e.className})},MtlsUnlock:function(e){return r.createElement(Yr.a,{className:e.className})},Ok:function(e){return r.createElement(Qr.a,{className:e.className,color:e.color||nt.Success})},Pause:function(e){return r.createElement(Xr.a,{className:e.className})},PauseCircle:function(e){return r.createElement(Jr.a,{className:e.className})},Play:function(e){return r.createElement(Zr.a,{className:e.className})},PlayCircle:function(e){return r.createElement($r.a,{className:e.className})},Regex:function(e){return r.createElement(ei.a,{className:e.className})},Repository:function(e){return r.createElement(ti.a,{className:e.className})},RequestRouting:function(e){return r.createElement(ai.a,{className:e.className})},RequestTimeout:function(e){return r.createElement(Pr.a,{className:e.className})},Services:function(e){return r.createElement(ni.a,{className:e.className})},Stop:function(e){return r.createElement(ri.a,{className:e.className})},Topology:function(e){return r.createElement(ii.a,{className:e.className})},TrafficShifting:function(e){return r.createElement(oi.a,{className:e.className})},Unknown:function(e){return r.createElement(ra.a,{className:e.className})},UserClock:function(e){return r.createElement(si.a,{className:e.className})},VirtualService:function(e){return r.createElement(ai.a,{className:e.className})},Warning:function(e){return r.createElement(li.a,{className:e.className,color:e.color||nt.Warning})},Website:function(e){return r.createElement(ci.a,{className:e.className})},Workloads:function(e){return r.createElement(ui.a,{className:e.className})},OnRunningIcon:function(e){return r.createElement(pi.a,{className:e.className})},InProgressIcon:function(e){return r.createElement(di.a,{className:e.className})}};function gi(e){return r.createElement("span",null,e)}Object.keys(fi).forEach((function(e){fi[e].defaultProps={className:hi}}));var vi=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).onkeyPress=function(e){"Enter"===e.key&&n.props.value&&n.props.value.length>0&&n.props.value.split(" ").map((function(e){return!n.props.isActive(e)&&n.props.filterAdd(e)}))},n.state={sortOperation:"or"},n}return Object(l.a)(a,[{key:"render",value:function(){var e=this;return r.createElement(r.Fragment,null,r.createElement(Ae.a,{type:"text",value:this.props.value,"aria-label":"filter_input_label_key",placeholder:"Set Label",onChange:function(t){return e.props.onChange(t)},onKeyPress:function(t){return e.onkeyPress(t)},style:{width:"auto"}}),r.createElement(Cr.a,{headerContent:r.createElement("span",null,"Label Filter Help"),position:Cr.b.right,bodyContent:r.createElement(r.Fragment,null,"To set a label filter you must enter values like.",r.createElement("br",null),r.createElement("ul",{style:{listStyleType:"circle",marginLeft:"20px"}},r.createElement("li",null,"Filter by label presence: label"),r.createElement("li",null,"Filter by label and value: label:value"),r.createElement("li",null,"Filter by more than one label and one or more values:",r.createElement("br",null),"label:value label2:value2,value2-2",r.createElement("br",null),"(separate with ' ')")))},r.createElement(vr.a,{variant:vr.b.link,style:{paddingLeft:"6px"}},r.createElement(fi.Help,{className:mi}))))}}]),a}(r.Component),Ei=a(30),bi=function(e,t,a){if(e.length!==t.length)return!1;for(var n=0;n<e.length;++n)if(!a(e[n],t[n]))return!1;return!0},yi=function(e,t){return bi(e,t,(function(e,t){return e.name===t.name}))};var Ci=[{id:"present",title:"Present"},{id:"notpresent",title:"Not Present"}],Si={id:"istiosidecar",title:"Istio Sidecar",placeholder:"Filter by IstioSidecar Validation",filterType:Oe.select,action:"update",filterValues:Ci},Ai={id:"health",title:"Health",placeholder:"Filter by Health",filterType:Oe.select,action:"append",filterValues:[{id:xa.name,title:xa.name},{id:Ra.name,title:Ra.name},{id:wa.name,title:wa.name},{id:ka.name,title:ka.name},{id:"na",title:Na.name}]},Ti={id:"label",title:"Label",placeholder:"Filter by Label",filterType:Oe.label,action:"append",filterValues:[]},Oi=function(e,t){var a,n=t.filters.filter((function(t){return t.id===e.id})).map((function(e){return e.value}));return a=n,Object(mt.a)(Array.from(new Set(a)))},Ii=function(e,t){var a=t.filters.filter((function(t){return t.id===e.id}));if(a.length>0)return"Present"===a[0].value},wi=function(e,t){var a=e.map((function(e){return e.healthPromise.then((function(t){return{health:t,item:e}}))}));return Promise.all(a).then((function(e){return e.filter((function(e){return t.includes(e.health.getGlobalStatus().name)})).map((function(e){return e.item}))}))},Ri=a(198),ki=Object(Jn.a)({paddingTop:"10px"}),xi=function e(){Object(s.a)(this,e)};xi.selectedFilters=void 0,xi.opSelected=void 0,xi.init=function(e){var t=xi.getSelected();return xi.isInitialized()?qn(e,t)||(t=Wn(e,t),xi.setSelected(t)):(t=Bn(e),xi.setSelected(t)),t},xi.resetFilters=function(){xi.selectedFilters=void 0},xi.setSelected=function(e){xi.selectedFilters=e.filters,xi.opSelected=e.op},xi.getSelected=function(){return{filters:xi.selectedFilters||[],op:xi.opSelected||"or"}},xi.isInitialized=function(){return void 0!==xi.selectedFilters};var Ni=Object(Jn.a)({paddingRight:"10px",display:"inherit"}),ji=Object(Jn.a)({borderRight:"1px solid #d1d1d1;",padding:"10px",display:"inherit"}),Pi=Object(Jn.a)({padding:"10px"}),Li=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).promises=new yr,n.filterAdded=function(e,t){var a=n.state.activeFilters,r={id:e.id,title:e.title,value:t},i=a.filters.filter((function(t){return t.id===e.id}));"update"===e.action&&i.length>0?i.forEach((function(e){return e.value=t})):a.filters.push(r),n.updateActiveFilters(a)},n.selectFilterType=function(e){var t=n.state.currentFilterType,a=n.state.filterTypes.filter((function(t){return t.id===e}))[0];t!==a&&n.setState({currentValue:"",currentFilterType:a})},n.filterValueAheadSelected=function(e,t){n.filterValueSelected(t),n.setState({isExpanded:!1})},n.filterValueSelected=function(e){var t=n.state,a=t.currentFilterType,r=t.currentValue,i=a.filterValues.find((function(t){return t.id===e}));i&&i.id!==r&&!n.isActive(a,i.title)&&n.filterAdded(a,i.title)},n.updateCurrentValue=function(e){n.setState({currentValue:e})},n.onValueKeyPress=function(e){var t=n.state,a=t.currentValue,r=t.currentFilterType;"Enter"===e.key&&(a&&a.length>0&&!n.isActive(r,a)&&n.filterAdded(r,a),n.setState({currentValue:""}),e.stopPropagation(),e.preventDefault())},n.isActive=function(e,t){return n.state.activeFilters.filters.some((function(a){return t===a.value&&e.id===a.id}))},n.removeFilter=function(e,t){var a=n.state.activeFilters.filters.filter((function(a){return a.id!==e||a.value!==t}));a.length!==n.state.activeFilters.filters.length&&n.updateActiveFilters({filters:a,op:n.state.activeFilters.op})},n.clearFilters=function(){n.updateActiveFilters({filters:[],op:"or"})},n.renderChildren=function(){return n.props.children&&r.createElement(ir.a,{style:{marginRight:"10px"}},Array.isArray(n.props.children)?n.props.children.map((function(e,t){return e&&r.createElement(or.a,{key:"toolbar_statefulFilters_"+t,className:Ri("pf-u-mr-md",t===n.props.children.length-1?Pi:ji)},e)})):r.createElement(or.a,null,n.props.children))},n.onToggle=function(e){n.setState({isExpanded:e})},n.state={currentFilterType:n.props.initialFilters[0],filterTypes:n.props.initialFilters,activeFilters:xi.init(n.props.initialFilters),isExpanded:!1,currentValue:""},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.loadDynamicFilters()}},{key:"loadDynamicFilters",value:function(){var e=this,t=this.props.initialFilters.map((function(e){return e.loader?e.loader().then((function(t){return e.filterValues=t,{id:e.id,title:e.title,placeholder:e.placeholder,filterType:e.filterType,action:e.action,filterValues:e.filterValues}})):Promise.resolve(e)}));this.promises.registerAll("filterType",t).then((function(t){return e.setState({filterTypes:t})})).catch((function(e){e.isCanceled||console.debug(e)}))}},{key:"componentDidUpdate",value:function(e){var t=this;if(this.props.initialFilters===e.initialFilters||bi(this.props.initialFilters,e.initialFilters,(function(e,t){return e.id===t.id&&bi(e.filterValues,t.filterValues,(function(e,t){return e.id===t.id&&e.title===t.title}))})))qn(this.state.filterTypes,this.state.activeFilters)||Wn(this.state.filterTypes,this.state.activeFilters);else{var a=this.props.initialFilters.find((function(e){return e.id===t.state.currentFilterType.id}))||this.props.initialFilters[0],n=Wn(this.props.initialFilters,this.state.activeFilters);this.setState({currentFilterType:a,filterTypes:this.props.initialFilters,activeFilters:n}),this.loadDynamicFilters()}}},{key:"componentWillUnmount",value:function(){this.promises.cancelAll()}},{key:"updateActiveFilters",value:function(e){var t=Wn(this.state.filterTypes,e);xi.setSelected(t),this.setState({activeFilters:t,currentValue:""}),this.props.onFilterChange(t)}},{key:"renderInput",value:function(){var e=this,t=this.state,a=t.currentFilterType,n=t.currentValue;return a?a.filterType===Oe.typeAhead?r.createElement(sr.a,{value:"default",onSelect:this.filterValueAheadSelected,onToggle:this.onToggle,variant:lr.e.typeahead,isExpanded:this.state.isExpanded,"aria-label":"filter_select_value",placeholderText:a.placeholder,width:"auto"},a.filterValues.map((function(e,t){return r.createElement(cr.a,{key:"filter_"+t,value:e.id,label:e.title})}))):a.filterType===Oe.select?r.createElement(ur.a,{value:"default",onChange:this.filterValueSelected,"aria-label":"filter_select_value",style:{width:"auto"}},r.createElement(pr.a,{key:"filter_default",value:"default",label:a.placeholder}),a.filterValues.map((function(e,t){return r.createElement(pr.a,{key:"filter_"+t,value:e.id,label:e.title})}))):a.filterType===Oe.label||a.filterType===Oe.nsLabel?r.createElement(vi,{value:n,onChange:this.updateCurrentValue,filterAdd:function(t){return e.filterAdded(a,t)},isActive:function(t){return e.isActive(a,t)}}):r.createElement(Ae.a,{type:a.filterType,value:n,"aria-label":"filter_input_value",placeholder:a.placeholder,onChange:this.updateCurrentValue,onKeyPress:function(t){return e.onValueKeyPress(t)},style:{width:"auto"}}):null}},{key:"render",value:function(){var e,t,a=this,n=this.state,i=n.currentFilterType,o=n.activeFilters;return r.createElement(r.Fragment,null,r.createElement(dr.a,{className:"pf-l-toolbar pf-u-justify-content-space-between pf-u-mx-xl pf-u-my-md"},r.createElement(mr.a,{"aria-label":"ToolbarSection"},this.props.childrenFirst&&this.renderChildren(),r.createElement(ir.a,{style:{marginRight:"0px"}},r.createElement(or.a,{className:Ri(this.props.children?Ni:"","pf-u-mr-xl")},r.createElement(ur.a,{value:i.id,"aria-label":"filter_select_type",onChange:this.selectFilterType,style:{width:"auto",backgroundColor:"#ededed",borderColor:"#bbb"}},this.state.filterTypes.map((function(e){return r.createElement(pr.a,{key:e.id,value:e.id,label:e.title})}))),this.renderInput())),!this.props.childrenFirst&&this.renderChildren(),(this.state.activeFilters.filters.filter((function(e){return e.id===Ti.id})).length>0||this.state.currentFilterType.filterType===Oe.label)&&r.createElement(ir.a,null,r.createElement(or.a,{className:Ri("pf-u-mr-md")},r.createElement("span",{className:Ri(Pi)},"Label Operation"),r.createElement(ur.a,{value:o.op,onChange:function(e){return a.updateActiveFilters({filters:a.state.activeFilters.filters,op:e})},"aria-label":"filter_select_value",style:{width:"auto"}},r.createElement(pr.a,{key:"filter_or",value:"or",label:"or"}),r.createElement(pr.a,{key:"filter_and",value:"and",label:"and"})))))),o&&o.filters.length>0&&r.createElement("div",{className:ki},r.createElement(dr.a,{className:"pf-l-toolbar pf-u-justify-content-space-between pf-u-mx-xl pf-u-my-md"},r.createElement(mr.a,{"aria-label":"FiltersSection"},r.createElement(r.Fragment,null,"Active Filters:"),r.createElement("div",{style:{marginLeft:"5px",display:"inline-flex",height:"80%"}},r.createElement(hr.a,{defaultIsOpen:!0,withToolbar:!0},Object.entries((e=o.filters,t="id",e.reduce((function(e,a){return Object(C.a)(Object(C.a)({},e),{},Object(Ei.a)({},a[t],[].concat(Object(mt.a)(e[a[t]]||[]),[a])))}),{}))).map((function(e){var t=Object(T.a)(e,2),n=t[0],i=t[1],o=i[0].title;return r.createElement(fr.a,{key:n,categoryName:o},i.map((function(e){return r.createElement(gr.a,{key:"filter_"+n+"_"+e.value,onClick:function(){return a.removeFilter(e.id,e.value)}},e.value)})))})))),r.createElement(vr.a,{variant:"link",onClick:function(e){e.preventDefault(),a.clearFilters()},style:{marginLeft:"5px"}},"Clear All Filters")))))}}]),a}(r.Component),Di={Sidecar:"sidecars",Gateway:"gateways",VirtualService:"virtualservices",DestinationRule:"destinationrules",ServiceEntry:"serviceentries",AuthorizationPolicy:"authorizationpolicies",PeerAuthentication:"peerauthentications",RequestAuthentication:"requestauthentications",WorkloadEntry:"workloadentries",WorkloadGroup:"workloadgroups",EnvoyFilter:"envoyfilters",gateways:"Gateway",virtualservices:"VirtualService",destinationrules:"DestinationRule",serviceentries:"ServiceEntry",authorizationpolicies:"AuthorizationPolicy",sidecars:"Sidecar",peerauthentications:"PeerAuthentication",requestauthentications:"RequestAuthentication",workloadentries:"WorkloadEntry",workloadgroups:"WorkloadGroup",envoyfilters:"EnvoyFilter",gateway:"Gateway",virtualservice:"VirtualService",destinationrule:"DestinationRule",serviceentry:"ServiceEntry",authorizationpolicy:"AuthorizationPolicy",sidecar:"Sidecar",peerauthentication:"PeerAuthentication",requestauthentication:"RequestAuthentication",workloadentry:"WorkloadEntry",workloadgroup:"WorkloadGroup",envoyfilter:"EnvoyFilter"},Fi=function(e,t){for(var a=0;a<t.length;a++)if(e.includes(t[a]))return!0;return!1},_i=function(e){var t=[],a=["validations","permissions","namespace"];return Object.keys(e).forEach((function(n){if(!(a.indexOf(n)>-1)){var r=Di[n.toLowerCase()],i=r.toLowerCase(),o=r.charAt(0).toLowerCase()+r.slice(1),s=e[n];s instanceof Array||(s=s.items),s.forEach((function(a){var n,r,s={namespace:e.namespace.name,type:i,name:a.metadata.name,creationTimestamp:a.metadata.creationTimestamp,resourceVersion:a.metadata.resourceVersion,validation:(n=i,r=a.metadata.name,e.validations[n]&&e.validations[n][r]?e.validations[i][a.metadata.name]:void 0)};s[o]=a,t.push(s)}))}})),t},Mi={applications:"App",services:"Service",workloads:"Workload",istio:"Istio Object",iter8:"Iter8 Experiment"},Hi=/namespaces\/([a-z0-9-]+)\/([\w-.]+)\/([\w-.]+)(\/([\w-.]+))?(\/([\w-.]+))?/,Gi=/extensions\/namespaces\/([a-z0-9-]+)\/([\w-.]+)\/([\w-.]+)(\/([\w-.]+))?(\/([\w-.]+))?/,Vi=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).updateItem=function(){var e=Hi,t=!1;n.props.location.pathname.startsWith("/extensions")&&(e=Gi,t=!0);var a=n.props.location.pathname.match(e)||[],r=a[1],i=ce[a[2].toUpperCase()],o=a[3];return{namespace:r,pathItem:i,item:"istio"!==i?a[3]:a[5],itemName:Mi[i],istioType:o,extension:t}},n.cleanFilters=function(){xi.resetFilters()},n.isIstio=function(){return"istio"===n.state.pathItem},n.isIter8=function(){return"iter8"===n.state.pathItem},n.getItemPage=function(){var e="/namespaces/".concat(n.state.namespace,"/").concat(n.state.pathItem,"/").concat(n.state.item);return n.state.extension&&(e="/extensions"+e),e},n.state=n.updateItem(),n}return Object(l.a)(a,[{key:"componentDidUpdate",value:function(e,t,a){e.location!==this.props.location&&this.setState(this.updateItem())}},{key:"render",value:function(){var e=this.state,t=e.namespace,n=e.item,i=e.istioType,o=e.pathItem,s=this.isIstio(),l=this.isIter8(),c=s?r.createElement(nr.a,{isActive:!0},n):r.createElement(nr.a,{isActive:!0},r.createElement(ar.a,{to:this.getItemPage(),onClick:this.cleanFilters},n));return r.createElement(rr.a,null,r.createElement(nr.a,null,r.createElement(ar.a,{to:"/".concat(this.state.extension?"extensions/"+o:o),onClick:this.cleanFilters},s?"Istio Config":l?"Iter8 Experiments":a.capitalize(o))),r.createElement(nr.a,null,r.createElement(ar.a,{to:"/".concat(this.state.extension?"extensions/"+o:o,"?namespaces=").concat(t),onClick:this.cleanFilters},"Namespace: ",t)),s&&r.createElement(nr.a,null,r.createElement(ar.a,{to:"/".concat(this.state.extension?"extensions/"+o:o,"?namespaces=").concat(t,"&istiotype=").concat(Di[this.state.istioType||""]),onClick:this.cleanFilters},i?a.istioType(i):i)),c)}}],[{key:"istioType",value:function(e){var t=Object.keys(Di).find((function(t){return Di[t]===e}));return t||this.capitalize(e)}}]),a}(r.Component);Vi.capitalize=function(e){return e.charAt(0).toUpperCase()+e.slice(1)};var Ui=Vi,Bi=Object(Jn.a)({padding:"0 20px 28px 20px"}),Wi=Object(Jn.a)({backgroundColor:nt.White}),qi=Object(Jn.a)({padding:"10px 0 4px 0"}),Ki=Object(Jn.a)({display:"flex",flexWrap:"wrap"}),zi=Object(Jn.a)({marginLeft:"auto"}),Yi=Object(Jn.a)({float:"right",backgroundColor:"#fff",padding:"0px 20px 22px 5px",marginTop:"-18px"}),Qi=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"".concat(Bi," ").concat(Wi)},this.props.location&&i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:qi},i.a.createElement("div",{className:Ki},i.a.createElement(Ui,{location:this.props.location}),this.props.rightToolbar&&i.a.createElement("div",{className:zi},this.props.rightToolbar)))),this.props.children),this.props.actionsToolbar&&i.a.createElement("div",{className:Yi},this.props.actionsToolbar))}}]),a}(i.a.Component),Xi="CronJob",Ji="DaemonSet",Zi="Deployment",$i="DeploymentConfig",eo="Job",to="Pod",ao="ReplicaSet",no="ReplicationController",ro="StatefulSet",io=a(741),oo=a(680),so=a(681),lo=a(616),co=a(1459),uo=a(214),po=["text","textTooltip","icon","namespace","color","tooltip","style"],mo=Object(Jn.a)({margin:"0px 5px 2px 4px",verticalAlign:"-5px !important"}),ho=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props,t=e.text,a=e.textTooltip,n=e.icon,i=e.namespace,o=e.color,s=e.tooltip,l=e.style,c=Object(uo.a)(e,po),u=r.createElement("span",Object.assign({style:l},c),r.createElement(n,{style:{color:o,verticalAlign:"-2px"}}),!s&&r.createElement("span",{style:{marginLeft:"8px"}},t,r.createElement(lo.a,{key:"tooltip_missing_sidecar",position:lo.b.top,content:r.createElement("div",{style:{textAlign:"left"}},a)},r.createElement(fi.Info,{className:mo}))));return _(i)?r.createElement(r.Fragment,null):s?r.createElement(lo.a,{content:r.createElement("div",{style:{textAlign:"left"}},a),position:lo.b.right},u):u}}]),a}(r.Component);ho.defaultProps={text:"Missing Sidecar",textTooltip:"Istio sidecar container not found in Pod(s). Check if the istio-injection label/annotation is correctly set on the namespace/workload.",tooltip:!1,icon:be.istio.missingSidecar.icon,color:be.istio.missingSidecar.color};var fo,go=ho,vo=function(e,t){return r.createElement(e.icon,{color:e.color,size:t,className:e.class})},Eo=(a(396),a(1430)),bo=Object(Jn.a)({margin:"15px 0 8px 0"}),yo=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).renderErrorRate=function(t,a){var n=e.props.health.getStatusConfig(),i=!(!n||!e.props.health.health.statusConfig)&&e.props.health.health.statusConfig.value>0;return!!t.children&&t.children.filter((function(e){return e.value&&e.value>0})).length>0?r.createElement("div",{key:a},r.createElement(r.Fragment,null,t.title+(t.text&&t.text.length>0?": ":"")," ",n&&r.createElement(Br.a,{color:nt.Black600})),t.text,t.children&&r.createElement("ul",{style:{listStyleType:"none"}},t.children.map((function(e,t){return e.value&&e.value>0?r.createElement("li",{key:t},r.createElement("span",{style:{marginRight:"10px"}},vo(e.status)),e.text):r.createElement(r.Fragment,{key:t})})),n&&i&&r.createElement("li",{key:"degraded_failure_config"},r.createElement("span",{style:{marginRight:"10px"}},vo(Ra)),":"," ",0===n.degraded?">":">=",n.degraded,"% ",vo(wa),": ",0===n.degraded?">":">=",n.failure,"%"))):r.createElement(r.Fragment,{key:a})},e.renderChildren=function(t,a){return t.title.startsWith("Traffic Status")?e.renderErrorRate(t,a):r.createElement("div",{key:a},r.createElement(r.Fragment,null,t.title+(t.text&&t.text.length>0?": ":"")),t.text,t.children&&r.createElement("ul",{style:{listStyleType:"none"}},t.children.map((function(e,t){return r.createElement("li",{key:t},r.createElement("span",{style:{marginRight:"10px"}},vo(e.status)),e.text)}))))},e}return Object(l.a)(a,[{key:"render",value:function(){var e=this;return this.props.health.health.items.map((function(t,a){return e.renderChildren(t,a)}))}}]),a}(r.PureComponent),Co=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).state=a.getDerivedStateFromProps(e),n}return Object(l.a)(a,[{key:"render",value:function(){if(this.props.health){var e=vo(this.state.globalStatus,"sm");return r.createElement(lo.a,{"aria-label":"Health indicator",content:r.createElement("div",null,r.createElement("strong",null,this.state.globalStatus.name),r.createElement(yo,{health:this.props.health})),position:Cr.b.auto,className:"health_indicator"},gi(e))}return r.createElement("span",null)}}],[{key:"getDerivedStateFromProps",value:function(e){return{globalStatus:e.health?e.health.getGlobalStatus():Na}}}]),a}(r.PureComponent);!function(e){e.Error="error",e.Warning="warning",e.Correct="correct",e.Info="info"}(fo||(fo={}));var So,Ao,To,Oo,Io={0:fo.Info,3:fo.Error,8:fo.Warning,12:fo.Info};!function(e){e.DEFAULT="DEFAULT",e.IPTABLES="IPTABLES",e.NONE="NONE"}(So||(So={})),function(e){e.STRICT="STRICT",e.PERMISSIVE="PERMISSIVE"}(Ao||(Ao={})),function(e){e.USE_PEER="USE_PEER",e.USE_ORIGIN="USE_ORIGIN"}(To||(To={})),function(e){e.UNSET="UNSET",e.DISABLE="DISABLE",e.PERMISSIVE="PERMISSIVE",e.STRICT="STRICT"}(Oo||(Oo={}));var wo,Ro=a(1441),ko=a(1440),xo=(a(945),{name:"Not Valid",color:nt.Danger,icon:ea.a}),No={name:"Warning",color:nt.Warning,icon:ta.a},jo={name:"Info",color:nt.Info,icon:ko.a},Po={error:xo,warning:No,correct:{name:"Valid",color:nt.Success,icon:na.a},info:jo},Lo=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"validation",value:function(){return Po[this.props.severity]}},{key:"severityColor",value:function(){return{color:this.validation().color}}},{key:"textStyle",value:function(){var e=this.props.messageColor||!1,t=this.props.textStyle||{};return e&&Object.assign(t,this.severityColor()),t}},{key:"iconStyle",value:function(){var e=this.props.iconStyle||{};return Object.assign(e,this.severityColor()),Object.assign(e,{verticalAlign:"-0.125em"}),e}},{key:"render",value:function(){var e=this.validation().icon;return!!this.props.message?i.a.createElement("div",{className:"validation"},i.a.createElement(Ro.a,{component:Ro.b.p,style:this.textStyle()},i.a.createElement(e,{style:this.iconStyle()})," ",this.props.message)):i.a.createElement(e,{style:this.iconStyle()})}}]),a}(i.a.Component),Do=Object(Jn.a)({textAlign:"left",border:0,padding:"0 0 0 0",margin:"0 0 0 0"}),Fo=Object(Jn.a)({textAlign:"center",border:0,padding:"0 0 0 0",margin:"0 0 0 0"}),_o=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).getTypeMessage=function(e,t){return e>1?"".concat(e," ").concat(t,"s found"):"".concat(e," ").concat(t," found")},e}return Object(l.a)(a,[{key:"severitySummary",value:function(){var e=[];return this.props.errors>0&&e.push(this.getTypeMessage(this.props.errors,fo.Error)),this.props.warnings>0&&e.push(this.getTypeMessage(this.props.warnings,fo.Warning)),0===e.length&&e.push("No issues found"),e}},{key:"severity",value:function(){var e=fo.Correct;return this.props.errors>0?e=fo.Error:this.props.warnings>0&&(e=fo.Warning),e}},{key:"tooltipNA",value:function(){return r.createElement(Ro.a,{className:Fo},"No Istio config objects found")}},{key:"tooltipNoValidationAvailable",value:function(){return r.createElement(Ro.a,{className:Do},"No Istio config validation available")}},{key:"tooltipSummary",value:function(){return r.createElement(r.Fragment,null,r.createElement(Ro.a,{style:{textAlign:"left",textEmphasis:"strong"},component:Ro.b.p},"Istio config objects analyzed: ",this.props.objectCount),r.createElement("div",{className:Do},this.severitySummary().map((function(e){return r.createElement("div",{key:e},e)}))))}},{key:"tooltipContent",value:function(){return void 0!==this.props.objectCount?0===this.props.objectCount?this.tooltipNA():this.tooltipSummary():this.tooltipNoValidationAvailable()}},{key:"tooltipBase",value:function(){return void 0===this.props.objectCount||this.props.objectCount>0?r.createElement(Lo,{iconStyle:this.props.style,severity:this.severity()}):r.createElement("div",{style:{display:"inline-block",marginLeft:"5px"}},"N/A")}},{key:"render",value:function(){return r.createElement(lo.a,{"aria-label":"Validations list",position:lo.b.auto,enableFlip:!0,content:this.tooltipContent()},this.tooltipBase())}}]),a}(r.PureComponent),Mo=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).numberOfChecks=function(t){var a=0;return e.props.validations.forEach((function(e){e.checks&&(a+=e.checks.filter((function(e){return e.severity===t})).length)})),a},e}return Object(l.a)(a,[{key:"render",value:function(){return r.createElement(_o,{id:this.props.id,objectCount:1,errors:this.numberOfChecks(fo.Error),warnings:this.numberOfChecks(fo.Warning),style:this.props.style})}}]),a}(r.PureComponent),Ho=a(755),Go=a.n(Ho),Vo=a(756),Uo=a.n(Vo),Bo=a(757),Wo=a.n(Bo),qo=a(758),Ko=a.n(qo),zo=a(759),Yo=a.n(zo),Qo=a(760),Xo=a.n(Qo),Jo=a(761),Zo=a.n(Jo),$o=a(762),es=a.n($o),ts=a(763),as=a.n(ts),ns=function(e,t,a,n,i){var o=n[e];return o?r.createElement("img",{key:"logo-"+a,src:o,alt:e,title:t,className:i}):r.createElement("span",{key:"logo-"+a},e)},rs={"Vert.x":Ko.a,"Node.js":Yo.a,Thorntail:Xo.a,Go:Zo.a,MicroProfile:es.a,JVM:as.a},is={grpc:Go.a,rest:Uo.a,graphql:Wo.a},os=Object(Jn.a)({marginTop:-2,marginRight:6,width:30}),ss=function(e,t,a){return ns(e,t,a,is,os)},ls=a(434),cs=a.n(ls),us=a(435),ps=a.n(us),ds=a(436),ms=a.n(ds),hs=a(437),fs=a.n(hs);!function(e){e.LOCK_FULL="LOCK_FULL",e.LOCK_HOLLOW="LOCK_HOLLOW",e.LOCK_FULL_DARK="LOCK_FULL_DARK",e.LOCK_HOLLOW_DARK="LOCK_HOLLOW_DARK"}(wo||(wo={}));var gs,vs=new Map([[wo.LOCK_FULL,cs.a],[wo.LOCK_FULL_DARK,ms.a],[wo.LOCK_HOLLOW,ps.a],[wo.LOCK_HOLLOW_DARK,fs.a]]),Es=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){return r.createElement(lo.a,{"aria-label":"mTLS status",position:this.props.tooltipPosition,enableFlip:!0,content:this.props.tooltipText},r.createElement("img",{className:this.props.iconClassName,src:vs.get(this.props.icon),alt:this.props.tooltipPosition}))}}]),a}(r.Component),bs={message:"",icon:"",showStatus:!1},ys=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"statusDescriptor",value:function(){return this.props.statusDescriptors.get(this.props.status)||bs}},{key:"icon",value:function(){return this.statusDescriptor().icon}},{key:"message",value:function(){return this.statusDescriptor().message}},{key:"showStatus",value:function(){return this.statusDescriptor().showStatus}},{key:"overlayPosition",value:function(){return this.props.overlayPosition||lo.b.left}},{key:"iconClassName",value:function(){return this.props.className||""}},{key:"render",value:function(){return this.showStatus()?r.createElement(Es,{icon:this.icon(),iconClassName:this.iconClassName(),tooltipText:this.message(),tooltipPosition:this.overlayPosition()}):null}}]),a}(r.Component);!function(e){e.ENABLED="MTLS_ENABLED",e.PARTIALLY="MTLS_PARTIALLY_ENABLED",e.NOT_ENABLED="MTLS_NOT_ENABLED",e.DISABLED="MTLS_DISABLED"}(gs||(gs={}));var Cs=function(e,t){var a=e;return t===gs.ENABLED&&e===gs.NOT_ENABLED&&(a=gs.ENABLED),a},Ss=new Map([[gs.ENABLED,{message:"mTLS is enabled for this namespace",icon:wo.LOCK_FULL_DARK,showStatus:!0}],[gs.PARTIALLY,{message:"mTLS is partially enabled for this namespace",icon:wo.LOCK_HOLLOW_DARK,showStatus:!0}],[gs.DISABLED,bs],[gs.NOT_ENABLED,bs]]),As=Object(Jn.a)({marginTop:-3,marginRight:18,marginLeft:2,width:10}),Ts=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){return r.createElement(ys,{status:this.props.status,className:As,statusDescriptors:Ss})}}]),a}(r.Component),Os=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).setFilters=function(){var t=[{id:Ai.id,title:Ai.title,value:e.props.status.name}];xi.setSelected({filters:t,op:"or"})},e}return Object(l.a)(a,[{key:"render",value:function(){var e=this,t=this.props.items.length,a=this.props.items;a.length>6&&(a=a.slice(0,5)).push("and "+(t-a.length)+" more...");var n=r.createElement("div",null,r.createElement("strong",null,this.props.status.name),a.map((function(t,a){return r.createElement("div",{key:e.props.id+"-"+a},r.createElement("span",{style:{marginRight:"10px"}},vo(e.props.status,"sm"))," ",t)})));return r.createElement(lo.a,{"aria-label":"Overview status",position:lo.b.auto,content:n,className:"health_indicator"},r.createElement("div",{style:{display:"inline-block",marginRight:"5px"}},r.createElement(ar.a,{to:"/".concat(this.props.targetPage,"?namespaces=").concat(this.props.namespace),onClick:function(){return e.setFilters()}},vo(this.props.status)," "+t)," "))}}]),a}(r.Component),Is=function(e,t,a,n){return"app"===e?t:"service"===e?a:n},ws=a(1442),Rs=a(1444),ks=a(1449),xs=a(1450),Ns=a(1452),js=a(1348),Ps=a(1339),Ls=a(1565),Ds=a(325),Fs=a(766),_s=document.createElement("canvas").getContext("2d");_s.font="14px overpass";var Ms,Hs,Gs=function(e){var t=e.x-11-e.textWidth/2,a=e.head?[e.head," "].concat(e.text):e.text,n=e.head?30:0,i=8+e.y-15*a.length/2+n;return r.createElement(r.Fragment,null,e.activePoints&&e.activePoints.filter((function(e){return e.color&&!e.hideLabel})).map((function(e,a){var n=e.symbol||"square";return r.createElement(Ls.a,{key:"item-"+a,style:{fill:e.color,type:n},x:t,y:i+15*a,symbol:n,size:5.5})})),r.createElement(Ds.a,Object.assign({},e,{text:a})))},Vs=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.props.onOpen&&this.props.activePoints&&this.props.onOpen(this.props.activePoints)}},{key:"componentWillUnmount",value:function(){this.props.onClose&&this.props.onClose()}},{key:"render",value:function(){return r.createElement(Ps.a,this.props)}}]),a}(r.Component),Us=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).state=a.getDerivedStateFromProps(e),n}return Object(l.a)(a,[{key:"render",value:function(){return r.createElement(Vs,Object.assign({},this.props,{text:this.state.texts,flyoutWidth:this.state.width,flyoutHeight:this.state.height,flyoutComponent:r.createElement(Fs.a,{style:{stroke:"none",fillOpacity:.6}}),labelComponent:r.createElement(Gs,{head:this.state.head,textWidth:this.state.textWidth}),constrainToVisibleArea:!0}))}}],[{key:"getDerivedStateFromProps",value:function(e){var t=e.showTime?function(e){if(e&&e.length>0){var t=e[0].x;if("object"===typeof t)return t.toLocaleTimeString()}}(e.activePoints):void 0,a=15*e.text.length+16;t&&(a+=30);var n=Array.isArray(e.text)?e.text:[e.text],r=Math.max.apply(Math,Object(mt.a)(n.map((function(e){return _s.measureText(e).width}))));return{head:t,texts:n,textWidth:r,width:50+(t?Math.max(r,_s.measureText(t).width):r),height:a}}}]),a}(r.Component),Bs=function(e,t){var a={};t.onClick&&(a.onClick=function(e){return e.stopPropagation(),[{childName:[t.serieID],target:"data",mutation:function(e){return t.onClick(e)}},{childName:[t.serieID],target:"data",eventKey:"all",mutation:function(){return null}}]}),t.onMouseOver&&(a.onMouseOver=function(){return[{childName:[t.serieID],target:"data",eventKey:"all",mutation:function(e){return t.onMouseOver(e)}}]},a.onMouseOut=function(){return[{childName:[t.serieID],target:"data",eventKey:"all",mutation:function(e){return t.onMouseOut?t.onMouseOut(e):null}}]}),e.push({childName:[t.legendName],target:"data",eventKey:String(t.idx),eventHandlers:a}),e.push({childName:[t.legendName],target:"labels",eventKey:String(t.idx),eventHandlers:a})},Ws=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).containerRef=void 0,n.handleResize=function(){n.containerRef&&n.containerRef.current&&n.setState({width:n.containerRef.current.clientWidth})},void 0===e.width&&(n.containerRef=r.createRef()),n.state={width:e.width||1,hiddenSeries:new Set},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.containerRef&&setTimeout((function(){e.handleResize(),window.addEventListener("resize",e.handleResize)}))}},{key:"componentWillUnmount",value:function(){this.containerRef&&window.removeEventListener("resize",this.handleResize)}},{key:"render",value:function(){return this.containerRef?r.createElement("div",{ref:this.containerRef},this.renderChart()):this.renderChart()}},{key:"renderChart",value:function(){var e=this,t=this.props.height||300,a=Object(C.a)({top:0,bottom:0,left:0,right:0},this.props.padding),n=[];this.props.showLegend&&(a.bottom+=30,t+=30,this.props.series.forEach((function(t,a){Bs(n,{legendName:e.props.name+"-legend",idx:a,serieID:e.props.name+"-area-"+a,onClick:function(){return e.state.hiddenSeries.delete(a)||e.state.hiddenSeries.add(a),e.setState({hiddenSeries:new Set(e.state.hiddenSeries)}),null},onMouseOver:function(e){return{style:Object(C.a)(Object(C.a)({},e.style),{},{strokeWidth:4,fillOpacity:.5})}}})})));var i=r.createElement(ws.a,{labels:function(t){return e.props.tooltipFormat?e.props.tooltipFormat(t.datum):t.datum.y},labelComponent:r.createElement(Us,null),voronoiBlacklist:this.props.series.map((function(t,a){return e.props.name+"-scatter-"+a}))}),o={axis:{stroke:"none"},ticks:{stroke:"none"},tickLabels:{stroke:"none",fill:"none"}};return r.createElement(Rs.a,Object.assign({},this.props,{height:t,width:this.state.width,padding:a,events:n,containerComponent:i,domainPadding:{y:1}}),r.createElement(ks.a,{tickCount:15,style:o}),r.createElement(ks.a,{dependentAxis:!0,style:o}),this.props.series.map((function(t,a){if(!e.state.hiddenSeries.has(a))return r.createElement(xs.a,{name:e.props.name+"-scatter-"+a,key:e.props.name+"-scatter-"+a,data:t.datapoints,style:{data:{fill:t.color}},size:function(e){return e.active?5:2}})})),this.props.series.map((function(t,a){if(!e.state.hiddenSeries.has(a))return r.createElement(Ns.a,{name:e.props.name+"-area-"+a,key:e.props.name+"-area-"+a,data:t.datapoints,style:{data:{fill:t.color,fillOpacity:.2,stroke:t.color,strokeWidth:2}},interpolation:"monotoneX"})})),this.props.showLegend&&r.createElement(js.a,{name:this.props.name+"-legend",data:this.props.series.map((function(t,a){return e.state.hiddenSeries.has(a)?Object(C.a)(Object(C.a)({},t.legendItem),{},{symbol:{fill:"#72767b"}}):t.legendItem})),y:t-30,height:30,width:this.state.width}))}}]),a}(r.Component),qs=function(e,t,a){return{name:e,symbol:{fill:t,type:a}}},Ks=function(e,t){var a=e.filter((function(e){return function(e,t){for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var n=e[a],r=t.get(a);if(r&&Object.prototype.hasOwnProperty.call(r,n)&&!r[n])return!1}return!0}(e.labels,t.values)}));return zs(a,t.prettifier)},zs=function(e,t){var a=!1;if(e.length>0){var n=e[0].name;a=e.some((function(e){return e.name!==n}))}var r=Ys(e);return e.map((function(e){var n=e.name,i=function(e){switch(e){case"0.5":return"p50";case"0.95":return"p95";case"0.99":return"p99";case"0.999":return"p99.9";default:return e}}(e.stat),o=Object.entries(e.labels).filter((function(e){return r.has(e[0])})).map((function(e){return t?t(e[0],e[1]):e[1]})),s=(i?[i]:[]).concat(o).join(","),l="";return l=""===s?n:a?"".concat(n," [").concat(s,"]"):s,Object(C.a)(Object(C.a)({},e),{},{name:l})}))},Ys=function(e){var t=new Map,a=new Set;return e.forEach((function(e){Object.entries(e.labels).forEach((function(e){if(!a.has(e[0])){var n=t.get(e[0]);void 0===n?t.set(e[0],e[1]):n!==e[1]&&(t.delete(e[0]),a.add(e[0]))}}))})),a},Qs=function(e,t){return e.map((function(e){return{name:t,x:new Date(1e3*e[0]),y:Number(e[1])}})).filter((function(e){return!isNaN(e.y)}))},Xs=function(e,t){var a=e.filter((function(e){return!isNaN(e[1])})).reduce((function(e,t){return t[0]>e[0]?t:e}));return a?[{name:t,time:new Date(1e3*a[0]),x:0,y:Number(a[1])}]:[]},Js=function(e,t){return{datapoints:e.map((function(e){return Object(C.a)(Object(C.a)({},t),e)})),legendItem:qs(t.name,t.color,t.symbol),color:t.color}},Zs=function(e,t,a){return Js(Qs(e,t),{name:t,color:a})},$s=0,el=function(e,t,a){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"time";return e.map((function(e){var r=a[$s%a.length];$s++;var i="time"===n?Qs(e.datapoints,e.name):Xs(e.datapoints,e.name);return Js(i,{name:e.name,unit:t,color:r})}))},tl=(a(414),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){if(this.props.metrics&&this.props.metrics.length>0){var e=el(this.props.metrics,"rps",[nt.Blue400],"time");return r.createElement(r.Fragment,null,"Traffic, "+ia(this.props.duration).toLowerCase(),r.createElement(Ws,{name:"traffic",height:60,showLegend:!1,padding:{top:5},tooltipFormat:function(e){return"".concat(e.x.toLocaleTimeString(),"\n").concat(e.y," RPS")},series:e}))}return r.createElement("div",{style:{paddingTop:"40px"}},"No traffic")}}]),a}(r.Component)),al=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){return r.createElement(r.Fragment,null,r.createElement(r.Fragment,null,this.renderStatus()),r.createElement("div",{style:{width:"100%",height:90,verticalAlign:"top"}},r.createElement(tl,{metrics:this.props.metrics,duration:this.props.duration})))}},{key:"renderStatus",value:function(){var e,t=Is(this.props.type,ce.APPLICATIONS,ce.SERVICES,ce.WORKLOADS),a=this.props.name,n=this.props.status,i=n.inError.length+n.inWarning.length+n.inSuccess.length+n.notAvailable.length+n.inNotReady.length;e=1===i?Is(this.props.type,"1 Application","1 Service","1 Workload"):i+Is(this.props.type," Applications"," Services"," Workloads");var o=r.createElement("div",{style:{display:"inline-block",width:"125px",whiteSpace:"nowrap"}},e);return i===n.notAvailable.length?r.createElement("div",{style:{textAlign:"left"}},r.createElement("span",null,o,r.createElement("div",{style:{display:"inline-block",marginLeft:"5px"}},"N/A"))):r.createElement(r.Fragment,null,r.createElement("div",{style:{textAlign:"left"}},r.createElement("span",null,o,r.createElement("div",{style:{display:"inline-block"}},n.inNotReady.length>0&&r.createElement(Os,{id:a+"-not-ready",namespace:a,status:ka,items:n.inNotReady,targetPage:t}),n.inError.length>0&&r.createElement(Os,{id:a+"-failure",namespace:a,status:wa,items:n.inError,targetPage:t}),n.inWarning.length>0&&r.createElement(Os,{id:a+"-degraded",namespace:a,status:Ra,items:n.inWarning,targetPage:t}),n.inSuccess.length>0&&r.createElement(Os,{id:a+"-healthy",namespace:a,status:xa,items:n.inSuccess,targetPage:t})))))}}]),a}(r.Component),nl=a(1456),rl=a(1457),il=a(1458),ol=a(1454),sl=a(1455),ll=Object(Jn.a)({width:"auto"}),cl=Object(Jn.a)({marginRight:"10px",marginTop:"10px",display:"inline"}),ul=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).onKeyChanged=function(e,t,a){if(!a){n.setState({currentValue:t,currentName:n.props.options[t]});var r=n.props.useName?n.props.options[t]:t;n.props.handleSelect(r)}n.setState({isExpanded:!1})},n.onToggle=function(e){n.setState({isExpanded:e}),n.props.onToggle&&n.props.onToggle(e)},n.state={currentValue:e.value||e.initialValue,currentName:e.label||e.initialLabel,isExpanded:!1},n}return Object(l.a)(a,[{key:"render",value:function(){var e=this,t=this.state,a=t.isExpanded,n=t.currentName,i=t.currentValue,o=r.createElement(sr.a,{onSelect:this.onKeyChanged,"aria-label":this.props.id,selections:this.props.value||i,placeholderText:this.props.label||n,id:this.props.id,onToggle:this.onToggle,isExpanded:a,ariaLabelledBy:this.props.id,isDisabled:this.props.disabled,className:this.props.classNameSelect?"".concat(this.props.classNameSelect," ").concat(ll):ll},Object.keys(this.props.options).map((function(t){return r.createElement(cr.a,{key:t,isSelected:t===String(e.props.value||e.state.currentValue),value:"".concat(t)},e.props.options[t])})));return r.createElement(r.Fragment,null,this.props.nameDropdown&&r.createElement(Ro.a,{component:Ro.b.h5,className:cl},this.props.nameDropdown),this.props.tooltip?r.createElement(lo.a,{key:"ot-"+this.props.id,entryDelay:1e3,position:this.props.tooltipBottom?"bottom":"top",content:r.createElement(r.Fragment,null,this.props.tooltip)},o):o)}}]),a}(r.Component),pl=ul,dl=a(363),ml=function(e){return Object(dl.a)(e,(function(e){return e}))},hl=ml((function(e){return e.namespaces.activeNamespaces})),fl=ml((function(e){return e.userSettings.duration})),gl=ml((function(e){return e.userSettings.timeRange})),vl=ml((function(e){return e.namespaces.filter})),El=ml((function(e){return e.graph.toolbarState.edgeLabels})),bl=ml((function(e){return e.graph.toolbarState.findValue})),yl=ml((function(e){return e.graph.toolbarState.graphType})),Cl=ml((function(e){return e.graph.toolbarState.hideValue})),Sl=ml((function(e){return e.namespaces.items})),Al=ml((function(e){return e.userSettings.refreshInterval})),Tl=ml((function(e){return e.userSettings.replayActive})),Ol=ml((function(e){return e.userSettings.replayWindow})),Il=ml((function(e){return e.userSettings.replayQueryTime})),wl=ml((function(e){return e.globalState.lastRefreshAt})),Rl=ml((function(e){return e.graph.toolbarState.showIdleNodes})),kl=ml((function(e){return e.graph.toolbarState.trafficRates})),xl=ml((function(e){return e.meshTLSStatus.status})),Nl=ml((function(e){return e.meshTLSStatus.status===gs.ENABLED})),jl=ml((function(e){return e.istioStatus})),Pl={paddingLeft:"10px",paddingRight:"10px"},Ll=[{id:"namespace",title:"Name",isNumeric:!1,param:"ns",compare:function(e,t){return e.name.localeCompare(t.name)}},{id:"health",title:"Health",isNumeric:!1,param:"h",compare:function(e,t){if(e.status&&t.status){var a=t.status.inError.length-e.status.inError.length;if(0!==a)return a;if(0!==(a=t.status.inWarning.length-e.status.inWarning.length))return a}else{if(e.status)return-1;if(t.status)return 1}return e.name.localeCompare(t.name)}},{id:"mtls",title:"mTLS",isNumeric:!1,param:"m",compare:function(e,t){return e.tlsStatus&&t.tlsStatus?e.tlsStatus.status.localeCompare(t.tlsStatus.status):e.tlsStatus?-1:t.tlsStatus?1:e.name.localeCompare(t.name)}},{id:"config",title:"Istio Config",isNumeric:!1,param:"ic",compare:function(e,t){if(e.validations&&t.validations){if(e.validations.errors!==t.validations.errors)return e.validations.errors>t.validations.errors?-1:1;if(e.validations.warnings!==t.validations.warnings)return e.validations.warnings>t.validations.warnings?-1:1;if(e.validations.objectCount&&t.validations.objectCount)return e.validations.objectCount===t.validations.objectCount?e.name.localeCompare(t.name):e.validations.objectCount>t.validations.objectCount?-1:1;if(e.validations.objectCount)return-1;if(t.validations.objectCount)return 1}else{if(e.validations)return-1;if(t.validations)return 1}return e.name.localeCompare(t.name)}}],Dl=function(e,t,a){return e.sort(a?t.compare:function(e,a){return t.compare(a,e)})},Fl={id:"namespace_search",title:"Namespace",placeholder:"Filter by Namespace",filterType:Ae.c.text,action:"append",filterValues:[],run:function(e,t){return t.filters.some((function(t){return e.name.includes(t.value)}))}},_l=new Map([[gs.ENABLED,"Enabled"],[gs.PARTIALLY,"Partially Enabled"],[gs.NOT_ENABLED,"Disabled"],[gs.DISABLED,"Disabled"]]),Ml={id:"mtls",title:"mTLS status",placeholder:"Filter by mTLS status",filterType:Oe.select,action:"append",filterValues:[{id:"enabled",title:"Enabled"},{id:"partiallyEnabled",title:"Partially Enabled"},{id:"disabled",title:"Disabled"}],run:function(e,t){return!!e.tlsStatus&&t.filters.some((function(t){return _l.get(e.tlsStatus.status)===t.value}))}},Hl={id:"nsLabel",title:"Namespace Label",placeholder:"Filter by Namespace Label",filterType:Oe.nsLabel,action:"append",filterValues:[],run:function(e,t){return t.filters.some((function(t){if(t.value.includes(":")){var a=t.value.split(":"),n=Object(T.a)(a,2),r=n[0];return n[1].split(",").some((function(t){return!!e.labels&&r in e.labels&&e.labels[r].startsWith(t)}))}return!!e.labels&&Object.keys(e.labels).some((function(e){return e.startsWith(t.value)}))}))}},Gl=[{id:ka.name,title:ka.name},{id:wa.name,title:wa.name},{id:Ra.name,title:Ra.name},{id:xa.name,title:xa.name}],Vl={id:"health",title:"Health",placeholder:"Filter by Application Health",filterType:Oe.select,action:"append",filterValues:Gl,run:function(e,t){var a=function(e){if(0===e.filters.length)return{noFilter:!0,showInNotReady:!0,showInError:!0,showInWarning:!0,showInSuccess:!0};var t=!1,a=!1,n=!1,r=!1;return e.filters.forEach((function(e){switch(e.value){case ka.name:t=!0;break;case wa.name:a=!0;break;case Ra.name:n=!0;break;case xa.name:r=!0}})),{noFilter:!1,showInNotReady:t,showInError:a,showInWarning:n,showInSuccess:r}}(t),n=a.showInNotReady,r=a.showInError,i=a.showInWarning,o=a.showInSuccess;return!!a.noFilter||!!e.status&&(n&&e.status.inNotReady.length>0||r&&e.status.inError.length>0||i&&e.status.inWarning.length>0||o&&e.status.inSuccess.length>0&&0===e.status.inError.length&&0===e.status.inWarning.length)}},Ul=[Fl,Vl,Ml,Hl],Bl=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=this,t=R(j,this.props.prefix,this.props.suffix);return r.createElement(pl,{id:this.props.id,disabled:this.props.disabled,handleSelect:function(t){return e.props.setDuration(Number(t))},value:String(this.props.duration),label:t[this.props.duration],options:t,tooltip:this.props.tooltip,tooltipBottom:this.props.tooltipBottom,nameDropdown:this.props.nameDropdown})}}]),a}(r.Component),Wl=Object(h.b)((function(e){return{duration:fl(e)}}),(function(e){return{setDuration:Object(Ie.b)(vt.setDuration,e)}}))(function(e){return function(t){Object(c.a)(n,t);var a=Object(u.a)(n);function n(e){var t;Object(s.a)(this,n),t=a.call(this,e);var r=new URLSearchParams(U.location.search),i=q.getDuration(r);return void 0!==i&&i!==e.duration&&e.setDuration(i),q.setParam(P.DURATION,String(t.props.duration)),t}return Object(l.a)(n,[{key:"componentDidUpdate",value:function(){q.setParam(P.DURATION,String(this.props.duration))}},{key:"render",value:function(){return r.createElement(e,this.props)}}]),n}(r.Component)}((Ms=Bl,function(e){return r.createElement(Ms,Object.assign({durations:R(j,e.prefix,e.suffix)},e))}))),ql=a(1453),Kl=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).handleRefresh=function(){e.props.setLastRefreshAt(Date.now()),e.props.handleRefresh()},e}return Object(l.a)(a,[{key:"getElementId",value:function(){return this.props.id||"refresh_button"}},{key:"getDisabled",value:function(){return this.props.disabled||!1}},{key:"render",value:function(){return r.createElement(lo.a,{position:"bottom",content:r.createElement(r.Fragment,null,"Refresh")},r.createElement(vr.a,{id:this.getElementId(),onClick:this.handleRefresh,isDisabled:this.getDisabled(),"aria-label":"Action",variant:"primary"},r.createElement(ql.a,null)))}}]),a}(r.Component),zl=Object(h.b)(null,(function(e){return{setLastRefreshAt:function(t){e(E.setLastRefreshAt(t))}}}))(Kl),Yl=fe.toolbar.refreshInterval,Ql=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;if(Object(s.a)(this,a),(n=t.call(this,e)).updateRefresher=function(){n.state.refresherRef&&clearInterval(n.state.refresherRef);var e=void 0;n.props.refreshInterval>0&&(e=window.setInterval(n.handleRefresh,n.props.refreshInterval),n.setState({refresherRef:e}))},n.updateRefreshInterval=function(e){n.props.setRefreshInterval(e)},n.handleRefresh=function(){n.props.setLastRefreshAt(Date.now()),n.props.handleRefresh&&n.props.handleRefresh()},e.manageURL){var r=q.getNumericParam(P.REFRESH_INTERVAL);void 0===r&&(r=e.refreshInterval),r!==e.refreshInterval&&e.setRefreshInterval(r),q.setParam(P.REFRESH_INTERVAL,String(r))}return n.state={refresherRef:void 0},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.updateRefresher()}},{key:"componentDidUpdate",value:function(e){this.props.manageURL&&q.setParam(P.REFRESH_INTERVAL,String(this.props.refreshInterval)),e.refreshInterval!==this.props.refreshInterval&&this.updateRefresher()}},{key:"componentWillUnmount",value:function(){this.state.refresherRef&&clearInterval(this.state.refresherRef)}},{key:"render",value:function(){var e=this;if(void 0!==this.props.refreshInterval){var t=this.props.hideLabel;return r.createElement(r.Fragment,null,!t&&r.createElement("label",{style:{paddingRight:"0.5em",marginLeft:"1.5em"}},"Refreshing"),r.createElement(ul,{id:this.props.id,handleSelect:function(t){return e.updateRefreshInterval(Number(t))},value:String(this.props.refreshInterval),label:Yl[this.props.refreshInterval],options:Yl,tooltip:"Refresh interval",tooltipBottom:!0}),r.createElement(zl,{handleRefresh:this.handleRefresh,disabled:this.props.disabled}))}return r.createElement(zl,{handleRefresh:this.handleRefresh})}}]),a}(r.PureComponent),Xl=Object(h.b)((function(e){return{refreshInterval:Al(e)}}),(function(e){return{setRefreshInterval:function(t){e(vt.setRefreshInterval(t))},setLastRefreshAt:function(t){e(E.setLastRefreshAt(t))}}}))(Ql),Jl=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).onToggleReplay=function(){e.props.toggleReplayActive()},e}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props.replayActive?"Traffic metrics per frame":"Traffic metrics per refresh",t=this.props.replayActive?[void 0,"Traffic"]:["Last",void 0],a=Object(T.a)(t,2),n=a[0],i=a[1];return r.createElement("span",null,this.props.supportsReplay&&!this.props.replayActive&&r.createElement(lo.a,{key:"time_range_replay",position:lo.b.left,content:"Replay..."},r.createElement(vr.a,{variant:"link",style:{padding:"1px 6px 0 0"},onClick:this.onToggleReplay},r.createElement(fi.History,{className:mi}))),r.createElement(Wl,{id:"time_range_duration",disabled:this.props.disabled,prefix:n,suffix:i,tooltip:e,tooltipBottom:!0}),!(this.props.supportsReplay&&this.props.replayActive)&&r.createElement(Xl,{id:"time_range_refresh",disabled:this.props.disabled,hideLabel:!0,handleRefresh:this.props.handleRefresh,manageURL:!0}),this.props.supportsReplay&&this.props.replayActive&&r.createElement(vr.a,{variant:"link",style:{margin:"1px 0 0 5px"},onClick:this.onToggleReplay},r.createElement("span",null,r.createElement(fi.Close,{className:mi}),"  Close Replay")))}}]),a}(r.PureComponent),Zl=Object(h.b)((function(e){return{duration:fl(e),replayActive:Tl(e)}}),(function(e){return{toggleReplayActive:Object(Ie.b)(vt.toggleReplayActive,e)}}))(Jl);!function(e){e[e.COMPACT=0]="COMPACT",e[e.EXPAND=1]="EXPAND",e[e.LIST=2]="LIST"}(Hs||(Hs={}));var $l={app:"Apps",workload:"Workloads",service:"Services"},ec=function(){var e={};return Ll.forEach((function(t){var a=t.id;Object.assign(e,Object(Ei.a)({},a,t.title))})),e}(),tc=Object(Jn.a)({backgroundColor:nt.White,padding:"0px 20px 0px 20px"}),ac=Object(Jn.a)({display:"flex",flexWrap:"wrap"}),nc=Object(Jn.a)({paddingTop:"10px"}),rc=Object(Jn.a)({marginLeft:"auto",height:"118px",padding:"10px 0px 0px 0px"}),ic=Object(Jn.a)({textAlign:"right"}),oc=Object(Jn.a)({paddingTop:"17px"}),sc=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).updateSortField=function(e){n.props.sort(e,n.state.isSortAscending),q.setParam(P.SORT,e.param),n.setState({sortField:e})},n.updateSortDirection=function(){var e=!n.state.isSortAscending;n.props.sort(n.state.sortField,e),q.setParam(P.DIRECTION,e?"asc":"desc"),n.setState({isSortAscending:e})},n.updateOverviewType=function(e){var t;if("app"!==(t=e)&&"workload"!==t&&"service"!==t)throw new Error("Overview type is not valid.");q.setParam(P.OVERVIEW_TYPE,e),n.setState({overviewType:e}),n.props.onRefresh()},n.changeSortField=function(e){var t=Ll.filter((function(t){return t.id===e}))[0];n.props.sort(t,n.state.isSortAscending),q.setParam(P.SORT,t.param),n.setState({sortField:t})},n.state={isSortAscending:Kn(),overviewType:a.currentOverviewType(),sortField:Yn(Ll)},n}return Object(l.a)(a,[{key:"componentDidUpdate",value:function(){var e=Yn(Ll),t=Kn();this.paramsAreSynced(e,t)||this.setState({sortField:e,isSortAscending:t})}},{key:"paramsAreSynced",value:function(e,t){return t===this.state.isSortAscending&&e.title===this.state.sortField.title}},{key:"render",value:function(){var e=this,t=r.createElement(Li,{initialFilters:Ul,onFilterChange:this.props.onRefresh,ref:this.props.statefulFilterRef},this.props.displayMode!==Hs.LIST&&r.createElement(r.Fragment,null,r.createElement(ul,{id:"sort_selector",handleSelect:this.changeSortField,value:this.state.sortField.id,label:ec[this.state.overviewType],options:ec}),r.createElement(vr.a,{variant:"plain",onClick:this.updateSortDirection,style:Object(C.a)({},Pl)},this.state.isSortAscending?r.createElement(ol.a,null):r.createElement(sl.a,null)))),a=r.createElement("div",{className:ic},r.createElement(Zl,{key:"overview-time-range",id:"overview-time-range",disabled:!1,handleRefresh:this.props.onRefresh})),n=r.createElement("div",{className:oc},r.createElement(ul,{id:"overview-type",disabled:!1,handleSelect:this.updateOverviewType,nameDropdown:"Health for",value:this.state.overviewType,label:$l[this.state.overviewType],options:$l}),r.createElement(lo.a,{content:r.createElement(r.Fragment,null,"Expand view"),position:lo.b.top},r.createElement(vr.a,{onClick:function(){return e.props.setDisplayMode(Hs.EXPAND)},variant:"plain",isActive:this.props.displayMode===Hs.EXPAND,style:{padding:"0 4px 0 16px"}},r.createElement(nl.a,null))),r.createElement(lo.a,{content:r.createElement(r.Fragment,null,"Compact view"),position:lo.b.top},r.createElement(vr.a,{onClick:function(){return e.props.setDisplayMode(Hs.COMPACT)},variant:"plain",isActive:this.props.displayMode===Hs.COMPACT,style:{padding:"0 4px 0 4px"}},r.createElement(rl.a,null))),r.createElement(lo.a,{content:r.createElement(r.Fragment,null,"List view"),position:lo.b.top},r.createElement(vr.a,{onClick:function(){return e.props.setDisplayMode(Hs.LIST)},variant:"plain",isActive:this.props.displayMode===Hs.LIST,style:{padding:"0 4px 0 4px"}},r.createElement(il.a,null))));return r.createElement("div",{className:tc},r.createElement("div",{className:ac},r.createElement("div",{className:nc},t),r.createElement("div",{className:rc},a,n)))}}],[{key:"currentOverviewType",value:function(){return q.getParam(P.OVERVIEW_TYPE)||"app"}}]),a}(r.Component),lc=Object(h.b)((function(e){return{duration:fl(e),refreshInterval:Al(e)}}),(function(e){return{setRefreshInterval:function(t){e(vt.setRefreshInterval(t))}}}))(sc),cc=Object.freeze({App:{badge:"A",tt:"Application"},Adapter:{badge:"A",tt:"Adapter"},AttributeManifest:{badge:"AM",tt:"Attribute Manifest"},AuthorizationPolicy:{badge:"AP",tt:"Authorization Policy"},Cluster:{badge:"CL",tt:"Cluster"},ClusterRBACConfig:{badge:"CRC",tt:"Cluster RBAC Configuration"},Container:{badge:"C",tt:"Container"},DestinationRule:{badge:"DR",tt:"Destination Rule"},EnvoyFilter:{badge:"EF",tt:"Envoy Filter"},Gateway:{badge:"G",tt:"Gateway"},Handler:{badge:"H",tt:"Handler"},Host:{badge:"H",tt:"Host"},Instance:{badge:"I",tt:"Instance"},Iter8:{badge:"IT8",tt:"Iter8 Experiment"},MeshPolicy:{badge:"MP",tt:"Mesh Policy"},Namespace:{badge:"NS",tt:"Namespace"},Operation:{badge:"O",tt:"Operation"},PeerAuthentication:{badge:"PA",tt:"Peer Authentication"},Pod:{badge:"P",tt:"Pod"},Policy:{badge:"P",tt:"Policy"},RBACConfig:{badge:"RC",tt:"RBAC Configuration"},RequestAuthentication:{badge:"RA",tt:"Request Authentication"},Rule:{badge:"R",tt:"Rule"},Service:{badge:"S",tt:"Service"},ServiceEntry:{badge:"SE",tt:"Service Entry"},ServiceRole:{badge:"SR",tt:"Service Role"},ServiceRoleBinding:{badge:"SRB",tt:"Service Role Binding"},Sidecar:{badge:"SC",tt:"Istio Sidecar Proxy"},Template:{badge:"T",tt:"Template"},Unknown:{badge:"U",tt:"Unknown"},VirtualService:{badge:"VS",tt:"Virtual Service"},Workload:{badge:"W",tt:"Workload"},WorkloadEntry:{badge:"WE",tt:"Workload Entry"},WorkloadGroup:{badge:"WG",tt:"Workload Group"}}),uc=Object(Jn.a)({backgroundColor:nt.Badge,borderRadius:"30em",marginRight:"10px"}),pc=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e="pfbadge-".concat(this.props.badge.badge),t=i.a.createElement(co.a,{className:this.props.className||uc,id:this.props.id||e,isRead:this.props.isRead||!1,key:this.props.key||e,style:this.props.style},this.props.badge.badge);return this.props.badge.tt?i.a.createElement(lo.a,{content:i.a.createElement(i.a.Fragment,null,this.props.badge.tt),id:"tt-".concat(this.props.id||e),key:"tt-".concat(this.props.key||e),position:this.props.position||lo.b.auto},t):t}}]),a}(i.a.PureComponent),dc=function(e,t){return i.a.createElement(pc,{badge:{badge:e,tt:t}})},mc=function(e,t,a,n){var r=Vc[a],i="/namespaces/"+t+"/"+ce.ISTIO;return i=i+"/"+r.url+"/"+e,n&&(i=i+"?"+n),i},hc=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props,t=e.name,a=e.namespace,n=e.type,i=e.subType,o=Vc[n];return r.createElement(r.Fragment,null,r.createElement(pc,{badge:o.badge,position:lo.b.top}),r.createElement(fc,{name:t,namespace:a,type:n,subType:i},a,"/",t))}}]),a}(r.Component),fc=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props,t=e.name,a=e.namespace,n=e.type,i=e.query;return r.createElement(ar.a,{to:mc(t,a,n,i)},this.props.children)}}]),a}(r.Component),gc=fc,vc=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).namespacesToParams=function(){var t="";return e.props.namespaces.length>0&&(t="namespaces="+e.props.namespaces.join(",")),t},e.validationToParams=function(){var t="";e.props.warnings&&(t+="configvalidation=Warning");var a="";return e.props.errors&&(a+="configvalidation=Not+Valid"),""!==t&&""!==a&&(t+="&"),t+=a},e.cleanFilters=function(){xi.resetFilters()},e}return Object(l.a)(a,[{key:"render",value:function(){var e=this.namespacesToParams(),t=this.validationToParams();return""!==e&&""!==t&&(e+="&"),e+=t,r.createElement(ar.a,{to:"/".concat(ce.ISTIO,"?").concat(e),onClick:this.cleanFilters},this.props.children)}}]),a}(r.Component),Ec=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).hasIstioObjects=function(){return e.props.objectCount&&e.props.objectCount>0},e}return Object(l.a)(a,[{key:"render",value:function(){var e=r.createElement("div",{style:{display:"inline-block",marginLeft:"5px"}},"N/A");return this.hasIstioObjects()&&(e=r.createElement(vc,{namespaces:[this.props.namespace],warnings:this.props.warnings>0,errors:this.props.errors>0},this.props.children)),e}}]),a}(r.PureComponent),bc=Object(Jn.a)({margin:"0px 5px 2px 4px",verticalAlign:"-5px !important"}),yc=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=j.istioLabels.appLabelName,t=j.istioLabels.versionLabelName,a=be.istio.missingLabel.icon,n=be.istio.missingLabel.color,i=r.createElement("div",{style:{textAlign:"left"}},this.props.missingApp&&r.createElement(r.Fragment,null,r.createElement("div",null,r.createElement(pc,{badge:{badge:e},isRead:!0,style:{marginRight:"0px"}})," label is missing."," ",r.createElement("br",null)),r.createElement("div",null,"This workload won't be linked with an application.")),this.props.missingVersion&&r.createElement(r.Fragment,null,r.createElement("div",null,r.createElement(pc,{badge:{badge:t},isRead:!0,style:{marginRight:"0px"}})," label is missing."," ",r.createElement("br",null)),r.createElement("div",null,"This workload won't have Istio routing capabilities.")),r.createElement("div",null,"Missing labels will impact in the telemetry collected by the Istio proxy.")),o=r.createElement("span",{style:this.props.style},r.createElement(a,{style:{color:n,verticalAlign:"-2px"}}),!this.props.tooltip&&r.createElement("span",{style:{marginLeft:"8px"}},"Missing ",this.props.missingApp?"App":this.props.missingVersion?"Version":"Label",r.createElement(lo.a,{key:"tooltip_missing_label",position:lo.b.top,content:i},r.createElement(fi.Info,{className:bc}))));return this.props.tooltip?r.createElement(lo.a,{key:"tooltip_missing_label",position:lo.b.right,content:i},o):o}}]),a}(r.Component),Cc=function(e,t,a){var n="istio"===t.name?Sc(e):"/namespaces/".concat(e.namespace,"/").concat(t.name,"/").concat(e.name);return a?n+"?"+a:n},Sc=function(e){var t=e.type;return mc(e.name,e.namespace,t)},Ac=function(e,t,a){var n="link_definition_"+t.name+"_"+e.namespace+"_"+e.name;return r.createElement("td",{role:"gridcell",key:"VirtuaItem_Item_"+e.namespace+"_"+e.name,style:{verticalAlign:"middle"}},r.createElement(pc,{badge:a,position:lo.b.top}),r.createElement(ar.a,{key:n,to:Cc(e,t),className:"virtualitem_definition_link"},e.name))};function Tc(e){return void 0!==e.healthPromise}var Oc,Ic=function(e){return!_(e.namespace)&&!e.istioSidecar},wc={name:"TLS",param:"tls",column:"TLS",transforms:[io.a,Object(oo.a)(5)],renderer:function(e){return r.createElement("td",{role:"gridcell",key:"VirtualItem_tls_"+e.name,style:{verticalAlign:"middle"}},e.tlsStatus?r.createElement(Ts,{status:e.tlsStatus.status}):void 0)}},Rc={name:"IstioConfiguration",param:"ic",column:"Config",transforms:[io.a,Object(oo.a)(5)],renderer:function(e){var t={objectCount:0,errors:0,warnings:0};return e.validations&&(t=e.validations),r.createElement("td",{role:"gridcell",key:"VirtuaItem_IstioConfig_"+e.name,style:{verticalAlign:"middle"}},r.createElement(Ec,{namespace:e.name,objectCount:t.objectCount,errors:t.errors,warnings:t.warnings},r.createElement(_o,{id:"ns-val-"+e.name,errors:t.errors,warnings:t.warnings,objectCount:t.objectCount})))}},kc={name:"Status",param:"h",column:"Status",transforms:[io.a,Object(oo.a)(40)],cellTransforms:[so.a],renderer:function(e){return e.status?r.createElement("td",{role:"gridcell",key:"VirtuaItem_Status_"+e.name,className:"pf-m-center",style:{verticalAlign:"middle"}},r.createElement(al,{key:e.name,name:e.name,duration:zn(),status:e.status,type:sc.currentOverviewType(),metrics:e.metrics})):r.createElement("td",{role:"gridcell",key:"VirtuaItem_Status_"+e.name})}},xc={name:"Namespace",param:"ns",column:"Namespace",transforms:[io.a],renderer:function(e,t,a){return r.createElement("td",{role:"gridcell",key:"VirtuaItem_NamespaceItem_"+e.name,style:{verticalAlign:"middle"}},r.createElement(pc,{badge:a}),e.name)}},Nc={name:"Item",param:"wn",column:"Name",transforms:[io.a],renderer:Ac},jc={name:"Item",param:"sn",column:"Name",transforms:[io.a],renderer:Ac},Pc={name:"Item",param:"in",column:"Name",transforms:[io.a],renderer:Ac},Lc={name:"Namespace",param:"ns",column:"Namespace",transforms:[io.a],renderer:function(e){return r.createElement("td",{role:"gridcell",key:"VirtuaItem_Namespace_"+e.namespace+"_"+e.name,style:{verticalAlign:"middle"}},r.createElement(pc,{badge:cc.Namespace,position:lo.b.top}),e.namespace)}},Dc={name:"Labels",param:"lb",column:"Labels",transforms:[Object(oo.a)(20)],renderer:function(e,t,a,n,i){var o=window.location.pathname,s="overview"===(o=o.substr(o.lastIndexOf("/console")+"/console".length+1))?Hl:Ti,l=Bn([s,du,mu]);return r.createElement("td",{role:"gridcell",key:"VirtuaItem_Labels_"+("namespace"in e&&"".concat(e.namespace,"_"))+e.name,style:{verticalAlign:"middle"}},e.labels&&Object.entries(e.labels).map((function(t){var a=Object(T.a)(t,2),n=a[0],o=a[1],c="".concat(n,":").concat(o),u=function(e,t,a,n){return e.some((function(e){if(e.id===n){if(e.value.includes(":")){var r=e.value.split(":"),i=Object(T.a)(r,2),o=i[0],s=i[1];return o===t&&s.split(",").some((function(e){return a.split(",").some((function(t){return t.trim().startsWith(e.trim())}))}))}return t===e.value}return e.id===du.id?"Present"===e.value&&"app"===t:"Present"===e.value&&"version"===t}))}(l.filters,n,o,s.id),p=Bn([s]).filters.some((function(e){return e.value.includes(c)})),d=r.createElement(co.a,{key:"labelbadge_".concat(n,"_").concat(o,"_").concat(e.name),isRead:!0,style:{backgroundColor:u?nt.Badge:void 0,cursor:p||!u?"pointer":"not-allowed",whiteSpace:"nowrap"},onClick:function(){return i?u?p&&i.current.removeFilter(s.id,c):i.current.filterAdded(s,c):{}}},n,": ",o);return i?r.createElement(lo.a,{key:"Tooltip_Label_"+n+"_"+o,content:u?p?r.createElement(r.Fragment,null,"Remove label from Filters"):r.createElement(r.Fragment,null,"Kiali can't remove the filter if is an expression"):r.createElement(r.Fragment,null,"Add label to Filters")},d):d})))}},Fc={name:"Health",param:"he",column:"Health",transforms:[io.a,Object(oo.a)(10)],renderer:function(e,t,a,n){return r.createElement("td",{role:"gridcell",key:"VirtuaItem_Health_"+e.namespace+"_"+e.name,style:{verticalAlign:"middle"}},n&&r.createElement(Co,{id:e.name,health:n}))}},_c={name:"Details",param:"is",column:"Details",transforms:[io.a,Object(oo.a)(10)],renderer:function(e){var t=Ic(e),a="appLabel"in e,n=a&&!e.appLabel,i=a&&!e.versionLabel,o=e.additionalDetailSample,s=t&&o&&o.icon;return r.createElement("td",{role:"gridcell",key:"VirtuaItem_Details_"+e.namespace+"_"+e.name,style:{verticalAlign:"middle",whiteSpace:"nowrap"}},r.createElement("ul",null,t&&r.createElement("li",null,r.createElement(go,{namespace:e.namespace})),a&&(n||i)&&r.createElement(yc,{missingApp:n,missingVersion:i,tooltip:!1}),s&&" ",o&&o.icon&&r.createElement("li",null,ss(o.icon,o.title,0)),e.istioReferences&&e.istioReferences.length>0&&e.istioReferences.map((function(t){return r.createElement("li",null,r.createElement(pc,{badge:cc[t.objectType],position:lo.b.top}),r.createElement(gc,{name:t.name,namespace:e.namespace||"",type:t.objectType.toLowerCase()},t.name))}))))}},Mc={name:"Configuration",param:"cv",column:"Configuration",transforms:[io.a,Object(oo.a)(10)],renderer:function(e,t){var a=e.validation,n=e.type?"list=yaml":"";return r.createElement("td",{role:"gridcell",key:"VirtuaItem_Conf_"+e.namespace+"_"+e.name,style:{verticalAlign:"middle"}},a?r.createElement(ar.a,{to:"".concat(Cc(e,t,n))},r.createElement(Mo,{id:e.name+"-config-validation",validations:[a]})):r.createElement(r.Fragment,null,"N/A"))}},Hc={name:"WorkloadType",param:"wt",column:"Type",transforms:[io.a],renderer:function(e){return r.createElement("td",{role:"gridcell",key:"VirtuaItem_WorkloadType_"+e.namespace+"_"+e.name,style:{verticalAlign:"middle"}},e.type)}},Gc={name:"IstioType",param:"it",column:"Type",transforms:[io.a],renderer:function(e){var t=e.type,a=Vc[t];return r.createElement("td",{role:"gridcell",key:"VirtuaItem_IstioType_"+e.namespace+"_"+e.name,style:{verticalAlign:"middle"}},a.name)}},Vc={gateway:{name:"Gateway",url:"gateways",badge:cc.Gateway},virtualservice:{name:"VirtualService",url:"virtualservices",badge:cc.VirtualService},destinationrule:{name:"DestinationRule",url:"destinationrules",badge:cc.DestinationRule},serviceentry:{name:"ServiceEntry",url:"serviceentries",badge:cc.ServiceEntry},rule:{name:"Rule",url:"rules",badge:cc.Rule},adapter:{name:"Adapter",url:"adapters",badge:cc.Adapter},template:{name:"Template",url:"templates",badge:cc.Template},instance:{name:"Instance",url:"instances",badge:cc.Instance},handler:{name:"Handler",url:"handlers",badge:cc.Handler},policy:{name:"Policy",url:"policies",badge:cc.Policy},meshpolicy:{name:"MeshPolicy",url:"meshpolicies",badge:cc.MeshPolicy},clusterrbacconfig:{name:"ClusterRbacConfig",url:"clusterrbacconfigs",badge:cc.ClusterRBACConfig},rbacconfig:{name:"RbacConfig",url:"rbacconfigs",badge:cc.RBACConfig},authorizationpolicy:{name:"AuthorizationPolicy",url:"authorizationpolicies",badge:cc.AuthorizationPolicy},sidecar:{name:"Sidecar",url:"sidecars",badge:cc.Sidecar},servicerole:{name:"ServiceRole",url:"serviceroles",icon:cc.ServiceRole},servicerolebinding:{name:"ServiceRoleBinding",url:"servicerolebindings",badge:cc.ServiceRoleBinding},peerauthentication:{name:"PeerAuthentication",url:"peerauthentications",badge:cc.PeerAuthentication},requestauthentication:{name:"RequestAuthentication",url:"requestauthentications",badge:cc.RequestAuthentication},workloadentry:{name:"WorkloadEntry",url:"workloadentries",badge:cc.WorkloadEntry},workloadgroup:{name:"WorkloadGroup",url:"workloadgroups",badge:cc.WorkloadGroup},envoyfilter:{name:"EnvoyFilter",url:"envoyfilters",badge:cc.EnvoyFilter},attributemanifest:{name:"AttributeManifest",url:"attributemanifests",badge:cc.AttributeManifest}},Uc={name:"namespaces",columns:[wc,xc,Rc,Dc,kc],badge:cc.Namespace},Bc={name:"workloads",columns:[Fc,Nc,Lc,Hc,Dc,_c],badge:cc.Workload},Wc={headerTable:!0,applications:{name:"applications",columns:[Fc,Nc,Lc,Dc,_c],badge:cc.App},workloads:Bc,overview:Uc,services:{name:"services",columns:[Fc,jc,Lc,Dc,Mc,_c],badge:cc.Service},istio:{name:"istio",columns:[Pc,Lc,Gc,Mc]}},qc=J()(Wc),Kc=function(e,t){var a=Xc(t),n=a.keys,r=a.keyValues,i=Object.keys(e).filter((function(e){return n.some((function(t){return e.startsWith(t)}))})).length>0;return!!i||(r.map((function(t){var a=t.split(":"),n=Object(T.a)(a,2),r=n[0];n[1].split(",").map((function(t){r in e&&!i&&(i=e[r].trim().split(",").some((function(e){return e.trim().startsWith(t.trim())})))}))})),i)},zc=function(e,t){var a=!0,n=Xc(t),r=n.keys,i=n.keyValues,o=Object.keys(e);return r.map((function(e){!o.includes(e)&&a&&(a=!1)})),a&&i.map((function(t){var n=t.split(":"),r=Object(T.a)(n,2),i=r[0],o=r[1];i in e&&a?o.split(",").map((function(t){e[i].split(",").some((function(e){return e.trim().startsWith(t.trim())}))||(a=!1)})):a=!1})),a},Yc=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"or";return"or"===a?Kc(e,t):zc(e,t)},Qc=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"or";return 0===t.length?e:e.filter((function(e){return Yc(e.labels,t,a)}))},Xc=function(e){return{keys:e.filter((function(e){return!e.includes(":")})),keyValues:e.filter((function(e){return e.includes(":")}))}},Jc=[{id:"namespace",title:"Namespace",isNumeric:!1,param:"ns",compare:function(e,t){return e.namespace.localeCompare(t.namespace)||e.name.localeCompare(t.name)}},{id:"istiotype",title:"Istio Type",isNumeric:!1,param:"it",compare:function(e,t){return e.type.localeCompare(t.type)||e.name.localeCompare(t.name)}},{id:"istioname",title:"Istio Name",isNumeric:!1,param:"in",compare:function(e,t){return e.name.localeCompare(t.name)||e.namespace.localeCompare(t.namespace)||e.type.localeCompare(t.type)}},{id:"configvalidation",title:"Config",isNumeric:!1,param:"cv",compare:function(e,t){var a=-1;return e.validation&&!t.validation?a=-1:!e.validation&&t.validation?a=1:e.validation||t.validation?e.validation&&t.validation&&(e.validation.valid&&!t.validation.valid?a=-1:!e.validation.valid&&t.validation.valid?a=1:e.validation.valid&&t.validation.valid?a=e.validation.checks.length-t.validation.checks.length:e.validation.valid||t.validation.valid||(a=t.validation.checks.length-e.validation.checks.length)):a=0,a||e.name.localeCompare(t.name)}}],Zc={id:"istioname",title:"Istio Name",placeholder:"Filter by Istio Name",filterType:Oe.text,action:"append",filterValues:[]},$c={id:"istiotype",title:"Istio Type",placeholder:"Filter by Istio Type",filterType:Oe.typeAhead,action:"append",filterValues:[{id:"AuthorizationPolicy",title:"AuthorizationPolicy"},{id:"DestinationRule",title:"DestinationRule"},{id:"EnvoyFilter",title:"EnvoyFilter"},{id:"Gateway",title:"Gateway"},{id:"PeerAuthentication",title:"PeerAuthentication"},{id:"RequestAuthentication",title:"RequestAuthentication"},{id:"ServiceEntry",title:"ServiceEntry"},{id:"Sidecar",title:"Sidecar"},{id:"VirtualService",title:"VirtualService"},{id:"WorkloadEntry",title:"WorkloadEntry"},{id:"WorkloadGroup",title:"WorkloadGroup"}]},eu={id:"configvalidation",title:"Config",placeholder:"Filter by Config Validation",filterType:Oe.select,action:"append",filterValues:[{id:"valid",title:"Valid"},{id:"warning",title:"Warning"},{id:"notvalid",title:"Not Valid"},{id:"notvalidated",title:"Not Validated"}]},tu=[$c,Zc,eu],au=function(e,t,a){return new Promise((function(n){n(e.sort(a?t.compare:function(e,a){return t.compare(a,e)}))}))},nu=[{id:"namespace",title:"Namespace",isNumeric:!1,param:"ns",compare:function(e,t){var a=e.namespace.localeCompare(t.namespace);return 0===a&&(a=e.name.localeCompare(t.name)),a}},{id:"appname",title:"App Name",isNumeric:!1,param:"wn",compare:function(e,t){return e.name.localeCompare(t.name)}},{id:"details",title:"Details",isNumeric:!1,param:"is",compare:function(e,t){var a=Ic(e)?1:0,n=Ic(t)?1:0;if(a!==n)return a-n;var r=e.istioReferences,i=t.istioReferences,o=su(r,i);return 0!==o?o:e.name.localeCompare(t.name)}},{id:"health",title:"Health",isNumeric:!1,param:"he",compare:function(e,t){if(Wa(e)&&Wa(t)){var a=e.health.getGlobalStatus(),n=t.health.getGlobalStatus();if(a.priority===n.priority){var r=ua(e.namespace,e.name,"app",e.health.requests).errorRatio.global.status.value,i=ua(t.namespace,t.name,"app",t.health.requests).errorRatio.global.status.value;return r===i?e.name.localeCompare(t.name):i-r}return n.priority-a.priority}return 0}}],ru={id:"appname",title:"App Name",placeholder:"Filter by App Name",filterType:Ae.c.text,action:"append",filterValues:[]},iu=[ru,Si,$c,Ai,Ti],ou=function(e,t){var a=e.objectType.localeCompare(t.objectType);if(0!==a)return a;var n=e.name.localeCompare(t.name);return 0!==n?n:e.namespace.localeCompare(t.namespace)},su=function(e,t){if(0===e.length&&0===t.length)return 0;if(0===e.length&&t.length>0)return-1;if(e.length>0&&0===t.length)return 1;if(e.length!==t.length)return e.length-t.length;for(var a=0;a<e.length;a++){var n=ou(e[a],t[a]);if(0!==n)return n}return 0},lu=function(e,t){return e.filter((function(t,a){return e.indexOf(t)===a})).sort((function(e,a){return t?ou(e,a):ou(a,e)}))},cu=function(e){return e.appLabel&&e.versionLabel?0:e.appLabel||e.versionLabel?1:2},uu=[{id:"namespace",title:"Namespace",isNumeric:!1,param:"ns",compare:function(e,t){var a=e.namespace.localeCompare(t.namespace);return 0===a&&(a=e.name.localeCompare(t.name)),a}},{id:"workloadname",title:"Workload Name",isNumeric:!1,param:"wn",compare:function(e,t){return e.name.localeCompare(t.name)}},{id:"workloadtype",title:"Workload Type",isNumeric:!1,param:"wt",compare:function(e,t){return e.type.localeCompare(t.type)}},{id:"details",title:"Details",isNumeric:!1,param:"is",compare:function(e,t){var a=Ic(e)?1:0,n=Ic(t)?1:0;if(a!==n)return a-n;var r=e.istioReferences,i=t.istioReferences,o=su(r,i);if(0!==o)return o;var s=e.additionalDetailSample&&e.additionalDetailSample.icon,l=t.additionalDetailSample&&t.additionalDetailSample.icon;if(s||l){if(!s||!l)return s?-1:1;var c=s.localeCompare(l);if(0!==c)return c}var u=cu(e),p=cu(t);return u!==p?u>p?1:-1:e.name.localeCompare(t.name)}},{id:"applabel",title:"App Label",isNumeric:!1,param:"al",compare:function(e,t){return e.appLabel&&!t.appLabel?-1:!e.appLabel&&t.appLabel?1:e.name.localeCompare(t.name)}},{id:"versionlabel",title:"Version Label",isNumeric:!1,param:"vl",compare:function(e,t){return e.versionLabel&&!t.versionLabel?-1:!e.versionLabel&&t.versionLabel?1:e.name.localeCompare(t.name)}},{id:"labelValidation",title:"Label Validation",isNumeric:!1,param:"lb",compare:function(e,t){return!e.versionLabel||!e.appLabel||t.versionLabel&&t.appLabel?e.versionLabel&&e.appLabel||!t.versionLabel||!t.appLabel?e.appLabel&&!t.appLabel?1:!e.appLabel&&t.appLabel?-1:e.versionLabel&&!t.versionLabel?1:!e.versionLabel&&t.versionLabel?-1:e.name.localeCompare(t.name):1:-1}},{id:"health",title:"Health",isNumeric:!1,param:"he",compare:function(e,t){if(Wa(e)&&Wa(t)){var a=e.health.getGlobalStatus(),n=t.health.getGlobalStatus();if(a.priority===n.priority){var r=ua(e.namespace,e.name,"workload",e.health.requests).errorRatio.global.status.value,i=ua(t.namespace,t.name,"workload",t.health.requests).errorRatio.global.status.value;return r===i?e.name.localeCompare(t.name):i-r}return n.priority-a.priority}return 0}}],pu={id:"workloadname",title:"Workload Name",placeholder:"Filter by Workload Name",filterType:Ae.c.text,action:"append",filterValues:[]},du={id:"applabel",title:"App Label",placeholder:"Filter by App Label Validation",filterType:Oe.select,action:"update",filterValues:Ci},mu={id:"versionlabel",title:"Version Label",placeholder:"Filter by Version Label Validation",filterType:Oe.select,action:"update",filterValues:Ci},hu={id:"workloadtype",title:"Workload Type",placeholder:"Filter by Workload Type",filterType:Oe.typeAhead,action:"append",filterValues:[{id:Xi,title:Xi},{id:Ji,title:Ji},{id:Zi,title:Zi},{id:$i,title:$i},{id:eo,title:eo},{id:to,title:to},{id:ao,title:ao},{id:no,title:no},{id:ro,title:ro}]},fu=[pu,hu,Si,$c,Ai,du,mu,Ti],gu=a(17),vu=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).onFilterChange=function(){n.updateListItems(!0)},n.handleError=function(e){Un(e)},n.updateSort=function(e,t){n.sortItemList(n.state.listItems,e,t).then((function(a){n.setState({currentSortField:e,isSortAscending:t,listItems:a}),q.setParam(P.SORT,e.param),q.setParam(P.DIRECTION,t?"asc":"desc")}))},n.updateListItems=n.updateListItems.bind(Object(gu.a)(n)),n.sortItemList=n.sortItemList.bind(Object(gu.a)(n)),n}return Object(l.a)(a,[{key:"handleAxiosError",value:function(e,t){var a="".concat(e,": ").concat(On(t));console.error(a),this.handleError(a)}}]),a}(r.Component),Eu=a(177),bu=a(1559),yu=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).promises=new yr,n.onHealthPromiseChanged=function(){var e=Object(Zt.a)(Jt.a.mark((function e(t){return Jt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.promises.register("health",t).then((function(e){n.setState({health:e})})).catch((function(e){if(!e.isCanceled)throw n.setState({health:void 0}),e}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.renderDetails=function(e,t){return n.props.config.columns.map((function(a){return a.renderer(e,n.props.config,n.getBadge(),t,n.props.statefulFilterProps)}))},n.getBadge=function(){return"istio"!==n.props.config.name?n.props.config.badge:Vc[n.props.item.type].badge},n.state={health:void 0},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){Tc(this.props.item)&&this.onHealthPromiseChanged(this.props.item.healthPromise)}},{key:"componentDidUpdate",value:function(e){Tc(this.props.item)&&this.props.item.healthPromise!==e.item.healthPromise&&this.onHealthPromiseChanged(this.props.item.healthPromise)}},{key:"componentWillUnmount",value:function(){this.promises.cancelAll()}},{key:"render",value:function(){var e=this.props,t=e.style,a=e.className,n=e.item,i="VirtualItem_"+("namespace"in n?"Ns"+n.namespace+"_"+n.name:n.name);return r.createElement("tr",{style:t,className:a,role:"row",key:i},this.renderDetails(n,this.state.health),this.props.action&&function(e,t){return r.createElement("td",{role:"gridcell",key:"VirtuaItem_Action_"+e,style:{verticalAlign:"middle"}},t)}(i,this.props.action))}}]),a}(r.Component),Cu=a(1460),Su=a(1461),Au=/\/([a-z0-9-]+)/,Tu=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;Object(s.a)(this,a),(n=t.call(this,e)).statefulFilters=r.createRef(),n.onSort=function(e,t,a){n.setState({sortBy:{index:t,direction:a}}),a&&q.setParam(P.DIRECTION,a),q.setParam(P.SORT,String(n.state.conf.columns[t].param)),n.props.sort&&n.props.sort(Yn(Ll),"asc"===a)};var i=(U.location.pathname.match(Au)||[])[1]||"",o=qc[i],l=o.columns&&qc.headerTable?o.columns.map((function(e){var t={title:e.column};return e.transforms&&(t.transforms=e.transforms),e.cellTransforms&&(t.cellTransforms=e.cellTransforms),t})):[];n.props.actions&&l.push({title:""});var c=-1,u=q.getParam(P.SORT);return u&&(c=o.columns.findIndex((function(e){return e.param===u}))),n.state={type:i,sortBy:{index:c,direction:q.getParam(P.DIRECTION)},columns:l,conf:o},n}return Object(l.a)(a,[{key:"render",value:function(){var e=this,t=this.props.rows,a=this.state,n=a.sortBy,i=a.columns,o=a.conf,s={cells:i,rows:[],gridBreakPoint:Eu.d.none,role:"presentation",caption:o.caption?o.caption:void 0},l="istio"===this.state.type?"Istio config":this.state.type,c=r.Children.map(this.props.children,(function(t){return r.isValidElement(t)?r.cloneElement(t,{ref:e.statefulFilters}):t})),u=t.map((function(t,a){return r.createElement(yu,{key:"vItem"+a,item:t,index:a,config:o,statefulFilterProps:e.props.statefulProps?e.props.statefulProps:e.statefulFilters,action:e.props.actions&&e.props.actions[a]?e.props.actions[a]:void 0})}));return r.createElement("div",{style:{padding:"20px",marginBottom:"20px"}},c,r.createElement(Eu.b,Object.assign({},s,{sortBy:n,onSort:this.onSort}),r.createElement(bu.a,null),r.createElement("tbody",null,this.props.rows.length>0?u:r.createElement("tr",null,r.createElement("td",{colSpan:s.cells.length},this.props.activeNamespaces.length>0?r.createElement(Cu.a,{variant:Cu.b.full},r.createElement(Eo.a,{headingLevel:"h5",size:"lg"},"No ",l," found"),r.createElement(Su.a,null,"No ",l," in namespace",1===this.props.activeNamespaces.length?" ".concat(this.props.activeNamespaces[0].name):"s: ".concat(this.props.activeNamespaces.map((function(e){return e.name})).join(", ")))):r.createElement(Cu.a,{variant:Cu.b.full},r.createElement(Eo.a,{headingLevel:"h5",size:"lg"},"No namespace is selected"),r.createElement(Su.a,null,"There is currently no namespace selected, please select one using the Namespace selector.")))))))}}]),a}(r.Component),Ou=Object(h.b)((function(e){return{activeNamespaces:hl(e)}}))(Tu),Iu=a(1462),wu=a(1433),Ru=a(1557),ku=a(1463),xu={asyncFetchNamespaces:function(){return function(e){return e(ht.requestStarted()),tn().then((function(e){return e.data})).then((function(t){e(ht.receiveList(Object(mt.a)(t),new Date))})).catch((function(){return e(ht.requestFailed())}))}},fetchNamespacesIfNeeded:function(){return function(e,t){if(function(e){return!e||!e.namespaces.isFetching}(t())){var a=t().authentication;return a&&a.session?e(xu.asyncFetchNamespaces()):Promise.resolve()}return Promise.resolve()}}},Nu=xu;!function(e){e[e.VIEWPORT_HEIGHT_MINUS_TOP=0]="VIEWPORT_HEIGHT_MINUS_TOP"}(Oc||(Oc={}));var ju=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).containerRef=void 0,n.containerRef=r.createRef(),n.state={},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.handleComponentUpdated()}},{key:"componentDidUpdate",value:function(){this.handleComponentUpdated()}},{key:"handleComponentUpdated",value:function(){var e=this.containerRef.current.getBoundingClientRect(),t={};if(this.props.maxHeight){var a=this.processProperty(this.props.maxHeight,e);a!==this.state.maxHeight&&(t.maxHeight=a)}Object.values(t).length>0&&this.setState(t),this.props.handleBoundingClientRect&&this.props.handleBoundingClientRect(e)}},{key:"render",value:function(){var e={maxHeight:this.state.maxHeight};return r.createElement("div",{className:this.props.className,style:e,ref:this.containerRef},this.props.children)}},{key:"processProperty",value:function(e,t){var a=e.margin?e.margin:0;switch(e.type){case Oc.VIEWPORT_HEIGHT_MINUS_TOP:return function(e,t){return"calc(100vh - ".concat(e.top+t,"px)")}(t,a);default:throw Error("Undefined property type:"+e.type)}}}]),a}(r.Component),Pu=a(276),Lu=Object(Jn.a)({borderRadius:"20px",backgroundColor:nt.Blue300,padding:"2px 6px",marginRight:"10px",color:nt.White});function Du(e,t,a){if("back"===a){for(var n=t-1;n>=0;--n)if(e.stops[n].isValid)return n}else for(var r=t+1;r<e.stops.length;++r)if(e.stops[r].isValid)return r}var Fu,_u=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).tourStopInfo=void 0,n.getStop=function(e){if(void 0!==n.props.activeStop)return Du(n.props.activeTour,n.props.activeStop,e)},n.setStop=function(e){n.props.setStop(e)},n.backButton=function(){var e=n.getStop("back");return r.createElement(vr.a,{isDisabled:void 0===e,variant:"secondary",onClick:function(){return n.setStop(e)}},r.createElement(fi.AngleLeft,null)," Back")},n.nextButton=function(){var e=Object(Jn.a)({float:"right"}),t=n.getStop("forward");return void 0===t?r.createElement(vr.a,{className:e,variant:"primary",onClick:n.props.endTour},"Done"):r.createElement(vr.a,{className:e,variant:"primary",onClick:function(){return n.setStop(t)}},"Next ",r.createElement(fi.AngleRight,null))},n.activeInfo=function(){var e,t=Object($t.a)(n.tourStopInfo);try{for(t.s();!(e=t.n()).done;){var a=e.value,r=a.name;if(void 0!==n.props.activeTour&&r===n.props.activeTour.stops[n.props.activeStop].name)return a}}catch(i){t.e(i)}finally{t.f()}},n.onHidden=function(){n.activeInfo()&&n.forceUpdate()},n.onResize=function(){n.activeInfo()&&n.forceUpdate()},n.shouldClose=function(){n.props.endTour()},n.tourStopInfo=Array.isArray(e.info)?e.info:[e.info],n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.tourStopInfo.forEach((function(e){return e.isValid=!0}))}},{key:"componentWillUnmount",value:function(){this.tourStopInfo.forEach((function(e){return e.isValid=!1}))}},{key:"render",value:function(){var e=this.activeInfo(),t={offset:e&&e.offset?e.offset:"0, 0"},a=this.props.children;return r.createElement(r.Fragment,null,e?r.createElement(r.Fragment,null,r.createElement(Pu.a,{refreshMode:"debounce",refreshRate:100,skipOnMount:!0,handleWidth:!0,handleHeight:!0,onResize:this.onResize}),r.createElement(Cr.a,{isVisible:!0,shouldClose:this.shouldClose,onHidden:this.onHidden,position:e.position,tippyProps:t,headerContent:r.createElement("div",null,r.createElement("span",{className:Lu},this.props.activeStop+1),r.createElement("span",null,e.name)),bodyContent:e.description,footerContent:r.createElement("div",null,this.backButton(),this.nextButton())},r.createElement(r.Fragment,null,a))):r.createElement(r.Fragment,null,a))}}]),a}(r.PureComponent),Mu=Object(h.b)((function(e){return{activeTour:e.tourState.activeTour,activeStop:e.tourState.activeStop}}),(function(e){return{endTour:Object(Ie.b)(yt.endTour,e),setStop:Object(Ie.b)(yt.setStop,e)}}))(_u),Hu={ContextualMenu:{name:"Contextual Menu",description:"Right-click a node or an edge to see the contextual menu with links to details, traffic and inbound/outbound metrics for the node or edge.",position:Cr.b.left,offset:"0, 250"},Display:{name:"Display",description:"Set edge labeling, node badging, and various display options. Response-time edge labeling, security badging, and traffic animation may affect performance. Response-times reflect the 95th percentile."},Find:{name:"Find and Hide",description:"Highlight or Hide graph elements via typed expressions. Click the dropdown for preset Find or Hide expressions. Click the Find/Hide help icon for details on the expression language.",position:Cr.b.bottom},Graph:{name:"Graph",description:"Click on a node or edge to see its summary and emphasize its end-to-end paths. Double-click a node to see a graph focused on that node.\nDouble-click an 'external namespace' node to navigate directly to the namespace in the node's text label. Shift-Drag to quickly zoom in.",position:Cr.b.left,offset:"0, 250"},GraphTraffic:{name:"Graph Traffic",description:"Choose the traffic rates used to generate the graph. Each supported protocol offers one or more options. Unused protocols can be omitted.",position:Cr.b.bottom},GraphType:{name:"Graph Type",description:"Select a workload, service or application graph view. An application view can optionally be versioned and relies on app and version labeling. Workload and service graphs provide physical and logical views, respectively.",position:Cr.b.right},Layout:{name:"Layout selection",description:"Select the graph layout for the mesh. Different layouts work best with different meshes. Find the layout that works best. Other buttons here provide zoom and fit-to-screen options."},Legend:{name:"Legend",description:"Display the legend to learn about what the different shapes, colors and backgrounds mean.",position:Cr.b.top},Namespaces:{name:"Namespaces",description:"Select the namespaces you want to see in the graph.",position:Cr.b.bottom},SidePanel:{name:"Side Panel",description:"The Side Panel shows details about the currently selected node or edge, otherwise the whole graph.",position:Cr.b.left},TimeRange:{name:"Time Range & Replay",description:'Select how often to refresh the graph and how much historical metric data is used to build the graph, per refresh. For example "Last 5m" means use the most recent 5 minutes of request metric data.  To replay a historical time window click the replay icon.  This replaces the current time range controls with the replay toolbar.',position:Cr.b.left}},Gu={name:"GraphTour",stops:[Hu.Namespaces,Hu.GraphTraffic,Hu.GraphType,Hu.Display,Hu.Find,Hu.TimeRange,Hu.Graph,Hu.ContextualMenu,Hu.SidePanel,Hu.Layout,Hu.Legend]},Vu=Object(Jn.a)({marginLeft:"0.5em",position:"relative",top:8}),Uu=Object(Jn.a)({marginLeft:"1.0em"}),Bu=Object(Jn.a)({marginLeft:"0.5em"}),Wu=Object(Jn.a)({margin:"0 0.5em 10px 0.5em",width:300}),qu=Object(Jn.a)({overflow:"auto"}),Ku=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).syncNamespacesURLParam=function(){var e=(q.getParam(P.NAMESPACES)||"").split(",").filter(Boolean);if(e.length>0&&A.a.difference(e,n.props.activeNamespaces.map((function(e){return e.name})))){var t=e.map((function(e){return{name:e}}));n.props.setActiveNamespaces(t)}else 0===e.length&&0!==n.props.activeNamespaces.length&&q.setParam(P.NAMESPACES,n.props.activeNamespaces.map((function(e){return e.name})).join(","))},n.onToggle=function(e){e?n.props.refresh():(n.props.setActiveNamespaces(n.state.selectedNamespaces),n.clearFilter()),n.setState({isOpen:e})},n.onBulkAll=function(){var e=Array.from(new Set([].concat(Object(mt.a)(n.state.selectedNamespaces),Object(mt.a)(n.filtered()))));n.setState({selectedNamespaces:e})},n.onBulkNone=function(){var e=n.filtered(),t=n.state.selectedNamespaces.filter((function(t){return e.findIndex((function(e){return e.name===t.name}))<0}));n.setState({selectedNamespaces:t})},n.onNamespaceToggled=function(e){var t=e.target.value,a=n.state.selectedNamespaces.find((function(e){return e.name===t}))?n.state.selectedNamespaces.filter((function(e){return e.name!==t})):n.state.selectedNamespaces.concat([{name:e.target.value}]);n.setState({selectedNamespaces:a})},n.onFilterChange=function(e){n.props.setFilter(e)},n.clearFilter=function(){n.props.setFilter("")},n.filtered=function(){return n.props.namespaces.filter((function(e){return e.name.includes(n.props.filter)}))},n.filteredSelected=function(){var e=n.filtered();return n.state.selectedNamespaces.filter((function(t){return e.findIndex((function(e){return e.name===t.name}))>=0}))},n.state={isBulkSelectorOpen:!1,isOpen:!1,selectedNamespaces:Object(mt.a)(n.props.activeNamespaces)},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.props.refresh(),this.syncNamespacesURLParam()}},{key:"componentDidUpdate",value:function(e){e.activeNamespaces!==this.props.activeNamespaces&&(0===this.props.activeNamespaces.length?q.deleteParam(P.NAMESPACES):q.setParam(P.NAMESPACES,this.props.activeNamespaces.map((function(e){return e.name})).join(",")),this.setState({selectedNamespaces:this.props.activeNamespaces}))}},{key:"namespaceButtonText",value:function(){return 0===this.state.selectedNamespaces.length?r.createElement("span",null,"Select Namespaces"):r.createElement(r.Fragment,null,r.createElement("span",{style:{paddingRight:"0.75em"}},"Namespace:"),1===this.state.selectedNamespaces.length?r.createElement("span",null,this.state.selectedNamespaces[0].name):r.createElement(co.a,null,this.state.selectedNamespaces.length))}},{key:"getBulkSelector",value:function(){var e=this,t=this.filteredSelected().length,a=t===this.props.namespaces.length,n=t>0,i=!!a||!!n&&null;return r.createElement("div",{className:Vu},r.createElement(Iu.a,{id:"bulk-select-id",key:"bulk-select-key","aria-label":"Select all",isChecked:i,onClick:function(){n?e.onBulkNone():e.onBulkAll()}}),r.createElement("span",{className:Bu},"Select all"))}},{key:"getHeader",value:function(){var e=!!this.props.filter;return r.createElement("div",{className:Wu},r.createElement("span",{style:{width:"100%"}},r.createElement(Ae.a,{style:{width:e?"calc(100% - 44px)":"100%"},"aria-label":"filter-namespace",type:"text",name:"namespace-filter",placeholder:"Filter by Name...",value:this.props.filter,onChange:this.onFilterChange}),e&&r.createElement(lo.a,{key:"ot_clear_namespace_filter",position:"top",content:"Clear Filter by Name"},r.createElement(vr.a,{onClick:this.clearFilter,isInline:!0},r.createElement(fi.Close,null)))),this.getBulkSelector(),r.createElement(wu.a,{style:{paddingTop:"5px"}}))}},{key:"getBody",value:function(){var e=this;if(this.props.namespaces.length>0){var t=this.state.selectedNamespaces.reduce((function(e,t){return e[t.name]=t.name,e}),{}),a=this.filtered().map((function(a){return r.createElement("div",{className:Uu,id:"namespace-list-item[".concat(a.name,"]"),key:"namespace-list-item[".concat(a.name,"]")},r.createElement("input",{type:"checkbox",value:a.name,checked:!!t[a.name],onChange:e.onNamespaceToggled}),r.createElement("span",{className:Bu},a.name))}));return r.createElement(r.Fragment,null,r.createElement(ju,{className:qu,maxHeight:{type:Oc.VIEWPORT_HEIGHT_MINUS_TOP,margin:20}},a))}return r.createElement("div",null,"No namespaces found")}},{key:"render",value:function(){return r.createElement(Mu,{info:Hu.Namespaces},r.createElement(Ru.a,{toggle:r.createElement(ku.a,{id:"namespace-selector",onToggle:this.onToggle,isDisabled:this.props.disabled},this.namespaceButtonText()),isOpen:this.state.isOpen},this.getHeader(),this.getBody()))}}]),a}(r.PureComponent),zu=Object(h.b)((function(e){return{namespaces:Sl(e),activeNamespaces:hl(e),filter:vl(e)}}),(function(e){return{refresh:function(){e(Nu.fetchNamespacesIfNeeded())},clearAll:function(){e(ht.setActiveNamespaces([]))},setActiveNamespaces:function(t){e(ht.setActiveNamespaces(t))},setFilter:function(t){e(ht.setFilter(t))}}}))(Ku),Yu=["applications","istio","istio/new","mesh","services","workloads","extensions/iter8","extensions/iter8/new","extensions/iter8/newfromfile"],Qu=Object(Jn.a)({padding:"10px 20px 10px 20px"}),Xu=Object(Jn.a)({display:"flex",flexWrap:"wrap"}),Ju=Object(Jn.a)({marginLeft:"auto"}),Zu=Object(Jn.a)({marginLeft:"auto",paddingTop:"17px"}),$u=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"showTitle",value:function(){var e=window.location.pathname;if(e=e.substr(e.lastIndexOf("/console")+"/console".length+1),Yu.some((function(t){return e.startsWith(t)}))){var t=e.charAt(0).toUpperCase()+e.slice(1),a=!1;if(e.startsWith("istio/new/"))t="Create "+e.substring(10);else"istio"===e?t="Istio Config":"extensions/iter8"===e?t="Iter8 Experiments":"extensions/iter8/new"===e?(t="Create New Iter8 Experiment",a=!0):"extensions/iter8/newfromfile"===e?t="Create New Iter8 Experiment from File":"mesh"===e&&(t="Clusters");return{title:i.a.createElement(Eo.a,{headingLevel:"h1",size:"3xl",style:{margin:"15px 0 11px"}},t),disabled:a}}return{title:void 0,disabled:!1}}},{key:"render",value:function(){var e=this.showTitle(),t=e.title,a=e.disabled;return i.a.createElement("div",{className:Qu},i.a.createElement("div",{className:Xu},i.a.createElement("div",null,!0===this.props.hideNamespaceSelector?null:i.a.createElement(zu,{disabled:a})),this.props.rightToolbar&&i.a.createElement("div",{className:Ju},this.props.rightToolbar)),i.a.createElement("div",{className:Xu},i.a.createElement("div",null,t),this.props.actionsToolbar&&i.a.createElement("div",{className:Zu},this.props.actionsToolbar)))}}]),a}(i.a.Component),ep=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;Object(s.a)(this,a),(n=t.call(this,e)).promises=new yr,n.getDeploymentItems=function(e){return e.workloads?e.workloads.map((function(t){return{namespace:e.namespace.name,name:t.name,type:t.type,appLabel:t.appLabel,versionLabel:t.versionLabel,istioSidecar:t.istioSidecar,additionalDetailSample:t.additionalDetailSample,healthPromise:fn(e.namespace.name,t.name,t.type,n.props.duration,t.istioSidecar),labels:t.labels,istioReferences:lu(t.istioReferences,!0)}})):[]};var r=Yn(uu),i=Kn();return n.state={listItems:[],currentSortField:r,isSortAscending:i},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.updateListItems()}},{key:"componentDidUpdate",value:function(e,t,a){var n=Yn(uu),r=Kn();yi(this.props.activeNamespaces,e.activeNamespaces)&&this.props.duration===e.duration&&this.state.currentSortField===n&&this.state.isSortAscending===r||(this.setState({currentSortField:n,isSortAscending:r}),this.updateListItems())}},{key:"componentWillUnmount",value:function(){this.promises.cancelAll()}},{key:"sortItemList",value:function(e,t,a){return this.promises.registerChained("sort",e,(function(e){return function(e,t,a){if("Health"===t.title){var n=e.map((function(e){return e.healthPromise.then((function(t){return Object(C.a)(Object(C.a)({},e),{},{health:t})}))}));return Promise.all(n).then((function(e){return e.sort(a?t.compare:function(e,a){return t.compare(a,e)})}))}var r=e.sort(a?t.compare:function(e,a){return t.compare(a,e)});return Promise.resolve(r)}(e,t,a)}))}},{key:"updateListItems",value:function(){this.promises.cancelAll();var e=xi.getSelected(),t=this.props.activeNamespaces.map((function(e){return e.name}));0!==t.length?this.fetchWorkloads(t,e):this.setState({listItems:[]})}},{key:"fetchWorkloads",value:function(e,t){var a=this,n=e.map((function(e){return function(e){return Xa(K.GET,qa.workloads(e),{},{})}(e)}));this.promises.registerAll("workloads",n).then((function(e){var n=[];return e.forEach((function(e){n=n.concat(a.getDeploymentItems(e.data))})),function(e,t){var a=Oi(hu,t),n=Oi(pu,t),r=Ii(Si,t),i=Ii(du,t),o=Ii(mu,t),s=Oi(Ti,t),l=e;l=function(e,t,a,n){var r=e;return void 0!==t&&(r=r.filter((function(e){return e.istioSidecar===t}))),void 0!==a&&(r=r.filter((function(e){return e.appLabel===a}))),void 0!==n&&(r=r.filter((function(e){return e.versionLabel===n}))),r}(l=function(e,t){return 0===t.length?e:e.filter((function(e){return t.some((function(t){return e.name.includes(t)}))}))}(l=function(e,t){return t&&0===t.length?e:e.filter((function(e){return function(e,t){for(var a=0;a<t.length;a++)if(e.includes(t[a]))return!0;return!1}(e.type,t)}))}(l,a),n),r,i,o),l=Qc(l,s,t.op);var c=Oi(Ai,t);if(c.length>0)return wi(l,c);var u=Oi($c,t);return u.length>0?function(e,t){return e.filter((function(e){return 0!==e.istioReferences.filter((function(e){return t.includes(e.objectType)})).length}))}(l,u):l}(n,t)})).then((function(e){a.promises.cancel("sort"),a.sortItemList(e,a.state.currentSortField,a.state.isSortAscending).then((function(e){a.setState({listItems:e})})).catch((function(e){e.isCanceled||console.debug(e)}))})).catch((function(e){e.isCanceled||a.handleAxiosError("Could not fetch workloads list",e)}))}},{key:"render",value:function(){return r.createElement(r.Fragment,null,r.createElement("div",{style:{backgroundColor:"#fff"}},r.createElement($u,{rightToolbar:r.createElement(Zl,{key:"DurationDropdown",id:"workload-list-duration-dropdown",handleRefresh:this.updateListItems,disabled:!1})})),r.createElement(tr,null,r.createElement(Ou,{rows:this.state.listItems},r.createElement(Li,{initialFilters:fu,onFilterChange:this.onFilterChange}))))}}]),a}(vu),tp=Object(h.b)((function(e){return{activeNamespaces:hl(e),duration:fl(e)}}))(ep),ap=[{id:"namespace",title:"Namespace",isNumeric:!1,param:"ns",compare:function(e,t){var a=e.namespace.localeCompare(t.namespace);return 0===a&&(a=e.name.localeCompare(t.name)),a}},{id:"servicename",title:"Service Name",isNumeric:!1,param:"sn",compare:function(e,t){return e.name.localeCompare(t.name)}},{id:"details",title:"Details",isNumeric:!1,param:"is",compare:function(e,t){var a=Ic(e)?1:0,n=Ic(t)?1:0;if(a!==n)return a-n;var r=e.istioReferences,i=t.istioReferences,o=su(r,i);if(0!==o)return o;var s=e.additionalDetailSample&&e.additionalDetailSample.icon,l=t.additionalDetailSample&&t.additionalDetailSample.icon;if(s||l){if(!s||!l)return s?-1:1;var c=s.localeCompare(l);if(0!==c)return c}return e.name.localeCompare(t.name)}},{id:"health",title:"Health",isNumeric:!1,param:"he",compare:function(e,t){if(Wa(e)&&Wa(t)){var a=e.health.getGlobalStatus(),n=t.health.getGlobalStatus();if(a.priority===n.priority){var r=ua(e.namespace,e.name,"service",e.health.requests).errorRatio.global.status.value,i=ua(t.namespace,t.name,"service",t.health.requests).errorRatio.global.status.value;return r===i?e.name.localeCompare(t.name):i-r}return n.priority-a.priority}return 0}},{id:"configvalidation",title:"Config",isNumeric:!1,param:"cv",compare:function(e,t){var a=-1;return e.validation&&!t.validation?a=-1:!e.validation&&t.validation?a=1:e.validation||t.validation?e.validation&&t.validation&&(e.validation.valid&&!t.validation.valid?a=-1:!e.validation.valid&&t.validation.valid?a=1:e.validation.valid&&t.validation.valid?a=e.validation.checks.length-t.validation.checks.length:e.validation.valid||t.validation.valid||(a=t.validation.checks.length-e.validation.checks.length)):a=0,a||e.name.localeCompare(t.name)}}],np={id:"servicename",title:"Service Name",placeholder:"Filter by Service Name",filterType:Ae.c.text,action:"append",filterValues:[]},rp=[np,Si,$c,Ai,Ti],ip=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;Object(s.a)(this,a),(n=t.call(this,e)).promises=new yr;var r=Yn(ap),i=Kn();return n.state={listItems:[],currentSortField:r,isSortAscending:i},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.updateListItems()}},{key:"componentDidUpdate",value:function(e,t,a){var n=Yn(ap),r=Kn();yi(this.props.activeNamespaces,e.activeNamespaces)&&this.props.duration===e.duration&&this.state.currentSortField===n&&this.state.isSortAscending===r||(this.setState({currentSortField:n,isSortAscending:r}),this.updateListItems())}},{key:"componentWillUnmount",value:function(){this.promises.cancelAll()}},{key:"sortItemList",value:function(e,t,a){return this.promises.registerChained("sort",e,(function(e){return function(e,t,a){if("Health"===t.title){var n=e.map((function(e){return e.healthPromise.then((function(t){return Object(C.a)(Object(C.a)({},e),{},{health:t})}))}));return Promise.all(n).then((function(e){return e.sort(a?t.compare:function(e,a){return t.compare(a,e)})}))}var r=e.sort(a?t.compare:function(e,a){return t.compare(a,e)});return Promise.resolve(r)}(e,t,a)}))}},{key:"updateListItems",value:function(){this.promises.cancelAll();var e=xi.getSelected(),t=this.props.activeNamespaces.map((function(e){return e.name}));0!==t.length?this.fetchServices(t,e,this.props.duration):this.setState({listItems:[]})}},{key:"getServiceItem",value:function(e,t){var a=this;return e.services?e.services.map((function(n){return{name:n.name,istioSidecar:n.istioSidecar,namespace:e.namespace.name,healthPromise:mn(e.namespace.name,n.name,t,n.istioSidecar),validation:a.getServiceValidation(n.name,e.validations),additionalDetailSample:n.additionalDetailSample,labels:n.labels||{},istioReferences:lu(n.istioReferences,!0),kialiWizard:n.kialiWizard}})):[]}},{key:"fetchServices",value:function(e,t,a){var n=this,r=e.map((function(e){return dn(e)}));this.promises.registerAll("services",r).then((function(e){var r=[];return e.forEach((function(e){r=r.concat(n.getServiceItem(e.data,a))})),function(e,t){var a=e,n=Ii(Si,t);void 0!==n&&(a=function(e,t){return e.filter((function(e){return e.istioSidecar===t}))}(a,n));var r=Oi(np,t);r.length>0&&(a=function(e,t){return e.filter((function(e){var a=!0;if(t.length>0){a=!1;for(var n=0;n<t.length;n++)if(e.name.includes(t[n])){a=!0;break}}return a}))}(a,r));var i=Oi(Ti,t);i.length>0&&(a=Qc(a,i,t.op));var o=Oi(Ai,t);if(o.length>0)return wi(a,o);var s=Oi($c,t);return s.length>0?function(e,t){return e.filter((function(e){return 0!==e.istioReferences.filter((function(e){return t.includes(e.objectType)})).length}))}(a,s):a}(r,t)})).then((function(e){n.promises.cancel("sort"),n.sortItemList(e,n.state.currentSortField,n.state.isSortAscending).then((function(e){n.setState({listItems:e})})).catch((function(e){e.isCanceled||console.debug(e)}))})).catch((function(e){e.isCanceled||n.handleAxiosError("Could not fetch services list",e)}))}},{key:"getServiceValidation",value:function(e,t){return t.service[e]}},{key:"render",value:function(){return r.createElement(r.Fragment,null,r.createElement("div",{style:{backgroundColor:"#fff"}},r.createElement($u,{rightToolbar:r.createElement(Zl,{key:"DurationDropdown",id:"service-list-duration-dropdown",handleRefresh:this.updateListItems,disabled:!1})})),r.createElement(tr,null,r.createElement(Ou,{rows:this.state.listItems},r.createElement(Li,{initialFilters:rp,onFilterChange:this.onFilterChange}))))}}]),a}(vu),op=Object(h.b)((function(e){return{activeNamespaces:hl(e),duration:fl(e)}}))(ip),sp=function(e,t){return"".concat(e.objectType,":").concat(e.name," ").concat(t.message)},lp=function(e){Array.isArray(e)?function(e){var t,a=[],n=!1,r=Object($t.a)(e);try{for(r.s();!(t=r.n()).done;){var i,o=t.value,s=Object($t.a)(o.checks);try{for(s.s();!(i=s.n()).done;){var l=i.value;[fo.Warning,fo.Error].includes(l.severity)&&(l.severity===fo.Error&&(n=!0),a.push("".concat(o.objectType,":").concat(o.name)))}}catch(u){s.e(u)}finally{s.f()}}}catch(u){r.e(u)}finally{r.f()}if(a.length>0){var c="".concat(a.join("\n"));n?_n("IstioConfig has errors",void 0,void 0,void 0,c):Vn("IstioConfig has warnings",!1,void 0,c)}}(e):function(e){var t,a=Object($t.a)(e.checks);try{for(a.s();!(t=a.n()).done;){var n=t.value;switch(n.severity){case fo.Warning:Vn(sp(e,n),!1);break;case fo.Error:_n(sp(e,n))}}}catch(r){a.e(r)}finally{a.f()}}(e)},cp=a(1470),up=a(1471),pp=a(61),dp=a(1467),mp=a(1464),hp=a(1469),fp=a(1466),gp=function(e){var t;return e&&(e.gateway?t=e.gateway:e.virtualService?t=e.virtualService:e.destinationRule?t=e.destinationRule:e.serviceEntry?t=e.serviceEntry:e.workloadEntry?t=e.workloadEntry:e.workloadGroup?t=e.workloadGroup:e.envoyFilter?t=e.envoyFilter:e.authorizationPolicy?t=e.authorizationPolicy:e.peerAuthentication?t=e.peerAuthentication:e.requestAuthentication?t=e.requestAuthentication:e.sidecar&&(t=e.sidecar)),t},vp=/^[a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[-a-z0-9]([-a-z0-9]*[a-z0-9])?)*$/,Ep=/(?=^.{4,253}$)(^((?!-)(([a-zA-Z0-9-]{0,62}[a-zA-Z0-9])|\*)\.)+[a-zA-Z]{2,63}$)/,bp=/^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])(\/([0-9]|[1-2][0-9]|3[0-2]))?$/,yp=/^[\d]+\.?[\d]*(h|m|s|ms)$/,Cp=function(e){return Sp(e,!1)},Sp=function(e,t){if(0===e.length)return!1;var a=e.split("/");if(a.length>2)return!1;if(t&&a.length<2)return!1;var n=!0,r=!0,i="",o="";return 2===a.length?(i=a[0],o=a[1],"."!==i&&"*"!==i&&(n=0===a[0].search(vp))):o=a[0],"*"!==o&&(r=0===o.search(Ep)),n&&r},Ap=function(e){return bp.test(e)},Tp=function(e){return"0ms"!==e&&"0s"!==e&&"0m"!==e&&"0h"!==e&&yp.test(e)},Op=function(e){return e>=100&&e<=599},Ip=function(e){if(e.tcp){if(e.tcp.connectTimeout&&!Tp(e.tcp.connectTimeout))return!1;if(e.tcp.tcpKeepalive){if(e.tcp.tcpKeepalive.interval&&!Tp(e.tcp.tcpKeepalive.interval))return!1;if(e.tcp.tcpKeepalive.time&&!Tp(e.tcp.tcpKeepalive.time))return!1}}return!(e.http&&e.http.idleTimeout&&!Tp(e.http.idleTimeout))},wp=function(e){return!(e.interval&&!Tp(e.interval))&&!(e.baseEjectionTime&&!Tp(e.baseEjectionTime))},Rp=a(79),kp=a(1555),xp=a(1465),Np=Object(Jn.a)({marginLeft:25,color:nt.Red100,textAlign:"center"}),jp=Object(Jn.a)({marginLeft:0,paddingLeft:0}),Pp=[{title:"Port Number",transforms:[Object(oo.a)(20)],props:{}},{title:"Port Name",transforms:[Object(oo.a)(20)],props:{}},{title:"Protocol",transforms:[Object(oo.a)(20)],props:{}}],Lp=["HTTP","HTTPS","GRPC","HTTP2","MONGO","TCP","TLS"],Dp=["PASSTHROUGH","SIMPLE","MUTUAL","AUTO_PASSTHROUGH","ISTIO_MUTUAL"],Fp=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).canAddServer=function(){var e=n.state.isHostsValid,t=n.state.newPortNumber.length>0&&!isNaN(Number(n.state.newPortNumber)),a=n.state.newPortName.length>0,r="HTTPS"===n.state.newPortProtocol||"TLS"===n.state.newPortProtocol,i=!r||("SIMPLE"!==n.state.newTlsMode&&"MUTUAL"!==n.state.newTlsMode||n.state.newTlsServerCertificate.length>0&&n.state.newTlsPrivateKey.length>0),o=!r||"MUTUAL"!==n.state.newTlsMode||n.state.newTlsCaCertificate.length>0;return e&&t&&a&&i&&o},n.areValidHosts=function(e){if(0===e.length)return!1;for(var t=!0,a=0;a<e.length;a++)if(!Cp(e[a])){t=!1;break}return t},n.onAddHosts=function(e,t){var a=0===e.trim().length?[]:e.split(",").map((function(e){return e.trim()}));n.setState({newHosts:a,isHostsValid:n.areValidHosts(a)})},n.onAddPortNumber=function(e,t){n.setState({newPortNumber:e.trim()})},n.onAddPortName=function(e,t){n.setState({newPortName:e.trim()})},n.onAddPortProtocol=function(e,t){n.setState({newPortProtocol:e})},n.onAddServer=function(){var e={hosts:n.state.newHosts,port:{number:+n.state.newPortNumber,name:n.state.newPortName,protocol:n.state.newPortProtocol}};"HTTPS"!==n.state.newPortProtocol&&"TLS"!==n.state.newPortProtocol||(e.tls={mode:n.state.newTlsMode},"SIMPLE"!==n.state.newTlsMode&&"MUTUAL"!==n.state.newTlsMode||(e.tls.privateKey=n.state.newTlsPrivateKey,e.tls.serverCertificate=n.state.newTlsServerCertificate),"MUTUAL"===n.state.newTlsMode&&(e.tls.caCertificates=n.state.newTlsCaCertificate)),n.setState({newHosts:[],isHostsValid:!1,newPortNumber:"",newPortName:"",newPortProtocol:Lp[0],newTlsMode:Dp[1],newTlsServerCertificate:"",newTlsPrivateKey:"",newTlsCaCertificate:""},(function(){return n.props.onAddServer(e)}))},n.onAddTlsMode=function(e,t){n.setState({newTlsMode:e})},n.onAddTlsServerCertificate=function(e,t){n.setState({newTlsServerCertificate:e})},n.onAddTlsPrivateKey=function(e,t){n.setState({newTlsPrivateKey:e})},n.onAddTlsCaCertificate=function(e,t){n.setState({newTlsCaCertificate:e})},n.state={newHosts:[],isHostsValid:!1,newPortNumber:"",newPortName:"",newPortProtocol:Lp[0],newTlsMode:Dp[1],newTlsServerCertificate:"",newTlsPrivateKey:"",newTlsCaCertificate:""},n}return Object(l.a)(a,[{key:"portRows",value:function(){return[{keys:"gatewayPortNew",cells:[r.createElement(r.Fragment,null,r.createElement(Rp.TextInputBase,{value:this.state.newPortNumber,type:"text",id:"addPortNumber","aria-describedby":"add port number",name:"addPortNumber",onChange:this.onAddPortNumber,isValid:this.state.newPortNumber.length>0&&!isNaN(Number(this.state.newPortNumber))})),r.createElement(r.Fragment,null,r.createElement(Rp.TextInputBase,{value:this.state.newPortName,type:"text",id:"addPortName","aria-describedby":"add port name",name:"addPortName",onChange:this.onAddPortName,isValid:this.state.newPortName.length>0})),r.createElement(r.Fragment,null,r.createElement(ur.a,{value:this.state.newPortProtocol,id:"addPortProtocol",name:"addPortProtocol",onChange:this.onAddPortProtocol},Lp.map((function(e,t){return r.createElement(pr.a,{isDisabled:!1,key:"p"+t,value:e,label:e})}))))]}]}},{key:"render",value:function(){var e="HTTPS"===this.state.newPortProtocol||"TLS"===this.state.newPortProtocol;return r.createElement(r.Fragment,null,r.createElement(mp.a,{label:"Hosts",isRequired:!0,fieldId:"gateway-selector",helperText:"One or more hosts exposed by this Gateway.",helperTextInvalid:"Invalid hosts for this Gateway. Enter one or hosts separated by comma.",isValid:this.state.isHostsValid},r.createElement(Rp.TextInputBase,{value:this.state.newHosts.join(","),isRequired:!0,type:"text",id:"hosts","aria-describedby":"hosts",name:"hosts",onChange:this.onAddHosts,isValid:this.state.isHostsValid})),r.createElement(mp.a,{label:"Port",isRequired:!0,fieldId:"server-port"},r.createElement(Eu.b,{"aria-label":"Port Level MTLS",cells:Pp,rows:this.portRows()},r.createElement(bu.a,null),r.createElement(kp.a,null))),e&&r.createElement(mp.a,{label:"TLS Mode",isRequired:!0,fieldId:"addTlsMode"},r.createElement(ur.a,{value:this.state.newTlsMode,id:"addTlsMode",name:"addTlsMode",onChange:this.onAddTlsMode},Dp.map((function(e,t){return r.createElement(pr.a,{isDisabled:!1,key:"p"+t,value:e,label:e})})))),e&&("SIMPLE"===this.state.newTlsMode||"MUTUAL"===this.state.newTlsMode)&&r.createElement(r.Fragment,null,r.createElement(mp.a,{label:"Server Certificate",isRequired:!0,fieldId:"server-certificate",isValid:this.state.newTlsServerCertificate.length>0,helperTextInvalid:"The path to the file holding the server-side TLS certificate to use."},r.createElement(Rp.TextInputBase,{value:this.state.newTlsServerCertificate,isRequired:!0,type:"text",id:"server-certificate","aria-describedby":"server-certificate",name:"server-certificate",onChange:this.onAddTlsServerCertificate,isValid:this.state.newTlsServerCertificate.length>0})),r.createElement(mp.a,{label:"Private Key",isRequired:!0,fieldId:"private-key",isValid:this.state.newTlsPrivateKey.length>0,helperTextInvalid:"The path to the file holding the server\u2019s private key."},r.createElement(Rp.TextInputBase,{value:this.state.newTlsPrivateKey,isRequired:!0,type:"text",id:"private-key","aria-describedby":"private-key",name:"private-key",onChange:this.onAddTlsPrivateKey,isValid:this.state.newTlsPrivateKey.length>0}))),e&&"MUTUAL"===this.state.newTlsMode&&r.createElement(mp.a,{label:"CA Certificate",isRequired:!0,fieldId:"ca-certificate",isValid:this.state.newTlsCaCertificate.length>0,helperTextInvalid:"The path to a file containing certificate authority certificates to use in verifying a presented client side certificate."},r.createElement(Rp.TextInputBase,{value:this.state.newTlsCaCertificate,isRequired:!0,type:"text",id:"ca-certificate","aria-describedby":"ca-certificate",name:"ca-certificate",onChange:this.onAddTlsCaCertificate,isValid:this.state.newTlsCaCertificate.length>0})),r.createElement(mp.a,{fieldId:"addRule"},r.createElement(vr.a,{variant:"link",icon:r.createElement(xp.a,null),onClick:this.onAddServer,isDisabled:!this.canAddServer(),className:jp},"Add Server to Server List"),!this.canAddServer()&&r.createElement("span",{className:Np},"A Server needs Hosts and Port sections defined")))}}]),a}(r.Component),_p=Object(Jn.a)({marginTop:10,color:nt.Red100,textAlign:"center",width:"100%"}),Mp=[{title:"Server Hosts",transforms:[Object(oo.a)(100)],props:{}},{title:"Port",transforms:[Object(oo.a)(20)],props:{}},{title:"TLS",transforms:[Object(oo.a)(100)],props:{}},{title:"",props:{}}],Hp=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).rows=function(){return e.props.serverList.map((function(e,t){return{key:"server_"+t,cells:[r.createElement(r.Fragment,null,e.hosts.map((function(e){return r.createElement("div",null,e)}))),r.createElement(r.Fragment,null,r.createElement("div",null,e.port.name),r.createElement("div",null,"[",e.port.number,", ",e.port.protocol,"]")),r.createElement(r.Fragment,null,e.tls?r.createElement(r.Fragment,null,r.createElement("div",null,e.tls.mode),e.tls.serverCertificate&&e.tls.serverCertificate.length>0?r.createElement("div",null,"[",e.tls.serverCertificate,"]"):void 0,e.tls.privateKey&&e.tls.privateKey.length>0?r.createElement("div",null,"[",e.tls.privateKey,"]"):void 0,e.tls.caCertificates&&e.tls.caCertificates.length>0?r.createElement("div",null,"[",e.tls.caCertificates,"]"):void 0):void 0),r.createElement(r.Fragment,null)]}}))},e.actionResolver=function(t,a){a.rowIndex;return[{title:"Remove Rule",onClick:function(t,a,n,r){e.props.onRemoveServer(a)}}]},e}return Object(l.a)(a,[{key:"render",value:function(){return r.createElement(r.Fragment,null,r.createElement(Eu.b,{"aria-label":"Server List",cells:Mp,rows:this.rows(),actionResolver:this.actionResolver},r.createElement(bu.a,null),r.createElement(kp.a,null)),0===this.props.serverList.length&&r.createElement("div",{className:_p},"No Servers defined"))}}]),a}(r.Component),Gp=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).addWorkloadLabels=function(e,t){if(0!==e.length){for(var a=(e=e.trim()).split(","),r=!0,i=0;i<a.length;i++){var o=a[i];if(o.indexOf("=")<0){r=!1;break}var s=o.split("=");if(2!==s.length){r=!1;break}if(0===s[0].trim().length||0===s[1].trim().length){r=!1;break}}n.setState({workloadSelectorValid:r,workloadSelectorLabels:e},(function(){return n.props.onChange(n.state)}))}else n.setState({workloadSelectorValid:!1,workloadSelectorLabels:""},(function(){return n.props.onChange(n.state)}))},n.areValidHosts=function(e){if(0===e.length)return!1;for(var t=!0,a=0;a<e.length;a++)if(!Cp(e[a])){t=!1;break}return t},n.onAddServer=function(){n.setState((function(e){return e.gatewayServers.push(e.addGatewayServer),{gatewayServers:e.gatewayServers,addGatewayServer:{hosts:[],port:{number:80,name:"http",protocol:"HTTP"}}}}),(function(){return n.props.onChange(n.state)}))},n.onRemoveServer=function(e){n.setState((function(t){return t.gatewayServers.splice(e,1),{gatewayServers:t.gatewayServers}}),(function(){return n.props.onChange(n.state)}))},n.state={addWorkloadSelector:!1,workloadSelectorLabels:"istio=ingressgateway",workloadSelectorValid:!0,gatewayServers:[],addGatewayServer:{hosts:[],port:{number:80,name:"http",protocol:"HTTP"}},validHosts:!1},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.setState(this.props.gateway)}},{key:"render",value:function(){var e=this;return r.createElement(r.Fragment,null,r.createElement(mp.a,{label:"Workload Selector",fieldId:"workloadSelectorSwitch"},r.createElement(fp.a,{id:"workloadSelectorSwitch",label:" ",labelOff:" ",isChecked:this.state.addWorkloadSelector,onChange:function(){e.setState((function(e){return{addWorkloadSelector:!e.addWorkloadSelector}}),(function(){return e.props.onChange(e.state)}))}})),this.state.addWorkloadSelector&&r.createElement(mp.a,{fieldId:"workloadLabels",label:"Labels",helperText:"One or more labels to select a workload where the Gateway is applied.",helperTextInvalid:"Enter a label in the format <label>=<value>. Enter one or multiple labels separated by comma.",isValid:this.state.workloadSelectorValid},r.createElement(Ae.b,{id:"gwHosts",name:"gwHosts",isDisabled:!this.state.addWorkloadSelector,value:this.state.workloadSelectorLabels,onChange:this.addWorkloadLabels,isValid:this.state.workloadSelectorValid})),r.createElement(Fp,{onAddServer:function(t){e.setState({addGatewayServer:t},(function(){return e.onAddServer()}))}}),r.createElement(mp.a,{label:"Server List",fieldId:"gwServerList"},r.createElement(Hp,{serverList:this.state.gatewayServers,onRemoveServer:this.onRemoveServer})))}}]),a}(r.Component),Vp=[{title:"Egress Host",transforms:[Object(oo.a)(60)],props:{}},{title:"",props:{}}],Up=Object(Jn.a)({marginTop:15,color:nt.Red100}),Bp=function(e){return{addEgressHost:{host:""},addWorkloadSelector:!1,egressHosts:[{host:e}],validEgressHost:!1,workloadSelectorValid:!1,workloadSelectorLabels:""}},Wp=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).actionResolver=function(e,t){var a={title:"Remove Server",onClick:function(e,t,a,r){n.setState((function(e){return e.egressHosts.splice(t,1),{egressHosts:e.egressHosts}}),(function(){return n.props.onChange(n.state)}))}};return t.rowIndex<n.state.egressHosts.length?[a]:[]},n.onAddHost=function(e,t){var a,r=e.trim();n.setState({addEgressHost:{host:r},validEgressHost:(a=r,Sp(a,!0))})},n.onAddEgressHost=function(){n.setState((function(e){return e.egressHosts.push(n.state.addEgressHost),{egressHosts:e.egressHosts,addEgressHost:{host:""}}}),(function(){return n.props.onChange(n.state)}))},n.addWorkloadLabels=function(e,t){if(0!==e.length){for(var a=(e=e.trim()).split(","),r=!0,i=0;i<a.length;i++){var o=a[i];if(o.indexOf("=")<0){r=!1;break}var s=o.split("=");if(2!==s.length){r=!1;break}if(0===s[0].trim().length||0===s[1].trim().length){r=!1;break}}n.setState({workloadSelectorValid:r,workloadSelectorLabels:e},(function(){return n.props.onChange(n.state)}))}else n.setState({workloadSelectorValid:!1,workloadSelectorLabels:""},(function(){return n.props.onChange(n.state)}))},n.state=Bp(""),n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.setState(this.props.sidecar)}},{key:"rows",value:function(){return this.state.egressHosts.map((function(e,t){return{key:"eH"+t,cells:[r.createElement(r.Fragment,null,e.host),""]}})).concat([{key:"eHNew",cells:[r.createElement(r.Fragment,null,r.createElement(Ae.b,{value:this.state.addEgressHost.host,type:"text",id:"addEgressHost",key:"addEgressHost","aria-describedby":"add egress host",name:"addHost",onChange:this.onAddHost,isValid:this.state.validEgressHost}),!this.state.validEgressHost&&r.createElement("div",{key:"hostsHelperText",className:Up},"Enter a valid namespace/FQDN Egress host.")),r.createElement(r.Fragment,null,r.createElement(vr.a,{variant:"link",icon:r.createElement(xp.a,null),isDisabled:!this.state.validEgressHost,onClick:this.onAddEgressHost}))]}])}},{key:"render",value:function(){var e=this;return r.createElement(r.Fragment,null,r.createElement(mp.a,{label:"Workload Selector",fieldId:"workloadSelectorSwitch"},r.createElement(fp.a,{id:"workloadSelectorSwitch",label:" ",labelOff:" ",isChecked:this.state.addWorkloadSelector,onChange:function(){e.setState((function(e){return{addWorkloadSelector:!e.addWorkloadSelector}}),(function(){return e.props.onChange(e.state)}))}})),this.state.addWorkloadSelector&&r.createElement(mp.a,{fieldId:"workloadLabels",label:"Labels",helperText:"One or more labels to select a workload where the Sidecar is applied.",helperTextInvalid:"Enter a label in the format <label>=<value>. Enter one or multiple labels separated by comma.",isValid:this.state.workloadSelectorValid},r.createElement(Ae.b,{id:"gwHosts",name:"gwHosts",isDisabled:!this.state.addWorkloadSelector,value:this.state.workloadSelectorLabels,onChange:this.addWorkloadLabels,isValid:this.state.workloadSelectorValid})),r.createElement(mp.a,{label:"Egress",fieldId:"egressHostTable"},r.createElement(Eu.b,{"aria-label":"Egress Hosts",cells:Vp,rows:this.rows(),actionResolver:this.actionResolver},r.createElement(bu.a,null),r.createElement(kp.a,null)),0===this.state.egressHosts.length&&r.createElement("div",{className:Up},"Sidecar has no Egress Hosts Defined")))}}]),a}(r.Component),qp=a(1468),Kp=Object(Jn.a)({margin:"0px 0px 2px 10px",verticalAlign:"-5px !important"}),zp=Object(Jn.a)({fontWeight:700}),Yp=function(e){return r.createElement(lo.a,{position:lo.b.right,content:r.createElement("div",{style:{textAlign:"left"}},e)},r.createElement(fi.Info,{className:Kp}))},Qp=r.createElement(r.Fragment,null,r.createElement("div",{style:{marginBottom:5}},"Connection pool settings for an upstream host."),r.createElement("div",{style:{marginBottom:5}},"The settings apply to each individual host in the upstream service."),r.createElement("div",null,"Connection pool settings can be applied at the ",r.createElement("span",{className:zp},"TCP")," level as well as at"," ",r.createElement("span",{className:zp},"HTTP")," level.")),Xp=r.createElement(r.Fragment,null,r.createElement("div",{style:{marginBottom:5}},"The names of gateways that should apply these routes."),r.createElement("div",{style:{marginBottom:5}},"If a list of gateway names is provided, the route rules will apply only to the gateways."),r.createElement("div",null,"To apply rules to both gateways and sidecars, specify the reserverd word"," ",r.createElement("span",{className:zp},"mesh"),".")),Jp=r.createElement(r.Fragment,null,"Abort HTTP request attempts and return error codes back to ",r.createElement("span",{className:zp},"DOWNSTREAM")," ","service, giving the impression that the ",r.createElement("span",{className:zp},"UPSTREAM")," service is faulty."),Zp=r.createElement(r.Fragment,null,"Delay requests ",r.createElement("span",{className:zp},"BEFORE")," forwarding, emulating various failures such as network issues, overloaded upstream service, etc."),$p=r.createElement(r.Fragment,null,"Describes the retry policy to use when a HTTP request fails."),ed=r.createElement(r.Fragment,null,"Timeout for HTTP requests, default is disabled."),td=r.createElement(r.Fragment,null,"Load balancing policies to apply for a specific destination."),ad=r.createElement(r.Fragment,null,r.createElement("div",{style:{marginBottom:5}},"Match conditions to be satisfied for the rule to be activated."),r.createElement("div",null,"Kiali Wizard will create all conditions with an ",r.createElement("span",{className:zp},"OR")," semantic.")),nd=r.createElement(r.Fragment,null,r.createElement("div",{style:{marginBottom:5}},"A Circuit breaker implementation that tracks the status of each individual host in the"," ",r.createElement("span",{className:zp},"upstream")," service."," "),r.createElement("div",{style:{marginBottom:5}},"For ",r.createElement("span",{className:zp},"HTTP")," services, hosts that continually return 5xx errors for API calls are ejected from the pool for a pre-defined period of time."),r.createElement("div",null,"For ",r.createElement("span",{className:zp},"TCP")," services, connection timeouts or connection failures to a given host counts as an error when measuring the consecutive errors metric.")),rd=r.createElement(r.Fragment,null,r.createElement("div",{style:{marginBottom:5}},"PeerAuthentication defines how traffic will be tunneled (or not) to the sidecar."),r.createElement("div",null,"Defines the ",r.createElement("span",{className:zp},"mTLS")," mode used for peer authentication.")),id=r.createElement(r.Fragment,null,r.createElement("div",{style:{marginBottom:5}},"An ordered list of route rules for HTTP traffic."),r.createElement("div",null,"The first rule ",r.createElement("span",{className:zp},"MATCHING")," an incoming request is used.")),od=["ROUND_ROBIN","LEAST_CONN","RANDOM","PASSTHROUGH"],sd=["UNSET","DISABLE","ISTIO_MUTUAL","SIMPLE","MUTUAL"];!function(e){e.HTTP_HEADER_NAME="HTTP_HEADER_NAME",e.HTTP_COOKIE="HTTP_COOKIE",e.USE_SOURCE_IP="USE_SOURCE_IP"}(Fu||(Fu={}));var ld,cd=/^[0-9]*(\.[0-9]+)?s?$/;!function(e){e[e.TLS=0]="TLS",e[e.TLS_CLIENT_CERTIFICATE=1]="TLS_CLIENT_CERTIFICATE",e[e.TLS_PRIVATE_KEY=2]="TLS_PRIVATE_KEY",e[e.TLS_CA_CERTIFICATES=3]="TLS_CA_CERTIFICATES",e[e.LB_SWITCH=4]="LB_SWITCH",e[e.LB_SIMPLE=5]="LB_SIMPLE",e[e.LB_SELECT=6]="LB_SELECT",e[e.LB_CONSISTENT_HASH=7]="LB_CONSISTENT_HASH",e[e.LB_HTTP_HEADER_NAME=8]="LB_HTTP_HEADER_NAME",e[e.LB_HTTP_COOKIE_NAME=9]="LB_HTTP_COOKIE_NAME",e[e.LB_HTTP_COOKIE_TTL=10]="LB_HTTP_COOKIE_TTL",e[e.PA_SWITCH=11]="PA_SWITCH",e[e.PA_MODE=12]="PA_MODE"}(ld||(ld={}));var ud,pd=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;Object(s.a)(this,a),(n=t.call(this,e)).isValidDuration=function(e){return 0!==e.length&&0===e.search(cd)},n.isValidCookie=function(e){return!!(e.name&&0!==e.name.length&&e.ttl&&0!==e.ttl.length&&n.isValidDuration(e.ttl))},n.isValidLB=function(e){if(!e.addLoadBalancer)return!0;if(e.simpleLB)return!0;if(e.consistentHashType===Fu.USE_SOURCE_IP)return!0;if(!e.loadBalancer.consistentHash)return!1;switch(e.consistentHashType){case Fu.HTTP_HEADER_NAME:return!(!e.loadBalancer.consistentHash||!e.loadBalancer.consistentHash.httpHeaderName)&&e.loadBalancer.consistentHash.httpHeaderName.length>0;case Fu.HTTP_COOKIE:return!(!e.loadBalancer.consistentHash||!e.loadBalancer.consistentHash.httpCookie)&&n.isValidCookie(e.loadBalancer.consistentHash.httpCookie);default:return!0}},n.isValidTLS=function(e){return void 0!==e.mtlsMode},n.onFormChange=function(e,t){switch(e){case ld.TLS:n.setState({tlsModified:!0,mtlsMode:t},(function(){return n.props.onTrafficPolicyChange("MUTUAL"!==n.state.mtlsMode||n.state.clientCertificate.length>0&&n.state.privateKey.length>0,n.state)}));break;case ld.TLS_CLIENT_CERTIFICATE:n.setState({tlsModified:!0,clientCertificate:t},(function(){return n.props.onTrafficPolicyChange("MUTUAL"===n.state.mtlsMode&&n.state.clientCertificate.length>0&&n.state.privateKey.length>0,n.state)}));break;case ld.TLS_PRIVATE_KEY:n.setState({tlsModified:!0,privateKey:t},(function(){return n.props.onTrafficPolicyChange("MUTUAL"===n.state.mtlsMode&&n.state.clientCertificate.length>0&&n.state.privateKey.length>0,n.state)}));break;case ld.TLS_CA_CERTIFICATES:n.setState({tlsModified:!0,caCertificates:t},(function(){return n.props.onTrafficPolicyChange("MUTUAL"===n.state.mtlsMode&&n.state.clientCertificate.length>0&&n.state.privateKey.length>0,n.state)}));break;case ld.LB_SWITCH:n.setState((function(e){return{addLoadBalancer:!e.addLoadBalancer}}),(function(){return n.props.onTrafficPolicyChange(n.isValidLB(n.state),n.state)}));break;case ld.LB_SIMPLE:n.setState((function(e){var a=e.loadBalancer;return a.simple=t,{loadBalancer:a}}),(function(){return n.props.onTrafficPolicyChange(n.isValidLB(n.state),n.state)}));break;case ld.LB_SELECT:n.setState((function(e){return e.loadBalancer&&e.loadBalancer.simple||(e.loadBalancer.simple="ROUND_ROBIN"),{simpleLB:"true"===t}}),(function(){return n.props.onTrafficPolicyChange(n.isValidLB(n.state),n.state)}));break;case ld.LB_CONSISTENT_HASH:n.setState((function(e){var a=e.loadBalancer;return a.consistentHash||(a.consistentHash={}),Fu[t]===Fu.USE_SOURCE_IP&&(a.consistentHash.useSourceIp=!0),{consistentHashType:Fu[t]}}),(function(){return n.props.onTrafficPolicyChange(n.isValidLB(n.state),n.state)}));break;case ld.LB_HTTP_HEADER_NAME:n.setState((function(e){var a=e.loadBalancer;return a.consistentHash||(a.consistentHash={}),a.consistentHash.httpHeaderName=t,{loadBalancer:a}}),(function(){return n.props.onTrafficPolicyChange(n.isValidLB(n.state),n.state)}));break;case ld.LB_HTTP_COOKIE_NAME:n.setState((function(e){var a=e.loadBalancer;return a.consistentHash?a.consistentHash.httpCookie?a.consistentHash.httpCookie.name=t:a.consistentHash.httpCookie={name:"",ttl:""}:a.consistentHash={},{loadBalancer:a}}),(function(){return n.props.onTrafficPolicyChange(n.isValidLB(n.state),n.state)}));break;case ld.LB_HTTP_COOKIE_TTL:n.setState((function(e){var a=e.loadBalancer?e.loadBalancer.consistentHash:{};return a&&(a.httpCookie?a.httpCookie.ttl=t:a.httpCookie={name:"",ttl:""}),{loadBalancer:{consistentHash:a}}}),(function(){return n.props.onTrafficPolicyChange(n.isValidLB(n.state),n.state)}));break;case ld.PA_SWITCH:n.setState((function(e){return{peerAuthnSelector:{addPeerAuthentication:!e.peerAuthnSelector.addPeerAuthentication,addPeerAuthnModified:!e.peerAuthnSelector.addPeerAuthnModified,mode:e.peerAuthnSelector.mode}}}),(function(){return n.props.onTrafficPolicyChange(n.isValidTLS(n.state),n.state)}));break;case ld.PA_MODE:n.setState((function(e){return{peerAuthnSelector:{addPeerAuthentication:e.peerAuthnSelector.addPeerAuthentication,addPeerAuthnModified:e.peerAuthnSelector.addPeerAuthnModified,mode:t}}}),(function(){return n.props.onTrafficPolicyChange(n.isValidTLS(n.state),n.state)}))}};var r=Fu.HTTP_HEADER_NAME;return e.loadBalancer.consistentHash&&(e.loadBalancer.consistentHash.httpHeaderName?r=Fu.HTTP_HEADER_NAME:e.loadBalancer.consistentHash.httpCookie?r=Fu.HTTP_COOKIE:e.loadBalancer.consistentHash.useSourceIp&&(r=Fu.USE_SOURCE_IP)),n.state={tlsModified:!1,mtlsMode:e.mtlsMode,clientCertificate:e.clientCertificate,privateKey:e.privateKey,caCertificates:e.caCertificates,addLoadBalancer:e.hasLoadBalancer,simpleLB:e.loadBalancer&&void 0!==e.loadBalancer.simple&&null!==e.loadBalancer.simple,consistentHashType:r,loadBalancer:e.loadBalancer,peerAuthnSelector:{addPeerAuthentication:e.hasPeerAuthentication,addPeerAuthnModified:!1,mode:e.peerAuthenticationMode},addConnectionPool:e.addConnectionPool,connectionPool:e.connectionPool,addOutlierDetection:e.addOutlierDetection,outlierDetection:e.outlierDetection},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=this.props.meshWideStatus||gs.NOT_ENABLED,a=this.props.nsWideStatus?this.props.nsWideStatus.status:gs.NOT_ENABLED,n=Cs(a,t);""!==this.props.mtlsMode&&"UNSET"!==this.props.mtlsMode?this.setState({tlsModified:!0,mtlsMode:this.props.mtlsMode},(function(){return e.props.onTrafficPolicyChange(!0,e.state)})):n===gs.ENABLED&&this.setState({tlsModified:!0,mtlsMode:"ISTIO_MUTUAL"},(function(){return e.props.onTrafficPolicyChange(!0,e.state)}))}},{key:"render",value:function(){var e=this,t=this.isValidLB(this.state);return r.createElement(dp.a,{isHorizontal:!0},r.createElement(mp.a,{label:"TLS",fieldId:"advanced-tls",helperText:"TLS related settings for connections to the upstream service."},r.createElement(ur.a,{value:this.state.mtlsMode,onChange:function(t){return e.onFormChange(ld.TLS,t)},id:"advanced-tls",name:"advanced-tls"},sd.map((function(e){return r.createElement(pr.a,{key:e,value:e,label:e})})))),"MUTUAL"===this.state.mtlsMode&&r.createElement(r.Fragment,null,r.createElement(mp.a,{label:"Client Certificate",fieldId:"clientCertificate",isValid:this.state.clientCertificate.length>0,helperTextInvalid:"Client Certificate must be non empty"},r.createElement(Ae.a,{value:this.state.clientCertificate,onChange:function(t){return e.onFormChange(ld.TLS_CLIENT_CERTIFICATE,t)},id:"clientCertificate",name:"clientCertificate"})),r.createElement(mp.a,{label:"Private Key",fieldId:"privateKey",isValid:this.state.privateKey.length>0,helperTextInvalid:"Private Key must be non empty"},r.createElement(Ae.a,{value:this.state.privateKey,onChange:function(t){return e.onFormChange(ld.TLS_PRIVATE_KEY,t)},id:"privateKey",name:"privateKey"})),r.createElement(mp.a,{label:"CA Certificates",fieldId:"caCertificates"},r.createElement(Ae.a,{value:this.state.caCertificates,onChange:function(t){return e.onFormChange(ld.TLS_CA_CERTIFICATES,t)},id:"caCertificates",name:"caCertificates"}))),r.createElement(mp.a,{label:"Add PeerAuthentication",fieldId:"advanced-paSwitch"},r.createElement(fp.a,{id:"advanced-paSwitch",label:" ",labelOff:" ",isChecked:this.state.peerAuthnSelector.addPeerAuthentication,onChange:function(){return e.onFormChange(ld.PA_SWITCH,"")}}),r.createElement("span",null,Yp(rd))),this.state.peerAuthnSelector.addPeerAuthentication&&r.createElement(mp.a,{fieldId:"advanced-pa-mode",label:"Mode"},r.createElement(ur.a,{value:this.state.peerAuthnSelector.mode,onChange:function(t){return e.onFormChange(ld.PA_MODE,t)},id:"trafficPolicy-pa-mode",name:"trafficPolicy-pa-mode"},Object.keys(Oo).map((function(e){return r.createElement(pr.a,{key:e,value:e,label:e})})))),r.createElement(mp.a,{label:"Add LoadBalancer",fieldId:"advanced-lbSwitch"},r.createElement(fp.a,{id:"advanced-lbSwitch",label:" ",labelOff:" ",isChecked:this.state.addLoadBalancer,onChange:function(){return e.onFormChange(ld.LB_SWITCH,"")}}),Yp(td)),this.state.addLoadBalancer&&r.createElement(r.Fragment,null,r.createElement(mp.a,{fieldId:"selectLBType"},r.createElement(qp.a,{id:"selectLBTypeSimple",name:"selectLBType",label:"Simple",isDisabled:!this.state.addLoadBalancer,isChecked:this.state.simpleLB,onChange:function(){return e.onFormChange(ld.LB_SELECT,"true")}}),r.createElement(qp.a,{id:"selectLBTypeConsistentHash",name:"selectLBType",label:"Consistent Hash",isDisabled:!this.state.addLoadBalancer,isChecked:!this.state.simpleLB,onChange:function(){return e.onFormChange(ld.LB_SELECT,"false")}})),this.state.simpleLB&&r.createElement(mp.a,{fieldId:"advanced-loadbalancer",label:"LoadBalancer"},r.createElement(ur.a,{value:this.state.loadBalancer.simple,onChange:function(t){return e.onFormChange(ld.LB_SIMPLE,t)},id:"trafficPolicy-lb",name:"trafficPolicy-lb"},od.map((function(e){return r.createElement(pr.a,{key:e,value:e,label:e})})))),!this.state.simpleLB&&r.createElement(mp.a,{fieldId:"selectConsistentHashType"},r.createElement(qp.a,{id:"httpHeaderName",name:"selectConsistentHashType",label:"HTTP Header Name",isDisabled:!this.state.addLoadBalancer,isChecked:this.state.consistentHashType===Fu.HTTP_HEADER_NAME,onChange:function(){return e.onFormChange(ld.LB_CONSISTENT_HASH,Fu.HTTP_HEADER_NAME)}}),r.createElement(qp.a,{id:"httpCookie",name:"selectConsistentHashType",label:"HTTP Cookie",isDisabled:!this.state.addLoadBalancer,checked:this.state.consistentHashType===Fu.HTTP_COOKIE,onChange:function(){return e.onFormChange(ld.LB_CONSISTENT_HASH,Fu.HTTP_COOKIE)}}),r.createElement(qp.a,{id:"sourceIp",name:"selectConsistentHashType",label:"Source IP",isDisabled:!this.state.addLoadBalancer,isChecked:this.state.consistentHashType===Fu.USE_SOURCE_IP,onChange:function(){return e.onFormChange(ld.LB_CONSISTENT_HASH,Fu.USE_SOURCE_IP)}})),!this.state.simpleLB&&this.state.consistentHashType===Fu.HTTP_HEADER_NAME&&r.createElement(mp.a,{label:"HTTP Header Name",fieldId:"httpHeaderName",isValid:t,disabled:!this.state.addLoadBalancer,helperTextInvalid:"HTTP Header Name must be non empty"},r.createElement(Ae.a,{value:this.state.loadBalancer.consistentHash&&this.state.loadBalancer.consistentHash.httpHeaderName?this.state.loadBalancer.consistentHash.httpHeaderName:"",id:"httpHeaderName",name:"httpHeaderName",onChange:function(t){return e.onFormChange(ld.LB_HTTP_HEADER_NAME,t)},isValid:t})),!this.state.simpleLB&&this.state.consistentHashType===Fu.HTTP_COOKIE&&r.createElement(r.Fragment,null,r.createElement(mp.a,{label:"HTTP Cookie Name",fieldId:"httpCookieName",isValid:t,disabled:!this.state.addLoadBalancer},r.createElement(Ae.a,{value:this.state.loadBalancer.consistentHash&&this.state.loadBalancer.consistentHash.httpCookie?this.state.loadBalancer.consistentHash.httpCookie.name:"",id:"httpCookieName",name:"httpCookieName",onChange:function(t){return e.onFormChange(ld.LB_HTTP_COOKIE_NAME,t)},isValid:t})),r.createElement(mp.a,{label:"HTTP Cookie TTL",fieldId:"httpCookieTtl",isValid:t,disabled:!this.state.addLoadBalancer,helperText:"TTL is expressed in nanoseconds (i.e. 1000, 2000, etc) or seconds (i.e. 10s, 1.5s, etc).",helperTextInvalid:"HTTP Cookie Name must be non empty and TTL must be expressed in in nanoseconds (i.e. 1000, 2000, etc) or seconds (i.e. 10s, 1.5s, etc)."},r.createElement(Ae.a,{value:this.state.loadBalancer.consistentHash&&this.state.loadBalancer.consistentHash.httpCookie?this.state.loadBalancer.consistentHash.httpCookie.ttl:"",id:"httpCookieTtl",name:"httpCookieTtl",onChange:function(t){return e.onFormChange(ld.LB_HTTP_COOKIE_TTL,t)},isValid:t})))))}}]),a}(r.Component),dd=Object(h.b)((function(e){return{meshWideStatus:xl(e)}}))(pd),md=dd,hd=["principals","notPrincipals","requestPrincipals","notRequestPrincipals","namespaces","notNamespaces","ipBlocks","notIpBlocks"].sort(),fd=Object(Jn.a)({color:nt.Red100}),gd=[{title:"Source Field",transforms:[Object(oo.a)(20)],props:{}},{title:"Values",transforms:[Object(oo.a)(80)],props:{}},{title:"",props:{}}],vd=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).onAddNewSourceField=function(e,t){n.setState({newSourceField:e})},n.onAddNewValues=function(e,t){n.setState({newValues:e})},n.onAddSource=function(){n.setState((function(e){var t=e.sourceFields.indexOf(e.newSourceField);return t>-1&&e.sourceFields.splice(t,1),e.source[e.newSourceField]=e.newValues.split(","),{sourceFields:e.sourceFields,source:e.source,newSourceField:e.sourceFields[0],newValues:""}}))},n.onAddSourceFromList=function(){var e=n.state.source;n.setState({sourceFields:Object.assign([],hd),source:{},newSourceField:hd[0],newValues:""},(function(){n.props.onAddFrom(e)}))},n.isValidSource=function(){if(("ipBlocks"===n.state.newSourceField||"notIpBlocks"===n.state.newSourceField)&&!n.state.newValues.split(",").every((function(e){return Ap(e)})))return[!1,"Not valid IP"];return n.state.newValues.split(",").every((function(e){return 0===e.length}))?[!1,"Empty value"]:[!0,""]},n.actionResolver=function(e,t){var a={title:"Remove Field",onClick:function(e,t,a,r){var i=a.cells[0].props.children.toString();n.setState((function(e){e.sourceFields.push(i),delete e.source[i];var t=e.sourceFields.sort();return{sourceFields:t,source:e.source,newSourceField:t[0],newValues:""}}))}};return t.rowIndex<Object.keys(n.state.source).length?[a]:[]},n.rows=function(){var e=n.isValidSource(),t=Object(T.a)(e,2),a=t[0],i=t[1],o=Object.keys(n.state.source).map((function(e,t){return{key:"sourceKey"+t,cells:[r.createElement(r.Fragment,null,e),r.createElement(r.Fragment,null,n.state.source[e].join(",")),r.createElement(r.Fragment,null)]}}));return n.state.sourceFields.length>0?o.concat([{key:"sourceKeyNew",cells:[r.createElement(r.Fragment,null,r.createElement(ur.a,{value:n.state.newSourceField,id:"addNewSourceField",name:"addNewSourceField",onChange:n.onAddNewSourceField},n.state.sourceFields.map((function(e,t){return r.createElement(pr.a,{isDisabled:!1,key:"source"+t,value:e,label:e})})))),r.createElement(r.Fragment,null,r.createElement(Ae.b,{value:n.state.newValues,type:"text",id:"addNewValues",key:"addNewValues","aria-describedby":"add new source values",name:"addNewValues",onChange:n.onAddNewValues,isValid:a}),!a&&r.createElement("div",{key:"hostsHelperText",className:fd},i)),r.createElement(r.Fragment,null,n.state.sourceFields.length>0&&r.createElement(vr.a,{variant:"link",icon:r.createElement(xp.a,null),onClick:n.onAddSource,isDisabled:!a}))]}]):o},n.state={sourceFields:Object.assign([],hd),source:{},newSourceField:hd[0],newValues:""},n}return Object(l.a)(a,[{key:"render",value:function(){return r.createElement(r.Fragment,null,r.createElement(Eu.b,{"aria-label":"Source Builder",cells:gd,rows:this.rows(),actionResolver:this.actionResolver},r.createElement(bu.a,null),r.createElement(kp.a,null)),r.createElement(vr.a,{variant:"link",icon:r.createElement(xp.a,null),isDisabled:0===Object.keys(this.state.source).length,onClick:this.onAddSourceFromList},"Add Source to From List"))}}]),a}(r.Component),Ed=vd,bd=[{title:"Source Matches of a Request",transforms:[Object(oo.a)(100)],props:{}},{title:"",props:{}}],yd=Object(Jn.a)({marginTop:10,color:nt.Red100,textAlign:"center",width:"100%"}),Cd=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).rows=function(){return e.props.fromList.map((function(e,t){return{key:"fromSource"+t,cells:[r.createElement(r.Fragment,null,"Rules",Object.keys(e).map((function(a,n){return r.createElement("div",{key:"sourceField_"+a+"_"+t+"_"+n},r.createElement("b",null,a),": [",e[a].join(","),"]",r.createElement("br",null))}))),r.createElement(r.Fragment,null)]}}))},e.actionResolver=function(t,a){a.rowIndex;return[{title:"Remove From",onClick:function(t,a,n,r){e.props.onRemoveFrom(a)}}]},e}return Object(l.a)(a,[{key:"render",value:function(){return r.createElement(r.Fragment,null,r.createElement(Eu.b,{"aria-label":"Source Builder",cells:bd,rows:this.rows(),actionResolver:this.actionResolver},r.createElement(bu.a,null),r.createElement(kp.a,null)),0===this.props.fromList.length&&r.createElement("div",{className:yd},"No Source Matches Defined"))}}]),a}(r.Component),Sd=Cd,Ad=["hosts","notHosts","ports","notPorts","methods","notMethods","paths","notPaths"].sort(),Td=[{title:"Operation Field",transforms:[Object(oo.a)(20)],props:{}},{title:"Values",transforms:[Object(oo.a)(80)],props:{}},{title:"",props:{}}],Od=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).onAddNewOperationField=function(e,t){n.setState({newOperationField:e})},n.onAddNewValues=function(e,t){n.setState({newValues:e})},n.onAddOperation=function(){n.setState((function(e){var t=e.operationFields.indexOf(e.newOperationField);return t>-1&&e.operationFields.splice(t,1),e.operation[e.newOperationField]=e.newValues.split(","),{operationFields:e.operationFields,operation:e.operation,newOperationField:e.operationFields[0],newValues:""}}))},n.onAddOperationToList=function(){var e=n.state.operation;n.setState({operationFields:Object.assign([],Ad),operation:{},newOperationField:Ad[0],newValues:""},(function(){n.props.onAddTo(e)}))},n.actionResolver=function(e,t){var a={title:"Remove Field",onClick:function(e,t,a,r){var i=a.cells[0].props.children.toString();n.setState((function(e){e.operationFields.push(i),delete e.operation[i];var t=e.operationFields.sort();return{operationFields:t,operation:e.operation,newOperationField:t[0],newValues:""}}))}};return t.rowIndex<Object.keys(n.state.operation).length?[a]:[]},n.rows=function(){var e=Object.keys(n.state.operation).map((function(e,t){return{key:"operationKey"+t,cells:[r.createElement(r.Fragment,null,e),r.createElement(r.Fragment,null,n.state.operation[e].join(",")),r.createElement(r.Fragment,null)]}}));return n.state.operationFields.length>0?e.concat([{key:"operationKeyNew",cells:[r.createElement(r.Fragment,null,r.createElement(ur.a,{value:n.state.newOperationField,id:"addNewOperationField",name:"addNewOperationField",onChange:n.onAddNewOperationField},n.state.operationFields.map((function(e,t){return r.createElement(pr.a,{isDisabled:!1,key:"operation"+t,value:e,label:e})})))),r.createElement(r.Fragment,null,r.createElement(Ae.b,{value:n.state.newValues,type:"text",id:"addNewValues",key:"addNewValues","aria-describedby":"add new operation values",name:"addNewValues",onChange:n.onAddNewValues})),r.createElement(r.Fragment,null,n.state.operationFields.length>0&&r.createElement(vr.a,{variant:"link",icon:r.createElement(xp.a,null),onClick:n.onAddOperation}))]}]):e},n.state={operationFields:Object.assign([],Ad),operation:{},newOperationField:Ad[0],newValues:""},n}return Object(l.a)(a,[{key:"render",value:function(){return r.createElement(r.Fragment,null,r.createElement(Eu.b,{"aria-label":"Operation Builder",cells:Td,rows:this.rows(),actionResolver:this.actionResolver},r.createElement(bu.a,null),r.createElement(kp.a,null)),r.createElement(vr.a,{variant:"link",icon:r.createElement(xp.a,null),isDisabled:0===Object.keys(this.state.operation).length,onClick:this.onAddOperationToList},"Add Operation to To List"))}}]),a}(r.Component),Id=Od,wd=[{title:"Operations of a Request",transforms:[Object(oo.a)(100)],props:{}},{title:"",props:{}}],Rd=Object(Jn.a)({marginTop:10,color:nt.Red100,textAlign:"center",width:"100%"}),kd=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).rows=function(){return e.props.toList.map((function(e,t){return{key:"toOperation"+t,cells:[r.createElement(r.Fragment,null,Object.keys(e).map((function(a,n){return r.createElement("div",{key:"operationField_"+t+"_"+n},r.createElement("b",null,a),": [",e[a].join(","),"]",r.createElement("br",null))}))),r.createElement(r.Fragment,null)]}}))},e.actionResolver=function(t,a){a.rowIndex;return[{title:"Remove To",onClick:function(t,a,n,r){e.props.onRemoveTo(a)}}]},e}return Object(l.a)(a,[{key:"render",value:function(){return r.createElement(r.Fragment,null,r.createElement(Eu.b,{"aria-label":"Source Builder",cells:wd,rows:this.rows(),actionResolver:this.actionResolver},r.createElement(bu.a,null),r.createElement(kp.a,null)),0===this.props.toList.length&&r.createElement("div",{className:Rd},"No Operations Defined"))}}]),a}(r.Component),xd=kd,Nd=/^[a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[-a-z0-9]([-a-z0-9]*[a-z0-9])?)*$/,jd=/^request\.headers\[.*\]$/,Pd=[{title:"Condition Key",transforms:[Object(oo.a)(30)],props:{}},{title:"Values",transforms:[Object(oo.a)(30)],props:{}},{title:"Not Values",transforms:[Object(oo.a)(30)],props:{}}],Ld=Object(Jn.a)({color:nt.Red100}),Dd=["source.ip","source.namespace","source.principal","request.auth.principal","request.auth.audiences","request.auth.presenter","destination.ip","destination.port","connection.sni"],Fd=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).onAddNewConditionKey=function(e,t){n.setState((function(t){return t.condition.key=e,{condition:t.condition}}))},n.onAddNewValues=function(e,t){n.setState((function(t){return t.condition.values=0===e.length?[]:e.split(","),{condition:t.condition}}))},n.onAddNewNotValues=function(e,t){n.setState((function(t){return t.condition.notValues=0===e.length?[]:e.split(","),{condition:t.condition}}))},n.onAddConditionToList=function(){var e=n.state.condition;n.setState({condition:{key:""}},(function(){n.props.onAddCondition(e)}))},n.isValidKey=function(e){return 0!==e.length&&(!!Dd.includes(e)||(e.startsWith("request.headers")?""!==(t=e)&&0===t.search(jd):!!e.startsWith("experimental.envoy.filters.")));var t},n.isValidCondition=function(){var e=n.state.condition.key;if(!n.isValidKey(e))return[!1,!0,!0,"Condition Key not supported"];var t=n.state.condition.values,a=n.state.condition.notValues;return t&&0!==t.length||a&&0!==a.length?"source.ip"===e||"destination.ip"===e?[!0,!t||!t.some((function(e){return!Ap(e)})),!a||!a.some((function(e){return!Ap(e)})),"Not valid IP"]:[!0,!0,!0,""]:[!0,!1,!1,"Values and NotValues cannot be empty"]},n.rows=function(e,t,a,i){return[{key:"conditionKeyNew",cells:[r.createElement(r.Fragment,null,r.createElement(Ae.b,{value:n.state.condition.key,type:"text",id:"addNewConditionKey",key:"addNewConditionKey","aria-describedby":"add new condition key",name:"addNewConditionKey",onChange:n.onAddNewConditionKey,isValid:e}),!e&&r.createElement("div",{key:"hostsHelperText",className:Ld},i)),r.createElement(r.Fragment,null,r.createElement(Ae.b,{value:n.state.condition.values?n.state.condition.values.join(","):"",type:"text",id:"addNewValues",key:"addNewValues","aria-describedby":"add new condition values",name:"addNewConditionValues",onChange:n.onAddNewValues}),!t&&r.createElement("div",{key:"hostsHelperText",className:Ld},i)),r.createElement(r.Fragment,null,r.createElement(Ae.b,{value:n.state.condition.notValues?n.state.condition.notValues.join(","):"",type:"text",id:"addNewNotValues",key:"addNewNotValues","aria-describedby":"add new condition not values",name:"addNewNotValues",onChange:n.onAddNewNotValues}),!a&&r.createElement("div",{key:"hostsHelperText",className:Ld},i))]}]},n.state={condition:{key:""}},n}return Object(l.a)(a,[{key:"render",value:function(){var e=this.isValidCondition(),t=Object(T.a)(e,4),a=t[0],n=t[1],i=t[2],o=t[3],s=a&&n&&i;return r.createElement(r.Fragment,null,r.createElement(Eu.b,{"aria-label":"Condition Builder",cells:Pd,rows:this.rows(a,n,i,o)},r.createElement(bu.a,null),r.createElement(kp.a,null)),r.createElement(vr.a,{variant:"link",icon:r.createElement(xp.a,null),isDisabled:!s,onClick:this.onAddConditionToList},"Add Condition to When List"))}}]),a}(r.Component),_d=Fd,Md=[{title:"Additional Conditions of a Request",transforms:[Object(oo.a)(100)],props:{}},{title:"",props:{}}],Hd=Object(Jn.a)({marginTop:10,color:nt.Red100,textAlign:"center",width:"100%"}),Gd=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).rows=function(){return e.props.conditionList.map((function(e,t){return{key:"condition"+t,cells:[r.createElement(r.Fragment,null,r.createElement("b",null,"key: ")," [",e.key,"]",r.createElement("br",null),e.values&&r.createElement(r.Fragment,null,r.createElement("b",null,"values: ")," [",e.values,"]",r.createElement("br",null)),e.notValues&&r.createElement(r.Fragment,null,r.createElement("b",null,"notValues: ")," [",e.notValues,"]",r.createElement("br",null))),r.createElement(r.Fragment,null)]}}))},e.actionResolver=function(t,a){a.rowIndex;return[{title:"Remove Condition",onClick:function(t,a,n,r){e.props.onRemoveCondition(a)}}]},e}return Object(l.a)(a,[{key:"render",value:function(){return r.createElement(r.Fragment,null,r.createElement(Eu.b,{"aria-label":"Condition Builder",cells:Md,rows:this.rows(),actionResolver:this.actionResolver},r.createElement(bu.a,null),r.createElement(kp.a,null)),0===this.props.conditionList.length&&r.createElement("div",{className:Hd},"No Conditions Defined"))}}]),a}(r.Component),Vd=Gd,Ud=Object(Jn.a)({marginLeft:25,color:nt.Red100,textAlign:"center"}),Bd=Object(Jn.a)({marginLeft:0,paddingLeft:0}),Wd=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).onAddFrom=function(e){n.setState((function(t){return t.fromList.push(e),{fromList:t.fromList}}))},n.onRemoveFrom=function(e){n.setState((function(t){return t.fromList.splice(e,1),{fromList:t.fromList}}))},n.onAddTo=function(e){n.setState((function(t){return t.toList.push(e),{toList:t.toList}}))},n.onRemoveTo=function(e){n.setState((function(t){return t.toList.splice(e,1),{toList:t.toList}}))},n.onAddCondition=function(e){n.setState((function(t){return t.conditionList.push(e),{conditionList:t.conditionList}}))},n.onRemoveCondition=function(e){n.setState((function(t){return t.conditionList.splice(e,1),{conditionList:t.conditionList}}))},n.onAddRule=function(){var e={from:Object.assign([],n.state.fromList),to:Object.assign([],n.state.toList),when:Object.assign([],n.state.conditionList)};n.setState({addFromSwitch:!1,addToSwitch:!1,addWhenSwitch:!1,fromList:[],toList:[],conditionList:[]},(function(){return n.props.onAddRule(e)}))},n.canAddRule=function(){return n.state.fromList.length>0||n.state.toList.length>0||n.state.conditionList.length>0},n.state={addFromSwitch:!1,addToSwitch:!1,addWhenSwitch:!1,fromList:[],toList:[],conditionList:[]},n}return Object(l.a)(a,[{key:"render",value:function(){var e=this;return r.createElement(r.Fragment,null,r.createElement(mp.a,{label:"From",fieldId:"addFromSwitch"},r.createElement(fp.a,{id:"addFromSwitch",label:" ",labelOff:" ",isChecked:this.state.addFromSwitch,onChange:function(){e.setState((function(e){return{addFromSwitch:!e.addFromSwitch}}))}})),this.state.addFromSwitch&&r.createElement(r.Fragment,null,r.createElement(mp.a,{label:"Source Builder",fieldId:"sourceBuilder"},r.createElement(Ed,{onAddFrom:this.onAddFrom})),r.createElement(mp.a,{label:"From List",fieldId:"sourceList"},r.createElement(Sd,{fromList:this.state.fromList,onRemoveFrom:this.onRemoveFrom}))),r.createElement(mp.a,{label:"To",fieldId:"addToSwitch"},r.createElement(fp.a,{id:"addToSwitch",label:" ",labelOff:" ",isChecked:this.state.addToSwitch,onChange:function(){e.setState((function(e){return{addToSwitch:!e.addToSwitch}}))}})),this.state.addToSwitch&&r.createElement(r.Fragment,null,r.createElement(mp.a,{label:"Operation Builder",fieldId:"operationBuilder"},r.createElement(Id,{onAddTo:this.onAddTo})),r.createElement(mp.a,{label:"To List",fieldId:"operationList"},r.createElement(xd,{toList:this.state.toList,onRemoveTo:this.onRemoveTo}))),r.createElement(mp.a,{label:"When",fieldId:"addWhenSwitch"},r.createElement(fp.a,{id:"addWhenSwitch",label:" ",labelOff:" ",isChecked:this.state.addWhenSwitch,onChange:function(){e.setState((function(e){return{addWhenSwitch:!e.addWhenSwitch}}))}})),this.state.addWhenSwitch&&r.createElement(r.Fragment,null,r.createElement(mp.a,{label:"Condition Builder",fieldId:"conditionBuilder"},r.createElement(_d,{onAddCondition:this.onAddCondition})),r.createElement(mp.a,{label:"When List",fieldId:"conditionList"},r.createElement(Vd,{conditionList:this.state.conditionList,onRemoveCondition:this.onRemoveCondition}))),r.createElement(mp.a,{fieldId:"addRule"},r.createElement(vr.a,{variant:"link",icon:r.createElement(xp.a,null),onClick:this.onAddRule,isDisabled:!this.canAddRule(),className:Bd},"Add Rule to Rule List"),!this.canAddRule()&&r.createElement("span",{className:Ud},'A Rule needs at least an item in "From", "To" or "When" sections')))}}]),a}(r.Component),qd=Wd,Kd=[{title:"From",transforms:[Object(oo.a)(40)],props:{}},{title:"To",transforms:[Object(oo.a)(40)],props:{}},{title:"When",transforms:[Object(oo.a)(40)],props:{}},{title:"",props:{}}],zd=Object(Jn.a)({paddingLeft:10}),Yd=Object(Jn.a)({marginTop:10,color:nt.Red100,textAlign:"center",width:"100%"}),Qd=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).rows=function(){return e.props.ruleList.map((function(e,t){return{key:"rule"+t,cells:[r.createElement(r.Fragment,null,e.from.length>0&&r.createElement(r.Fragment,null,r.createElement(r.Fragment,null,e.from.map((function(e,t){var a=Object.keys(e);return r.createElement("div",{id:"from"+t,className:zd},r.createElement("span",{style:{marginRight:20}},"source:"),a.map((function(n,i){return r.createElement("span",{id:"fromField"+t+"_"+i},r.createElement("b",null,n),": [",e[n].join(","),"]",i<a.length-1?" and ":"")})))}))))),r.createElement(r.Fragment,null,e.to.length>0&&r.createElement(r.Fragment,null,e.to.map((function(e,t){var a=Object.keys(e);return r.createElement("div",{id:"to"+t,className:zd},r.createElement("span",{style:{marginRight:20}},"operation:"),a.map((function(n,i){return r.createElement("span",{id:"toItem"+t+"_"+i},r.createElement("b",null,n),": [",e[n].join(","),"]",i<a.length-1?" and ":"")})))})))),r.createElement(r.Fragment,null,e.when.length>0&&r.createElement(r.Fragment,null,e.when.map((function(e,t){return r.createElement("div",{id:"when"+t,className:zd},r.createElement("span",null,r.createElement("b",null,"key"),": [",e.key,"]"),r.createElement("span",{style:{marginLeft:5}},r.createElement("b",null,"values:")," [",e.values,"]"),r.createElement("span",{style:{marginLeft:5}},r.createElement("b",null,"notValues:")," [",e.notValues,"]"))})))),r.createElement(r.Fragment,null)]}}))},e.actionResolver=function(t,a){a.rowIndex;return[{title:"Remove Rule",onClick:function(t,a,n,r){e.props.onRemoveRule(a)}}]},e}return Object(l.a)(a,[{key:"render",value:function(){var e="DENY"===this.props.action?" DENY action requires at least one Rule":"No Rules Defined.";return r.createElement(r.Fragment,null,r.createElement(Eu.b,{"aria-label":"Source Builder",cells:Kd,rows:this.rows(),actionResolver:this.actionResolver},r.createElement(bu.a,null),r.createElement(kp.a,null)),0===this.props.ruleList.length&&r.createElement("div",{className:Yd},e))}}]),a}(r.Component),Xd={DENY_ALL:"Denies all requests to workloads in given namespace(s)",ALLOW_ALL:"Allows all requests to workloads in given namespace(s)",RULES:"Builds an Authorization Policy based on Rules"},Jd=["DENY_ALL","ALLOW_ALL","RULES"],Zd=["ALLOW","DENY"],$d=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).onRulesFormChange=function(e,t){n.setState({policy:e},(function(){return n.onAuthorizationChange()}))},n.onChangeWorkloadSelector=function(){n.setState((function(e){return{addWorkloadSelector:!e.addWorkloadSelector}}),(function(){return n.onAuthorizationChange()}))},n.addWorkloadLabels=function(e,t){if(0!==e.length){for(var a=(e=e.trim()).split(","),r=!0,i=0;i<a.length;i++){var o=a[i];if(o.indexOf("=")<0){r=!1;break}var s=o.split("=");if(2!==s.length){r=!1;break}if(0===s[0].trim().length||0===s[1].trim().length){r=!1;break}}n.setState({workloadSelectorValid:r,workloadSelector:e},(function(){return n.onAuthorizationChange()}))}else n.setState({workloadSelectorValid:!1,workloadSelector:""},(function(){return n.onAuthorizationChange()}))},n.onActionChange=function(e,t){n.setState({action:e},(function(){return n.onAuthorizationChange()}))},n.onAddRule=function(e){n.setState((function(t){return t.rules.push(e),{rules:t.rules}}),(function(){return n.onAuthorizationChange()}))},n.onRemoveRule=function(e){n.setState((function(t){return t.rules.splice(e,1),{rules:t.rules}}),(function(){return n.onAuthorizationChange()}))},n.onAuthorizationChange=function(){n.props.onChange(n.state)},n.state={policy:"DENY_ALL",workloadSelector:"",action:"ALLOW",rules:[],addWorkloadSelector:!1,workloadSelectorValid:!1},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.setState({policy:this.props.authorizationPolicy.policy,workloadSelector:this.props.authorizationPolicy.workloadSelector,action:this.props.authorizationPolicy.action,rules:[],addWorkloadSelector:this.props.authorizationPolicy.addWorkloadSelector,workloadSelectorValid:this.props.authorizationPolicy.workloadSelectorValid})}},{key:"render",value:function(){return r.createElement(r.Fragment,null,r.createElement(mp.a,{label:"Policy",fieldId:"rules-form",helperText:Xd[this.state.policy]},r.createElement(ur.a,{value:this.state.policy,onChange:this.onRulesFormChange,id:"rules-form",name:"rules-form"},Jd.map((function(e,t){return r.createElement(pr.a,{key:t,value:e,label:e})})))),"RULES"===this.state.policy&&r.createElement(mp.a,{label:"Workload Selector",fieldId:"workloadSelectorSwitch"},r.createElement(fp.a,{id:"workloadSelectorSwitch",label:" ",labelOff:" ",isChecked:this.state.addWorkloadSelector,onChange:this.onChangeWorkloadSelector})),this.state.addWorkloadSelector&&r.createElement(mp.a,{fieldId:"workloadLabels",label:"Labels",helperText:"One or more labels to select a workload where the AuthorizationPolicy is applied.",helperTextInvalid:"Enter a label in the format <label>=<value>. Enter one or multiple labels separated by comma.",isValid:this.state.workloadSelectorValid},r.createElement(Ae.b,{id:"gwHosts",name:"gwHosts",isDisabled:!this.state.addWorkloadSelector,value:this.state.workloadSelector,onChange:this.addWorkloadLabels,isValid:this.state.workloadSelectorValid})),"RULES"===this.state.policy&&r.createElement(mp.a,{label:"Action",fieldId:"action-form"},r.createElement(ur.a,{value:this.state.action,onChange:this.onActionChange,id:"action-form",name:"action-form"},Zd.map((function(e,t){return r.createElement(pr.a,{key:t,value:e,label:e})})))),"RULES"===this.state.policy&&r.createElement(qd,{onAddRule:this.onAddRule}),"RULES"===this.state.policy&&r.createElement(mp.a,{label:"Rule List",fieldId:"apRuleList"},r.createElement(Qd,{action:this.state.action,ruleList:this.state.rules,onRemoveRule:this.onRemoveRule})))}}]),a}(r.Component),em=["request_routing","fault_injection","traffic_shifting","tcp_traffic_shifting","request_timeouts"],tm=(ud={},Object(Ei.a)(ud,"request_routing","Request Routing"),Object(Ei.a)(ud,"fault_injection","Fault Injection"),Object(Ei.a)(ud,"traffic_shifting","Traffic Shifting"),Object(Ei.a)(ud,"tcp_traffic_shifting","TCP Traffic Shifting"),Object(Ei.a)(ud,"request_timeouts","Request Timeouts"),ud),am=function(e,t){return e+"."+t+"."+j.istioIdentityDomain},nm=function(e){return e.exact?"exact "+e.exact:e.prefix?"prefix "+e.prefix:e.regex?"regex "+e.regex:""},rm=function(e,t){var a={},n=e.serviceName;1===e.destinationRules.items.length&&e.destinationRules.items[0].metadata.name!==n&&(n=e.destinationRules.items[0].metadata.name);var r={metadata:{namespace:e.namespace,name:n,labels:Object(Ei.a)({},"kiali_wizard",e.type)},spec:{host:am(e.serviceName,e.namespace)}},i=e.workloads.filter((function(e){var t=j.istioLabels.versionLabelName;return e.labels[t]})).map((function(e){var t=j.istioLabels.versionLabelName,n=e.labels[t],r={};return r[t]=n,a[e.name]=n,{name:n,labels:r}}));i.length>0&&(r.spec.subsets=i);var o=e.serviceName;1===e.virtualServices.items.length&&e.virtualServices.items[0].metadata.name!==o&&(o=e.virtualServices.items[0].metadata.name);var s={metadata:{namespace:e.namespace,name:o,labels:Object(Ei.a)({},"kiali_wizard",e.type)},spec:{}},l=void 0,c=function(e,t,a){var n=e+"/"+t+"-gateway";if(0===a.length)return n;for(var r=!1;!r;)if(a.includes(n))if("-"===n.charAt(n.length-2)){var i=+n.charAt(n.length-1);i+=1,n=n.substr(0,n.length-1)+i}else n+="-1";else r=!0;return n}(e.namespace,e.serviceName,e.gateways),u=t.gateway&&t.gateway.addGateway&&t.gateway.newGateway?{metadata:{namespace:e.namespace,name:c.substr(e.namespace.length+1),labels:Object(Ei.a)({},"kiali_wizard",e.type)},spec:{selector:{istio:"ingressgateway"},servers:[{port:{number:t.gateway.port,name:"http",protocol:"HTTP"},hosts:t.gateway.gwHosts.split(",")}]}}:void 0;switch(e.type){case"traffic_shifting":var p,d;s.spec={http:[{route:t.workloads.filter((function(e){return!e.mirrored})).map((function(t){var n={destination:{host:am(e.serviceName,e.namespace)},weight:t.weight};return a[t.name]&&(n.destination.subset=a[t.name]),n}))}]};var m=t.workloads.filter((function(e){return e.mirrored})).pop();m&&1===(null===s||void 0===s||null===(p=s.spec)||void 0===p||null===(d=p.http)||void 0===d?void 0:d.length)&&(s.spec.http[0].mirror={host:am(e.serviceName,e.namespace)},a[m.name]&&(s.spec.http[0].mirror.subset=a[m.name]),s.spec.http[0].mirrorPercentage={value:m.weight});break;case"tcp_traffic_shifting":s.spec={tcp:[{route:t.workloads.map((function(t){var n={destination:{host:am(e.serviceName,e.namespace)},weight:t.weight};return a[t.name]&&(n.destination.subset=a[t.name]),n}))}]};break;case"request_routing":s.spec={http:t.rules.map((function(t){var n={route:[]};t.workloadWeights.filter((function(e){return!e.mirrored})).forEach((function(t){var r,i={destination:{host:am(e.serviceName,e.namespace)},weight:t.weight};a[t.name]&&(i.destination.subset=a[t.name]),null===(r=n.route)||void 0===r||r.push(i)}));var r=t.workloadWeights.filter((function(e){return e.mirrored})).pop();return r&&(n.mirror={host:am(e.serviceName,e.namespace)},a[r.name]&&(n.mirror.subset=a[r.name]),n.mirrorPercentage={value:r.weight}),t.matches.length>0&&(n.match=function(e){var t=[],a={headers:{}};return e.filter((function(e){return e.startsWith("headers")})).forEach((function(e){var t=e.indexOf("["),n=e.indexOf("]"),r=e.substring(t+1,n).trim(),i=e.indexOf(" ",n+1),o=e.indexOf(" ",i+1),s=e.substring(i+1,o).trim(),l=e.substring(o+1).trim();a.headers[r]=Object(Ei.a)({},s,l)})),Object.keys(a.headers||{}).length>0&&t.push(a),e.filter((function(e){return!e.startsWith("headers")})).forEach((function(e){var a=e.indexOf(" "),n=e.indexOf(" ",a+1),r=e.substring(0,a).trim(),i=e.substring(a+1,n).trim(),o=e.substring(n+1).trim();t.push(Object(Ei.a)({},r,Object(Ei.a)({},i,o)))})),t}(t.matches)),(t.delay||t.abort)&&(n.fault={},t.delay&&(n.fault.delay=t.delay),t.abort&&(n.fault.abort=t.abort)),t.timeout&&(n.timeout=t.timeout),t.retries&&(n.retries=t.retries),n}))};break;case"fault_injection":s.spec={http:[{route:t.faultInjectionRoute.workloads.map((function(t){var n={destination:{host:am(e.serviceName,e.namespace)},weight:t.weight};return a[t.name]&&(n.destination.subset=a[t.name]),n}))}]},s.spec.http&&s.spec.http[0]&&(t.faultInjectionRoute.delayed||t.faultInjectionRoute.aborted)&&(s.spec.http[0].fault={},t.faultInjectionRoute.delayed&&(s.spec.http[0].fault.delay=t.faultInjectionRoute.delay),t.faultInjectionRoute.aborted&&(s.spec.http[0].fault.abort=t.faultInjectionRoute.abort));break;case"request_timeouts":s.spec={http:[{route:t.timeoutRetryRoute.workloads.map((function(t){var n={destination:{host:am(e.serviceName,e.namespace),subset:a[t.name]},weight:t.weight};return a[t.name]&&(n.destination.subset=a[t.name]),n}))}]},s.spec.http&&s.spec.http[0]&&(t.timeoutRetryRoute.isTimeout&&(s.spec.http[0].timeout=t.timeoutRetryRoute.timeout),t.timeoutRetryRoute.isRetry&&(s.spec.http[0].retries=t.timeoutRetryRoute.retries));break;default:console.log("Unrecognized type")}if(s.spec.hosts=t.vsHosts.length>1||1===t.vsHosts.length&&t.vsHosts[0].length>0?t.vsHosts:[e.serviceName],t.trafficPolicy.tlsModified&&"UNSET"!==t.trafficPolicy.mtlsMode&&(r.spec.trafficPolicy={},r.spec.trafficPolicy.tls={mode:t.trafficPolicy.mtlsMode,clientCertificate:null,privateKey:null,caCertificates:null},"MUTUAL"===t.trafficPolicy.mtlsMode&&(r.spec.trafficPolicy.tls.clientCertificate=t.trafficPolicy.clientCertificate,r.spec.trafficPolicy.tls.privateKey=t.trafficPolicy.privateKey,r.spec.trafficPolicy.tls.caCertificates=t.trafficPolicy.caCertificates)),t.trafficPolicy.peerAuthnSelector.addPeerAuthentication){var h={};h[j.istioLabels.appLabelName]=e.workloads[0].labels[j.istioLabels.appLabelName],l={metadata:{namespace:e.namespace,name:e.serviceName,labels:Object(Ei.a)({},"kiali_wizard",e.type)},spec:{selector:{matchLabels:h},mtls:{mode:t.trafficPolicy.peerAuthnSelector.mode}}},r.metadata.annotations={},r.metadata.annotations.kiali_wizard_related="PeerAuthentication/"+e.serviceName}if(t.trafficPolicy.addLoadBalancer)if(r.spec.trafficPolicy||(r.spec.trafficPolicy={}),t.trafficPolicy.simpleLB)r.spec.trafficPolicy.loadBalancer={simple:t.trafficPolicy.loadBalancer.simple,consistentHash:null};else if(r.spec.trafficPolicy.loadBalancer={simple:null,consistentHash:{}},r.spec.trafficPolicy.loadBalancer.consistentHash={httpHeaderName:null,httpCookie:null,useSourceIp:null},t.trafficPolicy.loadBalancer.consistentHash){var f=t.trafficPolicy.loadBalancer.consistentHash;switch(t.trafficPolicy.consistentHashType){case Fu.HTTP_HEADER_NAME:r.spec.trafficPolicy.loadBalancer.consistentHash.httpHeaderName=f.httpHeaderName;break;case Fu.HTTP_COOKIE:r.spec.trafficPolicy.loadBalancer.consistentHash.httpCookie=f.httpCookie;break;case Fu.USE_SOURCE_IP:r.spec.trafficPolicy.loadBalancer.consistentHash.useSourceIp=!0}}return t.trafficPolicy.addConnectionPool&&(r.spec.trafficPolicy||(r.spec.trafficPolicy={}),r.spec.trafficPolicy.connectionPool=t.trafficPolicy.connectionPool),t.trafficPolicy.addOutlierDetection&&(r.spec.trafficPolicy||(r.spec.trafficPolicy={}),r.spec.trafficPolicy.outlierDetection=t.trafficPolicy.outlierDetection),r.spec.trafficPolicy||(r.spec.trafficPolicy=null),l||(r.metadata.annotations=null),t.gateway&&t.gateway.addGateway?(s.spec.gateways=[],t.gateway.newGateway?s.spec.gateways.push(c):t.gateway.selectedGateway.length>0&&s.spec.gateways.push(t.gateway.selectedGateway),t.gateway.addMesh&&!s.spec.gateways.includes("mesh")&&s.spec.gateways.push("mesh"),0===s.spec.gateways.length&&(s.spec.gateways=null)):s.spec.gateways=null,[r,s,u,l]},im=function(e,t){var a=j.istioLabels.versionLabelName,n={};return e.forEach((function(e){return n[e.labels[a]]=e.name})),t.items.length>0&&t.items.forEach((function(e){var t;null===(t=e.spec.subsets)||void 0===t||t.forEach((function(e){var t=e.labels[a];n[e.name]=n[t]}))})),n},om=function(e){var t=e.length<100?Math.floor(100/e.length):0,a=e.length<100?100%e.length:0,n=e.map((function(e){return{name:e.name,weight:t,locked:!1,maxWeight:100,mirrored:!1}}));return a>0&&(n[n.length-1].weight=n[n.length-1].weight+a),n},sm=function(e,t,a){var n,r,i=im(e,a),o=[];if(1===t.items.length&&(t.items[0].spec.http&&1===t.items[0].spec.http.length&&(n=t.items[0].spec.http[0]),t.items[0].spec.tcp&&1===t.items[0].spec.tcp.length&&(n=t.items[0].spec.tcp[0]),n&&(null===(r=n.route)||void 0===r||r.forEach((function(e){e.destination.subset&&i[e.destination.subset]&&o.push({name:i[e.destination.subset],weight:e.weight||0,locked:!1,maxWeight:100,mirrored:!1})})),n.mirror))){var s=n;if(s.mirror&&s.mirror.subset&&i[s.mirror.subset]){var l=s.mirrorPercentage?s.mirrorPercentage.value:100;o.push({name:i[s.mirror.subset],weight:l,locked:!1,maxWeight:100,mirrored:!0})}}if(o.length>0&&e.length!==o.length)for(var c=0;c<e.length;c++){for(var u=e[c],p=!0,d=0;d<o.length;d++){var m=o[d];if(u.name===m.name){p=!1;break}}p&&o.push({name:u.name,weight:0,locked:!1,maxWeight:100,mirrored:!1})}return o},lm=function(e,t,a){var n=im(e,a),r=[];return 1===t.items.length&&t.items[0].spec.http.forEach((function(e){var t={matches:[],workloadWeights:[]};if(e.match&&e.match.forEach((function(e){return t.matches=t.matches.concat(function(e){var t=[];return e.headers&&Object.keys(e.headers).forEach((function(a){var n=e.headers[a];t.push("headers ["+a+"] "+nm(n))})),e.uri&&t.push("uri "+nm(e.uri)),e.scheme&&t.push("scheme "+nm(e.scheme)),e.method&&t.push("method "+nm(e.method)),e.authority&&t.push("authority "+nm(e.authority)),t}(e))})),e.route&&e.route.forEach((function(e){var a=e.destination.subset,r=n[a||""];r&&t.workloadWeights.push({name:r,weight:e.weight?e.weight:0,locked:!1,maxWeight:100,mirrored:!1})})),e.mirror){var a=e.mirror.subset,i=n[a||""];t.workloadWeights.push({name:i,weight:e.mirrorPercentage?e.mirrorPercentage.value:100,locked:!1,maxWeight:100,mirrored:!0})}e.fault&&(e.fault.delay&&(t.delay=e.fault.delay),e.fault.abort&&(t.abort=e.fault.abort)),e.timeout&&(t.timeout=e.timeout),e.retries&&(t.retries=e.retries),t.workloadWeights.length>0&&r.push(t)})),r},cm=function(e,t,a){var n=sm(e,t,a);e.length>0&&0===n.length&&(n=om(e));var r={workloads:n,delayed:!1,delay:{percentage:{value:100},fixedDelay:"5s"},isValidDelay:!0,aborted:!1,abort:{percentage:{value:100},httpStatus:503},isValidAbort:!0};if(1===t.items.length&&t.items[0].spec.http&&1===t.items[0].spec.http.length&&t.items[0].spec.http[0].fault){var i=t.items[0].spec.http[0].fault;i.delay&&(r.delayed=!0,r.delay.percentage.value=i.delay.percentage?i.delay.percentage.value:100,r.delay.fixedDelay=i.delay.fixedDelay),i.abort&&(r.aborted=!0,r.abort.percentage.value=i.abort.percentage?i.abort.percentage.value:100,r.abort.httpStatus=i.abort.httpStatus)}return r},um=function(e,t,a){var n=sm(e,t,a);e.length>0&&0===n.length&&(n=om(e));var r={workloads:n,isTimeout:!1,timeout:"2s",isValidTimeout:!0,isRetry:!1,retries:{attempts:3,perTryTimeout:"2s",retryOn:"gateway-error,connect-failure,refused-stream"},isValidRetry:!0};return 1===t.items.length&&t.items[0].spec.http&&1===t.items[0].spec.http.length&&(t.items[0].spec.http[0].timeout&&(r.isTimeout=!0,r.timeout=t.items[0].spec.http[0].timeout),t.items[0].spec.http[0].retries&&(r.isRetry=!0,r.retries.attempts=t.items[0].spec.http[0].retries.attempts,t.items[0].spec.http[0].retries.perTryTimeout&&(r.retries.perTryTimeout=t.items[0].spec.http[0].retries.perTryTimeout),t.items[0].spec.http[0].retries.retryOn)),r},pm=function(e){return!!(1===e.items.length&&e.items[0]&&e.items[0].spec.gateways&&e.items[0].spec.gateways.length>0)},dm=function(e){if(1===e.items.length&&e.items[0]&&e.items[0].spec.gateways&&e.items[0].spec.gateways.length>0){var t=e.items[0].spec.gateways[0];"mesh"===t&&(t="");var a=!1;return e.items[0].spec.gateways.includes("mesh")&&(a=!0),[t,a]}return["",!1]},mm=function(e,t,a){var n={metadata:{name:e,namespace:t,labels:Object(Ei.a)({},"kiali_wizard","AuthorizationPolicy")},spec:{}};if("DENY_ALL"===a.policy)return n.spec.action=void 0,n.spec.selector=void 0,n.spec.rules=void 0,n;if("ALLOW_ALL"===a.policy)return n.spec.action="ALLOW",n.spec.selector=void 0,n.spec.rules=[{}],n;if(a.workloadSelector.length>0){var r={matchLabels:{}};a.workloadSelector.split(",").forEach((function(e){var t=(e=e.trim()).split("=");2===t.length&&(r.matchLabels[t[0]]=t[1])})),n.spec.selector=r}return a.rules.length>0&&(n.spec.rules=[],a.rules.forEach((function(e){var t={from:void 0,to:void 0,when:void 0};e.from.length>0&&(t.from=e.from.map((function(e){var t={};return Object.keys(e).forEach((function(a){t[a]=e[a]})),{source:t}}))),e.to.length>0&&(t.to=e.to.map((function(e){var t={};return Object.keys(e).forEach((function(a){t[a]=e[a]})),{operation:t}}))),e.when.length>0&&(t.when=e.when.map((function(e){var t={key:e.key};return e.values&&e.values.length>0&&(t.values=e.values),e.notValues&&e.notValues.length>0&&(t.notValues=e.notValues),t}))),n.spec.rules.push(t)}))),a.action.length>0&&(n.spec.action=a.action),n},hm=function(e,t,a){var n={metadata:{name:e,namespace:t,labels:Object(Ei.a)({},"kiali_wizard","Gateway")},spec:{selector:{},servers:a.gatewayServers.map((function(e){return{port:e.port,hosts:e.hosts,tls:e.tls}}))}};return a.workloadSelectorLabels.trim().split(",").forEach((function(e){var t=e.trim().split("=");n.spec.selector&&2===t.length&&(n.spec.selector[t[0].trim()]=t[1].trim())})),n},fm=function(e,t,a){var n={metadata:{name:e,namespace:t,labels:Object(Ei.a)({},"kiali_wizard","PeerAuthentication")},spec:{}};if(a.workloadSelector.length>0){var r={matchLabels:{}};a.workloadSelector.split(",").forEach((function(e){var t=(e=e.trim()).split("=");2===t.length&&(r.matchLabels[t[0]]=t[1])})),n.spec.selector=r}return n.spec.mtls={mode:Oo[a.mtls]},a.portLevelMtls.length>0&&(n.spec.portLevelMtls={},a.portLevelMtls.forEach((function(e){n.spec.portLevelMtls&&(n.spec.portLevelMtls[Number(e.port)]={mode:Oo[e.mtls]})}))),n},gm=function(e,t,a){var n={metadata:{name:e,namespace:t,labels:Object(Ei.a)({},"kiali_wizard","RequestAuthentication")},spec:{jwtRules:[]}};if(a.workloadSelector.length>0){var r={matchLabels:{}};a.workloadSelector.split(",").forEach((function(e){var t=(e=e.trim()).split("=");2===t.length&&(r.matchLabels[t[0]]=t[1])})),n.spec.selector=r}return a.jwtRules.length>0&&(n.spec.jwtRules=a.jwtRules),n},vm=function(e,t,a){var n={metadata:{name:e,namespace:t,labels:Object(Ei.a)({},"kiali_wizard","Sidecar")},spec:{egress:[{hosts:a.egressHosts.map((function(e){return e.host}))}]}};return a.addWorkloadSelector&&a.workloadSelectorValid&&(n.spec.workloadSelector={labels:{}},a.workloadSelectorLabels.trim().split(",").forEach((function(e){var t=e.trim().split("=");n.spec.workloadSelector&&2===t.length&&(n.spec.workloadSelector.labels[t[0].trim()]=t[1].trim())}))),n},Em=function(e,t,a){var n={};a?(n[j.istioLabels.injectionLabelName]=null,n[j.istioLabels.injectionLabelRev]=a):(n[j.istioLabels.injectionLabelName]=t?null:e?"enabled":"disabled",n[j.istioLabels.injectionLabelRev]=null);var r={metadata:{labels:n}};return JSON.stringify(r)},bm=Object(Jn.a)({marginTop:15,color:nt.Red100}),ym=[{title:"Port Number",transforms:[Object(oo.a)(20)],props:{}},{title:"Mutual TLS Mode",transforms:[Object(oo.a)(20)],props:{}},{title:"",props:{}}],Cm=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).onChangeWorkloadSelector=function(){n.setState((function(e){return{addWorkloadSelector:!e.addWorkloadSelector}}),(function(){return n.onPeerAuthenticationChange()}))},n.onChangeAddPortMtls=function(){n.setState((function(e){return{addPortMtls:!e.addPortMtls}}),(function(){return n.onPeerAuthenticationChange()}))},n.addWorkloadLabels=function(e,t){if(0!==e.length){for(var a=(e=e.trim()).split(","),r=!0,i=0;i<a.length;i++){var o=a[i];if(o.indexOf("=")<0){r=!1;break}var s=o.split("=");if(2!==s.length){r=!1;break}if(0===s[0].trim().length||0===s[1].trim().length){r=!1;break}}n.setState({workloadSelectorValid:r,workloadSelector:e},(function(){return n.onPeerAuthenticationChange()}))}else n.setState({workloadSelectorValid:!1,workloadSelector:""},(function(){return n.onPeerAuthenticationChange()}))},n.onPeerAuthenticationChange=function(){n.props.onChange(n.state)},n.onMutualTlsChange=function(e,t){n.setState({mtls:e},(function(){return n.onPeerAuthenticationChange()}))},n.onAddPortNumber=function(e,t){n.setState((function(t){return{addNewPortMtls:{port:e.trim(),mtls:t.addNewPortMtls.mtls}}}),(function(){return n.onPeerAuthenticationChange()}))},n.onAddPortMtlsMode=function(e,t){n.setState((function(t){return{addNewPortMtls:{port:t.addNewPortMtls.port,mtls:e}}}),(function(){return n.onPeerAuthenticationChange()}))},n.onAddPortMtls=function(){n.setState((function(e){return e.portLevelMtls.push(e.addNewPortMtls),{portLevelMtls:e.portLevelMtls,addNewPortMtls:{port:"",mtls:Oo.UNSET}}}),(function(){return n.onPeerAuthenticationChange()}))},n.actionResolver=function(e,t){var a={title:"Remove Port MTLS",onClick:function(e,t,a,r){n.setState((function(e){return e.portLevelMtls.splice(t,1),{portLevelMtls:e.portLevelMtls}}),(function(){return n.onPeerAuthenticationChange()}))}};return t.rowIndex<n.props.peerAuthentication.portLevelMtls.length?[a]:[]},n.state={addWorkloadSelector:!1,workloadSelectorValid:!1,workloadSelector:n.props.peerAuthentication.workloadSelector,mtls:n.props.peerAuthentication.mtls,addPortMtls:!1,portLevelMtls:n.props.peerAuthentication.portLevelMtls,addNewPortMtls:{port:"",mtls:Oo.UNSET}},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.setState({addWorkloadSelector:this.props.peerAuthentication.addWorkloadSelector,workloadSelectorValid:this.props.peerAuthentication.workloadSelectorValid,workloadSelector:this.props.peerAuthentication.workloadSelector,mtls:this.props.peerAuthentication.mtls,addPortMtls:this.props.peerAuthentication.addPortMtls,portLevelMtls:this.props.peerAuthentication.portLevelMtls,addNewPortMtls:this.props.peerAuthentication.addNewPortMtls})}},{key:"rows",value:function(){return this.props.peerAuthentication.portLevelMtls.map((function(e,t){return{key:"portMtls"+t,cells:[r.createElement(r.Fragment,null,e.port),r.createElement(r.Fragment,null,e.mtls),""]}})).concat([{key:"pmtlsNew",cells:[r.createElement(r.Fragment,null,r.createElement(Rp.TextInputBase,{value:this.state.addNewPortMtls.port,id:"addPortNumber","aria-describedby":"add port number",name:"addPortNumber",onChange:this.onAddPortNumber,isValid:this.state.addNewPortMtls.port.length>0&&!isNaN(Number(this.state.addNewPortMtls.port))})),r.createElement(r.Fragment,null,r.createElement(ur.a,{value:this.state.addNewPortMtls.mtls,id:"addPortMtlsMode",name:"addPortMtlsMode",onChange:this.onAddPortMtlsMode},Object.keys(Oo).map((function(e,t){return r.createElement(pr.a,{key:"p"+t,value:e,label:e})})))),r.createElement(r.Fragment,null,r.createElement(vr.a,{id:"addServerBtn",variant:"link",icon:r.createElement(xp.a,null),isDisabled:0===this.state.addNewPortMtls.port.length||isNaN(Number(this.state.addNewPortMtls.port)),onClick:this.onAddPortMtls}))]}])}},{key:"render",value:function(){return r.createElement(r.Fragment,null,r.createElement(mp.a,{label:"Workload Selector",fieldId:"workloadSelectorSwitch"},r.createElement(fp.a,{id:"workloadSelectorSwitch",label:" ",labelOff:" ",isChecked:this.state.addWorkloadSelector,onChange:this.onChangeWorkloadSelector})),this.state.addWorkloadSelector&&r.createElement(mp.a,{fieldId:"workloadLabels",label:"Labels",helperText:"One or more labels to select a workload where the PeerAuthentication is applied.",helperTextInvalid:"Enter a label in the format <label>=<value>. Enter one or multiple labels separated by comma.",isValid:this.state.workloadSelectorValid},r.createElement(Rp.TextInputBase,{id:"gwHosts",name:"gwHosts",isDisabled:!this.state.addWorkloadSelector,value:this.state.workloadSelector,onChange:this.addWorkloadLabels,isValid:this.state.workloadSelectorValid})),r.createElement(mp.a,{label:"Mutual TLS Mode",fieldId:"mutualTls"},r.createElement(ur.a,{value:this.state.mtls,onChange:this.onMutualTlsChange,id:"mutualTls",name:"rules-form"},Object.keys(Oo).map((function(e,t){return r.createElement(pr.a,{key:t,value:e,label:e})})))),r.createElement(mp.a,{label:"Port Mutual TLS",fieldId:"addPortMtls"},r.createElement(fp.a,{id:"addPortMtls",label:" ",labelOff:" ",isChecked:this.state.addPortMtls,onChange:this.onChangeAddPortMtls})),this.state.addPortMtls&&r.createElement(mp.a,{label:"Port Level MTLS",fieldId:"portMtlsList"},r.createElement(Eu.b,{"aria-label":"Port Level MTLS",cells:ym,rows:this.rows(),actionResolver:this.actionResolver},r.createElement(bu.a,null),r.createElement(kp.a,null)),0===this.props.peerAuthentication.portLevelMtls.length&&r.createElement("div",{className:bm},"PeerAuthentication has no Port Mutual TLS defined"),!this.state.addWorkloadSelector&&r.createElement("div",{className:bm},"Port Mutual TLS requires a Workload Selector")))}}]),a}(r.Component),Sm=["issuer","audiences","jwksUri","jwks","fromHeaders","fromParams","outputPayloadToHeader","forwardOriginalToken"].sort(),Am=[{title:"JWT Rule Field",transforms:[Object(oo.a)(30)],props:{}},{title:"Values",transforms:[Object(oo.a)(70)],props:{}},{title:"",props:{}}],Tm=Object(Jn.a)({color:nt.Red100}),Om=Object(Jn.a)({marginLeft:25,color:nt.Red100,textAlign:"center"}),Im=function(e,t){switch(e){case"issuer":return t.issuer?t.issuer:"";case"audiences":return t.audiences?t.audiences.join(","):"";case"jwks":return t.jwks?t.jwks:"";case"jwksUri":return t.jwksUri?t.jwksUri:"";case"fromHeaders":return t.fromHeaders?t.fromHeaders.map((function(e){return e.prefix?e.name+": "+e.prefix:e.name})).join(","):"";case"fromParams":return t.fromParams?t.fromParams.join(","):"";case"outputPayloadToHeader":return t.outputPayloadToHeader?t.outputPayloadToHeader:"";case"forwardOriginalToken":return t.forwardOriginalToken?""+t.forwardOriginalToken:"false"}return""},wm=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).onAddJwtField=function(e,t){n.setState({newJwtField:e})},n.onAddNewValues=function(e,t){n.setState({newValues:e})},n.onUpdateJwtRule=function(){n.setState((function(e){var t=e.jwtRuleFields.indexOf(e.newJwtField);switch(t>-1&&e.jwtRuleFields.splice(t,1),e.newJwtField){case"issuer":e.jwtRule.issuer=e.newValues;break;case"audiences":e.jwtRule.audiences=e.newValues.split(",");break;case"jwks":e.jwtRule.jwks=e.newValues;break;case"jwksUri":e.jwtRule.jwksUri=e.newValues;break;case"fromHeaders":e.jwtRule.fromHeaders=[],e.newValues.split(",").forEach((function(t){var a=t.split(":"),n={name:a[0]};a.length>1&&(n.prefix=a[1].trimLeft()),e.jwtRule.fromHeaders&&e.jwtRule.fromHeaders.push(n)}));break;case"fromParams":e.jwtRule.fromParams=e.newValues.split(",");break;case"outputPayloadToHeader":e.jwtRule.outputPayloadToHeader=e.newValues;break;case"forwardOriginalToken":e.jwtRule.forwardOriginalToken="true"===e.newValues.toLowerCase()}return{jwtRuleFields:e.jwtRuleFields,jwtRule:e.jwtRule,newJwtField:e.jwtRuleFields[0],newValues:""}}))},n.onAddJwtRuleToList=function(){var e=n.state.jwtRule;n.setState({jwtRuleFields:Object.assign([],Sm),jwtRule:{},newJwtField:Sm[0],newValues:""},(function(){return n.props.onAddJwtRule(e)}))},n.actionResolver=function(e,t){var a={title:"Remove Field",onClick:function(e,t,a,r){var i=a.cells[0].props.children.toString();n.setState((function(e){e.jwtRuleFields.push(i),delete e.jwtRule[i];var t=e.jwtRuleFields.sort();return{jwtRuleFields:t,jwtRule:e.jwtRule,newJwtField:t[0],newValues:""}}))}};return t.rowIndex<Object.keys(n.state.jwtRule).length?[a]:[]},n.isJwtFieldValid=function(){return n.state.newValues.split(",").every((function(e){return 0===e.length}))?[!1,"Value cannot be empty"]:"jwksUri"!==n.state.newJwtField||function(e){try{new URL(e)}catch(t){return!1}return!0}(n.state.newValues)?[!0,""]:[!1,"jwsUri is not a valid Uri"]},n.isJwtRuleValid=function(){return!!n.state.jwtRule.issuer&&n.state.jwtRule.issuer.length>0},n.rows=function(){var e=Object.keys(n.state.jwtRule).map((function(e,t){return{key:"jwtField"+t,cells:[r.createElement(r.Fragment,null,e),r.createElement(r.Fragment,null,Im(e,n.state.jwtRule)),r.createElement(r.Fragment,null)]}}));if(n.state.jwtRuleFields.length>0){var t=n.isJwtFieldValid(),a=Object(T.a)(t,2),i=a[0],o=a[1];return e.concat([{key:"jwtFieldKeyNew",cells:[r.createElement(r.Fragment,null,r.createElement(ur.a,{value:n.state.newJwtField,id:"addNewJwtField",name:"addNewJwtField",onChange:n.onAddJwtField},n.state.jwtRuleFields.map((function(e,t){return r.createElement(pr.a,{isDisabled:!1,key:"jwt"+t,value:e,label:e})})))),r.createElement(r.Fragment,null,r.createElement(Rp.TextInputBase,{value:n.state.newValues,type:"text",id:"addNewValues",key:"addNewValues","aria-describedby":"add new source values",name:"addNewValues",onChange:n.onAddNewValues}),"fromHeaders"===n.state.newJwtField&&r.createElement("div",{key:"fromHeadersHelperText"},"List of header locations from which JWT is expected. ",r.createElement("br",null),'I.e. "x-jwt-assertion: Bearer ,Authorization: Bearer "'),!i&&r.createElement("div",{key:"hostsHelperText",className:Tm},o)),r.createElement(r.Fragment,null,n.state.jwtRuleFields.length>0&&r.createElement(vr.a,{variant:"link",icon:r.createElement(xp.a,null),onClick:n.onUpdateJwtRule,isDisabled:!i}))]}])}return e},n.state={jwtRuleFields:Object.assign([],Sm),jwtRule:{},newJwtField:"issuer",newValues:""},n}return Object(l.a)(a,[{key:"render",value:function(){return r.createElement(r.Fragment,null,r.createElement(Eu.b,{"aria-label":"JWT Rule Builder",cells:Am,rows:this.rows(),actionResolver:this.actionResolver},r.createElement(bu.a,null),r.createElement(kp.a,null)),r.createElement(vr.a,{variant:"link",icon:r.createElement(xp.a,null),isDisabled:!this.isJwtRuleValid(),onClick:this.onAddJwtRuleToList},"Add JWT Rule",!this.isJwtRuleValid()&&r.createElement("span",{className:Om},'A JWT Rule needs an "issuer"')))}}]),a}(r.Component),Rm=[{title:"JWT Rules to be validated",transforms:[Object(oo.a)(100)],props:{}},{title:"",props:{}}],km=Object(Jn.a)({marginTop:10,color:nt.Red100,textAlign:"center",width:"100%"}),xm=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).rows=function(){return e.props.jwtRules.map((function(e,t){return{key:"jwtRule"+t,cells:[r.createElement(r.Fragment,null,e.issuer?r.createElement("div",null,r.createElement("b",null,"issuer"),": [",Im("issuer",e),"]"):void 0,e.audiences?r.createElement("div",null,r.createElement("b",null,"audiences"),": [",Im("audiences",e),"]"):void 0,e.jwks?r.createElement("div",null,r.createElement("b",null,"jwks"),": [",Im("jwks",e),"]"):void 0,e.jwksUri?r.createElement("div",null,r.createElement("b",null,"jwksUri"),": [",Im("jwksUri",e),"]"):void 0,e.fromHeaders?r.createElement("div",null,r.createElement("b",null,"fromHeaders"),": [",Im("fromHeaders",e),"]"):void 0,e.fromParams?r.createElement("div",null,r.createElement("b",null,"fromParams"),": [",Im("fromParams",e),"]"):void 0,e.outputPayloadToHeader?r.createElement("div",null,r.createElement("b",null,"outputPayloadToHeader"),": [",Im("outputPayloadToHeader",e),"]"):void 0,void 0!==e.forwardOriginalToken?r.createElement("div",null,r.createElement("b",null,"forwardOriginalToken"),": [",Im("forwardOriginalToken",e),"]"):void 0),r.createElement(r.Fragment,null)]}}))},e.actionResolver=function(t,a){a.rowIndex;return[{title:"Remove JWT Rule",onClick:function(t,a,n,r){e.props.onRemoveJwtRule(a)}}]},e}return Object(l.a)(a,[{key:"render",value:function(){return r.createElement(r.Fragment,null,r.createElement(Eu.b,{"aria-label":"JWT Rules List",cells:Rm,rows:this.rows(),actionResolver:this.actionResolver},r.createElement(bu.a,null),r.createElement(kp.a,null)),0===this.props.jwtRules.length&&r.createElement("div",{className:km},"No JWT Rules Defined"))}}]),a}(r.Component),Nm=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).onRequestAuthenticationChange=function(){n.props.onChange(n.state)},n.onChangeWorkloadSelector=function(){n.setState((function(e){return{addWorkloadSelector:!e.addWorkloadSelector}}),(function(){return n.onRequestAuthenticationChange()}))},n.onChangeJwtRules=function(){n.setState((function(e){return{addJWTRules:!e.addJWTRules}}),(function(){return n.onRequestAuthenticationChange()}))},n.addWorkloadLabels=function(e,t){if(0!==e.length){for(var a=(e=e.trim()).split(","),r=!0,i=0;i<a.length;i++){var o=a[i];if(o.indexOf("=")<0){r=!1;break}var s=o.split("=");if(2!==s.length){r=!1;break}if(0===s[0].trim().length||0===s[1].trim().length){r=!1;break}}n.setState({workloadSelectorValid:r,workloadSelector:e},(function(){return n.onRequestAuthenticationChange()}))}else n.setState({workloadSelectorValid:!1,workloadSelector:""},(function(){return n.onRequestAuthenticationChange()}))},n.onAddJwtRule=function(e){n.setState((function(t){return t.jwtRules.push(e),{jwtRules:t.jwtRules}}),(function(){return n.onRequestAuthenticationChange()}))},n.onRemoveJwtRule=function(e){n.setState((function(t){return t.jwtRules.splice(e,1),{jwtRules:t.jwtRules}}),(function(){return n.onRequestAuthenticationChange()}))},n.state={workloadSelector:"",jwtRules:[],addWorkloadSelector:!1,workloadSelectorValid:!1,addJWTRules:!1},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.setState({workloadSelector:this.props.requestAuthentication.workloadSelector,jwtRules:this.props.requestAuthentication.jwtRules,addWorkloadSelector:this.props.requestAuthentication.addWorkloadSelector,workloadSelectorValid:this.props.requestAuthentication.workloadSelectorValid,addJWTRules:this.props.requestAuthentication.addJWTRules})}},{key:"render",value:function(){return r.createElement(r.Fragment,null,r.createElement(mp.a,{label:"Workload Selector",fieldId:"workloadSelectorSwitch"},r.createElement(fp.a,{id:"workloadSelectorSwitch",label:" ",labelOff:" ",isChecked:this.state.addWorkloadSelector,onChange:this.onChangeWorkloadSelector})),this.state.addWorkloadSelector&&r.createElement(mp.a,{fieldId:"workloadLabels",label:"Labels",helperText:"One or more labels to select a workload where the RequestAuthentication is applied.",helperTextInvalid:"Enter a label in the format <label>=<value>. Enter one or multiple labels separated by comma.",isValid:this.state.workloadSelectorValid},r.createElement(Rp.TextInputBase,{id:"gwHosts",name:"gwHosts",isDisabled:!this.state.addWorkloadSelector,value:this.state.workloadSelector,onChange:this.addWorkloadLabels,isValid:this.state.workloadSelectorValid})),r.createElement(mp.a,{label:"JWT Rules",fieldId:"addJWTRules"},r.createElement(fp.a,{id:"addJWTRules",label:" ",labelOff:" ",isChecked:this.state.addJWTRules,onChange:this.onChangeJwtRules})),this.state.addJWTRules&&r.createElement(r.Fragment,null,r.createElement(mp.a,{label:"JWT Rule Builder",fieldId:"jwtRulesBuilder"},r.createElement(wm,{onAddJwtRule:this.onAddJwtRule})),r.createElement(mp.a,{label:"JWT Rules List",fieldId:"jwtRulesList"},r.createElement(xm,{jwtRules:this.state.jwtRules,onRemoveJwtRule:this.onRemoveJwtRule}))))}}]),a}(r.Component),jm=["MESH_EXTERNAL","MESH_INTERNAL"],Pm=["NONE","STATIC","DNS"],Lm=["HTTP","HTTPS","GRPC","HTTP2","MONGO","TCP","TLS"],Dm=[{title:"Port Number",transforms:[Object(oo.a)(20)],props:{}},{title:"Port Name",transforms:[Object(oo.a)(20)],props:{}},{title:"Protocol",transforms:[Object(oo.a)(20)],props:{}},{title:"Target Port",transforms:[Object(oo.a)(20)],props:{}},{title:"",props:{}}],Fm=Object(Jn.a)({marginTop:15,color:nt.Red100}),_m=function(){return{serviceEntry:{location:jm[0],resolution:Pm[0]},validHosts:!1,addNewPortNumber:"80",addNewPortName:"",addNewPortProtocol:Lm[0],addNewTargetPort:""}},Mm=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).actionResolver=function(e,t){var a=t.rowIndex,r={title:"Remove Port",onClick:function(e,t,a,r){n.setState((function(e){var a;return null===(a=e.serviceEntry.ports)||void 0===a||a.splice(t,1),{serviceEntry:e.serviceEntry}}),(function(){return n.props.onChange(n.state)}))}};return n.state.serviceEntry.ports&&a<n.state.serviceEntry.ports.length?[r]:[]},n.areValidHosts=function(e){if(0===e.length)return!1;for(var t=!0,a=0;a<e.length;a++)if(!Cp(e[a])){t=!1;break}return t},n.isValidPort=function(){var e=n.state.addNewPortNumber.length>0&&!isNaN(Number(n.state.addNewPortNumber)),t=n.state.addNewPortName.length>0,a=0===n.state.addNewTargetPort.length||n.state.addNewTargetPort.length>0&&!isNaN(Number(n.state.addNewTargetPort));return e&&t&&a},n.onAddHosts=function(e,t){var a=0===e.trim().length?[]:e.split(",").map((function(e){return e.trim()}));n.setState((function(e){return e.serviceEntry.hosts=a,{serviceEntry:e.serviceEntry,validHosts:n.areValidHosts(a)}}),(function(){return n.props.onChange(n.state)}))},n.onAddLocation=function(e,t){n.setState((function(t){return t.serviceEntry.location=e,{serviceEntry:t.serviceEntry}}),(function(){return n.props.onChange(n.state)}))},n.onAddResolution=function(e,t){n.setState((function(t){return t.serviceEntry.resolution=e,{serviceEntry:t.serviceEntry}}),(function(){return n.props.onChange(n.state)}))},n.onAddPortNumber=function(e,t){n.setState({addNewPortNumber:e})},n.onAddPortName=function(e,t){n.setState({addNewPortName:e})},n.onAddPortProtocol=function(e,t){n.setState({addNewPortProtocol:e})},n.onAddTargetPort=function(e,t){n.setState({addNewTargetPort:e})},n.onAddNewPort=function(){n.setState((function(e){var t={number:+n.state.addNewPortNumber,name:n.state.addNewPortName,protocol:n.state.addNewPortProtocol};return n.state.addNewTargetPort.length>0&&(t.targetPort=+n.state.addNewTargetPort),e.serviceEntry.ports||(e.serviceEntry.ports=[]),e.serviceEntry.ports.push(t),{serviceEntry:e.serviceEntry,addNewPortNumber:"80",addNewPortName:"",addNewPortProtocol:Lm[0],addNewTargetPort:""}}),(function(){return n.props.onChange(n.state)}))},n.state=_m(),n}return Object(l.a)(a,[{key:"rows",value:function(){return(this.state.serviceEntry.ports||[]).map((function(e,t){return{key:"port_"+t,cells:[r.createElement(r.Fragment,null,e.number),r.createElement(r.Fragment,null,e.name),r.createElement(r.Fragment,null,e.protocol),r.createElement(r.Fragment,null,e.targetPort),""]}})).concat([{key:"portNew",cells:[r.createElement(r.Fragment,null,r.createElement(Rp.TextInputBase,{value:this.state.addNewPortNumber,id:"addPortNumber","aria-describedby":"add port number",name:"addPortNumber",onChange:this.onAddPortNumber,isValid:this.state.addNewPortNumber.length>0&&!isNaN(Number(this.state.addNewPortNumber))})),r.createElement(r.Fragment,null,r.createElement(Rp.TextInputBase,{value:this.state.addNewPortName,id:"addPortName","aria-describedby":"add port name",name:"addPortName",onChange:this.onAddPortName,isValid:this.state.addNewPortName.length>0})),r.createElement(r.Fragment,null,r.createElement(ur.a,{value:this.state.addNewPortProtocol,id:"addPortProtocol",name:"addPortProtocol",onChange:this.onAddPortProtocol},Lm.map((function(e,t){return r.createElement(pr.a,{key:"p"+t,value:e,label:e})})))),r.createElement(r.Fragment,null,r.createElement(Rp.TextInputBase,{value:this.state.addNewTargetPort,id:"addTargetPort","aria-describedby":"add target port",name:"addTargetPort",onChange:this.onAddTargetPort,isValid:0===this.state.addNewTargetPort.length||this.state.addNewTargetPort.length>0&&!isNaN(Number(this.state.addNewTargetPort))})),r.createElement(r.Fragment,null,r.createElement(vr.a,{id:"addServerBtn",variant:"link",icon:r.createElement(xp.a,null),isDisabled:!this.isValidPort(),onClick:this.onAddNewPort}))]}])}},{key:"render",value:function(){var e;return r.createElement(r.Fragment,null,r.createElement(mp.a,{label:"Hosts",isRequired:!0,fieldId:"hosts",helperText:"The hosts associated with the ServiceEntry.",helperTextInvalid:"Invalid hosts for this ServiceEntry. Enter one or hosts separated by comma.",isValid:this.state.validHosts},r.createElement(Rp.TextInputBase,{value:null===(e=this.state.serviceEntry.hosts)||void 0===e?void 0:e.join(","),isRequired:!0,type:"text",id:"hosts","aria-describedby":"hosts",name:"hosts",onChange:this.onAddHosts,isValid:this.state.validHosts})),r.createElement(mp.a,{label:"Location",isRequired:!0,fieldId:"location"},r.createElement(ur.a,{value:this.state.serviceEntry.location,id:"location",name:"location",onChange:this.onAddLocation},jm.map((function(e,t){return r.createElement(pr.a,{isDisabled:!1,key:"p"+t,value:e,label:e})})))),r.createElement(mp.a,{label:"Ports",fieldId:"ports"},r.createElement(Eu.b,{"aria-label":"Ports",cells:Dm,rows:this.rows(),actionResolver:this.actionResolver},r.createElement(bu.a,null),r.createElement(kp.a,null)),(!this.state.serviceEntry.ports||0===this.state.serviceEntry.ports.length)&&r.createElement("div",{className:Fm},"ServiceEntry has no Ports defined")),r.createElement(mp.a,{label:"Resolution",isRequired:!0,fieldId:"resolution"},r.createElement(ur.a,{value:this.state.serviceEntry.resolution,id:"resolution",name:"resolution",onChange:this.onAddResolution},Pm.map((function(e,t){return r.createElement(pr.a,{isDisabled:!1,key:"p"+t,value:e,label:e})})))))}}]),a}(r.Component),Hm=Object(Jn.a)({padding:"30px 20px 30px 20px"}),Gm=Object(Jn.a)({marginLeft:15,paddingTop:5,color:nt.Red100,textAlign:"center"}),Vm={AuthorizationPolicy:"authorizationpolicies",Gateway:"gateways",PeerAuthentication:"peerauthentications",RequestAuthentication:"requestauthentications",ServiceEntry:"serviceentries",Sidecar:"sidecars"},Um=[{value:"AuthorizationPolicy",label:"AuthorizationPolicy",disabled:!1},{value:"Gateway",label:"Gateway",disabled:!1},{value:"PeerAuthentication",label:"PeerAuthentication",disabled:!1},{value:"RequestAuthentication",label:"RequestAuthentication",disabled:!1},{value:"ServiceEntry",label:"ServiceEntry",disabled:!1},{value:"Sidecar",label:"Sidecar",disabled:!1}],Bm=function(){return{name:"",istioPermissions:{},authorizationPolicy:{policy:"DENY_ALL",workloadSelector:"",action:"ALLOW",rules:[],addWorkloadSelector:!1,workloadSelectorValid:!1},gateway:{addWorkloadSelector:!1,workloadSelectorLabels:"istio=ingressgateway",workloadSelectorValid:!0,gatewayServers:[],addGatewayServer:{hosts:[],port:{number:80,name:"http",protocol:"HTTP"}},validHosts:!1},peerAuthentication:{workloadSelector:"",mtls:Oo.UNSET,portLevelMtls:[],addWorkloadSelector:!1,workloadSelectorValid:!1,addPortMtls:!1,addNewPortMtls:{port:"",mtls:Oo.UNSET}},requestAuthentication:{workloadSelector:"",jwtRules:[],addWorkloadSelector:!1,workloadSelectorValid:!1,addJWTRules:!1},serviceEntry:_m(),sidecar:Bp(j.istioNamespace+"/*")}},Wm=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).promises=new yr,n.canCreate=function(e){return n.state.istioPermissions[e]&&n.props.match.params.objectType.length>0&&n.state.istioPermissions[e][Vm[n.props.match.params.objectType]].create},n.fetchPermissions=function(){n.props.activeNamespaces.length>0&&n.promises.register("permissions",kn(n.props.activeNamespaces.map((function(e){return e.name})))).then((function(e){n.setState({istioPermissions:e.data},(function(){n.props.activeNamespaces.forEach((function(e){n.canCreate(e.name)||Vn("User has not permissions to create Istio Config on namespace: "+e.name)}))}))})).catch((function(e){e.isCanceled||_n("Could not fetch Permissions.",e)}))},n.onNameChange=function(e,t){n.setState({name:e})},n.onIstioResourceCreate=function(){var e=[];n.props.activeNamespaces.forEach((function(t){switch(n.props.match.params.objectType){case"AuthorizationPolicy":e.push({namespace:t.name,json:JSON.stringify(mm(n.state.name,t.name,n.state.authorizationPolicy))});break;case"Gateway":e.push({namespace:t.name,json:JSON.stringify(hm(n.state.name,t.name,n.state.gateway))});break;case"PeerAuthentication":e.push({namespace:t.name,json:JSON.stringify(fm(n.state.name,t.name,n.state.peerAuthentication))});break;case"RequestAuthentication":e.push({namespace:t.name,json:JSON.stringify(gm(n.state.name,t.name,n.state.requestAuthentication))});break;case"ServiceEntry":e.push({namespace:t.name,json:JSON.stringify((a=n.state.name,r=t.name,i=n.state.serviceEntry,{metadata:{name:a,namespace:r,labels:Object(Ei.a)({},"kiali_wizard","ServiceEntry")},spec:i.serviceEntry}))});break;case"Sidecar":e.push({namespace:t.name,json:JSON.stringify(vm(n.state.name,t.name,n.state.sidecar))})}var a,r,i})),n.promises.registerAll("Create "+Vm[n.props.match.params.objectType],e.map((function(e){return pn(e.namespace,Vm[n.props.match.params.objectType],e.json)}))).then((function(e){e.length>0&&Dn("Istio "+n.props.match.params.objectType+" created","default",Te.SUCCESS),n.backToList()})).catch((function(e){_n("Could not create Istio "+n.props.match.params.objectType+" objects.",e)}))},n.backToList=function(){n.setState(Bm(),(function(){U.push("/".concat(ce.ISTIO,"?namespaces=").concat(n.props.activeNamespaces.map((function(e){return e.name})).join(",")))}))},n.isIstioFormValid=function(){switch(n.props.match.params.objectType){case"AuthorizationPolicy":return function(e){var t=!e.addWorkloadSelector||e.workloadSelectorValid,a="DENY"!==e.action||e.rules.length>0;return t&&a}(n.state.authorizationPolicy);case"Gateway":return(a=n.state.gateway).workloadSelectorValid&&a.gatewayServers.length>0;case"PeerAuthentication":return function(e){var t=!e.addWorkloadSelector||e.workloadSelectorValid,a=!e.addPortMtls||e.workloadSelectorValid&&e.portLevelMtls.length>0;return t&&a}(n.state.peerAuthentication);case"RequestAuthentication":return function(e){var t=!e.addWorkloadSelector||e.workloadSelectorValid,a=!e.addJWTRules||e.jwtRules.length>0;return t&&a}(n.state.requestAuthentication);case"ServiceEntry":return(t=n.state.serviceEntry).validHosts&&void 0!==t.serviceEntry.ports&&t.serviceEntry.ports.length>0;case"Sidecar":return(e=n.state.sidecar).egressHosts.length>0&&(!e.addWorkloadSelector||e.addWorkloadSelector&&e.workloadSelectorValid);default:return!1}var e,t,a},n.onChangeAuthorizationPolicy=function(e){n.setState((function(t){return Object.keys(t.authorizationPolicy).forEach((function(a){return t.authorizationPolicy[a]=e[a]})),{authorizationPolicy:t.authorizationPolicy}}))},n.onChangeGateway=function(e){n.setState((function(t){return Object.keys(t.gateway).forEach((function(a){return t.gateway[a]=e[a]})),{gateway:t.gateway}}))},n.onChangePeerAuthentication=function(e){n.setState((function(t){return Object.keys(t.peerAuthentication).forEach((function(a){return t.peerAuthentication[a]=e[a]})),{peerAuthentication:t.peerAuthentication}}))},n.onChangeRequestAuthentication=function(e){n.setState((function(t){return Object.keys(t.requestAuthentication).forEach((function(a){return t.requestAuthentication[a]=e[a]})),{requestAuthentication:t.requestAuthentication}}))},n.onChangeServiceEntry=function(e){n.setState((function(t){return Object.keys(t.serviceEntry).forEach((function(a){return t.serviceEntry[a]=e[a]})),{serviceEntry:t.serviceEntry}}))},n.onChangeSidecar=function(e){n.setState((function(t){return Object.keys(t.sidecar).forEach((function(a){return t.sidecar[a]=e[a]})),{sidecar:t.sidecar}}))},n.state=Bm(),n}return Object(l.a)(a,[{key:"componentWillUnmount",value:function(){this.promises.cancelAll()}},{key:"componentDidMount",value:function(){this.setState(Object.assign({},Bm)),this.fetchPermissions()}},{key:"componentDidUpdate",value:function(e,t){e.activeNamespaces!==this.props.activeNamespaces&&this.fetchPermissions()}},{key:"render",value:function(){var e,t=this,a=this.props.activeNamespaces.every((function(e){return t.canCreate(e.name)})),n=""!==(e=this.state.name)&&0===e.search(Nd),i=this.props.activeNamespaces.length>0,o=a&&n&&i&&this.isIstioFormValid();return r.createElement(r.Fragment,null,r.createElement("div",{style:{backgroundColor:"#fff"}},r.createElement($u,null)),r.createElement(tr,null,r.createElement(dp.a,{className:Hm,isHorizontal:!0},r.createElement(mp.a,{label:"Name",isRequired:!0,fieldId:"name",helperTextInvalid:"A valid "+this.props.match.params.objectType+" name is required",isValid:n},r.createElement(Ae.a,{value:this.state.name,isRequired:!0,type:"text",id:"name","aria-describedby":"name",name:"name",onChange:this.onNameChange,isValid:n})),"AuthorizationPolicy"===this.props.match.params.objectType&&r.createElement($d,{authorizationPolicy:this.state.authorizationPolicy,onChange:this.onChangeAuthorizationPolicy}),"Gateway"===this.props.match.params.objectType&&r.createElement(Gp,{gateway:this.state.gateway,onChange:this.onChangeGateway}),"PeerAuthentication"===this.props.match.params.objectType&&r.createElement(Cm,{peerAuthentication:this.state.peerAuthentication,onChange:this.onChangePeerAuthentication}),"RequestAuthentication"===this.props.match.params.objectType&&r.createElement(Nm,{requestAuthentication:this.state.requestAuthentication,onChange:this.onChangeRequestAuthentication}),"ServiceEntry"===this.props.match.params.objectType&&r.createElement(Mm,{serviceEntry:this.state.serviceEntry,onChange:this.onChangeServiceEntry}),"Sidecar"===this.props.match.params.objectType&&r.createElement(Wp,{sidecar:this.state.sidecar,onChange:this.onChangeSidecar}),r.createElement(hp.a,null,r.createElement(vr.a,{variant:"primary",isDisabled:!o,onClick:function(){return t.onIstioResourceCreate()}},"Create"),r.createElement(vr.a,{variant:"secondary",onClick:function(){return t.backToList()}},"Cancel"),!i&&r.createElement("span",{className:Gm},"An Istio Config resource needs at least a namespace selected")))))}}]),a}(r.Component),qm=Object(h.b)((function(e){return{activeNamespaces:hl(e)}}),null)(Wm),Km=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).onSelect=function(e){n.setState({dropdownOpen:!n.state.dropdownOpen})},n.onToggle=function(e){n.setState({dropdownOpen:e})},n.onClickCreate=function(e){U.push("/istio/new/"+e)},n.state={dropdownOpen:!1},n}return Object(l.a)(a,[{key:"render",value:function(){var e=this,t=[r.createElement(cp.a,{key:"group_create",label:"Create",className:"kiali-group-menu",children:Um.map((function(t){return r.createElement(up.a,{key:"createIstioConfig_"+t.value,onClick:function(){return e.onClickCreate(t.value)}},t.label)}))})];return r.createElement(Ru.a,{id:"actions",title:"Actions",toggle:r.createElement(ku.a,{onToggle:this.onToggle},"Actions"),onSelect:this.onSelect,position:pp.d.right,isOpen:this.state.dropdownOpen,dropdownItems:t})}}]),a}(r.Component),zm=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;Object(s.a)(this,a),(n=t.call(this,e)).promises=new yr;var r=Yn(Jc),i=Kn();return n.state={listItems:[],currentSortField:r,isSortAscending:i},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.updateListItems()}},{key:"componentDidUpdate",value:function(e,t,a){var n=Yn(Jc),r=Kn();yi(this.props.activeNamespaces,e.activeNamespaces)&&this.state.currentSortField===n&&this.state.isSortAscending===r||(this.setState({currentSortField:n,isSortAscending:r}),this.updateListItems())}},{key:"componentWillUnmount",value:function(){this.promises.cancelAll()}},{key:"sortItemList",value:function(e,t,a){return au(e,t,a)}},{key:"updateListItems",value:function(){this.promises.cancelAll();var e=xi.getSelected(),t=this.props.activeNamespaces.map((function(e){return e.name})),a=Oi($c,e).map((function(e){return Di[e]})),n=Oi(Zc,e),r=Oi(eu,e);0!==t.length?this.fetchConfigs(t,a,n,r):this.setState({listItems:[]})}},{key:"fetchConfigs",value:function(e,t,a,n){var r=this,i=this.fetchIstioConfigs(e,t,a);i.then((function(e){return e.map((function(e){return e.validation})).filter((function(e){return void 0!==e}))})).then((function(e){return lp(e)})),i.then((function(e){return au(e,r.state.currentSortField,r.state.isSortAscending)})).then((function(e){return function(e,t){if(t&&0===t.length)return e;var a=[],n=t.indexOf("Valid")>-1,r=t.indexOf("Not Valid")>-1,i=t.indexOf("Not Validated")>-1,o=t.indexOf("Warning")>-1;return n&&r&&i&&o?e:(e.forEach((function(e){n&&e.validation&&e.validation.valid&&a.push(e),r&&e.validation&&!e.validation.valid&&a.push(e),i&&!e.validation&&a.push(e),o&&e.validation&&e.validation.checks.filter((function(e){return"warning"===e.severity})).length>0&&a.push(e)})),a)}(e,n)})).then((function(e){r.setState({listItems:e})})).catch((function(e){console.log(e),e.isCanceled||r.handleAxiosError("Could not fetch Istio objects list",e)}))}},{key:"fetchIstioConfigs",value:function(e,t,a){return this.promises.registerAll("configs",e.map((function(e){return ln(e,t,!0,"","")}))).then((function(e){var t=[];return e.forEach((function(e){var n,r;t=t.concat(_i((n=e.data,(r=a)&&0===r.length?n:{namespace:n.namespace,gateways:n.gateways.filter((function(e){return Fi(e.metadata.name,r)})),virtualServices:{permissions:n.virtualServices.permissions,items:n.virtualServices.items.filter((function(e){return Fi(e.metadata.name,r)}))},destinationRules:{permissions:n.destinationRules.permissions,items:n.destinationRules.items.filter((function(e){return Fi(e.metadata.name,r)}))},serviceEntries:n.serviceEntries.filter((function(e){return Fi(e.metadata.name,r)})),authorizationPolicies:n.authorizationPolicies.filter((function(e){return Fi(e.metadata.name,r)})),sidecars:n.sidecars.filter((function(e){return Fi(e.metadata.name,r)})),peerAuthentications:n.peerAuthentications.filter((function(e){return Fi(e.metadata.name,r)})),requestAuthentications:n.requestAuthentications.filter((function(e){return Fi(e.metadata.name,r)})),workloadEntries:n.workloadEntries.filter((function(e){return Fi(e.metadata.name,r)})),workloadGroups:n.workloadGroups.filter((function(e){return Fi(e.metadata.name,r)})),envoyFilters:n.envoyFilters.filter((function(e){return Fi(e.metadata.name,r)})),validations:n.validations,permissions:n.permissions})))})),t}))}},{key:"render",value:function(){return r.createElement(r.Fragment,null,r.createElement("div",{style:{backgroundColor:"#fff"}},r.createElement($u,{rightToolbar:r.createElement(zl,{key:"Refresh",handleRefresh:this.updateListItems}),actionsToolbar:r.createElement(Km,null)})),r.createElement(tr,null,r.createElement(Ou,{rows:this.state.listItems},r.createElement(Li,{initialFilters:tu,onFilterChange:this.onFilterChange}))))}}]),a}(vu),Ym=Object(h.b)((function(e){return{activeNamespaces:hl(e)}}),null)(zm),Qm={showPrintMargin:!1,autoScrollEditorIntoView:!0},Xm={styles:{"!!null":"canonical"}},Jm=a(271),Zm=a.n(Jm),$m=(a(1053),a(1054),a(584)),eh=function(e,t){for(var a={position:t,row:0,col:0},n=-1,r=0;r<t;r++)"\n"===e.charAt(r)&&(a.row++,n=r);return a.col=n>-1?t-(n+1):t,a},th=function(e,t,a){for(var n=0,r=0,i=0;i<e.length;i++)if("\n"===e.charAt(i)?(n++,r=-1):r++,n===t&&r===a)return 0===a?i+1:i;return-1},ah=function(e,t,a,n,r){var i={startRow:0,startCol:0,endRow:0,endCol:0,position:-1},o=t;if(t<0&&(o=e.indexOf("spec:",o)),(o=e.indexOf(a,o))<0)return i;var s=function(e){for(var t=0,a=0;a<e.length;a++)"\n"===e.charAt(a)&&t++;return t}(e);if(n&&void 0!==r){o=e.indexOf("-",o);for(var l=eh(e,o),c=l.row,u=l.col,p=o,d=0;c<s&&d<r;){c++;var m=th(e,c,u);"-"===e.charAt(m)&&(p=m,d++)}var h=eh(e,p);i.position=p+1,i.startRow=h.row,i.startCol=h.col}else{var f=eh(e,o);i.position=o+a.length,i.startRow=f.row,i.startCol=f.col}for(var g=i.startRow+1;g<s+1;g++)for(var v=0;v<=i.startCol;v++){var E=th(e,g,v);if(" "!==e.charAt(E)&&(n||"-"!==e.charAt(E)))return i.endRow=g,i.endCol=0,i}return i},nh=function(e,t){var a={markers:[],annotations:[]};return t&&0!==e.length&&0!==Object.keys(t).length?(t.checks.forEach((function(t){var n=function(e,t){var a="error"===t.severity||"warning"===t.severity?t.severity:"info",n={startRow:0,startCol:0,endRow:0,endCol:0,className:"istio-validation-"+a,type:"fullLine"},r={row:0,column:0,type:a,text:(t.code?t.code+" ":"")+t.message},i={startRow:0,startCol:0,endRow:0,endCol:0,position:-1};if(t.path.length>0){var o=t.path.split("/");if(o.length>1)for(var s=1;s<o.length;s++){var l=o[s];if(l.indexOf("[")>-1&&l.indexOf("]")>-1){var c=l.indexOf("["),u=l.indexOf("]"),p=+l.substr(c+1,u-c-1),d=l.substr(0,c);i=ah(e,i.position,d,!0,p)}else i=ah(e,i.position,l,!1)}}return n.startRow=i.startRow,n.startCol=i.startCol,n.endRow=i.endRow>0?i.endRow-1:0,n.endCol=i.endCol,r.row=n.startRow,{marker:n,annotation:r}}(e,t);a.markers.push(n.marker),a.annotations.push(n.annotation)})),a):a},rh=function(e){var t={markers:[],annotations:[]};try{$m.safeLoadAll(e)}catch(i){var a=i.mark&&i.mark.line?i.mark.line:0,n=i.mark&&i.mark.column?i.mark.column:0,r=i.message?i.message:"";t.markers.push({startRow:a,startCol:0,endRow:a+1,endCol:0,className:"istio-validation-error",type:"fullLine"}),t.annotations.push({row:a,column:n,type:"error",text:r})}return t},ih=a(1551),oh=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).onSelect=function(e){n.setState({dropdownOpen:!n.state.dropdownOpen})},n.onToggle=function(e){n.setState({dropdownOpen:e})},n.hideConfirmModal=function(){n.setState({showConfirmModal:!1})},n.onClickDelete=function(){n.setState({showConfirmModal:!0})},n.onDelete=function(){n.hideConfirmModal(),n.props.onDelete()},n.state={showConfirmModal:!1,dropdownOpen:!1},n}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props.objectKind?this.props.objectKind:"Istio object";return r.createElement(r.Fragment,null,r.createElement(Ru.a,{id:"actions",title:"Actions",toggle:r.createElement(ku.a,{onToggle:this.onToggle},"Actions"),onSelect:this.onSelect,position:pp.d.right,isOpen:this.state.dropdownOpen,dropdownItems:[r.createElement(up.a,{key:"delete",onClick:this.onClickDelete,isDisabled:!this.props.canDelete},"Delete")]}),r.createElement(ih.a,{title:"Confirm Delete",isSmall:!0,isOpen:this.state.showConfirmModal,onClose:this.hideConfirmModal,actions:[r.createElement(vr.a,{key:"cancel",variant:"secondary",onClick:this.hideConfirmModal},"Cancel"),r.createElement(vr.a,{key:"confirm",variant:"danger",onClick:this.onDelete},"Delete")]},r.createElement(Ro.a,{component:Ro.b.p},"Are you sure you want to delete the ",e," '",this.props.objectName,"'? It cannot be undone. Make sure this is something you really want to do!")))}}]),a}(r.Component),sh=(a(1082),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).hideConfirmModal=function(){n.setState({showConfirmModal:!1})},n.handleRefresh=function(){n.props.onRefresh(),n.props.setLastRefreshAt(Date.now())},n.state={showConfirmModal:!1},n}return Object(l.a)(a,[{key:"render",value:function(){return r.createElement(r.Fragment,null,r.createElement("span",{style:{float:"left",padding:"10px"}},!this.props.readOnly&&r.createElement("span",{style:{paddingRight:"5px"}},r.createElement(vr.a,{variant:vr.b.primary,isDisabled:!this.props.canUpdate,onClick:this.props.onUpdate},"Save")),r.createElement("span",{style:{paddingRight:"5px"}},r.createElement(vr.a,{variant:vr.b.secondary,onClick:this.handleRefresh},"Reload")),r.createElement("span",{style:{paddingRight:"5px"}},r.createElement(vr.a,{variant:vr.b.secondary,onClick:this.props.onCancel},this.props.readOnly?"Close":"Cancel"))),this.props.showOverview&&r.createElement("span",{style:{float:"right",padding:"10px"}},r.createElement("span",{style:{paddingLeft:"5px"}},r.createElement(vr.a,{variant:vr.b.link,onClick:this.props.onOverview},this.props.overview?"Close Overview":"Show Overview"))))}}]),a}(r.Component)),lh=Object(h.b)(null,(function(e){return{setLastRefreshAt:function(t){e(E.setLastRefreshAt(t))}}}))(sh),ch=a(1558),uh=function(e,t){return new URLSearchParams(U.location.search).get(e)||t},ph=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).indexMap=void 0,n.tabLinks=void 0,n.activeIndex=function(){return n.tabIndexOf(n.props.activeTab)},n.isLinkTab=function(e){return null!=n.tabLinks[e]},n.tabSelectHandler=function(e){var t=new URLSearchParams("");t.set(n.props.tabName,e),U.push(U.location.pathname+"?"+t.toString()),n.props.postHandler&&n.props.postHandler(e),n.setState({currentTab:e})},n.tabTransitionHandler=function(e){var t=n.tabNameOf(e);n.tabSelectHandler(t),n.props.onSelect(t)},n.indexMap=n.buildIndexMap(),n.tabLinks=n.buildTabLinks(),n}return Object(l.a)(a,[{key:"componentDidUpdate",value:function(){this.indexMap=this.buildIndexMap(),this.tabLinks=this.buildTabLinks()}},{key:"buildIndexMap",value:function(){var e=this;return Object.keys(this.props.tabMap).reduce((function(t,a){return t[e.tabIndexOf(a)]=a,t}),{})}},{key:"buildTabLinks",value:function(){var e={};return r.Children.forEach(this.props.children,(function(t){var a=t;a.props.href&&(e[a.props.eventKey]=a.props.href)})),e}},{key:"tabIndexOf",value:function(e){return this.props.tabMap[e]}},{key:"tabNameOf",value:function(e){return this.indexMap[e]}},{key:"render",value:function(){var e=this;return r.createElement(ch.a,{id:this.props.id,activeKey:this.activeIndex(),onSelect:function(t,a){e.isLinkTab(a)||e.tabTransitionHandler(a)},mountOnEnter:void 0===this.props.mountOnEnter||this.props.mountOnEnter,unmountOnExit:void 0===this.props.unmountOnExit||this.props.unmountOnExit},this.props.children)}}]),a}(r.Component),dh=a(1479),mh=a(1561),hh=a(1480),fh=a(1481),gh=a(795),vh=a(1562),Eh=a(1482),bh=a(1483),yh=["error-warning","error-improvement","error-correct","warning-improvement","warning-correct","improvement-correct"],Ch=function(e){var t=fo.Correct;return e.forEach((function(e){var a,n;a=e.severity,n=t,yh.includes(a+"-"+n)&&(t=e.severity)})),t},Sh=function(e){var t=Na;return e===fo.Correct?t=xa:e===fo.Warning?t=Ra:e===fo.Error&&(t=wa),t},Ah=function(e,t){return e&&e.checks?e.checks.filter((function(e){return e.path===t})):[]},Th=a(788),Oh=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"bulletChartValues",value:function(e){var t=0;return(e.route||[]).map((function(a){var n=a.destination,r="".concat(n.host||"-","_").concat(n.subset||"-","_").concat(n.port||"-"),i=e.route&&1===e.route.length?100:a.weight||0;t+=i;var o=a.weight?a.weight:100;return{y:t,name:"".concat(o,"_").concat(r)}}))}},{key:"bulletChartLabels",value:function(e){var t=e.datum.name.split("_"),a=Object(T.a)(t,2),n=a[0],r="Weight";return a[1]&&(r="".concat(n," %")),r}},{key:"renderWeights",value:function(e,t){return r.createElement(r.Fragment,null,(e.route||[]).length>=1&&r.createElement(Th.ChartBullet,{key:"bullet-chart-"+t,ariaDesc:"Routing percentage representation",ariaTitle:"Traffic routing distribution",maxDomain:{y:100},height:80,qualitativeRangeData:[{name:"Range",y:100}],primarySegmentedMeasureData:this.bulletChartValues(e),labels:this.bulletChartLabels,padding:"80 0 0 0"}))}},{key:"render",value:function(){var e=this;return(this.props.routes||[]).map((function(t,a){var n=0===a?-30:0;return r.createElement("div",{key:"bulletchart-wrapper-"+a,style:{marginTop:n}},e.renderWeights(t,a))}))}}]),a}(r.Component),Ih=a(232),wh=a(1474),Rh=a(1475),kh=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"isValid",value:function(){return!!this.props.validation&&this.props.validation.valid}},{key:"numberOfChecks",value:function(e){var t=this.props.validation,a=0;return t&&(a=(t&&t.checks?t.checks:[]).filter((function(t){return t.severity===e})).length),a}},{key:"severity",value:function(){if(!this.props.validation)return fo.Error;var e=this.props.validation,t=this.numberOfChecks(fo.Warning),a=this.numberOfChecks(fo.Error),n=fo.Correct;return e.valid||(a>0?n=fo.Error:t>0&&(n=fo.Warning)),n}},{key:"checkForPath",value:function(e){var t=this.props.validation;return t&&t.checks?t.checks.filter((function(t){return t.path===e})):[]}},{key:"globalChecks",value:function(){return this.checkForPath("")}},{key:"message",value:function(){var e=this.globalChecks().map((function(e){return(e.code?e.code+" ":"")+e.message})).join(",");return e.length||this.isValid()||(e="Not all checks passed!"),e}},{key:"render",value:function(){return i.a.createElement(Lo,{severity:this.severity(),message:this.message(),messageColor:!0})}}]),a}(i.a.Component),xh=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).emptyHost=function(){return!!e.props.host},e.isFQDN=function(){return e.props.host.endsWith("."+j.istioIdentityDomain)},e.isTwoPartsService=function(){var t=e.hostParts();return 2===t.length&&t[1]===e.props.namespace},e.isShortName=function(){return 1===e.props.host.split(".").length},e.isWildCardScoped=function(){return e.props.host.startsWith("*")},e.showLink=function(){return e.props.isValid&&!e.isWildCardScoped()&&(e.isFQDN()||e.isTwoPartsService()||e.isShortName())},e.hostParts=function(){return e.props.host.split(".")},e.getHost=function(){var t=[e.props.namespace,e.props.host];if(e.isFQDN()||e.isTwoPartsService()){var a=e.hostParts();t=[a[1],a[0]]}return t},e.renderLink=function(){var t=e.getHost();return r.createElement(ar.a,{to:"/namespaces/"+t[0]+"/services/"+t[1]+"?list=istioconfig"},e.props.host+" ",r.createElement(ni.a,null))},e}return Object(l.a)(a,[{key:"render",value:function(){return this.emptyHost()?this.showLink()?this.renderLink():this.props.host:"-"}}]),a}(r.PureComponent),Nh=Object(Jn.a)({margin:"0px 0px 2px 10px",verticalAlign:"-5px !important"}),jh=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"validation",value:function(){return this.props.validation}},{key:"globalStatus",value:function(){var e=this.props.validation;return e&&!e.valid?r.createElement(kh,{validation:e}):void 0}},{key:"hostStatusMessage",value:function(){var e=Ah(this.validation(),"spec/hosts"),t=Ch(e);return{message:e.map((function(e){return(e.code?e.code+" ":"")+e.message})).join(","),severity:t}}},{key:"parseHost",value:function(e){if(e.includes("/")){var t=e.split("/");return{service:t[1],namespace:t[0]}}var a=e.split("."),n={service:a[0],namespace:this.props.namespace};return a.length>1&&(n.namespace=a[1]),n}},{key:"generateGatewaysList",value:function(e,t){var a=this,n=[];return Object.keys(e).forEach((function(i,o){var s=a.parseHost(e[i]);n.push(r.createElement("li",{key:"gateway_"+s.service+"_"+o},t?"mesh"===s.service?r.createElement("div",null,s.service,r.createElement(lo.a,{position:lo.b.right,content:r.createElement("div",{style:{textAlign:"left"}},'The reserved word, "mesh", implies all of the sidecars in the mesh')},r.createElement(fi.Info,{className:Nh}))):r.createElement(gc,{name:s.service,namespace:s.namespace,type:"gateway"},e[i]):s.service))})),r.createElement(r.Fragment,null,r.createElement(Ro.a,{component:Ro.b.h3},"Gateways"),r.createElement("ul",{className:"details"},n))}},{key:"generateServiceList",value:function(e,t){var a=this,n=[];return e.forEach((function(e){var t;null===(t=e.route)||void 0===t||t.forEach((function(e){n.includes(e.destination.host)||n.push(e.destination.host)}))})),n.length>0?r.createElement(r.Fragment,null,r.createElement(Ro.a,{component:Ro.b.h3},"Hosts"),r.createElement("ul",{className:"details"},n.map((function(e,n){return r.createElement("li",{key:"host_"+n},r.createElement(xh,{namespace:a.props.namespace,host:e,isValid:t}))})))):void 0}},{key:"render",value:function(){var e=this,t=this.props.virtualService,a=!this.globalStatus(),n=[{name:"HTTP",object:t.spec.http},{name:"TCP",object:t.spec.tcp},{name:"TLS",object:t.spec.tls}];return r.createElement(r.Fragment,null,r.createElement(Eo.a,{headingLevel:Eo.b.h3,size:Ih.a.xl},"Virtual Service Overview"),r.createElement(wh.a,null,t.spec.gateways&&t.spec.gateways.length>0&&r.createElement(Rh.a,{id:"gateways"},this.generateGatewaysList(t.spec.gateways,a)),n.map((function(n,i){var o=n.name,s=n.object;if(s&&s.length>0)return r.createElement(Rh.a,{id:n.name+"-routes-"+i,key:n.name+"-routes-"+i},n.name+" Routes",r.createElement(Oh,{name:t.metadata.name,namespace:t.metadata.namespace||"",kind:o,routes:s}),r.createElement("div",{style:{marginTop:30}},e.generateServiceList(s,a)))}))))}}]),a}(r.Component),Ph=a(1476),Lh=(a(1148),function(e){return"object"!==typeof e}),Dh=function(e){var t=e.name,a=e.value;return Lh(t)&&Lh(a)?r.createElement("span",{className:"label-pair"},r.createElement(Ph.a,{className:"label-key",isCompact:!0},t),a&&a.length>0&&r.createElement(Ph.a,{className:"label-value",isCompact:!0},a||"")):r.createElement("span",null,"This label has an unexpected format")},Fh=(a(1150),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"generateKey",value:function(){return"key_"+Math.random().toString(36).substr(2,9)}},{key:"label",value:function(e,t){return r.createElement(Dh,{name:e,value:t})}},{key:"checkLabel",value:function(e){return!!this.props.labels&&this.props.labels.indexOf(e)>-1}},{key:"canDisplay",value:function(e){return null==this.props.exclude||!this.props.exclude.includes(e)}},{key:"buildList",value:function(e,t,a,n){var i=this;if(!this.canDisplay(e))return"";var o=typeof t;if("string"===o||"number"===o||"boolean"===o)return r.createElement("div",{className:"label-collection"},a?this.label(e,t):r.createElement("span",null,r.createElement("span",null,e?"[".concat(e,"]"):e)," ",t.toString()));var s=[],l=this.generateKey(),c=this.checkLabel(e);return Array.isArray(t)?t.forEach((function(e,t){var a=typeof e;"string"===a||"number"===a||"boolean"===a?s.push(r.createElement("li",{key:l+"_i"+t},e)):Object.keys(e).forEach((function(a,o){var u=i.buildList(a,e[a],c,n+1);s.push(r.createElement("li",{key:l+"_i"+t+"_j"+o},u))}))})):Object.keys(t||{}).forEach((function(e,a){var o=i.buildList(e,t[e],c,n+1);s.push(r.createElement("li",{key:l+"_k"+a},o))})),s.length>0?r.createElement("div",null,r.createElement("strong",null,e),0===n&&this.props.validation&&this.props.validation.message?r.createElement(Lo,{severity:this.props.validation.severity,message:this.props.validation.message,messageColor:!0}):void 0,r.createElement("ul",{className:"details"},s)):""}},{key:"render",value:function(){var e=void 0!==this.props.labels&&this.props.labels.length>0,t=this.buildList(this.props.name,this.props.detail,e,0);return r.createElement("div",null,t)}}]),a}(r.Component)),_h=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"content",value:function(){return(this.props.checks||[]).map((function(e,t){return i.a.createElement(Lo,{key:"validation-check-"+t,severity:e.severity,message:(e.code?e.code+" ":"")+e.message})}))}},{key:"render",value:function(){var e=Ch(this.props.checks||[]),t=e===fo.Correct;return i.a.createElement(lo.a,{"aria-label":"Validations list",position:this.props.tooltipPosition||lo.b.left,enableFlip:!0,content:t?"Valid":this.content()},i.a.createElement("span",null,i.a.createElement(Lo,{severity:e})))}}]),a}(i.a.Component),Mh=Object(Jn.a)({float:"left",paddingLeft:"0px",marginLeft:"2px",fontSize:"0.8rem"}),Hh=Object(Jn.a)({margin:"0px 4px 2px 10px",verticalAlign:"-9px !important"}),Gh=Object(Jn.a)({overflow:"hidden"}),Vh=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e,n){var r;return Object(s.a)(this,a),(r=t.call(this,e,n)).expandLabels=function(){r.setState({expanded:!0})},r.state={expanded:!!e.expanded&&e.expanded},r}return Object(l.a)(a,[{key:"labelKeys",value:function(){return Object.keys(this.props.labels||{})}},{key:"hasLabels",value:function(){return this.labelKeys().length>0}},{key:"hasManyLabels",value:function(){return this.labelKeys().length>2}},{key:"showItem",value:function(e){return this.state.expanded||!this.hasManyLabels()||e<2}},{key:"renderMoreLabelsLink",value:function(){return this.hasManyLabels()&&!this.state.expanded?r.createElement(vr.a,{key:"label_more",variant:"link",className:Mh,onClick:this.expandLabels},"More labels..."):null}},{key:"renderLabels",value:function(){var e=this;return this.labelKeys().map((function(t,a){return e.showItem(a)?r.createElement("div",{key:"label_"+a},r.createElement(Dh,{key:"label_"+a,name:t,value:e.props.labels?e.props.labels[t]:""})):void 0}))}},{key:"renderEmptyLabels",value:function(){return r.createElement("span",null," No labels ")}},{key:"render",value:function(){var e=this.props.tooltipMessage?r.createElement(lo.a,{key:"tooltip_missing_sidecar",position:lo.b.auto,content:r.createElement("div",{style:{textAlign:"left"}},this.props.tooltipMessage)},r.createElement(fi.Info,{className:Hh})):void 0;return r.createElement("div",{className:Gh},this.hasLabels()?[this.renderLabels(),this.renderMoreLabelsLink()]:this.renderEmptyLabels(),e)}}]),a}(r.Component),Uh=(a(1151),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"subsetValidation",value:function(e){var t=Ah(this.props.validation,"spec/subsets["+e+"]");return r.createElement(_h,{checks:t,tooltipPosition:lo.b.right})}},{key:"columnsSubsets",value:function(){return[{title:"Status",props:{}},{title:"Name",props:{}},{title:"Labels",props:{}},{title:"Traffic Policy",props:{}}]}},{key:"rowsSubset",value:function(){var e=this;return(this.props.destinationRule.spec.subsets||[]).map((function(t,a){return{cells:[{title:e.subsetValidation(a)},{title:t.name},{title:r.createElement(Vh,{key:"subset-labels-"+a,labels:t.labels})},{title:r.createElement(Fh,{name:"",detail:t.trafficPolicy})}]}}))}},{key:"generateSubsets",value:function(){var e=(this.props.destinationRule.spec.subsets||[]).length>0;return r.createElement(r.Fragment,null,e?r.createElement(Eu.b,{"aria-label":"DestinationRule SubSets table",variant:Eu.e.compact,cells:this.columnsSubsets(),rows:this.rowsSubset(),className:"table"},r.createElement(bu.a,null),r.createElement(kp.a,null)):r.createElement(Ro.a,{component:Ro.b.p},"No subsets defined."))}},{key:"render",value:function(){var e=this.props.destinationRule,t=!!this.props.validation&&0===this.props.validation.checks.length;return r.createElement(r.Fragment,null,r.createElement(Eo.a,{headingLevel:Eo.b.h3,size:Ih.a.xl},"Destination Rule Overview"),r.createElement(wh.a,null,r.createElement(Rh.a,{id:"subsets"},e.spec.host&&r.createElement(r.Fragment,null,r.createElement(Ro.a,{component:Ro.b.h3},"Host"),r.createElement(xh,{namespace:e.metadata.namespace||"",host:e.spec.host,isValid:t})),this.generateSubsets())))}}]),a}(r.Component)),Bh=a(1477),Wh=a(1478),qh=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){return r.createElement(r.Fragment,null,r.createElement(Eo.a,{headingLevel:Eo.b.h3,size:Ih.a.xl},"Analyzer Messages"),r.createElement(wh.a,{gutter:"lg"},this.props.messages.map((function(e,t){var a=Io[e.level||0];return r.createElement(Rh.a,{id:"msg-"+t,className:"validation-message"},r.createElement(Bh.a,null,r.createElement(Wh.a,null,r.createElement(Lo,{severity:a})),r.createElement(Wh.a,null,r.createElement("a",{href:e.documentation_url,target:"_blank",rel:"noopener noreferrer"},e.type.code),e.description?": "+e.description:void 0)))}))))}}]),a}(r.Component),Kh=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){return r.createElement(r.Fragment,null,r.createElement(Eo.a,{headingLevel:Eo.b.h3,size:Ih.a.xl},"Validation references"),r.createElement(wh.a,null,this.props.objectReferences.map((function(e,t){return r.createElement(Rh.a,{key:"rel-object-"+t},r.createElement(hc,{name:e.name,type:e.objectType,namespace:e.namespace}))}))))}}]),a}(r.Component);a(702);var zh,Yh,Qh,Xh,Jh,Zh,$h,ef,tf,af,nf,rf,of,sf,lf,cf,uf,pf,df,mf=Object(Jn.a)({zIndex:500}),hf=Object(Jn.a)({margin:"0"}),ff={yaml:0},gf=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).aceEditorRef=void 0,n.drawerRef=void 0,n.promptTo=void 0,n.timerId=void 0,n.fetchIstioObjectDetails=function(){n.fetchIstioObjectDetailsFromProps(n.props.match.params)},n.newIstioObjectPromise=function(e,t){return function(e,t,a,n){return Xa(K.GET,qa.istioConfigDetail(e,t,a),n?{validate:!0}:{},{})}(e.namespace,e.objectType,e.object,t)},n.fetchIstioObjectDetailsFromProps=function(e){var t=n.newIstioObjectPromise(e,!0);window.clearInterval(n.timerId),n.timerId=window.setInterval((function(){n.newIstioObjectPromise(e,!1).then((function(t){if(t.data&&n.state.originalIstioObjectDetails){var a=function(e,t){for(var a=Object.keys(e),n=0;n<a.length;n++){var r=a[n],i=e[r],o=t[r];if(i&&o&&i.metadata&&o.metadata&&i.metadata.resourceVersion&&o.metadata.resourceVersion&&i.metadata.resourceVersion!==o.metadata.resourceVersion)return[!0,r,o.metadata.resourceVersion]}return[!1,"",""]}(n.state.originalIstioObjectDetails,t.data),r=Object(T.a)(a,3),i=r[0],o=r[1],s=r[2];i&&Vn(o+":"+e.object+" has a newer version ("+s+"). Reload to see a new version.")}})).catch((function(t){n.setState({isRemoved:!0}),_n("Could not fetch ".concat(e.objectType,": ").concat(e.object," in namespace: ").concat(e.namespace,". Has it been removed?"),t)}))}),5e3),t.then((function(e){n.setState({istioObjectDetails:e.data,originalIstioObjectDetails:e.data,istioValidations:e.data.validation,originalIstioValidations:e.data.validation,isModified:!1,isExpanded:n.isExpanded(e.data),yamlModified:"",currentTab:uh("list",n.defaultTab())},(function(){return n.resizeEditor()}))})).catch((function(t){n.setState({isRemoved:!0}),_n("Could not fetch Istio object type [".concat(e.objectType,"] name [").concat(e.object,"] in namespace [").concat(e.namespace,"]."),t)}))},n.backToList=function(){U.push("/".concat(ce.ISTIO,"?namespaces=").concat(n.props.match.params.namespace))},n.canDelete=function(){return void 0!==n.state.istioObjectDetails&&n.state.istioObjectDetails.permissions.delete},n.canUpdate=function(){return void 0!==n.state.istioObjectDetails&&n.state.istioObjectDetails.permissions.update},n.onCancel=function(){n.backToList()},n.onDelete=function(){cn(n.props.match.params.namespace,n.props.match.params.objectType,n.props.match.params.object).then((function(){return n.backToList()})).catch((function(e){_n("Could not delete IstioConfig details.",e)}))},n.onUpdate=function(){$m.safeLoadAll(n.state.yamlModified,(function(e){var t=JSON.stringify(function(e,t){if(!t)return e;return A.a.mergeWith(e,t,(function e(t,a){return t?(A.a.isObject(t)&&A.a.isObject(a)&&A.a.mergeWith(t,a,e),t):null})),e}(e,gp(n.state.istioObjectDetails)));un(n.props.match.params.namespace,n.props.match.params.objectType,n.props.match.params.object,t).then((function(){var e=n.props.match.params.namespace+" / "+n.props.match.params.objectType+" / "+n.props.match.params.object;Dn("Changes applied on "+e,"default",Te.SUCCESS),n.fetchIstioObjectDetails()})).catch((function(e){_n("Could not update IstioConfig details.",e),n.setState({yamlValidations:n.injectGalleyError(e)})}))}))},n.injectGalleyError=function(e){var t=On(e).split(":");return{annotations:[{column:0,row:0,text:t.slice(1,t.length).join(":"),type:"error"}],markers:[]}},n.resizeEditor=function(){n.aceEditorRef.current&&setTimeout((function(){n.aceEditorRef.current.editor.resize(!0)}),250)},n.onDrawerToggle=function(){n.setState((function(e){return{isExpanded:!e.isExpanded}}),(function(){return n.resizeEditor()}))},n.onDrawerClose=function(){n.setState({isExpanded:!1},(function(){return n.resizeEditor()}))},n.onEditorChange=function(e){n.setState({isModified:!0,yamlModified:e,istioValidations:void 0,yamlValidations:rh(e)})},n.onRefresh=function(){var e=!0;n.state.isModified&&(e=window.confirm("You have unsaved changes, are you sure you want to refresh ?")),e&&n.fetchIstioObjectDetails()},n.fetchYaml=function(){if(n.state.isModified)return n.state.yamlModified;var e=gp(n.state.istioObjectDetails);return e?$m.safeDump(e,Xm):""},n.getStatusMessages=function(e){var t=gp(e);return t&&t.status&&t.status.validationMessages?t.status.validationMessages:[]},n.hasOverview=function(){return"virtualservices"===n.props.match.params.objectType||"destinationrules"===n.props.match.params.objectType},n.objectReferences=function(e){return((e||{}).validation||{}).references||[]},n.getFoldRanges=function(e){var t={startRow:-1,endRow:-1};e&&e.split("\n").forEach((function(e,a){(e.startsWith("status:")||e.startsWith("  managedFields:"))&&(-1===t.startRow||t.startRow>a)&&(t.startRow=a),e.startsWith("spec:")&&-1!==t.startRow&&(t.endRow=a)}));return t},n.isExpanded=function(e){var t=!1;return e&&(t=n.showCards(n.objectReferences(e).length>0,n.getStatusMessages(e))),t},n.showCards=function(e,t){return e||n.hasOverview()||t.length>0},n.renderEditor=function(){var e=n.fetchYaml(),t=n.getStatusMessages(n.state.istioObjectDetails),a=n.objectReferences(n.state.istioObjectDetails),i=a.length>0,o=n.showCards(i,t),s={markers:[],annotations:[]};n.state.isModified?n.state.yamlValidations&&(s.markers=n.state.yamlValidations.markers,s.annotations=n.state.yamlValidations.annotations):s=nh(e,n.state.istioValidations);var l=r.createElement(dh.a,null,r.createElement(mh.a,null,r.createElement("div",null,o&&r.createElement(r.Fragment,null,n.state.istioObjectDetails&&n.state.istioObjectDetails.virtualService&&r.createElement(jh,{virtualService:n.state.istioObjectDetails.virtualService,validation:n.state.istioValidations,namespace:n.state.istioObjectDetails.namespace.name}),n.state.istioObjectDetails&&n.state.istioObjectDetails.destinationRule&&r.createElement(Uh,{destinationRule:n.state.istioObjectDetails.destinationRule,validation:n.state.istioValidations,namespace:n.state.istioObjectDetails.namespace.name}),t&&t.length>0&&r.createElement(qh,{messages:t}),i&&r.createElement(Kh,{objectReferences:a}))),r.createElement(hh.a,null,r.createElement(fh.a,{onClick:n.onDrawerClose})))),c=n.state.istioObjectDetails?r.createElement("div",{style:{width:"100%"}},r.createElement(Zm.a,{ref:n.aceEditorRef,mode:"yaml",theme:"eclipse",onChange:n.onEditorChange,height:"var(--kiali-yaml-editor-height)",width:"100%",className:"istio-ace-editor",wrapEnabled:!0,readOnly:!n.canUpdate(),setOptions:Qm,value:n.state.istioObjectDetails?e:void 0,annotations:s.annotations,markers:s.markers})):null;return r.createElement("div",{className:"object-drawer ".concat(hf)},o?r.createElement(gh.a,{isExpanded:n.state.isExpanded,isInline:!0},r.createElement(vh.a,{panelContent:o?l:void 0},r.createElement(Eh.a,null,c))):c,n.renderActionButtons(o))},n.renderActionButtons=function(e){var t=!!(n.state.yamlValidations&&n.state.yamlValidations.markers.length>0);return r.createElement(lh,{objectName:n.props.match.params.object,readOnly:!n.canUpdate(),canUpdate:n.canUpdate()&&n.state.isModified&&!n.state.isRemoved&&!t,onCancel:n.onCancel,onUpdate:n.onUpdate,onRefresh:n.onRefresh,showOverview:e,overview:n.state.isExpanded,onOverview:n.onDrawerToggle})},n.renderActions=function(){var e=void 0!==n.state.istioObjectDetails&&n.state.istioObjectDetails.permissions.delete&&!n.state.isRemoved,t=gp(n.state.istioObjectDetails);return r.createElement("span",{className:mf},r.createElement(oh,{objectKind:t?t.kind:void 0,objectName:n.props.match.params.object,canDelete:e,onDelete:n.onDelete}))},n.state={isModified:!1,isRemoved:!1,currentTab:uh("list",n.defaultTab()),isExpanded:!1},n.aceEditorRef=r.createRef(),n.drawerRef=r.createRef(),n.promptTo="",n.timerId=-1,n}return Object(l.a)(a,[{key:"defaultTab",value:function(){return"yaml"}},{key:"objectTitle",value:function(){var e="";if(this.state.istioObjectDetails){var t=Di[this.props.match.params.objectType],a=t.charAt(0).toLowerCase()+t.slice(1),n=this.state.istioObjectDetails[a];n&&(e=n.metadata.name)}return e}},{key:"componentDidMount",value:function(){this.fetchIstioObjectDetails()}},{key:"componentDidUpdate",value:function(e,t){if(this.state.isModified?window.onbeforeunload=function(){return!0}:window.onbeforeunload=null,this.promptTo="",this.aceEditorRef.current){var a=this.aceEditorRef.current.editor;a.onChangeAnnotation();var n=this.getFoldRanges(this.fetchYaml()),r=n.startRow,i=n.endRow;this.state.isModified||a.session.foldAll(r,i,0)}var o=uh("list",this.defaultTab());this.state.currentTab!==o&&this.setState({currentTab:o}),this.propsMatch(e)||this.fetchIstioObjectDetailsFromProps(this.props.match.params),this.state.istioValidations&&this.state.istioValidations!==t.istioValidations&&lp(this.state.istioValidations)}},{key:"propsMatch",value:function(e){return this.props.match.params.namespace===e.match.params.namespace&&this.props.match.params.object===e.match.params.object&&this.props.match.params.objectType===e.match.params.objectType}},{key:"componentWillUnmount",value:function(){window.onbeforeunload=null,window.clearInterval(this.timerId)}},{key:"render",value:function(){var e=this;return r.createElement(r.Fragment,null,r.createElement(Qi,{location:this.props.location,rightToolbar:r.createElement(zl,{key:"Refresh",handleRefresh:this.onRefresh}),actionsToolbar:this.renderActions()}),r.createElement(ph,{id:"basic-tabs",onSelect:function(t){e.setState({currentTab:t})},tabMap:ff,tabName:"list",defaultTab:this.defaultTab(),activeTab:this.state.currentTab,mountOnEnter:!1,unmountOnExit:!0},r.createElement(bh.a,{key:"istio-yaml",title:"YAML ".concat(this.state.isModified?" * ":""),eventKey:0},r.createElement(Zn,null,this.renderEditor()))),r.createElement(f.a,{message:function(t){return!e.state.isModified||(e.promptTo===t.pathname||(e.promptTo=t.pathname,"You have unsaved changes, are you sure you want to leave?"))}}))}}]),a}(r.Component),vf=gf,Ef=a(1484),bf=a(1485),yf=a(1486),Cf=Object(Jn.a)({margin:"0 0 0 0",padding:"0 0 0 0",display:"inline-block"}),Sf=Object(Jn.a)({margin:"0px 0 11px 0"}),Af=Object(Jn.a)({margin:"15px 0 8px 0"}),Tf=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"renderAppItem",value:function(e,t){return r.createElement("li",{key:"App_".concat(t)},r.createElement("div",{key:"service-icon",className:Cf},r.createElement(pc,{badge:cc.App,position:lo.b.top})),r.createElement("span",null,r.createElement(ar.a,{to:"/namespaces/"+e+"/applications/"+t},t)))}},{key:"renderServiceItem",value:function(e,t){return r.createElement("li",{key:"Service_".concat(t)},r.createElement("div",{key:"service-icon",className:Cf},r.createElement(pc,{badge:cc.Service,position:lo.b.top})),r.createElement("span",null,r.createElement(ar.a,{to:"/namespaces/"+e+"/services/"+t},t)))}},{key:"renderEmptyItem",value:function(e){var t="No "+e+" found";return r.createElement("div",null," ",t," ")}},{key:"appList",value:function(){var e=this,t=this.props.apps&&this.props.apps.length>0?this.props.apps.sort((function(e,t){return e<t?-1:1})).map((function(t){return e.renderAppItem(e.props.namespace,t)})):this.renderEmptyItem("applications");return[r.createElement("div",{className:Sf},r.createElement("ul",{id:"app-list",style:{listStyleType:"none"}},t))]}},{key:"renderWorkloadItem",value:function(e){return r.createElement("span",{key:"WorkloadItem_"+e.workloadName},r.createElement("div",{className:Cf},r.createElement(pc,{badge:cc.Workload,position:lo.b.top})),r.createElement(ar.a,{to:"/namespaces/"+this.props.namespace+"/workloads/"+e.workloadName},e.workloadName),!e.istioSidecar&&r.createElement(go,{namespace:this.props.namespace,tooltip:!0,style:{marginLeft:"10px"},text:""}))}},{key:"renderWorkloadHealthItem",value:function(e){var t=void 0;if(this.props.workloads&&this.props.workloads.length>0)for(var a=0;a<this.props.workloads.length;a++){if(e.text.substr(0,e.text.indexOf(":"))===this.props.workloads[a].workloadName){t=this.props.workloads[a];break}}return t?r.createElement("span",{key:"WorkloadItem_"+t.workloadName},r.createElement("div",{key:"service-icon",className:Cf},r.createElement(pc,{badge:cc.Workload,position:lo.b.top})),r.createElement(ar.a,{to:"/namespaces/"+this.props.namespace+"/workloads/"+t.workloadName},t.workloadName),r.createElement(lo.a,{"aria-label":"Health indicator",content:r.createElement(r.Fragment,null,e.text),position:Cr.b.auto,className:"health_indicator"},r.createElement("span",{style:{marginLeft:"10px"}},vo(e.status))),!t.istioSidecar&&r.createElement(go,{namespace:this.props.namespace,tooltip:!0,style:{marginLeft:"10px"},text:""})):r.createElement("span",{key:"WorkloadItem_"+e.text},r.createElement("span",{style:{marginRight:"10px"}},vo(e.status)),e.text)}},{key:"renderWorkloadStatus",value:function(){var e=this;if(this.props.health){var t=this.props.health.getWorkloadStatus();return t?r.createElement("div",null,t.text,t.children&&r.createElement("ul",{id:"workload-list",style:{listStyleType:"none"}},t.children.map((function(t,a){return r.createElement("li",{key:a},e.renderWorkloadHealthItem(t))})))):r.createElement("div",null,r.createElement("ul",{id:"workload-list",style:{listStyleType:"none"}},this.props.workloads?this.props.workloads.sort((function(e,t){return e.workloadName<t.workloadName?-1:1})).map((function(t,a){return r.createElement("li",{key:a},e.renderWorkloadItem(t))})):void 0))}}},{key:"workloadSummary",value:function(){return r.createElement("div",{className:Sf},this.renderWorkloadStatus())}},{key:"serviceList",value:function(){var e=this,t=this.props.services&&this.props.services.length>0?this.props.services.sort((function(e,t){return e<t?-1:1})).map((function(t){return e.renderServiceItem(e.props.namespace,t)})):this.renderEmptyItem("services");return[r.createElement("div",{className:Sf},r.createElement("ul",{id:"service-list",style:{listStyleType:"none"}},t))]}},{key:"render",value:function(){return r.createElement(r.Fragment,null,r.createElement("div",{className:Af}),void 0!==this.props.apps&&this.appList(),void 0!==this.props.workloads&&this.workloadSummary(),void 0!==this.props.services&&this.serviceList(),this.props.health&&function(e){var t=e.getStatusConfig(),a=!(!t||!e.health.statusConfig)&&e.health.statusConfig.value>0,n=e.getTrafficStatus();if(n&&(!!n.children&&n.children.filter((function(e){var t=e.value&&e.value>0;return e.status!==xa&&t})).length>0))return r.createElement("div",null,r.createElement(Eo.a,{headingLevel:"h5",size:"lg",className:bo},"Traffic"),n.text,n.children&&r.createElement("ul",{style:{listStyleType:"none"}},n.children.map((function(e,t){var a=e.value&&e.value>0;return e.status!==xa&&a?r.createElement("li",{key:t},r.createElement("span",{style:{marginRight:"10px"}},vo(e.status)),e.text):r.createElement(r.Fragment,{key:t})})),t&&a&&r.createElement("li",{key:"degraded_failure_config"},r.createElement("span",{style:{marginRight:"10px"}},vo(Ra)),":"," ",0===t.degraded?">":">=",t.degraded,"% ",vo(wa),": ",0===t.degraded?">":">=",t.failure,"%")))}(this.props.health))}}]),a}(r.PureComponent),Of={month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"},If=function(e,t){var a=Object(C.a)({},Of),n=new Date(e);return n.getFullYear()!==(new Date).getFullYear()&&(a.year="numeric"),n.toLocaleString("en-US",Object(C.a)(Object(C.a)({},a),t))},wf=function(e,t,a,n){var r=Object(C.a)({},Of),i=new Date(e),o=(new Date).getFullYear(),s=i.getFullYear();s!==o&&(r.year="numeric"),a=a||{};var l=i.toLocaleString("en-US",Object(C.a)(Object(C.a)({},r),a));r=Object(C.a)({},Of);var c=new Date(t);s!==c.getFullYear()&&(r.year="numeric");var u=i.getMonth(),p=c.getMonth(),d=i.getDay(),m=c.getDay();u===p&&d===m&&(delete r.month,delete r.day),n=n||{};var h=c.toLocaleString("en-US",Object(C.a)(Object(C.a)({},r),n));return"".concat(l," ... ").concat(h)},Rf=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e;return e=this.props.time?If(new Date(this.props.time).valueOf()):"-",r.createElement(r.Fragment,null,e)}}]),a}(r.Component),kf=function(e){if(e.text.startsWith("http://")||e.text.startsWith("https://")){var t=e.text;return e.urlTruncate&&e.text.length>e.urlTruncate&&(t=e.text.substr(0,e.urlTruncate/2)+"..."+e.text.substr(e.text.length-e.urlTruncate/2)),r.createElement("a",{href:e.text,target:"_blank",rel:"noopener noreferrer"},t)}return r.createElement(r.Fragment,null,e.text)},xf=Object(Jn.a)({margin:"0px 0 11px 0",$nest:{"& > ul > li > span":{float:"left",width:"125px",fontWeight:700}}}),Nf=Object(Jn.a)({display:"inline-block",verticalAlign:"2px !important"}),jf=Object(Jn.a)({margin:"0px 0px 2px 10px",verticalAlign:"-5px !important"}),Pf=Object(Jn.a)({marginLeft:"10px",verticalAlign:"-1px !important"}),Lf=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props.workload,t=[],a=[];e&&(e.labels[j.istioLabels.appLabelName]&&t.push(e.labels[j.istioLabels.appLabelName]),e.services.forEach((function(e){return a.push(e.name)})));var n=e&&["Deployment","ReplicaSet","ReplicationController","DeploymentConfig","StatefulSet"].indexOf(e.type)>=0,i=((null===e||void 0===e?void 0:e.runtimes)||[]).map((function(e){return e.name})).filter((function(e){return""!==e})),o=e?r.createElement(r.Fragment,null,r.createElement("div",{key:"properties-list",className:xf},r.createElement("ul",{style:{listStyleType:"none"}},void 0!==e.istioInjectionAnnotation&&r.createElement("li",null,r.createElement("span",null,"Istio Injection"),String(e.istioInjectionAnnotation)),r.createElement("li",null,r.createElement("span",null,"Type"),e.type?e.type:"N/A"),r.createElement("li",null,r.createElement("span",null,"Created"),r.createElement("div",{style:{display:"inline-block"}},r.createElement(Rf,{time:e.createdAt}))),r.createElement("li",null,r.createElement("span",null,"Version"),e.resourceVersion),e.additionalDetails.map((function(e,t){return r.createElement("li",{key:"additional-details-"+t,id:"additional-details-"+t},r.createElement("span",null,e.title),e.icon&&ss(e.icon,void 0,t),r.createElement(kf,{text:e.value,urlTruncate:64}))})),i.length>0&&r.createElement("li",{id:"runtimes"},r.createElement("span",null,"Runtimes"),r.createElement("div",{style:{display:"inline-block"}},i.map((function(e,t){return function(e,t){return ns(e,e,t,rs)}(e,t)})).reduce((function(e,t){return e.length>0?[].concat(Object(mt.a)(e),[r.createElement("span",{key:"sep"}," | "),t]):[t]}),[])))))):void 0;return e?r.createElement(Ef.a,{id:"WorkloadDescriptionCard"},r.createElement(bf.a,null,r.createElement(Eo.a,{headingLevel:"h5",size:"lg"},r.createElement("div",{key:"service-icon",className:Nf},r.createElement(pc,{badge:cc.Workload,position:lo.b.top})),this.props.workload?this.props.workload.name:"Workload",o?r.createElement(lo.a,{position:lo.b.right,content:r.createElement("div",{style:{textAlign:"left"}},o)},r.createElement(fi.Info,{className:jf})):void 0,r.createElement("span",{className:Pf},r.createElement(Co,{id:e.name,health:this.props.health})),this.props.workload&&!this.props.workload.istioSidecar&&r.createElement(go,{namespace:this.props.namespace,tooltip:!0,style:{marginLeft:"10px"},text:""}),this.props.workload&&(!this.props.workload.appLabel||!this.props.workload.versionLabel)&&r.createElement(yc,{missingApp:!this.props.workload.appLabel,missingVersion:!this.props.workload.versionLabel,style:{marginLeft:"10px"},tooltip:!0}))),r.createElement(yf.a,null,e.labels&&r.createElement(Vh,{labels:e.labels,tooltipMessage:n?"Labels defined on the Workload template":void 0}),r.createElement(Tf,{namespace:this.props.namespace,apps:t,services:a,health:this.props.health}))):"Loading"}}]),a}(r.Component),Df=a(1492),Ff=a(1493),_f=["traffic"],Mf=a(796),Hf=a.n(Mf),Gf={nodes:[],edges:[]},Vf=function(){function e(){var t=this;Object(s.a)(this,e),this.graphDuration=void 0,this.graphTimestamp=void 0,this._errorMessage=void 0,this._fetchParams=void 0,this._isError=void 0,this._isLoading=void 0,this.eventEmitter=void 0,this.graphElements=void 0,this.promiseRegistry=void 0,this.decoratedData=Object(dl.a)((function(e){return e}),(function(e){return function(e){var t={edges:{destPrincipal:void 0,grpc:NaN,grpcErr:NaN,grpcPercentErr:NaN,grpcPercentReq:NaN,hasTraffic:void 0,http:NaN,http3xx:NaN,http4xx:NaN,http5xx:NaN,httpNoResponse:NaN,httpPercentErr:NaN,httpPercentReq:NaN,isMTLS:-1,protocol:void 0,responses:void 0,responseTime:NaN,sourcePrincipal:void 0,tcp:NaN,throughput:NaN},nodes:{aggregate:void 0,aggregateValue:void 0,app:void 0,destServices:void 0,grpcIn:NaN,grpcInErr:NaN,grpcOut:NaN,hasCB:void 0,hasFaultInjection:void 0,hasMissingSC:void 0,hasRequestRouting:void 0,hasRequestTimeout:void 0,hasTCPTrafficShifting:void 0,hasTrafficShifting:void 0,hasVS:void 0,health:void 0,httpIn:NaN,httpIn3xx:NaN,httpIn4xx:NaN,httpIn5xx:NaN,httpInNoResponse:NaN,httpOut:NaN,isBox:void 0,isDead:void 0,isIdle:void 0,isInaccessible:void 0,isIstio:void 0,isMisconfigured:void 0,isOutside:void 0,isRoot:void 0,isServiceEntry:void 0,service:void 0,tcpIn:NaN,tcpOut:NaN,version:void 0,workload:void 0}},a={grpc:{grpc:0,grpcErr:0,grpcNoResponse:0,grpcPercentErr:0,grpcPercentReq:0},http:{http:0,http3xx:0,http4xx:0,http5xx:0,httpNoResponse:0,httpPercentErr:0,httpPercentReq:0},tcp:{tcp:0}},n=function(e,t){var a,n=Object(C.a)({},e),r=t||Object.keys(n),i=Object($t.a)(r);try{for(i.s();!(a=i.n()).done;){var o=a.value;n[o]=Number(n[o])}}catch(s){i.e(s)}finally{i.f()}return n},r={};return e&&(e.nodes&&(r.nodes=e.nodes.map((function(e){var a=Object(C.a)({},e);if(a.data.traffic){var r=a.data.traffic;a.data.traffic=void 0,r.forEach((function(e){a.data=Object(C.a)(Object(C.a)({},n(e.rates)),a.data)}))}if(a.data.aggregate){var i=a.data.aggregate.split("=");a.data.aggregate=i[0],a.data.aggregateValue=i[1]}var o=!!_(a.data.namespace)||void 0;return a.data=Object(C.a)(Object(C.a)({isIstio:o},t.nodes),a.data),a}))),e.edges&&(r.edges=e.edges.map((function(e){var r=Object(C.a)({},e),i=e.data,o=i.traffic,s=Object(uo.a)(i,_f);return o&&(ot(o)&&(r.data=Object(C.a)(Object(C.a)(Object(C.a)({hasTraffic:!0,responses:o.responses},a[o.protocol]),n(o.rates)),n(s,["isMtls","responseTime","throughput"]))),r.data=Object(C.a)({protocol:o.protocol},r.data)),r.data=Object(C.a)(Object(C.a)({},t.edges),r.data),r})))),r}(e)})),this.fetchGraphData=function(e){var a=t.fetchParameters;if(t._fetchParams=Object(C.a)({},e),0===e.namespaces.length)return t._isLoading=t._isError=!1,t.graphElements=Gf,t.graphDuration=0,t.graphTimestamp=0,void t.emit("emptyNamespaces",e);var n={duration:e.duration+"s",graphType:e.graphType,includeIdleEdges:e.showIdleEdges,injectServiceNodes:e.injectServiceNodes},r=[];e.boxByCluster&&r.push(Je.CLUSTER),e.boxByNamespace&&r.push(Je.NAMESPACE),e.graphType!==Xe.APP&&e.graphType!==Xe.VERSIONED_APP||r.push(Je.APP),r.length>0&&(n.boxBy=r.join(",")),e.queryTime&&(n.queryTime=String(Math.floor(e.queryTime/1e3)));var i="deadNode,sidecarsCheck,serviceEntry,istio,healthConfig";e.showOperationNodes&&(i+=",aggregateNode"),!e.node&&e.showIdleNodes&&(i+=",idleNode"),e.showSecurity&&(i+=",securityPolicy"),e.edgeLabels.forEach((function(e){switch(e){case De.RESPONSE_TIME_AVERAGE:i+=",responseTime",n.responseTime="avg";break;case De.RESPONSE_TIME_P50:i+=",responseTime",n.responseTime="50";break;case De.RESPONSE_TIME_P95:i+=",responseTime",n.responseTime="95";break;case De.RESPONSE_TIME_P99:i+=",responseTime",n.responseTime="99";break;case De.THROUGHPUT_REQUEST:i+=",throughput",n.throughputType="request";break;case De.THROUGHPUT_RESPONSE:i+=",throughput",n.throughputType="response";break;case De.TRAFFIC_DISTRIBUTION:case De.TRAFFIC_RATE:}})),n.appenders=i,n.rateGrpc="none",n.rateHttp="none",n.rateTcp="none",e.trafficRates.forEach((function(e){switch(e){case ze.GRPC_RECEIVED:n.rateGrpc="received";break;case ze.GRPC_REQUEST:n.rateGrpc="requests";break;case ze.GRPC_SENT:n.rateGrpc="sent";break;case ze.GRPC_TOTAL:n.rateGrpc="total";break;case ze.HTTP_REQUEST:n.rateHttp="requests";break;case ze.TCP_RECEIVED:n.rateTcp="received";break;case ze.TCP_SENT:n.rateTcp="sent";break;case ze.TCP_TOTAL:n.rateTcp="total"}})),t._isLoading=!0,t._isError=!1;var o=a.namespaces.map((function(e){return e.name})).join()!==t.fetchParameters.namespaces.map((function(e){return e.name})).join()||a.node!==t.fetchParameters.node||a.graphType!==t.fetchParameters.graphType||a.includeHealth!==t.fetchParameters.includeHealth||a.injectServiceNodes!==t.fetchParameters.injectServiceNodes||a.showOperationNodes!==t.fetchParameters.showOperationNodes||a.showIdleNodes!==t.fetchParameters.showIdleNodes;o&&(t.graphElements=Gf,t.graphDuration=0,t.graphTimestamp=0),t.emit("loadStart",o,e),e.node?t.fetchDataForNode(n):t.fetchDataForNamespaces(n)},this.on=function(e,a){t.eventEmitter.on(e,a)},this.removeListener=function(e,a){t.eventEmitter.removeListener(e,a)},this.fetchForApp=function(e,a,n){var r=t.fetchForAppParams(e,a,n);r.showSecurity=!0,t.fetchGraphData(r)},this.fetchForAppParams=function(t,a,n){var r=e.defaultFetchParams(t,a);return r.graphType=Xe.APP,r.node.nodeType=Ze.APP,r.node.app=n,r},this.fetchForVersionedApp=function(e,a,n){var r=t.fetchForVersionedAppParams(e,a,n);r.showSecurity=!0,t.fetchGraphData(r)},this.fetchForVersionedAppParams=function(t,a,n){var r=e.defaultFetchParams(t,a);return r.edgeLabels=[De.RESPONSE_TIME_GROUP,De.RESPONSE_TIME_P95,De.THROUGHPUT_GROUP,De.THROUGHPUT_REQUEST,De.TRAFFIC_DISTRIBUTION,De.TRAFFIC_RATE],r.graphType=Xe.VERSIONED_APP,r.node.nodeType=Ze.APP,r.node.app=n,r},this.fetchForWorkload=function(e,a,n){var r=t.fetchForWorkloadParams(e,a,n);r.showSecurity=!0,t.fetchGraphData(r)},this.fetchForWorkloadParams=function(t,a,n){var r=e.defaultFetchParams(t,a);return r.edgeLabels=[De.RESPONSE_TIME_GROUP,De.RESPONSE_TIME_P95,De.THROUGHPUT_GROUP,De.THROUGHPUT_REQUEST,De.TRAFFIC_DISTRIBUTION,De.TRAFFIC_RATE],r.graphType=Xe.WORKLOAD,r.node.nodeType=Ze.WORKLOAD,r.node.workload=n,r},this.fetchForService=function(e,a,n){var r=t.fetchForServiceParams(e,a,n);r.showSecurity=!0,t.fetchGraphData(r)},this.fetchForServiceParams=function(t,a,n){var r=e.defaultFetchParams(t,a);return r.edgeLabels=[De.RESPONSE_TIME_GROUP,De.RESPONSE_TIME_P95,De.THROUGHPUT_GROUP,De.THROUGHPUT_REQUEST,De.TRAFFIC_DISTRIBUTION,De.TRAFFIC_RATE],r.graphType=Xe.WORKLOAD,r.node.nodeType=Ze.SERVICE,r.node.service=n,r},this.fetchForNamespace=function(e,a){var n=t.fetchForNamespaceParams(e,a);t.fetchGraphData(n)},this.fetchForNamespaceParams=function(t,a){var n=e.defaultFetchParams(t,a);return n.graphType=Xe.WORKLOAD,n.showSecurity=!0,n},this.emit=function(e){for(var a,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];(a=t.eventEmitter).emit.apply(a,[e].concat(r))},this.fetchDataForNamespaces=function(e){e.namespaces=t.fetchParameters.namespaces.map((function(e){return e.name})).join(","),t.promiseRegistry.register("CURRENT_REQUEST",An(e)).then((function(e){var a=e.data;t.graphElements=a&&a.elements?a.elements:Gf,t.graphTimestamp=a&&a.timestamp?a.timestamp:0,t.graphDuration=a&&a.duration?a.duration:0;var n=t.graphData;t.fetchParameters.includeHealth?t.fetchHealth(n):(t._isLoading=t._isError=!1,t.emit("fetchSuccess",t.graphTimestamp,t.graphDuration,n,t.fetchParameters))}),(function(e){t._isLoading=!1,e.isCanceled||(t._isError=!0,t._errorMessage=On(e),_n("Cannot load the graph",e),t.emit("fetchError","Cannot load the graph: ".concat(t.errorMessage),t.fetchParameters))}))},this.fetchDataForNode=function(e){t.promiseRegistry.register("CURRENT_REQUEST",function(e,t){switch(e.nodeType){case Ze.AGGREGATE:return e.service?Xa(K.GET,qa.aggregateByServiceGraphElements(e.namespace.name,e.aggregate,e.aggregateValue,e.service),t,{}):Xa(K.GET,qa.aggregateGraphElements(e.namespace.name,e.aggregate,e.aggregateValue),t,{});case Ze.APP:case Ze.BOX:return Xa(K.GET,qa.appGraphElements(e.namespace.name,e.app,e.version),t,{});case Ze.SERVICE:return Xa(K.GET,qa.serviceGraphElements(e.namespace.name,e.service),t,{});case Ze.WORKLOAD:return Xa(K.GET,qa.workloadGraphElements(e.namespace.name,e.workload),t,{});default:return An(Object(C.a)({namespaces:e.namespace.name},t))}}(t.fetchParameters.node,e)).then((function(e){var a=e.data;t.graphElements=a&&a.elements?a.elements:Gf,t.graphTimestamp=a&&a.timestamp?a.timestamp:0,t.graphDuration=a&&a.duration?a.duration:0;var n=t.graphData;t.fetchParameters.includeHealth?t.fetchHealth(n):(t._isLoading=t._isError=!1,t.emit("fetchSuccess",t.graphTimestamp,t.graphDuration,n,t.fetchParameters))}),(function(e){t._isLoading=!1,e.isCanceled||(t._isError=!0,t._errorMessage=On(e),_n("Cannot load the graph",e),t.emit("fetchError",t.errorMessage,t.fetchParameters))}))},this.fetchHealth=function(e){if(!e.nodes||0===e.nodes.length)return t._isLoading=!1,void t.emit("fetchSuccess",t.graphTimestamp,t.graphDuration,e,t.fetchParameters);var a,n=t.graphDuration,r=t.graphTimestamp,i=new Map,o=new Map,s=new Map,l=new Map,c=Object($t.a)(e.nodes);try{for(c.s();!(a=c.n()).done;){var u=a.value;if(!u.data.isInaccessible){var p=u.data.namespace,d=u.data.nodeType,m=u.data.workload,h=m&&""!==m&&m!==it;if(d===Ze.WORKLOAD||d===Ze.APP&&h){var f=s.get(p),g={node:u,key:u.data.workload};if(f)l.get(f).push(g);else f=En(p,n,r),s.set(p,f),l.set(f,[g])}else switch(d){case Ze.APP:var v=i.get(p),E={node:u,key:u.data.app};if(v)l.get(v).push(E);else v=gn(p,n,r),i.set(p,v),l.set(v,[E]);break;case Ze.BOX:if(u.data.isBox===Je.APP){var b=i.get(p),y={node:u,key:u.data.app};if(b)l.get(b).push(y);else b=gn(p,n,r),i.set(p,b),l.set(b,[y])}break;case Ze.SERVICE:var C=o.get(p),S={node:u,key:u.data.service};if(C)l.get(C).push(S);else C=vn(p,n,r),o.set(p,C),l.set(C,[S])}}}}catch(T){c.e(T)}finally{c.f()}var A=Array.from(i.values());A=(A=A.concat(Array.from(o.values()))).concat(Array.from(s.values())),(new yr).registerAll("HEALTH_PROMISES",A).then((function(a){a.forEach((function(e,t){l.get(A[t]).forEach((function(t){var a=e[t.key];a?(t.node.data.health=a,t.node.data.healthStatus=a.getGlobalStatus().name):(t.node.data.healthStatus=Na.name,console.debug("No health found for [".concat(t.node.data.nodeType,"] [").concat(t.key,"]")))}))})),t._isLoading=!1,t.emit("fetchSuccess",t.graphTimestamp,t.graphDuration,e,t.fetchParameters)}),(function(e){t._isLoading=!1,e.isCanceled||(t._isError=!0,t._errorMessage=On(e),_n("Cannot load the graph [health]",e),t.emit("fetchError",t.errorMessage,t.fetchParameters))}))},this.graphElements=Gf,this.graphDuration=0,this.graphTimestamp=0,this.eventEmitter=new Hf.a,this.promiseRegistry=new yr,this._errorMessage=null,this._fetchParams={duration:0,edgeLabels:[],graphType:Xe.VERSIONED_APP,includeHealth:!0,injectServiceNodes:!0,namespaces:[],showIdleEdges:!1,showIdleNodes:!1,showOperationNodes:!1,showSecurity:!1,trafficRates:[]},this._isError=this._isLoading=!1}return Object(l.a)(e,[{key:"graphData",get:function(){return this.decoratedData(this.graphElements)}},{key:"graphDefinition",get:function(){return{duration:this.graphDuration,elements:this.graphElements,timestamp:this.graphTimestamp,graphType:this.fetchParameters.graphType}}},{key:"errorMessage",get:function(){return this._errorMessage}},{key:"fetchParameters",get:function(){return this._fetchParams}},{key:"isError",get:function(){return this._isError}},{key:"isLoading",get:function(){return this._isLoading}}],[{key:"defaultFetchParams",value:function(e,t){return{boxByCluster:!1,boxByNamespace:!1,duration:e,edgeLabels:[],graphType:Xe.WORKLOAD,includeHealth:!0,injectServiceNodes:!0,namespaces:[{name:t}],node:{app:"",namespace:{name:t},nodeType:Ze.UNKNOWN,service:"",version:"",workload:""},showIdleEdges:!1,showIdleNodes:!1,showOperationNodes:!1,showSecurity:!1,trafficRates:$e}}}]),e}(),Uf=a(1489),Bf=a(1490),Wf=a(1491),qf=function(e,t,a){return e<t?t:e>a?a:e},Kf=function(e,t,a,n){var r=Math.pow(1-n,2),i=2*(1-n)*n,o=n*n;return{x:r*e.x+i*t.x+o*a.x,y:r*e.y+i*t.y+o*a.y}},zf=function(e,t,a){var n=e.x-2*t.x+a.x,r=e.y-2*t.y+a.y,i=2*t.x-2*e.x,o=2*t.y-2*e.y,s=4*(n*n+r*r),l=4*(n*i+r*o),c=i*i+o*o,u=2*Math.sqrt(s+l+c),p=Math.sqrt(s),d=2*s*p,m=2*Math.sqrt(c),h=l/p;return(d*u+p*l*(u-m)+(4*c*s-l*l)*Math.log((2*p+h+u)/(h+m)))/(4*d)},Yf=function(e,t){return Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)},Qf=function(e,t){return e.length>0?e.reduce((function(e,a){return e+t(a)}),0)/e.length:void 0},Xf=a(797),Jf=a(1487),Zf=Object(Jn.a)({textAlign:"left"}),$f=Object(Jn.a)({textAlign:"left",fontSize:"16px",borderBottom:"1px solid black"}),eg=Object(Jn.a)({textAlign:"left",fontSize:"14px",color:"#737679",fontWeight:700,paddingTop:2,paddingBottom:4}),tg=Object(Jn.a)({textAlign:"left",fontSize:"12px",textDecoration:"none",$nest:{"&:hover":{backgroundColor:"#def3ff",color:"#4d5258"}}}),ag=Object(Jn.a)({color:"#363636"}),ng=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).onClick=function(t){e.props.contextMenu.hide(0)},e}return Object(l.a)(a,[{key:"createMenuItem",value:function(e,t){var a,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"_self",i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o={className:ag,children:t,onClick:this.onClick,target:n};return a=i?r.createElement("a",Object.assign({href:e,rel:"noreferrer noopener"},o),o.children," ",r.createElement(Jf.a,null)):r.createElement(ar.a,Object.assign({to:e},o)),r.createElement("div",{key:t,className:tg},a)}},{key:"render",value:function(){var e=this,t=a.derivedValuesFromProps(this.props);if(!t||this.props.isInaccessible)return this.props.contextMenu.disable(),null;var n=sg(t,this.props.jaegerInfo),i=r.createElement(r.Fragment,null,r.createElement("div",{className:eg},"Show"),n.map((function(t){return e.createMenuItem(t.url,t.text,t.target,t.external)})));return r.createElement("div",{className:Zf},r.createElement("div",{className:$f},r.createElement("strong",null,t.name)),i)}}],[{key:"derivedValuesFromProps",value:function(e){var t=e.cluster,a=e.isServiceEntry?e.isServiceEntry.namespace:e.namespace,n=void 0,r=void 0;switch(e.nodeType){case Ze.APP:case Ze.BOX:e.workload&&e.parent?(n=e.workload,r=ce.WORKLOADS):(r=ce.APPLICATIONS,n=e.app);break;case Ze.SERVICE:r=e.isServiceEntry?ce.SERVICEENTRIES:ce.SERVICES,n=e.service;break;case Ze.WORKLOAD:n=e.workload,r=ce.WORKLOADS}return r&&n?{cluster:t,namespace:a,type:r,name:n}:void 0}}]),a}(r.PureComponent),rg=function(e,t,a,n){return"".concat(a,"/search?service=").concat(n).concat(t?".".concat(e):"")},ig=function(e){e.external?window.open(e.url,e.target):U.push(e.url)},og=function(e,t){var a=ng.derivedValuesFromProps(e);return a?sg(a,t):[]},sg=function(e,t){var a,n=[],r=e.namespace,i=e.type,o=e.name,s=e.cluster,l="/namespaces/".concat(r,"/").concat(i,"/").concat(o);if(n.push({text:"Details",url:l}),i!==ce.SERVICEENTRIES&&(n.push({text:"Traffic",url:"".concat(l,"?tab=traffic")}),i===ce.WORKLOADS&&n.push({text:"Logs",url:"".concat(l,"?tab=logs")}),n.push({text:"Inbound Metrics",url:"".concat(l,"?tab=").concat(i===ce.SERVICES?"metrics":"in_metrics")}),i!==ce.SERVICES&&n.push({text:"Outbound Metrics",url:"".concat(l,"?tab=out_metrics")}),i===ce.APPLICATIONS&&t&&t.enabled&&(t.integration?n.push({text:"Traces",url:"".concat(l,"?tab=traces")}):t.url&&n.push({text:"Show Traces",url:rg(r,t.namespaceSelector,t.url,o),external:!0,target:"_blank"}))),(null===(a=j.clusterInfo)||void 0===a?void 0:a.name)&&s!==j.clusterInfo.name){var c,u=j.clusters[s],p=null===u||void 0===u||null===(c=u.kialiInstances)||void 0===c?void 0:c.find((function(e){return 0!==e.url.length}));if(void 0===p)n=n.filter((function(e){return"_blank"===e.target}));else for(var d=p.url.replace(/\/$/g,"")+"/console",m=0;m<n.length;m++)"_blank"!==n[m].target&&(n[m].external=!0,n[m].target="_blank",n[m].url=d+n[m].url)}return n},lg=Object(h.b)((function(e){return{jaegerInfo:e.jaegerState.info}}))(ng),cg=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).contextMenuRef=void 0,n.handleDocumentMouseUp=function(e){if(2!==e.button){var t=n.getCurrentContextMenu();if(t){if(e.target&&t.popper.contains(e.target))return;t.hide()}}},n.handleContextMenu=function(e){var t=n.getCurrentContextMenu();return t&&e.target&&t.popper.contains(e.target)&&e.preventDefault(),!0},n.contextMenuRef=r.createRef(),n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){document.addEventListener("mouseup",this.handleDocumentMouseUp)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mouseup",this.handleDocumentMouseUp)}},{key:"connectCy",value:function(e){var t=this;e.on("cxttapstart taphold",(function(a){if(a.preventDefault(),a.target){var n,r=t.getCurrentContextMenu();r&&r.hide(0),a.target===e?n=void 0:a.target.isNode()&&a.target.isParent()?n=t.props.groupContextMenuContent:a.target.isNode()?n=t.props.nodeContextMenuContent:a.target.isEdge()&&(n=t.props.edgeContextMenuContent),n&&og(Object(C.a)({},a.target.data())).length>0&&t.makeContextMenu(n,a.target)}return!1}))}},{key:"render",value:function(){return r.createElement("div",{className:"hidden"},r.createElement("div",{ref:this.contextMenuRef}))}},{key:"getCurrentContextMenu",value:function(){var e,t;return null===(e=this.contextMenuRef)||void 0===e||null===(t=e.current)||void 0===t?void 0:t._contextMenu}},{key:"setCurrentContextMenu",value:function(e){this.contextMenuRef.current._contextMenu=e}},{key:"tippyDistance",value:function(e){return void 0===e.isNode||e.isNode()?10:-30}},{key:"addContextMenuEventListener",value:function(){document.addEventListener("contextmenu",this.handleContextMenu)}},{key:"removeContextMenuEventListener",value:function(){document.removeEventListener("contextmenu",this.handleContextMenu)}},{key:"makeContextMenu",value:function(e,t){var a=this;this.addContextMenuEventListener();var n=this.contextMenuRef.current,i=Object(Xf.a)(t.popperRef(),{content:n,trigger:"manual",arrow:!0,placement:"bottom",hideOnClick:!1,multiple:!1,sticky:!0,interactive:!0,theme:"light-border",size:"large",distance:this.tippyDistance(t)}).instances[0],s=r.createElement(h.a,{store:Yt},r.createElement(f.d,{history:U},r.createElement(e,Object.assign({element:t,contextMenu:i},t.data()))));o.render(s,n,(function(){a.setCurrentContextMenu(i),i.show(),setTimeout((function(){a.removeContextMenuEventListener()}),0)}))}}]),a}(r.PureComponent),ug=function(){function e(){Object(s.a)(this,e)}return Object(l.a)(e,null,[{key:"getLayout",value:function(){return{name:"cola",animate:!1,fit:!1,flow:{axis:"x"},nodeDimensionsIncludeLabels:!0,randomize:!1}}}]),e}(),pg=function(){function e(){Object(s.a)(this,e)}return Object(l.a)(e,null,[{key:"getLayout",value:function(){return{name:"cose-bilkent",animate:!1,fit:!1,nodeDimensionsIncludeLabels:!0}}}]),e}(),dg={cola:ug.getLayout(),dagre:lt.getLayout(),"cose-bilkent":pg.getLayout()},mg=function(e){return dg.hasOwnProperty(e)?dg[e]:dg.dagre},hg="destPrincipal",fg="grpc",gg="grpcErr",vg="grpcNoResponse",Eg="grpcPercentErr",bg="grpcPercentReq",yg="hasTraffic",Cg="http",Sg="http3xx",Ag="http4xx",Tg="http5xx",Og="httpNoResponse",Ig="httpPercentErr",wg="httpPercentReq",Rg="isMTLS",kg="protocol",xg="responseTime",Ng="sourcePrincipal",jg="tcp",Pg="throughput",Lg="aggregate",Dg="aggregateValue",Fg="app",_g="cluster",Mg="destServices",Hg="grpcIn",Gg="grpcInErr",Vg="grpcInNoResponse",Ug="grpcOut",Bg="hasCB",Wg="hasFaultInjection",qg="hasMissingSC",Kg="hasRequestRouting",zg="hasRequestTimeout",Yg="hasTCPTrafficShifting",Qg="hasTrafficShifting",Xg="hasVS",Jg="healthStatus",Zg="httpIn",$g="httpIn3xx",ev="httpIn4xx",tv="httpIn5xx",av="httpInNoResponse",nv="httpOut",rv="id",iv="isBox",ov="isDead",sv="isIdle",lv="isInaccessible",cv="isIstio",uv="isOutside",pv="isRoot",dv="isServiceEntry",mv="namespace",hv="nodeType",fv="service",gv="tcpIn",vv="tcpOut",Ev="version",bv="workload",yv=25,Cv=2.5,Sv=function(e,t){e.fit(t,yv),e.zoom()>Cv&&(e.zoom(Cv),t&&t.length?e.center(t):e.center()),e.emit("fit")},Av=function(e,t){e.nodeHtmlLabel().updateNodeLabel(e.nodes());var a,n,r=function(e){return dg.hasOwnProperty(e.name)?dg[e.name]:dg.dagre}(t);return a=(n=e.nodes("$node > node").length>0?e.layout(Object(C.a)(Object(C.a)({},r),{},{name:"box-layout",appBoxLayout:"dagre",defaultLayout:t.name})):e.layout(r)).promiseOn("layoutstop"),n.run(),a},Tv=function(e){return e.data()},Ov=function(e){return e.data()},Iv=function(e){return!("cy"in e)},wv=a(798),Rv=a.n(wv),kv=a(799),xv=a.n(kv),Nv=be.istio.mtls.ascii,jv="Verdana,Arial,Helvetica,sans-serif,pficon",Pv=be.istio.circuitBreaker.className,Lv=be.istio.faultInjection.className,Dv=be.istio.gateway.className,Fv=be.istio.missingSidecar.className,_v=be.istio.root.className,Mv=be.istio.virtualService.className,Hv=be.istio.requestRouting.className,Gv=be.istio.requestTimeout.className,Vv=be.istio.trafficShifting.className,Uv=nt.Black1000,Bv=nt.White,Wv=nt.White,qv=nt.Black700,Kv=nt.Purple400,zv=nt.White,Yv=function(e){return""===e?Object(Jn.a)({marginLeft:"1px"}):Object(Jn.a)({marginRight:"2px"})},Qv=Object(Jn.a)({alignItems:"center",backgroundColor:Kv,borderTopLeftRadius:"3px",borderBottomLeftRadius:"3px",color:zv,display:"flex",fontSize:"12px",padding:"3px 3px"}),Xv=Object(Jn.a)({backgroundColor:nt.Badge,fontSize:"10px",marginRight:"5px",minWidth:"24px",paddingLeft:"0px",paddingRight:"0px"}),Jv=Object(Jn.a)({alignItems:"center",backgroundColor:Wv,borderRadius:"3px",borderWidth:"1px",color:Uv,display:"flex",fontSize:"8px",padding:"3px 5px"}),Zv=Object(Jn.a)({backgroundColor:qv,color:Bv,fontSize:"10px"}),$v=Object(Jn.a)({borderBottomLeftRadius:"unset",borderColor:Kv,borderStyle:"solid",borderTopLeftRadius:"unset",borderLeft:"0"}),eE=Object(Jn.a)({borderTop:"1px solid ".concat(nt.Black600),textAlign:"initial",fontSize:"8px",marginTop:"0.5em",paddingTop:"0.5em",$nest:{"& div:last-child":{display:"none"},"&:hover div:last-child":{display:"block"},"&:hover div:first-child":{display:"none"}}}),tE=Object(Jn.a)({borderRadius:"3px",boxShadow:"0 2px 4px 0 rgba(0, 0, 0, 0.2), 0 2px 8px 0 rgba(0, 0, 0, 0.19)",display:"inline-flex",fontFamily:"Verdana,Arial,Helvetica,sans-serif,pficon",fontSize:"0",fontWeight:"normal",marginTop:"4px",lineHeight:"11px",textAlign:"center"}),aE=Object(Jn.a)({marginTop:"13px"}),nE=function(){function e(){Object(s.a)(this,e)}return Object(l.a)(e,null,[{key:"options",value:function(){return{wheelSensitivity:.1,autounselectify:!1,autoungrabify:!0}}},{key:"getNodeLabel",value:function(e){var t,a,n,r,i,o,s,l,c=function(e){return e.cy().scratch("_global")}(e),u=Ov(e),p=u.app||"",d=u.cluster,m=u.namespace,h=u.nodeType,f=u.service||"",g=u.version||"",v=u.workload||"",E=u.isBox,b=u.parent,y=b?e.parent()[0]:void 0,C=y?y.data().isBox:void 0,S=y&&y.parent()?y.parent()[0]:void 0,A=S?S.data().isBox:void 0,T=C===Je.APP,O=C===Je.NAMESPACE||A===Je.NAMESPACE,I=c.activeNamespaces.length>1,w=u.isOutside,R="";(c.showMissingSidecars&&u.hasMissingSC&&(R='<span class="'.concat(Fv," ").concat(Yv(R),'"></span> ').concat(R)),c.showVirtualServices)&&(u.hasCB&&(R='<span class="'.concat(Pv," ").concat(Yv(R),'"></span> ').concat(R)),u.hasVS&&(u.hasFaultInjection||u.hasRequestRouting||u.hasRequestTimeout||u.hasTCPTrafficShifting||u.hasTrafficShifting?(u.hasFaultInjection&&(R='<span class="'.concat(Lv," ").concat(Yv(R),'"></span> ').concat(R)),(u.hasTrafficShifting||u.hasTCPTrafficShifting)&&(R='<span class="'.concat(Vv," ").concat(Yv(R),'"></span> ').concat(R)),u.hasRequestTimeout&&(R='<span class="'.concat(Gv," ").concat(Yv(R),'"></span> ').concat(R)),u.hasRequestRouting&&(R='<span class="'.concat(Hv," ").concat(Yv(R),'"></span> ').concat(R))):R='<span class="'.concat(Mv," ").concat(Yv(R),'"></span> ').concat(R)));u.isRoot&&(void 0!==(null===(o=u.isGateway)||void 0===o||null===(s=o.ingressInfo)||void 0===s||null===(l=s.hostnames)||void 0===l?void 0:l.length)&&(R="<span class='".concat(Dv," ").concat(Yv(R),"'></span> ").concat(R)),R="<span class='".concat(_v," ").concat(Yv(R),"'></span> ").concat(R));var k=R.length>0;k&&(R="<div class=".concat(Qv,">").concat(R,"</div>"));var x="";e.hasClass("mousehighlight")&&(x+="font-size: 11px;"),e.hasClass("mousedim")&&(x+="opacity: 0.6;");var N="";e.hasClass("mousehighlight")&&(N+="font-size: "+(E&&E!==Je.APP?"13px":"11px")+";");var j=[];switch(!I&&!w||!m||m===it||T||O||E===Je.NAMESPACE||j.push("(".concat(m,")")),d&&d!==it&&d!==c.homeCluster&&!b&&E!==Je.CLUSTER&&j.push("(".concat(d,")")),h){case Ze.AGGREGATE:j.unshift(u.aggregateValue);break;case Ze.APP:T?c.graphType===Xe.APP?j.unshift(p):g&&g!==it?j.unshift(g):j.unshift(v||p):(c.graphType===Xe.APP||g===it||j.unshift(g),j.unshift(p));break;case Ze.BOX:switch(E){case Je.APP:j.unshift(p);break;case Je.CLUSTER:j.unshift(u.cluster);break;case Je.NAMESPACE:j.unshift(u.namespace)}break;case Ze.SERVICE:j.unshift(f);break;case Ze.UNKNOWN:j.unshift(it);break;case Ze.WORKLOAD:j.unshift(v);break;default:j.unshift("error")}var P=j.join("<br/>"),L=k?"".concat(Jv," ").concat($v):"".concat(Jv),D="";if(E){var F="";switch(E){case Je.APP:F=cc.App.badge,D+="font-size: ".concat("8px",";");break;case Je.CLUSTER:F=cc.Cluster.badge;break;case Je.NAMESPACE:F=cc.Namespace.badge;break;default:console.warn("GraphSyles: Unexpected box [".concat(E,"] "))}var _='<span class="pf-c-badge pf-m-unread '.concat(Xv,'" style="').concat(D,'">').concat(F,"</span>"),M='<span class="'.concat(L," ").concat(Zv,'" style=" ').concat(D).concat(N,'">').concat(_).concat(P,"</span>");return'<div class="'.concat(tE," ").concat(aE,'" style="').concat(x,'">').concat(R).concat(M,"</div>")}var H=[];null===(t=u.hasVS)||void 0===t||null===(a=t.hostnames)||void 0===a||a.forEach((function(e){return H.push("*"===e?"* (all hosts)":e)})),null===(n=u.isGateway)||void 0===n||null===(r=n.ingressInfo)||void 0===r||null===(i=r.hostnames)||void 0===i||i.forEach((function(e){return H.push("*"===e?"* (all hosts)":e)}));var G="";if(0!==H.length){var V=H;V.length>fe.graph.maxHosts&&(V=H.slice(0,fe.graph.maxHosts)).push(H.length-fe.graph.maxHosts===1?"1 more host...":"".concat(H.length-fe.graph.maxHosts," more hosts...")),G="<div class='".concat(eE,"'><div>").concat(H.length," ").concat(1===H.length?"host":"hosts","</div><div>").concat(V.join("<br/>"),"</div></div>")}var U='<div class="'.concat(L,'" style="display: block; ').concat(N,'"><div>').concat(P,"</div><div></div>").concat(G,"</div></div>");return'<div class="'.concat(tE,'" style="').concat(x,'">').concat(R).concat(U,"</div>")}},{key:"htmlNodeLabels",value:function(e){var t=this;return[{query:"node:visible",halign:"center",valign:"bottom",halignBox:"center",valignBox:"bottom",tpl:function(a){return t.getNodeLabel(e.$id(a.id))}}]}},{key:"styles",value:function(){e.setRuntimeColors();var t=function(e){return e.cy().scratch("_global")},a=function(e){var a=Tv(e),n=t(e);if(!a.hasTraffic)return Yh;if("tcp"===a.protocol)return Jh;if("grpc"===a.protocol&&!n.trafficRates.includes(ze.GRPC_REQUEST))return zh;switch(function(e,t,a){var n=t.hasHealthConfig?new sa(t.hasHealthConfig):void 0,r=n&&n.toleranceConfig?n.toleranceConfig:Aa(t.namespace,t[t.nodeType],t.nodeType).tolerance,i=a.hasHealthConfig?new sa(a.hasHealthConfig):void 0,o=i&&i.toleranceConfig?i.toleranceConfig:Aa(a.namespace,a[a.nodeType],a.nodeType).tolerance,s=r.filter((function(e){return Ca(e.direction,"outbound")})),l=o.filter((function(e){return Ca(e.direction,"inbound")})),c=Oa(Ta(e.responses,e.protocol),s,!0),u=Oa(Ta(e.responses,e.protocol),l,!0),p=fa(c,e.responses),d=fa(u,e.responses);return p.status.status.priority>d.status.status.priority?p.status:d.status}(a,Ov(e.source()),Ov(e.target())).status){case wa:return Xh;case Ra:return Qh;default:return zh}},n=function(e,a){var n,r=t(e),u=r.edgeLabels,p=Tv(e),d=a||u.filter((function(e){return e!==De.RESPONSE_TIME_GROUP&&e!==De.THROUGHPUT_GROUP})).length>1,m=[];if(u.includes(De.TRAFFIC_RATE)){var h=0,f=0;if(p.http>0?(h=p.http,f=p.httpPercentErr>0?p.httpPercentErr:0):p.grpc>0?(h=p.grpc,f=p.grpcPercentErr>0?p.grpcPercentErr:0):p.tcp>0&&(h=p.tcp),h>0)if(f>0)m.push("".concat(i(h,d),"\n").concat(o(f)));else switch(p.protocol){case Le.GRPC:r.trafficRates.includes(ze.GRPC_REQUEST)?m.push(i(h,d)):m.push(i(h,d,"mps"));break;case Le.TCP:m.push(s(h,d));break;default:m.push(i(h,d))}}if(u.includes(De.RESPONSE_TIME_GROUP)){var g=p.responseTime;isNaN(g)||Number.isInteger(g)||console.log("Unexpected string responseTime=|".concat(g,"|"));var v=parseInt(String(p.responseTime)),E=v>0?v:0;E&&E>0&&m.push(c(E))}if(u.includes(De.THROUGHPUT_GROUP)){var b=p.throughput;b>0&&m.push(s(b,d))}u.includes(De.TRAFFIC_DISTRIBUTION)&&(p.httpPercentReq>0?n=p.httpPercentReq:p.grpcPercentReq>0&&(n=p.grpcPercentReq),n>0&&n<100&&m.push(l(n)));var y=m.join("\n");if(a){var C=p.protocol;y=C?"".concat(C,"\n").concat(y):y}var S=p.isMTLS,T=!1;if((r.showSecurity&&p.hasTraffic&&S&&S>0&&(T=!0,y="".concat(Nv,"\n").concat(y)),p.hasTraffic&&p.responses)&&Ov(e.target()).hasCB){var O,I=p.responses,w=Object($t.a)(A.a.keys(I));try{for(w.s();!(O=w.n()).done;){var R=O.value;if(I[R].UO||I[R].UH){y=T?"".concat(Pv," ").concat(y):"".concat(Pv,"\n").concat(y);break}}}catch(k){w.e(k)}finally{w.f()}}return y},r=function(e){if(!e.includes("."))return e;for(;e.endsWith("0");)e=e.slice(0,-1);return e.endsWith(".")?e=e.slice(0,-1):e},i=function(e,t,a){var n=r(e.toFixed(2));return t?"".concat(n," ").concat(a||"rps"):n},o=function(e){return"".concat(r(e.toFixed(e<1?1:0)),"% err")},s=function(e,t){if(e<1024){var a=e<1?r(e.toFixed(2)):e.toFixed(0);return t?"".concat(a," bps"):a}var n=r((e/1024).toFixed(2));return t?"".concat(n," kps"):n},l=function(e){return"".concat(r(e.toFixed(1)),"%")},c=function(e){return e<1e3?"".concat(e.toFixed(0),"ms"):"".concat(r((e/1e3).toFixed(2)),"s")},u=function(e){var t=Ov(e);switch(t.nodeType){case Ze.AGGREGATE:return"round-pentagon";case Ze.APP:case Ze.BOX:return"round-rectangle";case Ze.SERVICE:return t.isServiceEntry?"round-tag":"round-triangle";case Ze.UNKNOWN:case Ze.WORKLOAD:default:return"ellipse"}},p={"border-color":function(e){switch(e.data(Jg)){case Ra.name:return tf;case wa.name:return af;default:return rf}},"border-width":"3px"};return[{selector:"node",css:{"background-color":of,"background-image":function(e){return function(e){var t=Ov(e),a=t.isInaccessible,n=t.isServiceEntry,r=t.isBox;return!a||n||r?t.isOutside&&!r?Rv.a:"none":xv.a}(e)},"background-width":"80%","background-height":"80%","background-position-x":function(e){return"round-tag"===u(e)?"0":"50%"},"background-position-y":function(e){return"round-triangle"===u(e)?"6px":"50%"},"border-color":function(e){return function(e){var t=e.data(iv);if(t&&t!==Je.APP)return ef;switch(e.data(Jg)){case Ra.name:return tf;case wa.name:return af;default:return $h}}(e)},"border-style":function(e){return Ov(e).isIdle?"dotted":"solid"},"border-width":"1px",ghost:"yes","ghost-offset-x":1,"ghost-offset-y":1,"ghost-opacity":.4,height:"25px",shape:function(e){return u(e)},width:"25px","z-index":10}},{selector:'node[isBox="'.concat(Je.CLUSTER,'"]'),css:{"background-color":lf}},{selector:'node[isBox="'.concat(Je.NAMESPACE,'"]'),css:{"background-color":cf}},{selector:'node[isBox="'.concat(Je.APP,'"]'),css:{"background-color":sf}},{selector:"node:selected",style:p},{selector:"node.".concat("mousehighlight"),style:{"font-size":"11px"}},{selector:"node.".concat("mousehighlight","[^isBox]"),style:{"background-color":function(e){switch(e.data(Jg)){case Ra.name:return pf;case wa.name:return df;default:return uf}},"border-color":function(e){switch(e.data(Jg)){case Ra.name:return tf;case wa.name:return af;default:return nf}}}},{selector:"node.".concat("mousedim"),style:{opacity:.6}},{selector:"edge",css:{"curve-style":"bezier","font-family":jv,"font-size":"6px",label:function(e){return n(e)},"line-color":function(e){return a(e)},"line-style":"solid","target-arrow-shape":"vee","target-arrow-color":function(e){return a(e)},"text-events":"yes","text-outline-color":Zh,"text-outline-width":"1px","text-wrap":"wrap",width:2}},{selector:"edge:selected",css:{width:4,label:function(e){return n(e,!0)}}},{selector:'edge[protocol="tcp"]',css:{"target-arrow-shape":"triangle-cross","line-style":"solid"}},{selector:"edge.".concat("mousehighlight"),style:{"font-size":"10px"}},{selector:"edge.".concat("mousehover"),style:{label:function(e){return n(e,!0)}}},{selector:"edge.".concat("mousedim"),style:{opacity:.3}},{selector:"*.find[^isBox]",style:{"overlay-color":rt.Gold400,"overlay-padding":"7px","overlay-opacity":.3}},{selector:"*.span[^isBox]",style:{"overlay-color":rt.Purple200,"overlay-padding":"7px","overlay-opacity":.3}}]}}]),e}();nE.runtimeColorsSet=void 0,nE.setRuntimeColors=function(){nE.runtimeColorsSet||(nE.runtimeColorsSet=!0,zh=rt.Success,Yh=rt.Black500,Qh=rt.Warning,Xh=rt.Danger,Jh=rt.Blue600,Zh=rt.White,$h=rt.Black400,ef=rt.Black600,tf=rt.Warning,af=rt.Danger,nf=rt.Blue300,rf=rt.Blue300,of=rt.White,sf=rt.White,lf=rt.Black200,cf=rt.Black100,uf=rt.Blue50,pf="#fdf2e5",df="#ffe6e6")};var rE=a(800),iE=a.n(rE),oE=a(206),sE=a.n(oE),lE=a(801),cE=a.n(lE),uE=a(802),pE=a.n(uE),dE=a(803),mE=a.n(dE),hE=function(){function e(){Object(s.a)(this,e),this.nextId=0,this.generatedMap={}}return Object(l.a)(e,[{key:"getEdge",value:function(e,t,a){var n=this.normalizeToParent(e,t).id(),r=this.normalizeToParent(e,a).id();if(n===r)return!1;var i="".concat(n,"->").concat(r);return!this.generatedMap[i]&&(this.generatedMap[i]=!0,{group:"edges",data:{id:"synthetic-edge-"+this.nextId++,source:n,target:r}})}},{key:"normalizeToParent",value:function(e,t){var a=t.parent();return a&&a.data(iv)===e?a:t}}]),e}(),fE=function(){function e(t){Object(s.a)(this,e),this.appBoxLayout=void 0,this.clusterBoxLayout=void 0,this.defaultLayout=void 0,this.namespaceBoxLayout=void 0,this.cy=void 0,this.elements=void 0,this.syntheticEdgeGenerator=void 0,this.appBoxLayout=t.appBoxLayout||t.defaultLayout,this.clusterBoxLayout=t.clusterBoxLayout||t.defaultLayout,this.defaultLayout=t.defaultLayout,this.namespaceBoxLayout=t.namespaceBoxLayout||t.defaultLayout,this.cy=t.cy,this.elements=t.eles,this.syntheticEdgeGenerator=new hE}return Object(l.a)(e,[{key:"run",value:function(){this.runAsync()}},{key:"emit",value:function(e){}},{key:"runAsync",value:function(){var e=Object(Zt.a)(Jt.a.mark((function e(){var t,a,n,r,i,o=this;return Jt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.cy.collection(),a=this.cy.collection(),n=this.cy.collection(),e.next=5,this.layoutBoxType(Je.APP);case 5:return r=e.sent,t=t.add(r.boxNodes),a=a.add(r.removedElements),n=n.add(r.syntheticEdges),e.next=11,this.layoutBoxType(Je.NAMESPACE);case 11:return r=e.sent,t=t.add(r.boxNodes),a=a.add(r.removedElements),n=n.add(r.syntheticEdges),e.next=17,this.layoutBoxType(Je.CLUSTER);case 17:r=e.sent,t=t.add(r.boxNodes),a=a.add(r.removedElements),n=n.add(r.syntheticEdges),this.cy.collection().add(this.elements).subtract(a).add(n).position({x:0,y:0}),(i=this.cy.layout(Object(C.a)(Object(C.a)({},mg(this.defaultLayout)),{},{eles:this.cy.elements()}))).one("layoutstop",(function(e){t.each((function(e){e.scratch("box-layout.parent_position",Object(C.a)({},e.position()))})),a.restore(),o.cy.remove(n),t.each((function(e){var t=e.scratch("box-layout.parent_position");e.children().each((function(e){var a=e.scratch("box-layoutrelative_position");e.position({x:t.x+a.x,y:t.y+a.y}),e.removeData("box-layoutrelative_position")})),e.style(e.scratch("box-layoutstyles")),e.removeClass("__boxNodeClass"),e.removeScratch("box-layoutstyles"),e.removeScratch("box-layout.parent_position")})),o.emit("layoutstop")})),i.run();case 26:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"layoutBoxType",value:function(){var e=Object(Zt.a)(Jt.a.mark((function e(t){var a=this;return Jt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var r,i=a.getBoxNodes(t);switch(t){case Je.APP:r=mg(a.appBoxLayout);break;case Je.CLUSTER:r=mg(a.clusterBoxLayout);break;case Je.NAMESPACE:r=mg(a.namespaceBoxLayout);break;default:r=mg(a.defaultLayout)}var o=[];i.each((function(e){var t=e.children(),n=t.add(t.edgesTo(t)).layout(r);o.push(new Promise((function(i,o){a.runLayout(r.name,n).then((function(a){var n=e.boundingBox();t.each((function(e){e.scratch("box-layoutrelative_position",e.relativePosition())}));var r={shape:e.style("shape"),height:e.style("height"),width:e.style("width")},o={shape:"rectangle",height:"".concat(n.h,"px"),width:"".concat(n.w,"px")};e.scratch("box-layoutstyles",r),e.addClass("__boxNodeClass"),e.style(o),i(!0)}))})))})),Promise.all(o).then((function(n){var r,o=a.cy.collection(),s=a.cy.collection(),l=i.children(),c=Object($t.a)(l);try{for(c.s();!(r=c.n()).done;){var u,p=r.value,d=Object($t.a)(p.connectedEdges());try{for(d.s();!(u=d.n()).done;){var m=u.value,h=a.syntheticEdgeGenerator.getEdge(t,m.source(),m.target());h&&(s=s.add(a.cy.add(h)))}}catch(f){d.e(f)}finally{d.f()}}}catch(f){c.e(f)}finally{c.f()}o=o.add(a.cy.remove(l)),e({boxNodes:i,syntheticEdges:s,removedElements:o})}))})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"runLayout",value:function(){var e=Object(Zt.a)(Jt.a.mark((function e(t,a){var n;return Jt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.on("layoutstart layoutready layoutstop",(function(e){return!1})),"dagre"!==t){e.next=3;break}return e.abrupt("return",a.run());case 3:return n=a.promiseOn("layoutstop"),a.run(),e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"getBoxNodes",value:function(e){return this.elements.nodes("[".concat(iv,'="').concat(e,'"]'))}}]),e}(),gE=a(804),vE=a.n(gE),EE=a(1245);sE.a.use(iE.a),sE.a.use(cE.a),sE.a.use(pE.a),sE.a.use(mE.a),sE.a.use(vE.a),sE()("layout","box-layout",fE),EE(sE.a);var bE={height:"100%"},yE=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).cy=void 0,n.divParentRef=void 0,n.divParentRef=r.createRef(),n}return Object(l.a)(a,[{key:"getCy",value:function(){return this.cy}},{key:"shouldComponentUpdate",value:function(e,t){return!1}},{key:"componentDidMount",value:function(){this.build()}},{key:"componentWillUnmount",value:function(){this.destroy()}},{key:"render",value:function(){return r.createElement("div",{id:"cy",className:"graph",style:bE,ref:this.divParentRef})}},{key:"build",value:function(){this.cy&&this.destroy();var e=Object(C.a)({container:this.divParentRef.current,boxSelectionEnabled:!1,style:nE.styles()},nE.options());this.cy=sE()(e),this.cy.nodeHtmlLabel(nE.htmlNodeLabels(this.cy))}},{key:"destroy",value:function(){this.cy&&(this.cy.destroy(),this.cy=void 0)}}]),a}(r.Component),CE=a(189),SE=a.n(CE),AE=a(115),TE=a.n(AE),OE=function(){var e=q.getTimeBounds(),t=q.getRangeDuration();return{from:null===e||void 0===e?void 0:e.from,to:null===e||void 0===e?void 0:e.to,rangeDuration:t}},IE=function(e){return e.from?(q.setParam(P.FROM,String(e.from)),e.to?q.setParam(P.TO,String(e.to)):q.deleteParam(P.TO),void q.deleteParam(P.RANGE_DURATION)):e.rangeDuration?(q.setParam(P.RANGE_DURATION,String(e.rangeDuration)),q.deleteParam(P.FROM),void q.deleteParam(P.TO)):void 0},wE=a(212),RE=a.n(wE),kE=function(){function e(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];Object(s.a)(this,e),this.value=void 0,this.children=void 0,this.value=t,this.children=a}return Object(l.a)(e,[{key:"depth",get:function(){return this.children.reduce((function(e,t){return Math.max(t.depth+1,e)}),1)}},{key:"size",get:function(){var e=0;return this.walk((function(){return e++})),e}},{key:"addChild",value:function(t){return this.children.push(t instanceof e?t:new e(t)),this}},{key:"find",value:function(t){if(e.iterFunction(e.searchFunction(t))(this))return this;for(var a=0;a<this.children.length;a++){var n=this.children[a].find(t);if(n)return n}return null}},{key:"getPath",value:function(t){var a=e.iterFunction(e.searchFunction(t));return function e(t,n){var r=n.concat([t]);if(a(t))return r;for(var i=0;i<t.children.length;i++){var o=e(t.children[i],r);if(o)return o}return null}(this,[])}},{key:"walk",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=[],n=t;for(a.push({node:this,depth:n});a.length;){var r=a.pop(),i=r.node,o=r.depth;e(i.value,i,o),n=o+1;for(var s=i.children.length-1;s>=0;)a.push({node:i.children[s],depth:n}),s--}}}],[{key:"iterFunction",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return function(a){return e(a.value,a,t)}}},{key:"searchFunction",value:function(t){return"function"===typeof t?t:function(a,n){return t instanceof e?n===t:a===t}}}]),e}();var xE=function(e,t){return+(e.startTime>t.startTime)||+(e.startTime===t.startTime)-1};function NE(e){var t=e.traceID;if(!t)return null;t=t.toLowerCase();var a=0,n=Number.MAX_SAFE_INTEGER,r=new Map,i=new Map;e.spans=e.spans.filter((function(e){return Boolean(e.startTime)}));for(var o=e.spans.length,s=0;s<o;s++){var l=e.spans[s],c=l.startTime,u=l.duration,p=l.processID,d=l.spanID;c<n&&(n=c),c+u>a&&(a=c+u);var m=r.get(d);null!=m?(console.warn("Dupe spanID, ".concat(m+1," x ").concat(d),l,i.get(d)),RE()(l,i.get(d))&&console.warn("\t two spans with same ID have `isEqual(...) === true`"),r.set(d,m+1),d="".concat(d,"_").concat(m),l.spanID=d):r.set(d,1),l.process=e.processes[p],i.set(d,jE(l))}var h=function(e){var t=new Map(e.spans.map((function(e){return[e.spanID,new kE(e.spanID)]}))),a=new Map(e.spans.map((function(e){return[e.spanID,e]}))),n=new kE("__root__");e.spans.forEach((function(e){var a=t.get(e.spanID);if(Array.isArray(e.references)&&e.references.length){var r=e.references[0],i=r.refType,o=r.spanID;if("CHILD_OF"!==i&&"FOLLOWS_FROM"!==i)throw new Error("Unrecognized ref type: ".concat(i));(t.get(o)||n).children.push(a)}else n.children.push(a)}));var r=function(e,t){return xE(a.get(e.value),a.get(t.value))};return e.spans.forEach((function(e){var a=t.get(e.spanID);a.children.length>1&&a.children.sort(r)})),n.children.sort(r),n}(e),f=[],g={},v="";return h.walk((function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if("__root__"!==e){var r=i.get(e);if(r){var o=r.process.serviceName;g[o]=(g[o]||0)+1,r.references&&r.references.length||(v=r.operationName),r.relativeStartTime=r.startTime-n,r.depth=a-1,r.hasChildren=t.children.length>0,r.references.forEach((function(e){var t=i.get(e.spanID);t&&(e.span=t)})),f.push(r)}}})),{services:Object.keys(g).map((function(e){return{name:e,numberOfSpans:g[e]}})),spans:f,traceID:t,traceName:v,processes:e.processes,duration:a-n,startTime:n,endTime:a}}var jE=function(e){e.warnings=e.warnings||[],e.tags=e.tags||[],e.references=e.references||[];var t=function(e){var t=new Map;return{tags:e.reduce((function(e,a){return e.some((function(e){return e.key===a.key&&e.value===a.value}))?t.set("".concat(a.key,":").concat(a.value),'Duplicate tag "'.concat(a.key,":").concat(a.value,'"')):e.push(a),e}),[]),warnings:Array.from(t.values())}}(e.tags);e.tags=t.tags,e.warnings=e.warnings.concat(t.warnings);var a=KE(e),n=a.type,r=a.info,i=DE(e),o=e.process.serviceName.split("."),s=o[0],l=i?i.namespace:o.length>1?o[1]:void 0;l||console.warn("Could not determine span namespace");var c=l?"/namespaces/"+l+"/applications/"+s:void 0,u=i?"/namespaces/"+i.namespace+"/workloads/"+i.workload:void 0;return Object(C.a)(Object(C.a)({},e),{},{type:n,info:r,component:r.component||"unknown",namespace:l||"unknown",app:s,linkToApp:c,workload:null===i||void 0===i?void 0:i.workload,pod:null===i||void 0===i?void 0:i.pod,linkToWorkload:u})},PE=function(e){var t=e.key,a=e.value;return"error"===t&&(!0===a||"true"===a)},LE=function(){var e=le(OE(),de,(function(e){return e})),t=(new Date).getTime()-6e5;return{from:e.from?1e3*e.from:1e3*t,to:e.to?1e3*e.to:void 0}},DE=function(e){var t=e.tags.find((function(e){return"node_id"===e.key}));if(t){var a=t.value.split("~");if(a.length<3)return;var n=a[2],r=n.lastIndexOf(".");return r>=0?_E(n.substring(0,r),n.substring(r+1)):void 0}var i=e.process.tags.find((function(e){return"hostname"===e.key}));if(i){var o=e.process.serviceName.split(".");return _E(i.value,o.length>1?o[1]:"")}},FE=/^([a-z0-9-.]+)-[a-z0-9]+$/,_E=function(e,t){var a=FE.exec(e);if(a&&2===a.length)return{pod:e,workload:HE(a[1]),namespace:t}},ME=/^[bcdfghjklmnpqrstvwxz2456789]{6,16}$/,HE=function(e){var t=e.split("-");if(t.length<2)return e;var a=t[t.length-1];return ME.test(a)?e.substring(0,e.length-a.length-1):e},GE=function(e){if(Array.isArray(e.references)){var t=e.references.find((function(e){return"CHILD_OF"===e.refType||"FOLLOWS_FROM"===e.refType}));return(null===t||void 0===t?void 0:t.span)||void 0}},VE=function(e){var t=GE(e);return t?DE(t):void 0},UE=function(e){var t=e.process.serviceName.split(".");return{app:t[0],namespace:t.length>1?t[1]:""}},BE=function(e){var t=GE(e);return t?UE(t):void 0},WE=function(e){var t={hasError:!1};return e.tags.forEach((function(e){"component"===e.key&&(t.component=e.value),PE(e)&&(t.hasError=!0)})),t},qE=function(e){var t=WE(e);return e.tags.forEach((function(e){if("http.status_code"===e.key){var a=parseInt(e.value,10);!isNaN(a)&&a>0&&(t.statusCode=a)}else"http.url"===e.key?t.url=e.value:"http.method"===e.key?t.method=e.value:"span.kind"===e.key&&("client"===e.value?t.direction="outbound":"server"===e.value&&(t.direction="inbound"))})),t},KE=function(e){var t=function(e){var t=e.tags.find((function(e){return"component"===e.key}));return"proxy"===(null===t||void 0===t?void 0:t.value)?"envoy":e.tags.some((function(e){return e.key.startsWith("http.")}))?"http":e.tags.some((function(e){return e.key.startsWith("peer.")}))?"tcp":"unknown"}(e);return{type:t,info:"envoy"===t?function(e){var t=qE(e);return e.tags.forEach((function(a){if("response_flags"===a.key)"-"!==a.value&&(t.responseFlags=a.value);else if("upstream_cluster"===a.key){var n=a.value.split("|");if(4===n.length)if("outbound"===n[0]){var r=n[3].split(".");5===r.length&&(t.direction="outbound",t.peer={name:r[0],namespace:r[1],kind:"service"})}else if("inbound"===n[0]){var i=VE(e);i&&(t.direction="inbound",t.peer={name:i.workload,namespace:i.namespace,kind:"workload"})}}})),t}(e):"http"===t?qE(e):"tcp"===t?function(e){var t=WE(e);return e.tags.forEach((function(e){"message_bus.destination"===e.key?t.topic=e.value:"peer.address"===e.key?t.peerAddress=e.value:"peer.hostname"===e.key?t.peerHostname=e.value:"span.kind"===e.key&&("producer"===e.value||"client"===e.value?t.direction="outbound":"consumer"!==e.value&&"server"!==e.value||(t.direction="inbound"))})),t}(e):WE(e)}},zE=function(e,t){return e.map((function(e){return e.spanID})).join()===t.map((function(e){return e.spanID})).join()};function YE(e){var t=e/1e3,a="ms";return t>=1e3&&(a="s",t/=1e3),SE()(t,2)+a}var QE,XE,JE=function(e,t,a){var n=a.process.serviceName.split("."),r=n[0],i=void 0;if(t===Xe.SERVICE){var o=BE(a);if(o){var s="node[!".concat(iv,"][").concat(hv,'="').concat(Ze.SERVICE,'"][').concat(Fg,'="').concat(o.app,'"][').concat(mv,'="').concat(o.namespace,'"]'),l=e.elements(s);if(!l||0===l.length){var c=VE(a);c&&(s="node[".concat(bv,'="').concat(c.workload,'"][').concat(mv,'="').concat(c.namespace,'"]'),l=e.elements(s))}l&&0!==l.length&&(i=l)}}else if(t===Xe.APP){var u=BE(a);if(u){var p="node[".concat(hv,'="').concat(Ze.APP,'"][').concat(Fg,'="').concat(u.app,'"][').concat(mv,'="').concat(u.namespace,'"]'),d=e.elements(p);d&&0!==d.length&&(i=d)}}else{var m=VE(a);if(m){var h="node[".concat(bv,'="').concat(m.workload,'"][').concat(mv,'="').concat(m.namespace,'"]'),f=e.elements(h);f&&0!==f.length&&(i=f)}}var g=tb(a,e);i=rb(a,g,i);var v=n.length>1?"[".concat(mv,'="').concat(n[1],'"]'):"",E="[".concat(hv,'="').concat(Ze.SERVICE,'"][').concat(Fg,'="').concat(r,'"]').concat(v);if(i=rb(a,e.elements(E),i),t===Xe.APP){var b=UE(a);if(b){var y="node[".concat(hv,'="').concat(Ze.APP,'"][').concat(Fg,'="').concat(b.app,'"][').concat(mv,'="').concat(b.namespace,'"]');i=rb(a,e.elements(y),i)}}else{var C=DE(a);if(C){var S="node[".concat(bv,'="').concat(C.workload,'"][').concat(mv,'="').concat(C.namespace,'"]');i=rb(a,e.elements(S),i)}}var A=eb(a,e);rb(a,A,i)},ZE=function(e,t){e&&(e.hasClass("span")?e.data("spans").push(t):(e.addClass("span"),e.data("spans",[t])))},$E=function(e){if(e){var t=e.elements("*.span");t.removeClass("span"),t.data("spans",void 0)}},eb=function(e,t){if(e.tags.some((function(e){return"span.kind"===e.key&&("client"===e.value||"producer"===e.value)})))return ab(e,t)},tb=function(e,t){if(e.tags.some((function(e){return"span.kind"===e.key&&("server"===e.value||"consumer"===e.value)})))return ab(e,t)},ab=function(e,t){var a=e.tags.find((function(e){return"peer.hostname"===e.key}));if(a&&""!==a.value)return nb(a.value,t);var n=e.tags.find((function(e){return"peer.address"===e.key}));return n&&""!==n.value?nb(n.value.split(":")[0],t):void 0},nb=function(e,t){return t.elements("[".concat(hv,'="').concat(Ze.SERVICE,'"]')).filter((function(t){var a=t.data(dv);return!(!a||!a.hosts.some((function(t){return t.startsWith(e)})))}))},rb=function(e,t,a){if(t&&0!==t.length){var n=((o=t).length>1&&console.debug("Expected singleton, found [".concat(o.length,"] nodes. Using first.")),o.length>0?o[0]:void 0);if(ZE(n,e),a){var r=a.edgesTo(t);r&&0!==r.length||(r=t.edgesTo(a)),ZE(((i=r).length>1&&console.debug("Expected singleton, found [".concat(i.length,"] edges. Using first.")),i.length>0?i[0]:void 0),e)}return t}var i,o;return a},ib=a(1488),ob=Object(Jn.a)({height:"98%",marginRight:"auto",marginLeft:"auto",marginBottom:10,marginTop:10}),sb=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"shouldComponentUpdate",value:function(e){var t=void 0===this.props.elements||S.isEmpty(this.props.elements.nodes),a=void 0===e.elements||S.isEmpty(e.elements.nodes);return!e.isLoading&&!a||(t!==a||!(!a&&S.isEqual(this.props.namespaces,e.namespaces)))}},{key:"namespacesText",value:function(){if(this.props.namespaces&&this.props.namespaces.length>0){if(1===this.props.namespaces.length)return r.createElement(r.Fragment,null,"namespace ",r.createElement("b",null,this.props.namespaces[0].name));var e=this.props.namespaces.slice(0,-1).map((function(e){return e.name})).join(",")+" and "+this.props.namespaces[this.props.namespaces.length-1].name;return r.createElement(r.Fragment,null,"namespaces ",r.createElement("b",null,e))}return null}},{key:"render",value:function(){if(this.props.isError)return r.createElement(Cu.a,{variant:Cu.b.large,className:ob},r.createElement(ib.a,{icon:fi.Error}),r.createElement(Eo.a,{headingLevel:"h5",size:"lg"},"Error loading Graph"),r.createElement(Su.a,null,this.props.error));if(this.props.isLoading)return r.createElement(Cu.a,{variant:Cu.b.large,className:ob},r.createElement(Eo.a,{headingLevel:"h5",size:"lg"},"Loading Graph"));if(0===this.props.namespaces.length)return r.createElement(Cu.a,{variant:Cu.b.large,className:ob},r.createElement(Eo.a,{headingLevel:"h5",size:"lg"},"No namespace is selected"),r.createElement(Su.a,null,"There is currently no namespace selected, please select one using the Namespace selector."));var e=!this.props.elements||!this.props.elements.nodes||this.props.elements.nodes.length<1;return e&&!this.props.isMiniGraph?r.createElement(Cu.a,{variant:Cu.b.large,className:ob},r.createElement(Eo.a,{headingLevel:"h5",size:"lg"},"Empty Graph"),r.createElement(Su.a,null,"There is currently no graph available for ",this.namespacesText(),". This could either mean there is no service mesh available for ",1===this.props.namespaces.length?"this namespace":"these namespaces"," or the service mesh has yet to see request traffic.",this.props.showIdleNodes&&r.createElement(r.Fragment,null," You are currently displaying 'Idle nodes', send requests to the service mesh and click 'Refresh'."),!this.props.showIdleNodes&&r.createElement(r.Fragment,null," You can enable 'Idle Nodes' to display service mesh nodes that have yet to see any request traffic.")),r.createElement(vr.a,{onClick:this.props.showIdleNodes?this.props.action:this.props.toggleIdleNodes,variant:"primary"},this.props.showIdleNodes&&r.createElement(r.Fragment,null,"Refresh")||r.createElement(r.Fragment,null,"Display idle nodes"))):e&&this.props.isMiniGraph?r.createElement(Cu.a,{variant:Cu.b.large,className:ob},r.createElement(Eo.a,{headingLevel:"h5",size:"lg"},"Empty Graph"),r.createElement(Su.a,null,"No graph traffic for the time period.")):this.props.children}}]),a}(r.Component),lb=function(){function e(t){var a=this;Object(s.a)(this,e),this.animationTimer=void 0,this.startTimestamp=void 0,this.elements=void 0,this.onFinishedCallback=void 0,this.layer=void 0,this.context=void 0,this.processStep=function(){try{var e=Date.now();void 0===a.startTimestamp&&(a.startTimestamp=e);var t=(e-a.startTimestamp)/2e3;if(a.layer.clear(a.context),a.layer.setTransform(a.context),t>=1)return a.stop(),void(a.onFinishedCallback&&a.onFinishedCallback());a.elements.forEach((function(e){return a.render(e,60*a.easingFunction(t))}))}catch(n){throw a.stop(),n}},this.layer=t.cyCanvas(),this.context=this.layer.getCanvas().getContext("2d"),t.one("destroy",(function(){return a.stop()}))}return Object(l.a)(e,[{key:"onFinished",value:function(e){this.onFinishedCallback=e}},{key:"start",value:function(e){this.stop(),this.elements=e,this.animationTimer=window.setInterval(this.processStep,1/30*1e3)}},{key:"stop",value:function(){this.animationTimer&&(window.clearInterval(this.animationTimer),this.animationTimer=void 0,this.clear())}},{key:"clear",value:function(){this.layer.clear(this.context)}},{key:"easingFunction",value:function(e){return e<.5?1-2*e:e<.75?4*(e-.5):1-4*(e-.75)}},{key:"getCenter",value:function(e){return e.isNode()?e.position():e.midpoint()}},{key:"render",value:function(e,t){var a=this.getCenter(e),n=a.x,r=a.y;this.context.strokeStyle=rt.Blue300,this.context.lineWidth=1,this.context.beginPath(),this.context.arc(n,r,t,0,2*Math.PI,!0),this.context.stroke()}}]),e}(),cb=function(){function e(t){var a=this;Object(s.a)(this,e),this.cy=void 0,this.selected=void 0,this.hovered=void 0,this.onClick=function(e){a.selected.summaryTarget!==e.summaryTarget&&(a.selected=e,a.clearHover(),a.unhighlight(),"graph"!==a.selected.summaryType&&a.refresh())},this.clearHover=function(){a.hovered&&(a.hovered.summaryTarget.removeClass("mousehover"),a.hovered=void 0)},this.onMouseIn=function(e){"graph"===a.selected.summaryType&&-1!==["node","edge","box"].indexOf(e.summaryType)&&(a.hovered=e,a.hovered.summaryTarget.addClass("mousehover"),a.refresh())},this.onMouseOut=function(e){a.hovered&&a.hovered.summaryTarget===e.summaryTarget&&(a.clearHover(),a.unhighlight())},this.unhighlight=function(){a.cy.elements(".".concat("mousedim")).removeClass("mousedim"),a.cy.elements(".".concat("mousehighlight")).removeClass("mousehighlight")},this.refresh=function(){var e=a.getHighlighted();e.toHighlight&&(e.toHighlight.addClass("mousehighlight"),e.dimOthers&&a.cy.elements().difference(e.toHighlight).addClass("mousedim"))},this.cy=t,this.selected={summaryType:"graph",summaryTarget:this.cy}}return Object(l.a)(e,[{key:"getHighlighted",value:function(){var e="graph"===this.selected.summaryType,t=e?this.hovered:this.selected;if(t)switch(t.summaryType){case"node":return{toHighlight:this.getNodeHighlight(t.summaryTarget,e),dimOthers:!0};case"edge":return{toHighlight:this.getEdgeHighlight(t.summaryTarget,e),dimOthers:!0};case"box":return this.getBoxHighlight(t.summaryTarget,e)}return{toHighlight:void 0,dimOthers:!1}}},{key:"includeAncestorNodes",value:function(e){return e.reduce((function(e,t){return e=e.add(t),t.isChild()&&(e=e.add(t.ancestors())),e}),this.cy.collection())}},{key:"getNodeHighlight",value:function(e,t){var a=t?e.closedNeighborhood():e.predecessors().add(e.successors());return this.includeAncestorNodes(a.add(e))}},{key:"getEdgeHighlight",value:function(e,t){var a;if(t)a=e.connectedNodes();else{var n=e.source(),r=e.target();a=n.add(r).add(n.predecessors()).add(r.successors())}return this.includeAncestorNodes(a.add(e))}},{key:"getBoxHighlight",value:function(e,t){if(e.data(iv)===Je.APP){var a;if(t)a=e.descendants().reduce((function(e,t){return e.add(t.closedNeighborhood())}),this.cy.collection());else{var n=e.descendants();a=n.add(n.predecessors()).add(n.successors())}return{toHighlight:this.includeAncestorNodes(a),dimOthers:!0}}return{toHighlight:this.includeAncestorNodes(e),dimOthers:!1}}}]),e}(),ub=function e(){Object(s.a)(this,e)},pb=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e,n,r,i){var o;return Object(s.a)(this,a),(o=t.call(this)).radius=void 0,o.backgroundColor=void 0,o.borderColor=void 0,o.lineWidth=void 0,o.radius=e,o.backgroundColor=n,o.borderColor=r,o.lineWidth=i,o}return Object(l.a)(a,[{key:"render",value:function(e,t){e.fillStyle=this.backgroundColor,e.strokeStyle=this.borderColor,e.lineWidth=this.lineWidth,e.beginPath(),e.arc(t.x,t.y,this.radius,0,2*Math.PI,!0),e.stroke(),e.fill()}}]),a}(ub),db=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e,n){var r;return Object(s.a)(this,a),(r=t.call(this)).outerDiamond=void 0,r.innerDiamond=void 0,r.outerDiamond=e,r.innerDiamond=n,r}return Object(l.a)(a,[{key:"render",value:function(e,t){a.diamondPath(e,t,this.outerDiamond),a.diamondPath(e,t,this.innerDiamond)}}],[{key:"diamondPath",value:function(e,t,a){e.fillStyle=a.backgroundColor,e.strokeStyle=a.borderColor,e.lineWidth=a.lineWidth,e.beginPath(),e.moveTo(t.x,t.y-a.radius),e.lineTo(t.x+a.radius,t.y),e.lineTo(t.x,t.y+a.radius),e.lineTo(t.x-a.radius,t.y),e.lineTo(t.x,t.y-a.radius),e.stroke(),e.fill()}}]),a}(ub),mb=function e(t,a,n,r){Object(s.a)(this,e),this.radius=void 0,this.backgroundColor=void 0,this.borderColor=void 0,this.lineWidth=void 0,this.radius=t,this.backgroundColor=a,this.borderColor=n,this.lineWidth=r},hb=function(){function e(t){Object(s.a)(this,e),this.baseDelay=t,this.threshold=void 0,this.scaleFactor=void 0,this.threshold=50,this.scaleFactor=1}return Object(l.a)(e,[{key:"resetCalibration",value:function(){this.threshold=50,this.scaleFactor=1}},{key:"calibrate",value:function(e){e>this.threshold&&(this.threshold=2*e,this.scaleFactor=this.computeScaleFactor())}},{key:"computeDelay",value:function(e){if(!isNaN(e)&&0!==e){var t=1e3*this.baseDelay*this.scaleFactor/e;return qf(t,40,5e3)}}},{key:"computeScaleFactor",value:function(){return this.threshold>1e5?Math.pow(this.threshold/50,.9):this.threshold>1e3?Math.pow(this.threshold/50,.95):this.threshold/50}}]),e}(),fb=new hb(1),gb=new hb(20);!function(e){e[e.LINEAR=0]="LINEAR",e[e.CURVE=1]="CURVE",e[e.LOOP=2]="LOOP"}(QE||(QE={})),function(e){e[e.RPS=0]="RPS",e[e.TCP=1]="TCP",e[e.NONE=2]="NONE"}(XE||(XE={}));var vb=function(){function e(){Object(s.a)(this,e),this.timer=void 0,this.timerForNextPoint=void 0,this.speed=0,this.errorRate=0,this.type=XE.NONE}return Object(l.a)(e,[{key:"processStep",value:function(e,t){if(void 0!==this.timerForNextPoint&&(this.timerForNextPoint-=e,this.timerForNextPoint<=200*Math.random()))return this.timerForNextPoint=this.timer,this.nextPoint(t)}},{key:"setTimer",value:function(e){this.timer=e,void 0===this.timerForNextPoint&&(this.timerForNextPoint=e)}},{key:"setSpeed",value:function(e){this.speed=e}},{key:"setErrorRate",value:function(e){this.errorRate=e}},{key:"setType",value:function(e){this.type=e}},{key:"nextPoint",value:function(e){var t,a,n=Math.random()<=this.errorRate;return this.type===XE.RPS?t=n?new db(new mb(5,rt.White,rt.Danger,1),new mb(2,rt.Danger,rt.Danger,1)):function(e){return new pb(2,rt.White,e.style("line-color"),2)}(e):this.type===XE.TCP&&(t=new pb(1.6,rt.Black100,rt.Black500,1),a={x:3*Math.random()-1.5,y:3*Math.random()-1.5}),{speed:this.speed,delta:0,renderer:t,offset:a}}}]),e}(),Eb=function(){function e(){Object(s.a)(this,e),this.points=[],this.generator=void 0,this.edge=void 0,this.type=XE.NONE,this.generator=new vb}return Object(l.a)(e,[{key:"processStep",value:function(e){this.points=this.points.map((function(t){return t.delta+=e*t.speed/1e3,t}));var t=this.generator.processStep(e,this.edge);t&&this.points.push(t)}},{key:"getPoints",value:function(){return this.points}},{key:"getEdge",value:function(){return this.edge}},{key:"getType",value:function(){return this.type}},{key:"setTimer",value:function(e){this.generator.setTimer(e)}},{key:"removeFinishedPoints",value:function(){this.points=this.points.filter((function(e){return e.delta<=1}))}},{key:"setSpeed",value:function(e){this.generator.setSpeed(e)}},{key:"setErrorRate",value:function(e){this.generator.setErrorRate(e)}},{key:"setEdge",value:function(e){this.edge=e}},{key:"setType",value:function(e){this.type=e,this.generator.setType(e)}}]),e}(),bb=function(){function e(t){var a=this;Object(s.a)(this,e),this.animationTimer=void 0,this.previousTimestamp=void 0,this.trafficEdges={},this.layer=void 0,this.context=void 0,this.processStep=function(){try{var e=Date.now();a.previousTimestamp||(a.previousTimestamp=e);var t=a.currentStep(e);a.layer.clear(a.context),a.layer.setTransform(a.context),Object.keys(a.trafficEdges).forEach((function(e){var n=a.trafficEdges[e],r=n.getEdge();r.visible()&&r.inside()&&(n.processStep(t),n.removeFinishedPoints(),a.render(n))})),a.previousTimestamp=e}catch(n){throw a.stop(),n}},this.layer=t.cyCanvas();var n=this.layer.getCanvas();n.style["pointer-events"]="none",this.context=n.getContext("2d")}return Object(l.a)(e,[{key:"start",value:function(e){this.pause(),this.trafficEdges=this.processEdges(e),this.animationTimer=window.setInterval(this.processStep,1/60*1e3)}},{key:"pause",value:function(){void 0!==this.animationTimer&&(window.clearInterval(this.animationTimer),this.layer.clear(this.context),this.animationTimer=void 0,this.previousTimestamp=void 0)}},{key:"stop",value:function(){this.pause(),this.trafficEdges={}}},{key:"render",value:function(e){var t=this,a=e.getEdge();a.hasClass("mousedim")||a.hasClass("mousehover")||e.getPoints().forEach((function(e){var n=t.edgeControlPoints(a);try{var r=t.pointWithOffset(t.pointInGraph(n,e.delta),e.offset);r&&e.renderer.render(t.context,r)}catch(i){console.log("Error rendering TrafficEdge, it won't be rendered: ".concat(i.message))}}))}},{key:"pointInGraph",value:function(e,t){var a=this.edgeConnectionTypeFromControlPoints(e);switch(a){case QE.LINEAR:return function(e,t,a){return{x:e.x+a*(t.x-e.x),y:e.y+a*(t.y-e.y)}}(e[0],e[1],t);case QE.CURVE:return Kf(e[0],e[1],e[2],t);case QE.LOOP:return t<.5?Kf(e[0],e[1],e[2],t/.5):Kf(e[2],e[3],e[4],2*(t-.5));default:throw Error("Unhandled EdgeConnectionType:"+a)}}},{key:"pointWithOffset",value:function(e,t){return void 0===t?e:{x:e.x+t.x,y:e.y+t.y}}},{key:"currentStep",value:function(e){var t=e-this.previousTimestamp;return 0===t?1/60*1e3:t}},{key:"getTrafficEdgeType",value:function(e){switch(Tv(e).protocol){case Le.GRPC:case Le.HTTP:return XE.RPS;case Le.TCP:return XE.TCP;default:return XE.NONE}}},{key:"processEdges",value:function(e){var t=this;return fb.resetCalibration(),gb.resetCalibration(),e.forEach((function(e){var t=Tv(e);switch(t.protocol){case Le.GRPC:fb.calibrate(t.grpc);break;case Le.HTTP:fb.calibrate(t.http);break;case Le.TCP:gb.calibrate(t.tcp)}})),e.reduce((function(e,a){var n=t.getTrafficEdgeType(a);if(n!==XE.NONE){var r=Tv(a).id;r in t.trafficEdges?e[r]=t.trafficEdges[r]:e[r]=new Eb,e[r].setType(n),t.fillTrafficEdge(a,e[r])}return e}),{})}},{key:"fillTrafficEdge",value:function(e,t){var a=1;try{var n=this.edgeLength(e);a=50/Math.max(n,1)}catch(p){console.error("Error when finding the length of the edge for the traffic animation, this TrafficEdge won't be rendered: ".concat(p.message))}var r=Tv(e);if(t.getType()===XE.RPS){var i=r.protocol===Le.HTTP,o=i?r.http:r.grpc,s=i?r.httpPercentErr:r.grpcPercentErr,l=fb.computeDelay(o),c=this.speedFromResponseTime(r.responseTime)*a,u=isNaN(s)?0:s/100;t.setSpeed(c),t.setTimer(l),t.setEdge(e),t.setErrorRate(u)}else t.getType()===XE.TCP&&(t.setSpeed(1*a),t.setErrorRate(0),t.setTimer(gb.computeDelay(r.tcp)),t.setEdge(e))}},{key:"speedFromResponseTime",value:function(e){return isNaN(e)?2:.1+1.9*(1-qf(e,0,1e4)/1e4)}},{key:"edgeLength",value:function(e){var t,a,n=this.edgeControlPoints(e),r=this.edgeConnectionTypeFromControlPoints(n);switch(r){case QE.LINEAR:return t=n[0],a=n[1],Math.sqrt(Math.pow(t.x-a.x,2)+Math.pow(t.y-a.y,2));case QE.CURVE:return zf(n[0],n[1],n[2]);case QE.LOOP:return zf(n[0],n[1],n[2])+zf(n[2],n[3],n[4]);default:throw Error("Unhandled EdgeConnectionType:"+r)}}},{key:"edgeControlPoints",value:function(e){var t=[e.sourceEndpoint()],a=e.controlPoints();if(a)for(var n=0;n<a.length;++n)t.push(a[n]),n+1<a.length&&t.push({x:(a[n].x+a[n+1].x)/2,y:(a[n].y+a[n+1].y)/2});return t.push(e.targetEndpoint()),t}},{key:"edgeConnectionTypeFromControlPoints",value:function(e){if(2===e.length)return QE.LINEAR;if(3===e.length)return QE.CURVE;if(5===e.length)return QE.LOOP;throw Error("Unknown EdgeConnectionType, ControlPoint.length="+e.length)}}]),e}(),yb=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).contextMenuRef=void 0,n.cy=void 0,n.customViewport=void 0,n.cytoscapeReactWrapperRef=void 0,n.focusSelector=void 0,n.graphHighlighter=void 0,n.namespaceChanged=void 0,n.needsInitialLayout=void 0,n.nodeChanged=void 0,n.resetSelection=!1,n.trafficRenderer=void 0,n.userBoxSelected=void 0,n.onResize=function(){n.cy&&(n.cy.resize(),n.safeFit(n.cy,!0))},n.selectTarget=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];n.props.isMiniGraph&&t||n.cy&&(n.cy.$(":selected").selectify().unselect().unselectify(),e&&!Iv(e)&&e.selectify().select().unselectify())},n.selectTargetAndUpdateSummary=function(e){n.selectTarget(e);var t={summaryType:e.data(iv)?"box":"node",summaryTarget:e};n.props.updateSummary&&n.props.updateSummary(t),n.graphHighlighter.onClick(t)},n.handleDoubleTap=function(e){n.props.onNodeDoubleTap&&a.isCyNodeClickEvent(e)&&n.props.onNodeDoubleTap(a.buildTapEventArgs(e))},n.handleTap=function(e){n.props.updateSummary&&n.props.updateSummary(e),n.props.onNodeTap&&a.isCyNodeClickEvent(e)&&n.props.onNodeTap(a.buildTapEventArgs(e)),n.props.isMiniGraph?n.props.onEdgeTap&&a.isCyEdgeClickEvent(e)&&n.props.onEdgeTap(a.buildTapEventArgs(e)):n.graphHighlighter.onClick(e)},n.handleMouseIn=function(e){n.graphHighlighter.onMouseIn(e)},n.handleMouseOut=function(e){n.graphHighlighter.onMouseOut(e)},n.contextMenuRef=r.createRef(),n.customViewport=!1,n.cytoscapeReactWrapperRef=r.createRef(),n.focusSelector=e.focusSelector,n.namespaceChanged=!1,n.needsInitialLayout=!1,n.nodeChanged=!1,n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.cyInitialization(this.getCy())}},{key:"shouldComponentUpdate",value:function(e){return this.nodeChanged=this.nodeChanged||this.props.graphData.fetchParams.node!==e.graphData.fetchParams.node,this.props.edgeLabels!==e.edgeLabels||this.props.graphData.isLoading!==e.graphData.isLoading||this.props.graphData.elements!==e.graphData.elements||this.props.layout!==e.layout||this.props.compressOnHide!==e.compressOnHide||this.props.showMissingSidecars!==e.showMissingSidecars||this.props.showTrafficAnimation!==e.showTrafficAnimation||this.props.showVirtualServices!==e.showVirtualServices||this.props.trace!==e.trace}},{key:"componentDidUpdate",value:function(e){var t=this;if(!this.props.graphData.isLoading){var a=this.getCy();if(a){var n=!1;(this.needsInitialLayout||this.nodeNeedsRelayout()||this.namespaceNeedsRelayout(e.graphData.elements,this.props.graphData.elements)||this.elementsNeedRelayout(e.graphData.elements,this.props.graphData.elements)||this.props.layout.name!==e.layout.name)&&(n=!0,this.needsInitialLayout=!1),this.processGraphUpdate(a,n).then((function(n){var r=t.props.graphData.fetchParams.node;if(r&&a&&0===a.$(":selected").length){var i='[namespace = "'.concat(r.namespace.name,'"][nodeType = "').concat(r.nodeType,'"]');switch(r.nodeType){case Ze.AGGREGATE:i=i+"[aggregate = '"+r.aggregate+"'][aggregateValue = '"+r.aggregateValue+"']";break;case Ze.APP:case Ze.BOX:i=i+"[app = '"+r.app+"']",r.version&&r.version!==it&&(i=i+"[version = '"+r.version+"']");break;case Ze.SERVICE:i=i+"[service = '"+r.service+"']";break;default:i=i+"[workload = '"+r.workload+"']"}var o=a.nodes(i);if(o.length>0){var s=o[0];r.nodeType!==Ze.APP&&r.nodeType!==Ze.BOX||r.version||!s.isChild()||s.parent()[0].data(iv)!==Je.APP||(s=s.parent()[0]),t.selectTargetAndUpdateSummary(s)}}t.props.trace?function(e,t,a){e&&(e.startBatch(),$E(e),a.spans.forEach((function(a){return JE(e,t,a)})),e.endBatch())}(a,t.props.graphData.fetchParams.graphType,t.props.trace):!t.props.trace&&e.trace&&$E(a)}))}}}},{key:"render",value:function(){var e=this;return r.createElement("div",{id:"cytoscape-container",className:this.props.containerClassName},r.createElement(Pu.a,{handleWidth:!0,handleHeight:!0,skipOnMount:!1,onResize:this.onResize}),r.createElement(sb,{action:this.props.onEmptyGraphAction,elements:this.props.graphData.elements,error:this.props.graphData.errorMessage,isLoading:this.props.graphData.isLoading,isError:!!this.props.graphData.isError,isMiniGraph:this.props.isMiniGraph,namespaces:this.props.graphData.fetchParams.namespaces,showIdleNodes:this.props.showIdleNodes,toggleIdleNodes:this.props.toggleIdleNodes},r.createElement(cg,{ref:this.contextMenuRef,edgeContextMenuContent:this.props.contextMenuEdgeComponent,nodeContextMenuContent:this.props.contextMenuNodeComponent,groupContextMenuContent:this.props.contextMenuGroupComponent}),r.createElement(yE,{ref:function(t){return e.setCytoscapeReactWrapperRef(t)}})))}},{key:"getCy",value:function(){return this.cytoscapeReactWrapperRef.current?this.cytoscapeReactWrapperRef.current.getCy():null}},{key:"setCytoscapeReactWrapperRef",value:function(e){this.cytoscapeReactWrapperRef.current=e,this.cyInitialization(this.getCy())}},{key:"cyInitialization",value:function(e){var t=this;if(e&&this.cy!==e){this.cy=e,this.cy.boxSelectionEnabled(!0),this.contextMenuRef.current.connectCy(this.cy),this.graphHighlighter=new cb(e),this.trafficRenderer=new bb(e);var n=function(t){var a=t.target;return a===e?{summaryType:"graph",summaryTarget:e}:function(e){return!Iv(e)&&e.isNode()}(a)?a.data(iv)?{summaryType:"box",summaryTarget:a}:{summaryType:"node",summaryTarget:a}:function(e){return!Iv(e)&&e.isEdge()}(a)?{summaryType:"edge",summaryTarget:a}:null};e.on("tap",(function(r){if(r.originalEvent){var i=function(e){if(e.getAttribute(a.DataNodeId))return null;for(;e&&e.getAttribute;){var t=e.getAttribute(a.DataNodeId);if(t)return t;e=e.parentNode}return null}(document.elementFromPoint(r.originalEvent.clientX,r.originalEvent.clientY));if(i){var o=e.$id(i);if(o)return r.preventDefault(),void o.trigger("tap")}}var s=r.target;if(a.tapTimeout&&(clearTimeout(a.tapTimeout),a.tapTimeout=null,s===a.tapTarget)){s=null,a.tapTarget=null;var l=n(r);l&&t.handleDoubleTap(l)}s&&(a.tapTarget=s,a.tapTimeout=setTimeout((function(){a.tapTarget=null;var e=n(r);e&&(t.handleTap(e),t.selectTarget(r.target,!0))}),a.doubleTapMs))})),e.on("boxstart",(function(a){n(a)&&(t.userBoxSelected=e.collection())})),e.on("box",(function(a){if(n(a)){var r=a.target;r&&(r.forEach((function(e){var a;e.data(hv)!==Ze.BOX&&(t.userBoxSelected=null===(a=t.userBoxSelected)||void 0===a?void 0:a.add(r))})),Sv(e,t.userBoxSelected),t.customViewport=!0)}})),e.on("mouseover","node,edge",(function(e){var a=n(e);a&&t.handleMouseIn(a)})),e.on("mouseout","node,edge",(function(e){var a=n(e);a&&t.handleMouseOut(a)})),e.on("viewport",(function(e){n(e)&&(t.customViewport=!0)})),e.on("fit",(function(e){n(e)&&(t.customViewport=!1)})),e.on("nodehtml-create-or-update","node",(function(e,t){var a=t.label,n=t.isNew,r=e.target,i=a.getNode();if(n&&i.setAttribute("data-node-id",r.id()),!r.isParent()){var o=r.numericStyle("bounds-expansion");1===o.length&&(o=Array(4).fill(o[0]));var s=r.boundingBox({includeOverlays:!1}),l=Object(mt.a)(o),c=i.offsetWidth-s.w,u=i.offsetHeight;l[1]+=.5*c,l[3]+=.5*c,l[2]=u;(function(e,t){if(e.length!==t.length)return!1;for(var a=0;a<e.length;++a)if(Math.abs(e[a]-t[a])>1e-5)return!1;return!0})(o,l=l.map((function(e){return Math.max(e,0)})))||(r.style("bounds-expansion",l),r.isChild()&&setTimeout((function(){r.cy().destroyed()||r.cy().nodeHtmlLabel().updateNodeLabel(r.parent())}),0))}})),e.on("layoutstop",(function(a){t.safeFit(e),t.fixLoopOverlap(e)})),e.ready((function(e){t.props.onReady&&t.props.onReady(e.cy),t.needsInitialLayout=!0})),e.on("destroy",(function(e){t.trafficRenderer.stop(),t.trafficRenderer=void 0,t.cy=void 0,t.props.updateSummary&&t.props.updateSummary({summaryType:"graph",summaryTarget:void 0})}))}}},{key:"focus",value:function(e){if(this.focusSelector){var t=this.focusSelector;this.focusSelector=void 0;var a=e.$(t);if(a){if(1===a.length)this.selectTargetAndUpdateSummary(a[0]);else{var n=a.filter("$node > node");n&&1===n.length&&a.subtract(n).same(n.children())&&(this.selectTargetAndUpdateSummary(n[0]),a=n)}new lb(e).start(a)}else Hn("Could not focus on requested node. The node may be idle or hidden.",!0,void 0,"".concat(t))}}},{key:"safeFit",value:function(e,t){!t&&this.customViewport||(this.focus(e),Sv(e))}},{key:"processGraphUpdate",value:function(e,t){var a,n=this;this.trafficRenderer.pause();var r=0===e.$(":selected").length;this.resetSelection&&(r||(this.selectTarget(),this.handleTap({summaryType:"graph",summaryTarget:e})),this.resetSelection=!1);var i={activeNamespaces:this.props.graphData.fetchParams.namespaces,edgeLabels:this.props.edgeLabels,homeCluster:(null===j||void 0===j||null===(a=j.clusterInfo)||void 0===a?void 0:a.name)||"Kubernetes",graphType:this.props.graphData.fetchParams.graphType,trafficRates:this.props.graphData.fetchParams.trafficRates,showMissingSidecars:this.props.showMissingSidecars,showSecurity:this.props.showSecurity,showVirtualServices:this.props.showVirtualServices};return e.scratch("_global",i),e.startBatch(),t&&e.nodes().positions({x:0,y:0}),e.json({elements:this.props.graphData.elements}),e.endBatch(),t?new Promise((function(t,a){Av(e,n.props.layout).then((function(a){n.finishGraphUpdate(e,r),t()}))})):(this.finishGraphUpdate(e,r),Promise.resolve())}},{key:"finishGraphUpdate",value:function(e,t){e.nodes().unselectify(),e.edges().unselectify(),t||0!==e.$(":selected").length||this.handleTap({summaryType:"graph",summaryTarget:e}),this.props.showTrafficAnimation&&this.trafficRenderer.start(e.edges()),this.props.setUpdateTime&&this.props.setUpdateTime(Date.now())}},{key:"namespaceNeedsRelayout",value:function(e,t){var a=this.namespaceChanged&&e!==t;return a&&(this.namespaceChanged=!1),a}},{key:"nodeNeedsRelayout",value:function(){var e=this.nodeChanged;return e&&(this.nodeChanged=!1),e}},{key:"elementsNeedRelayout",value:function(e,t){return e!==t&&(!(e&&t&&e.nodes&&e.edges&&t.nodes&&t.edges&&e.nodes.length===t.nodes.length&&e.edges.length===t.edges.length)||!(this.nodeOrEdgeArrayHasSameIds(t.nodes,e.nodes)&&this.nodeOrEdgeArrayHasSameIds(t.edges,e.edges)))}},{key:"nodeOrEdgeArrayHasSameIds",value:function(e,t){var a=e.map((function(e){return e.id})).sort();return t.map((function(e){return e.id})).sort().every((function(e,t){return e===a[t]}))}},{key:"fixLoopOverlap",value:function(e){e.$(":loop").forEach((function(e){var t=e.source(),a=t.connectedEdges().subtract(e);e.style("loop-direction",-.7854),e.style("loop-sweep",-1.5707);var n=!1;if(a.forEach((function(a){var r=a.source().same(t)?a.sourceEndpoint():a.targetEndpoint();if(Yf(r,e.sourceEndpoint())<=1||Yf(r,e.targetEndpoint())<=1)return n=!0,!1})),n)if(1!==a.length){var r=[];a.forEach((function(e){var a=e.source().same(t)?e.sourceEndpoint():e.targetEndpoint(),n=function(e,t){return Math.atan2(t.y,t.x)-Math.atan2(e.y,e.x)}(function(e){var t=Math.sqrt(e.x*e.x+e.y*e.y);return{x:e.x/t,y:e.y/t}}({x:a.x-t.position().x,y:a.y-t.position().y}),{x:0,y:1});r.push(n<0?n+2*Math.PI:n)})),r.sort((function(e,t){return e-t}));for(var i={start:0,end:0,value:0},o=0;o<r.length;++o){var s=0===o?r[r.length-1]:r[o-1],l=r[o],c=Math.abs(s-l);c>i.value&&(i.value=c,i.start=s,i.end=l)}i.value<1||(i.start>i.end&&(i.end+=2*Math.PI),i.value<=1.5707&&(e.style("loop-sweep",.9*-i.value),i.start+=.05*i.value,i.end-=.05*i.value),e.style("loop-direction",i.start+.5*(i.end-i.start)))}else{var u=e.numericStyle("loop-direction")-.5*e.numericStyle("loop-sweep");e.style("loop-direction",u)}}))}}],[{key:"buildTapEventArgs",value:function(e){var t=e.summaryTarget,a=e.summaryType,n="box"===a?t.descendants():t;if("edge"===a){var r=Ov(t.source()),i=Ov(t.target());return{namespace:r.namespace,type:r.nodeType,source:r[r.nodeType],target:i[i.nodeType]}}return{aggregate:t.data(Lg),aggregateValue:t.data(Dg),app:t.data(Fg),hasMissingSC:n.every((function(e){return e.data(qg)})),isBox:t.data(iv),isIdle:n.every((function(e){return e.data(sv)})),isInaccessible:t.data(lv),isOutside:t.data(uv),isServiceEntry:t.data(dv),namespace:t.data(mv),nodeType:t.data(hv),service:t.data(fv),version:"box"===a?void 0:t.data(Ev),workload:t.data(bv)}}},{key:"isCyNodeClickEvent",value:function(e){var t=e.summaryType;return"node"===t||"box"===t}},{key:"isCyEdgeClickEvent",value:function(e){return"edge"===e.summaryType}}]),a}(r.Component);yb.contextTypes={router:function(){return null}},yb.defaultProps={isMiniGraph:!1},yb.doubleTapMs=350,yb.tapTarget=void 0,yb.tapTimeout=void 0,yb.DataNodeId="data-node-id";var Cb,Sb=function(){function e(){Object(s.a)(this,e),this.data={},this.clazz=""}return Object(l.a)(e,[{key:"aggregate",value:function(e,t){return this.data.aggregate=e,this.data.aggregateValue=t,this}},{key:"app",value:function(e){return this.data.app=e,this}},{key:"class",value:function(e){return this.clazz="."+e,this}},{key:"id",value:function(e){return this.data.id=e,this}},{key:"isBox",value:function(e){return this.data.isBox=e,this}},{key:"namespace",value:function(e){return this.data.namespace=e,this}},{key:"nodeType",value:function(e){return this.data.nodeType=e,this}},{key:"service",value:function(e){return this.data.service=e,this}},{key:"version",value:function(e){return this.data.version=e,this}},{key:"workload",value:function(e){return this.data.workload=e,this}},{key:"build",value:function(){return"node"+this.clazz+this.buildDataSelector()}},{key:"buildDataSelector",value:function(){var e=this;return Object.keys(this.data).reduce((function(t,a){return t+(null==e.data[a]?"[!".concat(a,"]"):"[".concat(a,'="').concat(e.data[a],'"]'))}),"")}}]),e}(),Ab=function(){return"true"===new URLSearchParams(window.location.search).get("kiosk")},Tb=function(){return new URLSearchParams(window.location.search).get(P.JAEGER_SPAN_ID)||void 0},Ob=function(){return new URLSearchParams(window.location.search).get(P.JAEGER_TRACE_ID)||void 0},Ib=function(e){e?q.setParam(P.JAEGER_TRACE_ID,e):q.deleteParam(P.JAEGER_TRACE_ID)},wb=function(e){var t="&".concat(P.GRAPH_EDGES,"=").concat(e.edgeLabels);return t+="&".concat(P.GRAPH_LAYOUT,"=").concat(e.graphLayout.name),t+="&".concat(P.GRAPH_IDLE_EDGES,"=").concat(e.showIdleEdges),t+="&".concat(P.GRAPH_IDLE_NODES,"=").concat(e.showIdleNodes),t+="&".concat(P.GRAPH_SERVICE_NODES,"=").concat(e.showServiceNodes),t+="&".concat(P.GRAPH_TRAFFIC,"=").concat(e.trafficRates),t+="&".concat(P.GRAPH_TYPE,"=").concat(e.graphType),t+="&".concat(P.DURATION,"=").concat(e.duration),t+="&".concat(P.OPERATION_NODES,"=").concat(e.showOperationNodes),t+="&".concat(P.REFRESH_INTERVAL,"=").concat(e.refreshInterval)},Rb=function(e){var t=e.node;if(!t)return"";switch(t.nodeType){case Ze.AGGREGATE:return"/graph/node/namespaces/".concat(t.namespace.name,"/aggregates/").concat(t.aggregate,"/").concat(t.aggregateValue,"?")+wb(e);case Ze.APP:return t.version&&"unknown"!==t.version?"/graph/node/namespaces/".concat(t.namespace.name,"/applications/").concat(t.app,"/versions/").concat(t.version,"?")+wb(e):"/graph/node/namespaces/".concat(t.namespace.name,"/applications/").concat(t.app,"?")+wb(e);case Ze.BOX:return"/graph/node/namespaces/".concat(t.namespace.name,"/applications/").concat(t.app,"?")+wb(e);case Ze.SERVICE:return"/graph/node/namespaces/".concat(t.namespace.name,"/services/").concat(t.service,"?")+wb(e);case Ze.WORKLOAD:return"/graph/node/namespaces/".concat(t.namespace.name,"/workloads/").concat(t.workload,"?")+wb(e);default:return console.debug("makeNodeUrl defaulting to makeNamespaceUrl"),function(e){var t=wb(e);if(e.activeNamespaces.length>0){var a=e.activeNamespaces.map((function(e){return e.name})).join(",");t+="&".concat(P.NAMESPACES,"=").concat(a)}return Ab()&&(t+="&kiosk=true"),"/graph/namespaces?"+t}(e)}},kb=Object(Jn.a)({width:"100%",height:"100%"}),xb=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).cytoscapeGraphRef=void 0,n.refresh=function(){n.setState({graphData:n.props.dataSource.graphData})},n.handleNodeTap=function(e){if(!e.isInaccessible&&!e.isServiceEntry){var t=n.props.dataSource.fetchParameters.node,a="box"===e.nodeType&&e.isBox?e.isBox:e.workload?"workload":e.nodeType;if(!((null===t||void 0===t?void 0:t.namespace.name)===e.namespace&&t.nodeType===a&&t[t.nodeType]===e[a])){var r=n.cytoscapeGraphRef.current.getCy();r&&r.$(":selected").selectify().unselect().unselectify();var i=e[a],o=a===Ze.APP?"application":a;U.push("/namespaces/".concat(e.namespace,"/").concat(o,"s/").concat(i))}}},n.onGraphActionsToggle=function(e){n.setState({isKebabOpen:e})},n.onViewFullGraph=function(){var e=n.props.dataSource.fetchParameters.namespaces[0].name,t=(new Sb).namespace(e),a=Xe.APP;switch(n.props.dataSource.fetchParameters.node.nodeType){case Ze.AGGREGATE:t=t.aggregate(n.props.dataSource.fetchParameters.node.aggregate,n.props.dataSource.fetchParameters.node.aggregateValue).nodeType(Ze.AGGREGATE);break;case Ze.APP:t=t.app(n.props.dataSource.fetchParameters.node.app).nodeType(Ze.APP);break;case Ze.SERVICE:a=Xe.SERVICE,t=t.service(n.props.dataSource.fetchParameters.node.service);break;case Ze.WORKLOAD:a=Xe.WORKLOAD,t=t.workload(n.props.dataSource.fetchParameters.node.workload)}var r="/graph/namespaces?graphType=".concat(a,"&injectServiceNodes=true&namespaces=").concat(e,"&focusSelector=").concat(encodeURI(t.build()));U.push(r)},n.onViewNodeGraph=function(){var e=n.props.dataSource.fetchParameters.graphType;switch(n.props.dataSource.fetchParameters.node.nodeType){case Ze.APP:e=Xe.APP;break;case Ze.SERVICE:e=Xe.SERVICE;break;case Ze.WORKLOAD:e=Xe.WORKLOAD}var t={activeNamespaces:n.props.dataSource.fetchParameters.namespaces,duration:n.props.dataSource.fetchParameters.duration,edgeLabels:n.props.dataSource.fetchParameters.edgeLabels,graphLayout:Yt.getState().graph.layout,graphType:e,node:n.props.dataSource.fetchParameters.node,refreshInterval:Yt.getState().userSettings.refreshInterval,showIdleEdges:n.props.dataSource.fetchParameters.showIdleEdges,showIdleNodes:n.props.dataSource.fetchParameters.showIdleNodes,showOperationNodes:n.props.dataSource.fetchParameters.showOperationNodes,showServiceNodes:!0,trafficRates:n.props.dataSource.fetchParameters.trafficRates};U.push(Rb(t))},n.cytoscapeGraphRef=r.createRef(),n.state={isKebabOpen:!1,graphData:e.dataSource.graphData},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.props.dataSource.on("fetchSuccess",this.refresh),this.props.dataSource.on("fetchError",this.refresh)}},{key:"componentWillUnmount",value:function(){this.props.dataSource.removeListener("fetchSuccess",this.refresh),this.props.dataSource.removeListener("fetchError",this.refresh)}},{key:"render",value:function(){var e=this,t=[r.createElement(up.a,{key:"viewFullGraph",onClick:this.onViewFullGraph},"Show full graph"),r.createElement(up.a,{key:"viewNodeGraph",onClick:this.onViewNodeGraph},"Show node graph")],a=1e3*this.props.dataSource.graphTimestamp,n=a-1e3*this.props.dataSource.graphDuration,i=a>0?wf(n,a,{second:"2-digit"},{second:"2-digit"}):"Loading";return r.createElement(Ef.a,{style:{height:"100%"},id:"MiniGraphCard"},r.createElement(Uf.a,null,r.createElement(Bf.a,null,r.createElement(Ru.a,{toggle:r.createElement(Wf.a,{onToggle:this.onGraphActionsToggle}),dropdownItems:t,isPlain:!0,isOpen:this.state.isKebabOpen,position:"right"})),r.createElement(bf.a,null,r.createElement(Eo.a,{style:{float:"left"},headingLevel:"h5",size:"lg"},i))),r.createElement(yf.a,null,r.createElement("div",{style:{height:"100%"}},r.createElement(yb,{compressOnHide:!0,containerClassName:this.props.graphContainerStyle?this.props.graphContainerStyle:kb,graphData:{elements:this.state.graphData,errorMessage:this.props.dataSource.errorMessage?this.props.dataSource.errorMessage:void 0,isError:this.props.dataSource.isError,isLoading:this.props.dataSource.isLoading,fetchParams:this.props.dataSource.fetchParameters,timestamp:this.props.dataSource.graphTimestamp},toggleIdleNodes:function(){},edgeLabels:this.props.dataSource.fetchParameters.edgeLabels,isMTLSEnabled:this.props.mtlsEnabled,isMiniGraph:!0,onEdgeTap:this.props.onEdgeTap,layout:lt.getLayout(),onNodeTap:this.handleNodeTap,ref:function(t){return e.setCytoscapeGraph(t)},refreshInterval:0,showIdleEdges:!1,showMissingSidecars:!0,showOperationNodes:!1,showSecurity:!0,showServiceNodes:!0,showTrafficAnimation:!1,showIdleNodes:!1,showVirtualServices:!0}))))}},{key:"setCytoscapeGraph",value:function(e){this.cytoscapeGraphRef.current=e}}]),a}(r.Component),Nb=Object(Jn.a)({padding:"0 0 0 0",margin:"0 0 0 0"}),jb=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"columns",value:function(){return[{title:"Name"},{title:"Status",transforms:[Object(oo.a)(10)]}]}},{key:"noIstioConfig",value:function(){return[{cells:[{title:r.createElement(Cu.a,{variant:Cu.b.small,className:Nb},r.createElement(Su.a,{className:Nb},"No Istio Config found for ",this.props.name)),props:{colSpan:2}}]}]}},{key:"overviewLink",value:function(e){return r.createElement(gc,{name:e.name,namespace:e.namespace||"",type:e.type},e.name)}},{key:"rows",value:function(){var e=this;if(0===this.props.items.length)return this.noIstioConfig();var t=[];return this.props.items.sort((function(e,t){return e.type<t.type?-1:e.type>t.type?1:e.name<t.name?-1:1})).map((function(a,n){return t.push({cells:[{title:r.createElement("span",null,r.createElement(pc,{badge:Vc[a.type].badge,position:lo.b.top}),e.overviewLink(a))},{title:r.createElement(Mo,{id:n+"-config-validation",validations:a.validation?[a.validation]:[],style:{verticalAlign:"-0.5em"}})}]}),t})),t}},{key:"render",value:function(){return r.createElement(Ef.a,{isCompact:!0,id:"IstioConfigCard"},r.createElement(Uf.a,null,r.createElement(Bf.a,null),r.createElement(bf.a,null,r.createElement(Eo.a,{style:{float:"left"},headingLevel:"h5",size:"lg"},"Istio Config"))),r.createElement(yf.a,null,r.createElement(Eu.b,{variant:Eu.e.compact,"aria-label":"list_istio_config",cells:this.columns(),rows:this.rows(),className:"table"},r.createElement(bu.a,null),r.createElement(kp.a,null))))}}]),a}(r.Component),Pb=Object(Jn.a)({fontSize:"70%",color:nt.White}),Lb=Object(Jn.a)({fontSize:"1.1rem",color:nt.White}),Db=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).statusList=function(){return e.props.status?[{c:"CDS",s:e.props.status.CDS},{c:"EDS",s:e.props.status.EDS},{c:"LDS",s:e.props.status.LDS},{c:"RDS",s:e.props.status.RDS}].map((function(e,t){if(Da(e.s))return null;var a=e.s?e.s:"-";return r.createElement(Rh.a,{key:"proxy-status-"+t,className:Pb},e.c+": "+a)})):[]},e}return Object(l.a)(a,[{key:"render",value:function(){return this.props.status&&!La(this.props.status)?r.createElement(wh.a,null,r.createElement(Rh.a,{className:Lb},"Istio Proxy Status"),this.statusList()):null}}]),a}(r.Component),Fb=Object(Jn.a)({color:nt.White}),_b=Object(Jn.a)({color:nt.White,fontSize:"1.1rem"}),Mb=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"validationList",value:function(){return(this.props.checks||[]).map((function(e,t){return i.a.createElement(Rh.a,{key:"validation-check-item-"+t,className:Fb},i.a.createElement(Lo,{key:"validation-check-"+t,severity:e.severity,message:(e.code?e.code+" ":"")+e.message}))}))}},{key:"render",value:function(){return Ch(this.props.checks||[])===fo.Correct?null:i.a.createElement(wh.a,null,i.a.createElement(Rh.a,{className:_b},i.a.createElement(Ro.a,{component:Ro.b.h1},"Istio validations")),this.validationList())}}]),a}(i.a.Component),Hb=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).proxyStatusSeverity=function(){return e.props.proxyStatus&&!La(e.props.proxyStatus)?Ra:xa},e.severityIcon=function(){var t=e.proxyStatusSeverity(),a=Sh(Ch(e.props.checks||[]));return Fa(t,a)},e.showTooltip=function(){var t=e.proxyStatusSeverity(),a=Ch(e.props.checks||[]);return t.name!==xa.name||a!==fo.Correct},e.content=function(){return i.a.createElement(i.a.Fragment,null,i.a.createElement(Db,{status:e.props.proxyStatus}),i.a.createElement(Mb,{checks:e.props.checks}))},e}return Object(l.a)(a,[{key:"render",value:function(){return this.showTooltip()?i.a.createElement(lo.a,{"aria-label":"Pod Status",position:lo.b.auto,enableFlip:!0,content:this.content()},i.a.createElement("span",null,vo(this.severityIcon(),"sm"))):vo(xa,"sm")}}]),a}(i.a.Component),Gb=Object(Jn.a)({padding:"0 0 0 0",margin:"0 0 0 0"}),Vb=Object(Jn.a)({margin:"0px 0 11px 0",$nest:{"& > ul > li > span":{float:"left",width:"125px",fontWeight:700}}}),Ub=Object(Jn.a)({margin:"0px 5px 2px 10px",verticalAlign:"-4px !important"}),Bb=Object(Jn.a)({display:"inline-block",verticalAlign:"2px !important"}),Wb=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"columns",value:function(){return[{title:"Name"},{title:"Status",transforms:[Object(oo.a)(10)]}]}},{key:"noPods",value:function(){return[{cells:[{title:r.createElement(Cu.a,{variant:Cu.b.small,className:Gb},r.createElement(Su.a,{className:Gb},"No Pods in workload ",this.props.workload)),props:{colSpan:2}}]}]}},{key:"rows",value:function(){var e=this;if(0===(this.props.pods||[]).length)return this.noPods();var t=[];return(this.props.pods||[]).sort((function(e,t){return e.name<t.name?-1:1})).map((function(a,n){var i={};e.props.validations[a.name]&&(i=e.props.validations[a.name]);var o=r.createElement("div",{key:"properties-list",className:Vb},r.createElement("ul",{style:{listStyleType:"none"}},r.createElement("li",null,r.createElement("span",null,"Created"),r.createElement("div",{style:{display:"inline-block"}},r.createElement(Rf,{time:a.createdAt}))),r.createElement("li",null,r.createElement("span",null,"Created By"),r.createElement("div",{style:{display:"inline-block"}},a.createdBy&&a.createdBy.length>0?a.createdBy.map((function(e){return e.name+" ("+e.kind+")"})).join(", "):"Not found")),r.createElement("li",null,r.createElement("span",null,"Istio Init Container"),r.createElement("div",{style:{display:"inline-block"}},a.istioInitContainers?a.istioInitContainers.map((function(e){return"".concat(e.image)})).join(", "):"Not found")),r.createElement("li",null,r.createElement("span",null,"Istio Container"),r.createElement("div",{style:{display:"inline-block"}},a.istioContainers?a.istioContainers.map((function(e){return"".concat(e.image)})).join(", "):"Not found")),r.createElement("li",null,r.createElement("span",null,"Labels"),r.createElement("div",{style:{display:"inline-block"}},r.createElement(Vh,{labels:a.labels,expanded:!0})))));return t.push({cells:[{title:r.createElement("span",null,r.createElement("div",{key:"service-icon",className:Bb},r.createElement(pc,{badge:cc.Pod,position:lo.b.top})),a.name,r.createElement(lo.a,{position:lo.b.right,content:r.createElement("div",{style:{textAlign:"left"}},o)},r.createElement(fi.Info,{className:Ub})))},{title:r.createElement(r.Fragment,null,r.createElement(Hb,{proxyStatus:a.proxyStatus,checks:i.checks}))}]}),t})),t}},{key:"render",value:function(){return r.createElement(Ef.a,{isCompact:!0,id:"WorkloadPodsCard"},r.createElement(bf.a,null,r.createElement(Eo.a,{headingLevel:"h5",size:"lg"},"Pods")),r.createElement(yf.a,null,r.createElement(Eu.b,{variant:Eu.e.compact,"aria-label":"list_workloads_pods",cells:this.columns(),rows:this.rows(),className:"table"},r.createElement(bu.a,null),r.createElement(kp.a,null))))}}]),a}(r.Component),qb=Object(Jn.a)({height:"100%"}),Kb=["gateways","authorizationpolicies","peerauthentications","sidecars","requestauthentications","envoyfilters"],zb=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).graphDataSource=new Vf,n.fetchBackend=function(){if(n.props.workload){n.graphDataSource.fetchForWorkload(n.props.duration,n.props.namespace,n.props.workload.name),n.setState({validations:n.workloadValidations(n.props.workload)});var e=n.props.workload.labels,t=[];Object.keys(e).forEach((function(a){var n=a+(e[a]?"="+e[a]:"");t.push(n)}));var a=t.join(",");Promise.all([fn(n.props.namespace,n.props.workload.name,n.props.workload?n.props.workload.type:"",n.props.duration,!!n.props.workload&&n.props.workload.istioSidecar),ln(n.props.namespace,Kb,!0,"",a)]).then((function(e){n.setState({health:e[0],workloadIstioConfig:e[1].data})})).catch((function(e){return _n("Could not fetch Health/IstioConfig.",e)}))}},n.goToMetrics=function(e){if(e.source!==e.target&&n.props.workload){var t=e.source===n.props.workload.name?"outbound":"inbound",a="inbound"===t?"source_canonical_service":"destination_canonical_service",r=new URLSearchParams(U.location.search);r.set("tab","inbound"===t?"in_metrics":"out_metrics"),r.set(P.BY_LABELS,a+"="+(e.source===n.props.workload.name?e.target:e.source)),U.replace(U.location.pathname+"?"+r.toString())}},n.state={currentTab:uh("list","pods")},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.fetchBackend()}},{key:"componentDidUpdate",value:function(e){e.duration===this.props.duration&&this.props.workload===e.workload||this.fetchBackend()}},{key:"workloadValidations",value:function(e){var t=this,a={message:"Pod has no Istio sidecar",severity:fo.Warning,path:""},n={message:"Pod has no app label",severity:fo.Warning,path:""},r={message:"Pod has no version label",severity:fo.Warning,path:""},i={message:"Pod is in Pending Phase",severity:fo.Warning,path:""},o={message:"Pod is in Unknown Phase",severity:fo.Warning,path:""},s={message:"Pod is in Failed Phase",severity:fo.Error,path:""},l={message:"Pod has failing container",severity:fo.Warning,path:""},c={message:"Pod has failing Istio container",severity:fo.Warning,path:""},u={message:"Pod has failing app container",severity:fo.Warning,path:""},p={};return e.pods.length>0&&(p.pod={},e.pods.forEach((function(e){switch(p.pod[e.name]={name:e.name,objectType:"pod",valid:!0,checks:[]},_(t.props.namespace)||(e.istioContainers&&0!==e.istioContainers.length?e.istioContainers.forEach((function(t){t.isReady||-1!==p.pod[e.name].checks.indexOf(c)||p.pod[e.name].checks.push(c)})):p.pod[e.name].checks.push(a),e.containers&&0!==e.containers.length?e.containers.forEach((function(t){t.isReady||-1!==p.pod[e.name].checks.indexOf(u)||p.pod[e.name].checks.push(u)})):p.pod[e.name].checks.push(l),e.labels?(e.appLabel||p.pod[e.name].checks.push(n),e.versionLabel||p.pod[e.name].checks.push(r)):(p.pod[e.name].checks.push(n),p.pod[e.name].checks.push(r))),e.status){case"Pending":p.pod[e.name].checks.push(i);break;case"Unknown":p.pod[e.name].checks.push(o);break;case"Failed":p.pod[e.name].checks.push(s)}e.statusReason&&p.pod[e.name].checks.push({message:e.statusReason,severity:fo.Warning,path:""}),p.pod[e.name].valid=0===p.pod[e.name].checks.length}))),p}},{key:"render",value:function(){var e,t,a,n=this,i=this.props.workload,o=(null===i||void 0===i?void 0:i.pods)||[],s=this.state.workloadIstioConfig?_i(this.state.workloadIstioConfig):[];if(null===(e=this.state.workloadIstioConfig)||void 0===e?void 0:e.validations){var l={};[{field:"gateways",validation:"gateway"},{field:"sidecars",validation:"sidecar"},{field:"envoyFilters",validation:"envoyfilter"},{field:"requestAuthentications",validation:"requestauthentication"},{field:"authorizationPolicies",validation:"authorizationpolicy"},{field:"peerAuthentications",validation:"peerauthentication"}].forEach((function(e){var t;n.state.workloadIstioConfig&&n.state.workloadIstioConfig.validations[e.validation]&&(l[e.validation]=[],null===(t=n.state.workloadIstioConfig[e.field])||void 0===t||t.forEach((function(t){return l[e.validation].push(t.metadata.name)})))}))}var c=this.state.tabHeight?this.state.tabHeight-115:300,u=Object(Jn.a)({width:"100%",height:c});return r.createElement(r.Fragment,null,r.createElement(Zn,{onResize:function(e){return n.setState({tabHeight:e})}},r.createElement(Df.a,{gutter:"md",className:qb},r.createElement(Ff.a,{span:4},r.createElement(wh.a,{gutter:"md"},r.createElement(Rh.a,null,r.createElement(Lf,{workload:i,health:this.state.health,namespace:this.props.namespace})),r.createElement(Rh.a,null,r.createElement(Wb,{namespace:this.props.namespace,workload:(null===(t=this.props.workload)||void 0===t?void 0:t.name)||"",pods:o,validations:(null===(a=this.state.validations)||void 0===a?void 0:a.pod)||{}})),r.createElement(Rh.a,{style:{paddingBottom:"20px"}},r.createElement(jb,{name:this.props.workload?this.props.workload.name:"",items:s})))),r.createElement(Ff.a,{span:8},r.createElement(xb,{onEdgeTap:this.goToMetrics,dataSource:this.graphDataSource,mtlsEnabled:this.props.mtlsEnabled,graphContainerStyle:u})))))}}]),a}(r.Component),Yb=Object(h.b)((function(e){return{duration:fl(e),lastRefreshAt:e.globalState.lastRefreshAt,mtlsEnabled:Nl(e)}}))(zb),Qb=["0.5","0.95","0.99","0.999"],Xb=Object(Jn.a)({marginLeft:10,fontWeight:700}),Jb=Object(Jn.a)({marginLeft:10}),Zb=Object(Jn.a)({marginLeft:18}),$b=Object(Jn.a)({height:"1em"}),ey=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;Object(s.a)(this,a),(n=t.call(this,e)).checkSelected=function(){var e=!0;n.state.labelsSettings.forEach((function(t){!1===t.checked?e=!1:Object.keys(t.values).forEach((function(a){!1===t.values[a]&&(e=!1)}))})),n.setState({allSelected:e})},n.onToggle=function(e){n.setState({isOpen:e})},n.onGroupingChanged=function(e,t){var a=n.state.labelsSettings.get(e);a&&(a.checked=t),n.updateLabelsSettingsURL(n.state.labelsSettings),n.setState({labelsSettings:new Map(n.state.labelsSettings)},(function(){n.props.onChanged(n.state),n.checkSelected()}))},n.onLabelsFiltersChanged=function(e,t,a,r){var i=function(e,t,a,n,r){var i=new Map(e),o=i.get(t);if(o){if(r)for(var s=0,l=Object.keys(o.values);s<l.length;s++){var c=l[s];o.values[c]=!1}o.values[a]=n}return i}(n.state.labelsSettings,e,t,a,r);n.updateLabelsSettingsURL(i),n.setState({labelsSettings:i},(function(){n.props.onLabelsFiltersChanged(i),n.checkSelected()}))},n.updateLabelsSettingsURL=function(e){var t=new URLSearchParams(U.location.search);t.delete(P.BY_LABELS),e.forEach((function(e,a){if(e.checked){var n=Object.keys(e.values).filter((function(t){return e.values[t]})).join(",");n?t.append(P.BY_LABELS,a+"="+n):t.append(P.BY_LABELS,a)}})),U.replace(U.location.pathname+"?"+t.toString())},n.onHistogramAverageChanged=function(e){var t=new URLSearchParams(U.location.search);t.set(P.SHOW_AVERAGE,String(e)),U.replace(U.location.pathname+"?"+t.toString()),n.setState({showAverage:e},(function(){return n.props.onChanged(n.state)}))},n.onHistogramOptionsChanged=function(e,t){var a=t?[e].concat(n.state.showQuantiles):n.state.showQuantiles.filter((function(t){return e!==t})),r=new URLSearchParams(U.location.search);r.set(P.QUANTILES,a.join(" ")),U.replace(U.location.pathname+"?"+r.toString()),n.setState({showQuantiles:a},(function(){return n.props.onChanged(n.state)}))},n.bulkUpdate=function(e){n.state.labelsSettings.forEach((function(t){t.checked=e,Object.keys(t.values).forEach((function(a){t.values[a]=e}))})),n.updateLabelsSettingsURL(n.state.labelsSettings),n.setState({labelsSettings:new Map(n.state.labelsSettings)},(function(){n.props.onChanged(n.state)}))},n.onBulkAll=function(){n.bulkUpdate(!0),n.setState({allSelected:!0})},n.onBulkNone=function(){n.bulkUpdate(!1),n.setState({allSelected:!1})};var r=ie();return r.labelsSettings=ee(e.labelsSettings,r.labelsSettings),n.state=Object(C.a)(Object(C.a)({},r),{},{isOpen:!1,allSelected:!1}),n}return Object(l.a)(a,[{key:"componentDidUpdate",value:function(e){var t=e.direction!==this.props.direction,a=ie(),n=t?a.labelsSettings:new Map,r=t?n:this.state.labelsSettings,i=ee(this.props.labelsSettings,r);RE()(r,i)&&!t||this.setState((function(e){return{labelsSettings:i,showQuantiles:t?a.showQuantiles:e.showQuantiles,showAverage:t?a.showAverage:e.showAverage,showSpans:t?a.showSpans:e.showSpans}}),this.checkSelected)}},{key:"render",value:function(){var e=this.props.hasHistograms,t=this.state.labelsSettings.size>0;return e||t?r.createElement(Ru.a,{toggle:r.createElement(ku.a,{onToggle:this.onToggle},"Metrics Settings"),isOpen:this.state.isOpen},r.createElement("div",{style:{paddingLeft:"10px",backgroundColor:nt.White},className:"pf-c-dropdown__menu-item"},t&&this.renderBulkSelector(),t&&this.renderLabelOptions(),e&&this.renderHistogramOptions())):null}},{key:"renderBulkSelector",value:function(){var e=this;return r.createElement("div",null,r.createElement(Iu.a,{id:"bulk-select-id",key:"bulk-select-key","aria-label":"Select all metric/label filters",isChecked:this.state.allSelected,onClick:function(){e.state.allSelected?e.onBulkNone():e.onBulkAll()}}),r.createElement("span",{className:Xb},"Select all metric/label filters"),r.createElement(wu.a,{style:{paddingTop:"5px"}}))}},{key:"renderLabelOptions",value:function(){var e=this,t=[];return this.state.labelsSettings.forEach((function(a,n){var i=a.checked&&a.values?Object.keys(a.values).map((function(t){return r.createElement("div",{key:"groupings_"+n+"_"+t,className:Zb},a.singleSelection?r.createElement(qp.a,{isChecked:a.values[t],id:t,onChange:function(a){return e.onLabelsFiltersChanged(n,t,!0,!0)},label:oe(n,t),name:t,value:t}):r.createElement("label",null,r.createElement("input",{type:"checkbox",checked:a.values[t],onChange:function(a){return e.onLabelsFiltersChanged(n,t,a.target.checked,!1)}}),r.createElement("span",{className:Jb},oe(n,t))))})):null;t.push(r.createElement("div",{key:"groupings_"+n},r.createElement("label",null,r.createElement("input",{type:"checkbox",checked:a.checked,onChange:function(t){return e.onGroupingChanged(n,t.target.checked)}}),r.createElement("span",{className:Jb},a.displayName)),i))})),r.createElement(r.Fragment,null,r.createElement("label",null,"Show metrics by:"),t,r.createElement("div",{className:$b}))}},{key:"renderHistogramOptions",value:function(){var e=this,t=[r.createElement("div",{key:"histo_avg"},r.createElement("label",null,r.createElement("input",{type:"checkbox",checked:this.state.showAverage,onChange:function(t){return e.onHistogramAverageChanged(t.target.checked)}}),r.createElement("span",{className:Jb},"Average")))].concat(Qb.map((function(t,a){var n=e.state.showQuantiles.includes(t);return r.createElement("div",{key:"histo_"+a},r.createElement("label",null,r.createElement("input",{type:"checkbox",checked:n,onChange:function(a){return e.onHistogramOptionsChanged(t,a.target.checked)}}),r.createElement("span",{className:Jb},"Quantile ",t)))})));return r.createElement(r.Fragment,null,r.createElement("label",null,"Histograms:"),t,r.createElement("div",{className:$b}))}}]),a}(r.Component),ty=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).reporter=void 0,n.onReporterChanged=function(e){q.setParam(P.REPORTER,e),n.reporter=e,n.props.onChanged(n.reporter)},n.reporter=a.initialReporter(e.direction),n}return Object(l.a)(a,[{key:"render",value:function(){return r.createElement(ul,{id:"metrics_filter_reporter",disabled:!1,handleSelect:this.onReporterChanged,nameDropdown:"Reported from",value:this.reporter,initialLabel:a.ReporterOptions[this.reporter],options:a.ReporterOptions})}}]),a}(r.Component);ty.ReporterOptions={destination:"Destination",source:"Source"},ty.initialReporter=function(e){var t=q.getParam(P.REPORTER);return void 0!==t?t:"inbound"===e?"destination":"source"},function(e){e[e.SERVICE=0]="SERVICE",e[e.WORKLOAD=1]="WORKLOAD",e[e.APP=2]="APP"}(Cb||(Cb={}));var ay=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=a.buildGrafanaLinks(this.props);return r.createElement(r.Fragment,null,1===e.length&&r.createElement(or.a,{style:{borderRight:"none"}},r.createElement("a",{id:"grafana_link_0",title:e[0][0],href:e[0][1],target:"_blank",rel:"noopener noreferrer"},"View in Grafana ",r.createElement(Jf.a,null))),e.length>1&&r.createElement(or.a,{style:{borderRight:"none"}},"View in Grafana:\xa0",e.map((function(e,t){return r.createElement("a",{id:"grafana_link_"+t,title:e[0],href:e[1],target:"_blank",rel:"noopener noreferrer"},e[0]," ",r.createElement(Jf.a,null))})).reduce((function(e,t){return[e,", ",t]}))))}}],[{key:"buildGrafanaLinks",value:function(e){var t=[];return e.links.forEach((function(a){var n=a.url.includes("?")?"&":"?",r=a.variables.namespace?"&".concat(a.variables.namespace,"=").concat(e.namespace):"",i=a.variables.version&&e.version?"&".concat(a.variables.version,"=").concat(e.version):"";switch(e.objectType){case Cb.SERVICE:var o="".concat(e.object,".").concat(e.namespace,".svc.cluster.local");if(a.variables.service){var s="".concat(a.url).concat(n).concat(a.variables.service,"=").concat(o).concat(r).concat(i);t.push([a.name,s])}break;case Cb.WORKLOAD:if(a.variables.workload){var l="".concat(a.url).concat(n).concat(a.variables.workload,"=").concat(e.object).concat(r).concat(i);t.push([a.name,l])}break;case Cb.APP:if(a.variables.app){var c="".concat(a.url).concat(n).concat(a.variables.app,"=").concat(e.object).concat(r).concat(i);t.push([a.name,c])}}})),t}}]),a}(r.PureComponent),ny=function(){function e(t){Object(s.a)(this,e),this.onChange=t,this.spans=[],this.lastFetchError=!1}return Object(l.a)(e,[{key:"reset",value:function(){this.spans=[]}},{key:"setSpans",value:function(e){this.spans=e}},{key:"fetch",value:function(e){var t=this,a=le(e.range,de,(function(e){return e})),n=(new Date).getTime()-6e5,r={startMicros:a.from?1e3*a.from:1e3*n,endMicros:a.to?1e3*a.to:void 0};this.spans=this.spans.filter((function(e){return e.startTime>=r.startMicros&&(void 0===r.endMicros||e.startTime<=r.endMicros)})),this.spans.length>0&&(r.startMicros=1+Math.max.apply(Math,Object(mt.a)(this.spans.map((function(e){return e.startTime}))))),(e.targetKind===Cb.APP?In:e.targetKind===Cb.SERVICE?wn:Rn)(e.namespace,e.target,r).then((function(e){t.lastFetchError=!1,t.spans=t.spans.concat(e.data),t.onChange(t.buildOverlay())})).catch((function(e){t.lastFetchError||(_n("Could not fetch spans.",e),t.lastFetchError=!0)}))}},{key:"buildOverlay",value:function(){if(this.spans.length>0)return function(e,t){return{info:e,vcLine:Js(t,e.lineInfo)}}({lineInfo:{name:"Span duration",unit:"seconds",color:nt.Cyan300,symbol:"circle",size:10},dataStyle:{fill:function(e){return e.datum.error?nt.Danger:nt.Cyan300},fillOpacity:.6},buckets:this.spans.length>1e3?15:0},this.spans.map((function(e){var t=e.tags.some((function(e){return"error"===e.key&&e.value})),a=e.tags.filter((function(e){return"http.method"===e.key})),n=a.length>0?a[0].value:void 0;return{name:"".concat(n&&"[".concat(n,"] ")).concat(e.operationName),x:new Date(e.startTime/1e3),y:Number(e.duration/1e6),error:t,color:t?nt.Danger:nt.Cyan300,size:4,traceId:e.traceID,spanId:e.spanID}})))}}]),e}(),ry=a(167),iy=a(47),oy=a(1495),sy=a(1496),ly=a(1497),cy=a(1494),uy=a(860),py=a(858),dy=a(320),my=a(1566),hy=a(1549),fy=function(e,t,a){a=Math.round(1e4*a)/1e4;var n="";switch(t){case"seconds":n=yy(e,a,"s",!0);break;case"bytes":case"bytes-si":n=vy(e,a,"B",!0);break;case"bytes-iec":n=Ey(e,a,"B",!0);break;case"bitrate":case"bitrate-si":n=vy(e,a,"bit/s",!0);break;case"bitrate-iec":n=Ey(e,a,"bit/s",!0);break;case"connrate":n=vy(e,a,"conn/s",!0);break;case"msgrate":n=vy(e,a,"msg/s",!0);break;default:n=vy(e,a,t,!0)}return n.split(" ")[1]},gy=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return function(n){switch(n=Math.round(1e4*n)/1e4,t){case"seconds":return yy(e,n,"s",a);case"bytes":case"bytes-si":return vy(e,n,"B",a);case"bytes-iec":return Ey(e,n,"B",a);case"bitrate":case"bitrate-si":return vy(e,n,"bit/s",a);case"bitrate-iec":return Ey(e,n,"bit/s",a);case"connrate":return vy(e,n,"conn/s",a);case"msgrate":return vy(e,n,"msg/s",a);default:return vy(e,n,t,a)}}},vy=function(e,t,a,n){var r=by(e,t,1e3,["k","M","G","T","P","E","Z","Y"],n);return n?r+a:r},Ey=function(e,t,a,n){var r=by(e,t,1024,["Ki","Mi","Gi","Ti","Pi","Ei","Zi","Yi"],n);return n?r+a:r},by=function(e,t,a,n,r){if(Math.abs(t)<a)return t+" ";var i=-1;do{t/=a,++i}while(Math.abs(t)>=a&&i<n.length-1);var o=e("~r")(t);return r?o+" "+n[i]:o},yy=function(e,t,a,n){for(var r=e("~s")(t),i="",o=r.length-1;o>=0;o--){var s=r.charAt(o);if(s>="0"&&s<="9"){var l=r.substr(0,o+1);return n?l+" "+i+a:l}i=s+i}return n?r+a:r},Cy=a(1473),Sy=a(387),Ay=function(e,t,a){return e+": "+gy(hy.a,t.unit,!0)(a/(t.scaleFactor||1))},Ty=function(e,t,a){var n={labels:function(e){if(e.datum.hideLabel||a())return"";if(void 0!==e.datum._median){var t=e.datum.y.reduce((function(e,t){return e+t}),0)/e.datum.y.length;return"".concat(e.datum.name," (").concat(e.datum.y.length," datapoints)\n          ").concat(Ay("avg",e.datum,t),", ").concat(Ay("min",e.datum,e.datum._min),", ").concat(Ay("max",e.datum,e.datum._max),"\n          ").concat(Ay("p25",e.datum,e.datum._q1),", ").concat(Ay("p50",e.datum,e.datum._median),", ").concat(Ay("p75",e.datum,e.datum._q3))}return Ay(e.datum.name,e.datum,e.datum.y)},labelComponent:e,voronoiBlacklist:["parent"]};if(t){var i=Object(Cy.b)("brush","voronoi");return r.createElement(i,Object.assign({brushDimension:"x",brushDomain:{x:[0,0]},brushStyle:{stroke:"transparent",fill:"blue",fillOpacity:.1},defaultBrushArea:"none",onBrushCleared:t.onCleared,onBrushDomainChange:t.onDomainChange,onBrushDomainChangeEnd:t.onDomainChangeEnd},n))}return r.createElement(Sy.a,n)},Oy={tickLabels:{fontSize:12,padding:2},grid:{fill:"none",stroke:"#ECEFF1",strokeDasharray:"10, 5",strokeLinecap:"round",strokeLinejoin:"round",pointerEvents:"painted"}},Iy=Object(Jn.a)({margin:"0px 5px 2px 10px",verticalAlign:"-4px !important"}),wy=Object(Jn.a)({margin:"0px 0px 0px 0px",verticalAlign:"-4px !important"}),Ry=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).containerRef=void 0,n.hoveredItem=void 0,n.mouseOnLegend=!1,n.onTooltipOpen=function(e){e&&e.length>0?n.hoveredItem=e[0]:n.hoveredItem=void 0},n.onTooltipClose=function(){n.hoveredItem=void 0},n.onShowMoreLegend=function(){n.setState((function(e){return{showMoreLegend:!e.showMoreLegend}}))},n.renderTimeSeries=function(e){var t=n.props.groupOffset||0;return r.createElement(cy.a,{offset:t,height:e},n.props.data.map((function(e,t){if(!n.state.hiddenSeries.has(e.legendItem.name))return r.cloneElement(n.props.seriesComponent,n.withStyle({key:"serie-"+t,name:"serie-"+t,data:e.datapoints,interpolation:"monotoneX"},e.color))})))},n.renderCategories=function(){var e=1,t=n.props.data.length-n.state.hiddenSeries.size,a=(n.props.sizeRatio||1)*n.state.width/Math.max(t,1);return n.props.data.map((function(t,i){if(!n.state.hiddenSeries.has(t.legendItem.name))return r.cloneElement(n.props.seriesComponent,n.withStyle({key:"serie-"+i,name:"serie-"+i,data:t.datapoints.map((function(t){return Object(C.a)(Object(C.a)({size:a},t),{},{x:e++})})),barWidth:a},t.color))}))},n.withStyle=function(e,t){return!1===n.props.overrideSeriesComponentStyle?e:Object(C.a)(Object(C.a)({},e),{},{style:{data:{fill:n.props.fill?t:void 0,stroke:n.props.stroke?t:void 0}}})},n.handleResize=function(){n.containerRef&&n.containerRef.current&&n.setState({width:n.containerRef.current.clientWidth})},n.containerRef=r.createRef(),n.state={width:0,hiddenSeries:new Set(["overlay"]),showMoreLegend:!1},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this;setTimeout((function(){e.handleResize(),window.addEventListener("resize",e.handleResize)}))}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.handleResize)}},{key:"render",value:function(){var e,t=this,a=this.scaledAxisInfo(this.props.data),n=this.buildFullLegendData(),i=this.buildFilteredLegendData(n),o=n.length>i.length,s=this.props.chartHeight||300,l=this.props.data.length,c=this.props.overlay&&this.props.showSpans||!1,u=c?15:0,p={top:0,bottom:25,left:0,right:10+u},d=[];this.props.onClick&&d.push({target:"parent",eventHandlers:{onClick:function(){return t.hoveredItem&&t.props.onClick(t.hoveredItem),[]}}}),this.props.data.forEach((function(e,a){return t.registerEvents(d,a,"serie-"+a,e.legendItem.name)}));var m=c,h=[],f=1,g=Math.max.apply(Math,Object(mt.a)(this.props.data.map((function(e){return Math.max.apply(Math,Object(mt.a)(e.datapoints.map((function(e){return e.y}))))}))));if(this.props.overlay){this.registerEvents(d,l,"overlay","overlay");var v=Math.max.apply(Math,Object(mt.a)(this.props.overlay.vcLine.datapoints.map((function(e){return e.y}))));if(0!==v&&(f=g/v),this.props.unit===this.props.overlay.info.lineInfo.unit&&f>.5&&f<2&&(m=!1,f=1),h=this.normalizeOverlay(f),this.props.overlay.info.buckets){var E=Object(C.a)(Object(C.a)({},this.props.overlay.info.lineInfo),{},{scaleFactor:f});h=function(e,t,a,n){if(0===t.length)return[];var r="object"===typeof t[0].x?function(e){return new Date(e)}:function(e){return e},i=0,o=0;if(n)i=n[0].getTime(),o=n[1].getTime();else{var s=t.map((function(e){return Number(e.x)}));i=Math.min.apply(Math,Object(mt.a)(s)),o=Math.max.apply(Math,Object(mt.a)(s))}var l=(1+o-i)/e,c=Array.from({length:e},(function(e,t){var n=Math.floor(i+t*l),o=Math.floor(n+l-1);return Object(C.a)(Object(C.a)({},a),{},{start:r(n),end:r(o),x:r(Math.floor(n+l/2)),y:[]})}));return t.forEach((function(e){var t=Math.floor((Number(e.x)-i)/l);t>=0&&t<c.length&&c[t].y.push(e.y)})),c.filter((function(e){return e.y.length>0}))}(this.props.overlay.info.buckets,h,E,this.props.timeWindow)}}var b={onOpen:this.onTooltipOpen,onClose:this.onTooltipClose},y=this.props.labelComponent?r.cloneElement(this.props.labelComponent,b):r.createElement(Us,Object.assign({showTime:!0},b)),S=this.props.data.filter((function(e){return!t.state.hiddenSeries.has(e.legendItem.name)})),A=r.createElement("div",{ref:this.containerRef,style:{marginTop:"0px",height:s}},r.createElement(Rs.a,Object.assign({width:this.state.width,padding:p,events:d,height:s,containerComponent:Ty(y,this.props.brushHandlers,(function(){return t.mouseOnLegend})),scale:{x:"series"===this.props.xAxis?"linear":"time"},domainPadding:{y:1,x:"series"===this.props.xAxis?50:void 0}},this.props.moreChartProps),"series"===this.props.xAxis?r.createElement(uy.a,{domain:[0,S.length+1],style:Oy,tickValues:S.map((function(e){return e.legendItem.name})),theme:py.a.material,tickFormat:function(){return""}}):this.state.width<=275?r.createElement(uy.a,{tickCount:a.count,style:Oy,theme:py.a.material,domain:this.props.timeWindow,tickFormat:function(e){return":".concat(e.getMinutes())}}):r.createElement(uy.a,{tickCount:a.count,style:Oy,theme:py.a.material,domain:this.props.timeWindow}),r.createElement(uy.a,{tickLabelComponent:r.createElement(dy.a,null,r.createElement(Ds.a,null)),dependentAxis:!0,tickFormat:gy(hy.a,this.props.unit),label:fy(hy.a,this.props.unit,g),axisLabelComponent:r.createElement(Ds.a,{y:-10,x:-15,angle:0,renderInPortal:!0}),theme:py.a.material,style:Oy}),m&&this.props.overlay&&r.createElement(uy.a,{dependentAxis:!0,offsetX:this.state.width-u,style:Oy,tickFormat:function(e){var a;return gy(hy.a,(null===(a=t.props.overlay)||void 0===a?void 0:a.info.lineInfo.unit)||"")(e/f)},tickLabelComponent:r.createElement(Ds.a,{dx:15,textAnchor:"start"}),theme:py.a.material,label:fy(hy.a,(null===(e=this.props.overlay)||void 0===e?void 0:e.info.lineInfo.unit)||"",Math.max.apply(Math,Object(mt.a)(this.props.overlay.vcLine.datapoints.map((function(e){return e.y}))))),axisLabelComponent:r.createElement(Ds.a,{y:-10,x:this.state.width,angle:0,renderInPortal:!0})}),"series"===this.props.xAxis?this.renderCategories():this.renderTimeSeries(s-25),c&&(this.props.overlay.info.buckets?r.createElement(my.a,{key:"overlay",name:"overlay",data:h,style:{data:this.props.overlay.info.dataStyle,min:{stroke:this.props.overlay.info.lineInfo.color,strokeWidth:2},max:{stroke:this.props.overlay.info.lineInfo.color,strokeWidth:2},q1:{fill:this.props.overlay.info.lineInfo.color},q3:{fill:this.props.overlay.info.lineInfo.color},median:{stroke:"white",strokeWidth:2}}}):r.createElement(xs.a,{key:"overlay",name:"overlay",data:h,style:{data:this.props.overlay.info.dataStyle}})),r.createElement(js.a,{name:"serie-legend",data:i,x:0,y:s,height:25,width:this.state.width,style:{data:{cursor:"pointer",padding:0},labels:{cursor:"pointer",fontSize:14}},borderPadding:{top:5,left:0,right:0,bottom:0},symbolSpacer:5,gutter:{left:0,right:15}})),o&&r.createElement("div",{style:{position:"relative",left:this.state.width-31,width:16,height:16}},r.createElement(lo.a,{position:lo.b.left,content:r.createElement("div",{style:{textAlign:"left"}},"Show full legend")},r.createElement(vr.a,{variant:vr.b.link,isInline:!0,onClick:function(){return t.onShowMoreLegend()}},r.createElement(fi.MoreLegend,{className:Iy})))),this.state.showMoreLegend&&r.createElement("div",{style:{display:"flex",flexWrap:"wrap",flexDirection:"column",position:"relative",width:this.state.width,height:s,top:-(s+25),background:"var(--pf-global--BackgroundColor--dark-100)",opacity:.7,overflow:"auto"}},n.map((function(e){return r.createElement("div",{style:{color:"white",margin:"auto"}},r.createElement("div",{style:{display:"inline-block",backgroundColor:e.symbol.fill,marginRight:"5px",width:"9px",height:"9px"}}),e.name)}))));return s>30?A:r.createElement("div",null,r.createElement(lo.a,{position:lo.b.right,content:r.createElement("div",{style:{textAlign:"left"}},"Increase height of the chart")},r.createElement(vr.a,{variant:vr.b.link,isInline:!0},r.createElement(fi.MoreLegend,{className:wy}))))}},{key:"buildFullLegendData",value:function(){var e=this;return this.props.data.map((function(t){var a=t.legendItem.name;return e.state.hiddenSeries.has(t.legendItem.name)?{name:a,symbol:Object(C.a)(Object(C.a)({},t.legendItem.symbol),{},{fill:"#72767b"})}:Object(C.a)(Object(C.a)({},t.legendItem),{},{name:a})}))}},{key:"buildFilteredLegendData",value:function(e){for(var t=this.state.width-30-10,a=[],n=0,r=0;r<e.length;r++){var i=e[r];if((n+=12+7*i.name.length+15)>=t)break;a.push(i)}return a}},{key:"registerEvents",value:function(e,t,a,n){var r=this;Bs(e,{legendName:"serie-legend",idx:t,serieID:a,onMouseOver:function(e){return r.mouseOnLegend=!0,"overlay"===n?null:{style:Object(C.a)(Object(C.a)({},e.style),{},{strokeWidth:4,fillOpacity:0})}},onMouseOut:function(){return r.mouseOnLegend=!1,null},onClick:function(){return r.state.hiddenSeries.delete(n)||r.state.hiddenSeries.add(n),r.setState({hiddenSeries:new Set(r.state.hiddenSeries)}),null}})}},{key:"scaledAxisInfo",value:function(e){var t=Math.max.apply(Math,Object(mt.a)(e.map((function(e){return e.datapoints.length}))));return this.state.width<500?{count:Math.min(5,t),format:"%H:%M"}:this.state.width<700?{count:Math.min(10,t),format:"%H:%M"}:{count:Math.min(15,t),format:"%H:%M:%S"}}},{key:"normalizeOverlay",value:function(e){return this.props.overlay.vcLine.datapoints.map((function(t){return Object(C.a)(Object(C.a)({},t),{},{y:t.y*e,scaleFactor:e})}))}}]),a}(r.Component),ky={position:"relative",float:"right"},xy=Object(Jn.a)({padding:"0 0 0 0",margin:"0 0 0 0"}),Ny=Object(Jn.a)({paddingTop:15,paddingLeft:25,paddingRight:25,paddingBottom:12}),jy={fill:!1,stroke:!0,groupOffset:0,seriesComponent:r.createElement(oy.a,null),sizeRatio:1},Py={fill:!0,stroke:!1,groupOffset:0,seriesComponent:r.createElement(Ns.a,null),sizeRatio:1},Ly={fill:!0,stroke:!1,groupOffset:7,seriesComponent:r.createElement(sy.a,null),sizeRatio:1/6},Dy={fill:!0,stroke:!1,groupOffset:0,seriesComponent:r.createElement(xs.a,null),sizeRatio:1/30},Fy=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).getInnerChartHeight=function(){return(n.props.chartHeight||300)-64},n.state={collapsed:n.props.chart.startCollapsed||!n.props.chart.error&&n.isEmpty()},n}return Object(l.a)(a,[{key:"componentDidUpdate",value:function(e){var t=!this.props.data.some((function(e){return 0!==e.datapoints.length}));t!==!e.data.some((function(e){return 0!==e.datapoints.length}))&&this.setState({collapsed:t})}},{key:"render",value:function(){return r.createElement("div",{className:Ny},r.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},r.createElement("div",{style:{minWidth:"0px",display:"inline-block",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}},this.props.chart.name),this.props.onToggleMaximized&&r.createElement("div",{style:ky},r.createElement(vr.a,{variant:vr.b.link,onClick:this.props.onToggleMaximized,isInline:!0},r.createElement(fi.Expand,{className:mi})))),r.createElement("div",{style:{marginTop:20}},this.props.chart.error?this.renderError():this.isEmpty()?this.renderEmpty():this.renderChart()))}},{key:"determineChartType",value:function(){if(void 0===this.props.chart.chartType)return"series"===this.props.chart.xAxis?Ly:jy;switch(this.props.chart.chartType){case"area":return Py;case"bar":return Ly;case"scatter":return Dy;case"line":default:return jy}}},{key:"renderChart",value:function(){if(!this.state.collapsed){var e=this.determineChartType(),t=void 0===this.props.chart.min?void 0:{y:this.props.chart.min},a=void 0===this.props.chart.max?void 0:{y:this.props.chart.max};return r.createElement(Ry,{chartHeight:this.getInnerChartHeight(),data:this.props.data,seriesComponent:e.seriesComponent,fill:e.fill,stroke:e.stroke,showSpans:this.props.showSpans,groupOffset:e.groupOffset,sizeRatio:e.sizeRatio,overlay:this.props.overlay,unit:this.props.chart.unit,isMaximized:this.props.isMaximized,moreChartProps:{minDomain:t,maxDomain:a},onClick:this.props.onClick,brushHandlers:this.props.brushHandlers,timeWindow:this.props.timeWindow,xAxis:this.props.chart.xAxis})}}},{key:"isEmpty",value:function(){return!this.props.data.some((function(e){return 0!==e.datapoints.length}))}},{key:"renderEmpty",value:function(){return r.createElement("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",overflow:"hidden",height:this.getInnerChartHeight()-25,textAlign:"center",borderLeft:"2px solid #ECEFF1",borderBottom:"2px solid #ECEFF1"}},r.createElement(Cu.a,{variant:Cu.b.small,className:xy},this.props.isMaximized&&r.createElement(ib.a,{icon:ly.a}),r.createElement(Su.a,{className:xy},"No data available")))}},{key:"renderError",value:function(){return r.createElement("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",overflow:"hidden",height:this.getInnerChartHeight(),textAlign:"center"}},r.createElement(Cu.a,{variant:Cu.b.small,className:xy},this.props.isMaximized&&r.createElement(ib.a,{icon:function(){return r.createElement(_r.a,{style:{color:"#cc0000"},width:32,height:32})}}),r.createElement(Su.a,{className:xy},"An error occured while fetching this metric:",r.createElement("p",null,r.createElement("i",null,this.props.chart.error)))))}}]),a}(r.Component),_y=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).getChartHeight=function(){if(n.state.maximizedChart)return n.props.dashboardHeight;var e=n.props.dashboard.rows>0?n.props.dashboard.rows:2;return n.props.dashboardHeight/e},n.onToggleMaximized=function(e){var t=n.state.maximizedChart?void 0:e;n.setState({maximizedChart:t}),n.props.expandHandler(t)},n.state={maximizedChart:e.maximizedChart},n}return Object(l.a)(a,[{key:"render",value:function(){var e=this;if(this.state.maximizedChart){var t=this.props.dashboard.charts.find((function(t){return t.name===e.state.maximizedChart}));if(t)return this.renderChart(t)}return r.createElement(Df.a,null,this.props.dashboard.charts.map((function(t){return r.createElement(Ff.a,{span:t.spans,key:t.name},e.renderChart(t))})))}},{key:"renderChart",value:function(e){var t=this,a=this.props.colors||Object(ry.k)(iy.q.multi,iy.r.default).chart.colorScale,n=function(e,t,a){return function(){$s=0;var n=Ks(e.metrics,t);return el(n,e.unit,a,e.xAxis||"time")}}(e,{values:this.props.labelValues,prettifier:this.props.labelPrettifier},a),i=void 0;return this.props.onClick&&(i=function(a){return t.props.onClick(e,a)}),r.createElement(Fy,{key:e.name,chartHeight:this.getChartHeight(),chart:e,showSpans:this.props.showSpans,data:n(),onToggleMaximized:function(){return t.onToggleMaximized(e.name)},isMaximized:void 0!==this.state.maximizedChart,overlay:"series"===e.xAxis?void 0:this.props.overlay,onClick:i,brushHandlers:this.props.brushHandlers,timeWindow:this.props.timeWindow})}}]),a}(r.Component),My=Object(Jn.a)({display:"flex"}),Hy=Object(Jn.a)({height:"100%"}),Gy=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;Object(s.a)(this,a),(n=t.call(this,e)).toolbarRef=void 0,n.options=void 0,n.spanOverlay=void 0,n.refresh=function(){n.fetchMetrics(),n.props.jaegerIntegration&&n.spanOverlay.fetch({namespace:n.props.namespace,target:n.props.object,targetKind:n.props.objectType,range:n.props.timeRange})},n.fetchMetrics=function(){var e,t,a,r;switch(re(n.props.timeRange,n.options),n.props.objectType){case Cb.WORKLOAD:t=n.props.namespace,a=n.props.object,r=n.options,e=Xa(K.GET,qa.workloadDashboard(t,a),r,{});break;case Cb.APP:e=function(e,t,a){return Xa(K.GET,qa.appDashboard(e,t),a,{})}(n.props.namespace,n.props.object,n.options);break;case Cb.SERVICE:default:e=function(e,t,a){return Xa(K.GET,qa.serviceDashboard(e,t),a,{})}(n.props.namespace,n.props.object,n.options)}return e.then((function(e){var t=te(e.data,n.state.labelsSettings);n.setState({dashboard:e.data,labelsSettings:t})})).catch((function(e){throw _n("Could not fetch metrics.",e),e}))},n.onMetricsSettingsChanged=function(e){var t=["inbound"===n.props.direction?"source_canonical_service":"destination_canonical_service"];ne(e,n.options,t),n.fetchMetrics()},n.onLabelsFiltersChanged=function(e){n.setState({labelsSettings:e})},n.onReporterChanged=function(e){n.options.reporter=e,n.fetchMetrics()},n.onClickDataPoint=function(e,t){if("start"in t&&"end"in t)n.onDomainChange([t.start,t.end]);else if("traceId"in t){var a=t.traceId,r=t.spanId,i=n.props.objectType===Cb.APP?"applications":n.props.objectType===Cb.SERVICE?"services":"workloads";U.push("/namespaces/".concat(n.props.namespace,"/").concat(i,"/").concat(n.props.object,"?tab=traces&").concat(P.JAEGER_TRACE_ID,"=").concat(a,"&").concat(P.JAEGER_SPAN_ID,"=").concat(r))}},n.onSpans=function(e){var t=new URLSearchParams(U.location.search);t.set(P.SHOW_SPANS,String(e)),U.replace(U.location.pathname+"?"+t.toString()),n.setState({showSpans:!n.state.showSpans})},n.expandHandler=function(e){var t=new URLSearchParams(U.location.search);t.delete("expand"),e&&t.set("expand",e),U.push(U.location.pathname+"?"+t.toString())},n.toolbarRef=r.createRef();var i=ie();return n.options=n.initOptions(i),n.state={labelsSettings:i.labelsSettings,grafanaLinks:[],tabHeight:300,showSpans:i.showSpans},n.spanOverlay=new ny((function(e){return n.setState({spanOverlay:e})})),n}return Object(l.a)(a,[{key:"initOptions",value:function(e){var t={reporter:ty.initialReporter(this.props.direction),direction:this.props.direction},a=["inbound"===this.props.direction?"source_canonical_service":"destination_canonical_service","inbound"===this.props.direction?"source_workload_namespace":"destination_workload_namespace"];return ne(e,t,a),t}},{key:"componentDidMount",value:function(){this.fetchGrafanaInfo(),this.refresh()}},{key:"componentDidUpdate",value:function(e){if(this.props.direction!==e.direction||this.props.namespace!==e.namespace||this.props.object!==e.object||this.props.objectType!==e.objectType||this.props.lastRefreshAt!==e.lastRefreshAt||!me(this.props.timeRange,e.timeRange)){if(this.props.direction!==e.direction){var t=ie();this.options=this.initOptions(t),this.setState({labelsSettings:t.labelsSettings})}this.spanOverlay.reset(),this.refresh()}}},{key:"fetchGrafanaInfo",value:function(){var e=this;a.grafanaInfoPromise||(a.grafanaInfoPromise=bn().then((function(e){if(204!==e.status)return e.data}))),a.grafanaInfoPromise.then((function(t){t?e.setState({grafanaLinks:t.externalLinks}):e.setState({grafanaLinks:[]})})).catch((function(e){Fn(Object(C.a)(Object(C.a)({},Mn("Could not fetch Grafana info. Turning off links to Grafana.",e)),{},{group:"default",type:Te.INFO,showNotification:!1}))}))}},{key:"onDomainChange",value:function(e){if(e&&e[0]&&e[1]){var t={from:e[0].getTime(),to:e[1].getTime()};this.props.setTimeRange(t)}}},{key:"render",value:function(){var e=this,t=new URLSearchParams(U.location.search).get("expand")||void 0,a=44+(this.toolbarRef.current?this.toolbarRef.current.clientHeight:51)+15+24+20,n=this.state.tabHeight-a;return r.createElement(Zn,{onResize:function(t){return e.setState({tabHeight:t})}},r.createElement(Ef.a,{className:Hy},r.createElement(yf.a,null,this.renderOptionsBar(),this.state.dashboard&&r.createElement(_y,{dashboard:this.state.dashboard,labelValues:ae(this.state.labelsSettings),maximizedChart:t,expandHandler:this.expandHandler,onClick:this.onClickDataPoint,labelPrettifier:oe,overlay:this.state.spanOverlay,showSpans:this.state.showSpans,dashboardHeight:n,timeWindow:ue(this.props.timeRange),brushHandlers:{onDomainChangeEnd:function(t,a){return e.onDomainChange(a.currentDomain.x)}}}))))}},{key:"renderOptionsBar",value:function(){var e=this;return r.createElement("div",{ref:this.toolbarRef},r.createElement(dr.a,{style:{paddingBottom:15}},r.createElement(ir.a,null,r.createElement(or.a,null,r.createElement(ey,{onChanged:this.onMetricsSettingsChanged,onLabelsFiltersChanged:this.onLabelsFiltersChanged,direction:this.props.direction,labelsSettings:this.state.labelsSettings,hasHistograms:!0}))),r.createElement(ir.a,null,r.createElement(or.a,{className:My},r.createElement(ty,{onChanged:this.onReporterChanged,direction:this.props.direction}))),r.createElement(ir.a,null,r.createElement(or.a,{className:My},r.createElement("div",{style:ky,className:"pf-c-check"},r.createElement("input",{key:"spans-show-chart",id:"spans-show-",className:"pf-c-check__input",style:{marginBottom:"3px"},type:"checkbox",checked:this.state.showSpans,onChange:function(t){return e.onSpans(t.target.checked)}}),r.createElement("label",{className:"pf-c-check__label",style:{paddingLeft:"5px",paddingRight:"5px"}},"Spans")))),r.createElement(ir.a,{style:{marginLeft:"auto",paddingRight:"20px"}},r.createElement(ay,{links:this.state.grafanaLinks,namespace:this.props.namespace,object:this.props.object,objectType:this.props.objectType}))))}}]),a}(r.Component);Gy.grafanaInfoPromise=void 0;var Vy=Object(f.h)(Object(h.b)((function(e){return{jaegerIntegration:!!e.jaegerState.info&&e.jaegerState.info.integration,lastRefreshAt:e.globalState.lastRefreshAt,timeRange:gl(e)}}),(function(e){return{setTimeRange:Object(Ie.b)(vt.setTimeRange,e)}}))(Gy)),Uy=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).aggregator=void 0,n.onAggregatorChanged=function(e){q.setParam(P.AGGREGATOR,e),n.aggregator=e,n.props.onChanged(n.aggregator)},n.aggregator=a.initialAggregator(),n}return Object(l.a)(a,[{key:"render",value:function(){return r.createElement(ul,{id:"metrics_filter_aggregator",disabled:!1,handleSelect:this.onAggregatorChanged,nameDropdown:"Pods aggregation",value:this.aggregator,initialLabel:a.Aggregators[this.aggregator],options:a.Aggregators})}}]),a}(r.Component);Uy.Aggregators={sum:"Sum",avg:"Average",min:"Min",max:"Max",stddev:"Standard deviation",stdvar:"Standard variance"},Uy.initialAggregator=function(){var e=q.getParam(P.AGGREGATOR);return void 0!==e?e:"sum"};var By=Object(Jn.a)({display:"flex"}),Wy=Object(Jn.a)({height:"100%"}),qy=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;Object(s.a)(this,a),(n=t.call(this,e)).toolbarRef=void 0,n.options=void 0,n.spanOverlay=void 0,n.refresh=function(){n.fetchMetrics(),n.props.jaegerIntegration&&n.spanOverlay.fetch({namespace:n.props.namespace,target:n.props.workload||n.props.app,targetKind:n.props.workload?Cb.WORKLOAD:Cb.APP,range:n.props.timeRange})},n.fetchMetrics=function(){var e,t,a;re(n.props.timeRange,n.options),n.options.workload=n.props.workload,n.options.workloadType=n.props.workloadType,(e=n.props.namespace,t=n.props.template,a=n.options,Xa(K.GET,qa.customDashboard(e,t),a,{})).then((function(e){var t=te(e.data,n.state.labelsSettings);n.setState({dashboard:e.data,labelsSettings:t,grafanaLinks:e.data.externalLinks})})).catch((function(e){_n("Could not fetch custom dashboard.",e)}))},n.onMetricsSettingsChanged=function(e){ne(e,n.options,[]),n.fetchMetrics()},n.onLabelsFiltersChanged=function(e){n.setState({labelsSettings:e})},n.onRawAggregationChanged=function(e){n.options.rawDataAggregator=e,n.fetchMetrics()},n.onClickDataPoint=function(e,t){if("start"in t&&"end"in t)n.onDomainChange([t.start,t.end]);else if("traceId"in t){var a=t.traceId,r=t.spanId;U.push("/namespaces/".concat(n.props.namespace,"/applications/").concat(n.props.app,"?tab=traces&").concat(P.JAEGER_TRACE_ID,"=").concat(a,"&").concat(P.JAEGER_SPAN_ID,"=").concat(r))}},n.onSpans=function(e){var t=new URLSearchParams(U.location.search);t.set(P.SHOW_SPANS,String(e)),U.replace(U.location.pathname+"?"+t.toString()),n.setState({showSpans:!n.state.showSpans})},n.expandHandler=function(e){var t=new URLSearchParams(U.location.search);t.delete("expand"),e&&t.set("expand",e),U.push(U.location.pathname+"?"+t.toString())},n.toolbarRef=r.createRef();var i=ie();return n.options=n.initOptions(i),n.state={labelsSettings:i.labelsSettings,grafanaLinks:[],tabHeight:300,showSpans:i.showSpans},n.spanOverlay=new ny((function(e){return n.setState({spanOverlay:e})})),n}return Object(l.a)(a,[{key:"initOptions",value:function(e){var t="".concat(j.istioLabels.appLabelName,":").concat(this.props.app),a=this.props.version?{labelsFilters:"".concat(t,",").concat(j.istioLabels.versionLabelName,":").concat(this.props.version)}:{labelsFilters:t,additionalLabels:"version:Version"};return ne(e,a,[]),a}},{key:"componentDidMount",value:function(){this.refresh()}},{key:"componentDidUpdate",value:function(e){if(this.props.namespace!==e.namespace||this.props.app!==e.app||this.props.workload!==e.workload||this.props.version!==e.version||this.props.template!==e.template||this.props.lastRefreshAt!==e.lastRefreshAt||!me(this.props.timeRange,e.timeRange)){var t=ie();this.options=this.initOptions(t),this.spanOverlay.reset(),this.refresh()}}},{key:"onDomainChange",value:function(e){if(e&&e[0]&&e[1]){var t={from:e[0].getTime(),to:e[1].getTime()};this.props.setTimeRange(t)}}},{key:"render",value:function(){var e=this,t=new URLSearchParams(U.location.search).get("expand")||void 0,a=44+(this.toolbarRef.current?this.toolbarRef.current.clientHeight:51)+15+24+20,n=(this.props.height?this.props.height:this.state.tabHeight)-a,i=this.state.dashboard&&r.createElement(_y,{dashboard:this.state.dashboard,customMetric:!0,template:this.props.template,labelValues:ae(this.state.labelsSettings),maximizedChart:t,expandHandler:this.expandHandler,onClick:this.onClickDataPoint,showSpans:this.state.showSpans,dashboardHeight:n,overlay:this.state.spanOverlay,timeWindow:ue(this.props.timeRange),brushHandlers:{onDomainChangeEnd:function(t,a){return e.onDomainChange(a.currentDomain.x)}}}),o=r.createElement(r.Fragment,null,this.renderOptionsBar(),this.state.dashboard&&i);return r.createElement(r.Fragment,null,this.props.embedded?r.createElement(r.Fragment,null,o):r.createElement(Zn,{onResize:function(t){return e.setState({tabHeight:t})}},r.createElement(Ef.a,{className:Wy},r.createElement(yf.a,null,o))))}},{key:"renderOptionsBar",value:function(){var e,t=this,a=void 0!==this.state.dashboard&&this.state.dashboard.charts.some((function(e){return e.metrics.some((function(e){return e.stat}))})),n=this.state.labelsSettings.size>0;return r.createElement("div",{ref:this.toolbarRef},r.createElement(dr.a,{style:{paddingBottom:15}},(a||n)&&r.createElement(ir.a,null,r.createElement(or.a,null,r.createElement(ey,{onChanged:this.onMetricsSettingsChanged,onLabelsFiltersChanged:this.onLabelsFiltersChanged,direction:(null===(e=this.state.dashboard)||void 0===e?void 0:e.title)||"dashboard",labelsSettings:this.state.labelsSettings,hasHistograms:a}))),r.createElement(ir.a,null,r.createElement(or.a,{className:By},r.createElement(Uy,{onChanged:this.onRawAggregationChanged}))),r.createElement(ir.a,null,r.createElement(or.a,{className:By},r.createElement("div",{className:"pf-c-check"},r.createElement("input",{key:"spans-show-chart",id:"spans-show-",className:"pf-c-check__input",style:{marginBottom:"3px"},type:"checkbox",checked:this.state.showSpans,onChange:function(e){return t.onSpans(e.target.checked)}}),r.createElement("label",{className:"pf-c-check__label",style:{paddingLeft:"5px",paddingRight:"5px"}},"Spans")))),r.createElement(ir.a,{style:{marginLeft:"auto",paddingRight:"20px"}},r.createElement(ay,{links:this.state.grafanaLinks,namespace:this.props.namespace,object:this.props.app,objectType:Cb.APP,version:this.props.version}))))}}]),a}(r.Component),Ky=Object(f.h)(Object(h.b)((function(e){return{jaegerIntegration:!!e.jaegerState.info&&e.jaegerState.info.integration,lastRefreshAt:e.globalState.lastRefreshAt,timeRange:gl(e)}}),(function(e){return{setTimeRange:Object(Ie.b)(vt.setTimeRange,e)}}))(qy)),zy=a(382),Yy=a(237),Qy=a(602),Xy=a.n(Qy),Jy=Object(Jn.a)({color:nt.Gold400,display:"inline-block"}),Zy=Object(Jn.a)({height:"70%",width:"50%"}),$y=Object(Jn.a)({fontFamily:"monospace",fontSize:"14px",backgroundColor:nt.Black1000,color:nt.Gold400,margin:"10px 10px 15px 10px",overflow:"auto",resize:"none",padding:"10px",whiteSpace:"pre",width:"calc(100% - 15px)"}),eC=Object(Jn.a)({overflow:"auto",overflowY:"auto",width:"50%"}),tC=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).accessLogContent=function(e){return r.createElement("div",{style:{textAlign:"left"}},n.accessLogField("authority",e.authority),n.accessLogField("bytes received",e.bytes_received),n.accessLogField("bytes sent",e.bytes_sent),n.accessLogField("downstream local",e.downstream_local),n.accessLogField("downstream remote",e.downstream_remote),n.accessLogField("duration",e.duration),n.accessLogField("forwarded for",e.forwarded_for),n.accessLogField("method",e.method),n.accessLogField("protocol",e.protocol),n.accessLogField("request id",e.request_id),n.accessLogField("requested server",e.requested_server),n.accessLogField("response flags",e.response_flags),n.accessLogField("route name",e.route_name),n.accessLogField("status code",e.status_code),n.accessLogField("tcp service time",e.tcp_service_time),n.accessLogField("timestamp",e.timestamp),n.accessLogField("upstream cluster",e.upstream_cluster),n.accessLogField("upstream failure reason",e.upstream_failure_reason),n.accessLogField("upstream local",e.upstream_local),n.accessLogField("upstream service",e.upstream_service),n.accessLogField("upstream service time",e.upstream_service_time),n.accessLogField("uri param",e.uri_param),n.accessLogField("uri path",e.uri_path),n.accessLogField("user agent",e.user_agent))},n.accessLogField=function(e,t){return r.createElement(r.Fragment,null,r.createElement(vr.a,{key:e,className:Jy,variant:vr.b.link,onClick:function(){return n.handleClick(e)}},e,":\xa0"),r.createElement("span",null,t||"-"),r.createElement("br",null))},n.handleClick=function(e){n.setState({description:n.getDescription(e)})},n.getDescription=function(e){switch(console.log("fetch docs(".concat(e,")")),e){case"authority":return r.createElement(r.Fragment,null,r.createElement("dt",null,"%REQ(X?Y):Z%"),r.createElement("dd",null,r.createElement("dl",{className:"simple"},r.createElement("dt",null,"HTTP"),r.createElement("dd",null,r.createElement("p",null,"Authority is the request authority header %REQ(:AUTHORITY)%")),r.createElement("dt",null,"TCP"),r.createElement("dd",null,r.createElement("p",null,"Not implemented (\u201c-\u201c).")))));case"bytes received":return r.createElement(r.Fragment,null,r.createElement("dt",null,"%BYTES_RECEIVED%"),r.createElement("dd",null,r.createElement("dl",{className:"simple"},r.createElement("dt",null,"HTTP"),r.createElement("dd",null,r.createElement("p",null,"Body bytes received.")),r.createElement("dt",null,"TCP"),r.createElement("dd",null,r.createElement("p",null,"Downstream bytes received on connection."))),r.createElement("p",null,"Renders a numeric value in typed JSON logs.")));case"bytes sent":return r.createElement(r.Fragment,null,r.createElement("dt",null,"%BYTES_SENT%"),r.createElement("dd",null,r.createElement("dl",{className:"simple"},r.createElement("dt",null,"HTTP"),r.createElement("dd",null,r.createElement("p",null,"Body bytes sent. For WebSocket connection it will also include response header bytes.")),r.createElement("dt",null,"TCP"),r.createElement("dd",null,r.createElement("p",null,"Downstream bytes sent on connection."))),r.createElement("p",null,"Renders a numeric value in typed JSON logs.")));case"downstream local":return r.createElement(r.Fragment,null,r.createElement("dt",null,"%DOWNSTREAM_LOCAL_ADDRESS%"),r.createElement("dd",null,r.createElement("p",null,"Local address of the downstream connection. If the address is an IP address it includes both address and port. If the original connection was redirected by iptables REDIRECT, this represents the original destination address restored by the",r.createElement("a",{className:"reference internal",href:"/docs/envoy/latest/configuration/listeners/listener_filters/original_dst_filter#config-listener-filters-original-dst"},r.createElement("span",{className:"std std-ref"},"Original Destination Filter"))," ","using SO_ORIGINAL_DST socket option. If the original connection was redirected by iptables TPROXY, and the listener\u2019s transparent option was set to true, this represents the original destination address and port.")));case"downstream remote":return r.createElement(r.Fragment,null,r.createElement("dt",null,"%DOWNSTREAM_REMOTE_ADDRESS%"),r.createElement("dd",null,r.createElement("p",null,"Remote address of the downstream connection. If the address is an IP address it includes both address and port."),r.createElement("div",{className:"admonition note"},r.createElement("p",{className:"admonition-title"},"Note"),r.createElement("p",null,"This may not be the physical remote address of the peer if the address has been inferred from",r.createElement("a",{className:"reference internal",href:"/docs/envoy/latest/configuration/listeners/listener_filters/proxy_protocol#config-listener-filters-proxy-protocol"},r.createElement("span",{className:"std std-ref"},"Proxy Protocol filter"))," ","or"," ",r.createElement("a",{className:"reference internal",href:"/docs/envoy/latest/configuration/http/http_conn_man/headers#config-http-conn-man-headers-x-forwarded-for"},r.createElement("span",{className:"std std-ref"},"x-forwarded-for")),"."))));case"duration":return r.createElement(r.Fragment,null,r.createElement("dt",null,"%DURATION%"),r.createElement("dd",null,r.createElement("dl",{className:"simple"},r.createElement("dt",null,"HTTP"),r.createElement("dd",null,r.createElement("p",null,"Total duration in milliseconds of the request from the start time to the last byte out.")),r.createElement("dt",null,"TCP"),r.createElement("dd",null,r.createElement("p",null,"Total duration in milliseconds of the downstream connection."))),r.createElement("p",null,"Renders a numeric value in typed JSON logs.")));case"forwarded for":return r.createElement(r.Fragment,null,r.createElement("dt",null,"%REQ(X?Y):Z%"),r.createElement("dd",null,r.createElement("dl",{className:"simple"},r.createElement("dt",null,"HTTP"),r.createElement("dd",null,r.createElement("p",null,"ForwardedFor is the X-Forwarded-For header value %REQ(FORWARDED-FOR)%")),r.createElement("dt",null,"TCP"),r.createElement("dd",null,r.createElement("p",null,"Not implemented (\u201c-\u201c).")))));case"method":return r.createElement(r.Fragment,null,r.createElement("dt",null,"%REQ(X?Y):Z%"),r.createElement("dd",null,r.createElement("dl",{className:"simple"},r.createElement("dt",null,"HTTP"),r.createElement("dd",null,r.createElement("p",null,"Method is the HTTP method %REQ(:METHOD)%")),r.createElement("dt",null,"TCP"),r.createElement("dd",null,r.createElement("p",null,"Not implemented (\u201c-\u201c).")))));case"protocol":return r.createElement(r.Fragment,null,r.createElement("dt",null,"%PROTOCOL%"),r.createElement("dd",null,r.createElement("dl",{className:"simple"},r.createElement("dt",null,"HTTP"),r.createElement("dd",null,r.createElement("p",null,"Protocol. Currently either ",r.createElement("em",null,"HTTP/1.1")," or ",r.createElement("em",null,"HTTP/2"),".")),r.createElement("dt",null,"TCP"),r.createElement("dd",null,r.createElement("p",null,"Not implemented (\u201c-\u201c)."))),r.createElement("p",null,"In typed JSON logs, PROTOCOL will render the string"," ",r.createElement("code",{className:"docutils literal notranslate"},r.createElement("span",{className:"pre"},'"-"'))," ","if the protocol is not available (e.g. in TCP logs).")));case"request id":return r.createElement(r.Fragment,null,r.createElement("dt",null,"%REQ(X?Y):Z%"),r.createElement("dd",null,r.createElement("dl",{className:"simple"},r.createElement("dt",null,"HTTP"),r.createElement("dd",null,r.createElement("p",null,'RequestId is the envoy generated X-REQUEST-ID header "%REQ(X-REQUEST-ID)%"')),r.createElement("dt",null,"TCP"),r.createElement("dd",null,r.createElement("p",null,"Not implemented (\u201c-\u201c).")))));case"requested server":return r.createElement(r.Fragment,null,r.createElement("dt",null,"%REQUESTED_SERVER_NAME%"),r.createElement("dd",null,r.createElement("dl",{className:"simple"},r.createElement("dt",null,"HTTP"),r.createElement("dd",null,r.createElement("p",null,"String value set on ssl connection socket for Server Name Indication (SNI)")),r.createElement("dt",null,"TCP"),r.createElement("dd",null,r.createElement("p",null,"String value set on ssl connection socket for Server Name Indication (SNI)")))));case"response flags":return r.createElement(r.Fragment,null,r.createElement("dt",null,"%RESPONSE_FLAGS%"),r.createElement("dd",null,r.createElement("p",null,"Additional details about the response or connection, if any. For TCP connections, the response codes mentioned in the descriptions do not apply. Possible values are:"),r.createElement("dl",{className:"simple"},r.createElement("dt",null,"HTTP and TCP"),r.createElement("dd",null,r.createElement("ul",{className:"simple"},r.createElement("li",null,r.createElement("p",null,r.createElement("strong",null,"UH"),": No healthy upstream hosts in upstream cluster in addition to 503 response code.")),r.createElement("li",null,r.createElement("p",null,r.createElement("strong",null,"UF"),": Upstream connection failure in addition to 503 response code.")),r.createElement("li",null,r.createElement("p",null,r.createElement("strong",null,"UO"),": Upstream overflow (",r.createElement("a",{className:"reference internal",href:"/docs/envoy/latest/intro/arch_overview/upstream/circuit_breaking#arch-overview-circuit-break"},r.createElement("span",{className:"std std-ref"},"circuit breaking")),") in addition to 503 response code.")),r.createElement("li",null,r.createElement("p",null,r.createElement("strong",null,"NR"),": No"," ",r.createElement("a",{className:"reference internal",href:"/docs/envoy/latest/intro/arch_overview/http/http_routing#arch-overview-http-routing"},r.createElement("span",{className:"std std-ref"},"route configured"))," ","for a given request in addition to 404 response code, or no matching filter chain for a downstream connection.")),r.createElement("li",null,r.createElement("p",null,r.createElement("strong",null,"URX"),": The request was rejected because the"," ",r.createElement("a",{className:"reference internal",href:"/docs/envoy/latest/api-v3/config/route/v3/route_components.proto#envoy-v3-api-field-config-route-v3-retrypolicy-num-retries"},r.createElement("span",{className:"std std-ref"},"upstream retry limit (HTTP)"))," ","or"," ",r.createElement("a",{className:"reference internal",href:"/docs/envoy/latest/api-v3/extensions/filters/network/tcp_proxy/v3/tcp_proxy.proto#envoy-v3-api-field-extensions-filters-network-tcp-proxy-v3-tcpproxy-max-connect-attempts"},r.createElement("span",{className:"std std-ref"},"maximum connect attempts (TCP)"))," ","was reached.")),r.createElement("li",null,r.createElement("p",null,r.createElement("strong",null,"NC"),": Upstream cluster not found.")))),r.createElement("dt",null,"HTTP only"),r.createElement("dd",null,r.createElement("ul",{className:"simple"},r.createElement("li",null,r.createElement("p",null,r.createElement("strong",null,"DC"),": Downstream connection termination.")),r.createElement("li",null,r.createElement("p",null,r.createElement("strong",null,"LH"),": Local service failed"," ",r.createElement("a",{className:"reference internal",href:"/docs/envoy/latest/intro/arch_overview/upstream/health_checking#arch-overview-health-checking"},r.createElement("span",{className:"std std-ref"},"health check request"))," ","in addition to 503 response code.")),r.createElement("li",null,r.createElement("p",null,r.createElement("strong",null,"UT"),": Upstream request timeout in addition to 504 response code.")),r.createElement("li",null,r.createElement("p",null,r.createElement("strong",null,"LR"),": Connection local reset in addition to 503 response code.")),r.createElement("li",null,r.createElement("p",null,r.createElement("strong",null,"UR"),": Upstream remote reset in addition to 503 response code.")),r.createElement("li",null,r.createElement("p",null,r.createElement("strong",null,"UC"),": Upstream connection termination in addition to 503 response code.")),r.createElement("li",null,r.createElement("p",null,r.createElement("strong",null,"DI"),": The request processing was delayed for a period specified via"," ",r.createElement("a",{className:"reference internal",href:"/docs/envoy/latest/configuration/http/http_filters/fault_filter#config-http-filters-fault-injection"},r.createElement("span",{className:"std std-ref"},"fault injection")),".")),r.createElement("li",null,r.createElement("p",null,r.createElement("strong",null,"FI"),": The request was aborted with a response code specified via"," ",r.createElement("a",{className:"reference internal",href:"/docs/envoy/latest/configuration/http/http_filters/fault_filter#config-http-filters-fault-injection"},r.createElement("span",{className:"std std-ref"},"fault injection")),".")),r.createElement("li",null,r.createElement("p",null,r.createElement("strong",null,"RL"),": The request was ratelimited locally by the"," ",r.createElement("a",{className:"reference internal",href:"/docs/envoy/latest/configuration/http/http_filters/rate_limit_filter#config-http-filters-rate-limit"},r.createElement("span",{className:"std std-ref"},"HTTP rate limit filter"))," ","in addition to 429 response code.")),r.createElement("li",null,r.createElement("p",null,r.createElement("strong",null,"UAEX"),": The request was denied by the external authorization service.")),r.createElement("li",null,r.createElement("p",null,r.createElement("strong",null,"RLSE"),": The request was rejected because there was an error in rate limit service.")),r.createElement("li",null,r.createElement("p",null,r.createElement("strong",null,"IH"),": The request was rejected because it set an invalid value for a",r.createElement("a",{className:"reference internal",href:"/docs/envoy/latest/api-v3/extensions/filters/http/router/v3/router.proto#envoy-v3-api-field-extensions-filters-http-router-v3-router-strict-check-headers"},r.createElement("span",{className:"std std-ref"},"strictly-checked header"))," ","in addition to 400 response code.")),r.createElement("li",null,r.createElement("p",null,r.createElement("strong",null,"SI"),": Stream idle timeout in addition to 408 response code.")),r.createElement("li",null,r.createElement("p",null,r.createElement("strong",null,"DPE"),": The downstream request had an HTTP protocol error.")),r.createElement("li",null,r.createElement("p",null,r.createElement("strong",null,"UPE"),": The upstream response had an HTTP protocol error.")),r.createElement("li",null,r.createElement("p",null,r.createElement("strong",null,"UMSDR"),": The upstream request reached to max stream duration.")))))));case"route name":return r.createElement(r.Fragment,null,r.createElement("dt",null,"%ROUTE_NAME%"),r.createElement("dd",null,r.createElement("p",null,"RouteName is the name of the VirtualService route which matched this request %ROUTE_NAME%")));case"status code":return r.createElement(r.Fragment,null,r.createElement("dt",null,"%RESPONSE_CODE%"),r.createElement("dd",null,r.createElement("dl",null,r.createElement("dt",null,"HTTP"),r.createElement("dd",null,r.createElement("p",null,"HTTP response code. Note that a response code of \u20180\u2019 means that the server never sent the beginning of a response. This generally means that the (downstream) client disconnected."),r.createElement("p",null,"Note that in the case of 100-continue responses, only the response code of the final headers will be logged. If a 100-continue is followed by a 200, the logged response will be 200. If a 100-continue results in a disconnect, the 100 will be logged.")),r.createElement("dt",null,"TCP"),r.createElement("dd",null,r.createElement("p",null,"Not implemented (\u201c-\u201c)."))),r.createElement("p",null,"Renders a numeric value in typed JSON logs.")));case"tcp service time":return r.createElement(r.Fragment,null,r.createElement("dt",null,"%REQ(X?Y):Z%"),r.createElement("dd",null,r.createElement("dl",{className:"simple"},r.createElement("dt",null,"HTTP"),r.createElement("dd",null,r.createElement("p",null,'TCPServiceTime is the X-ENVOY-UPSTREAM-SERVICE-TIME header "%REQ(X-ENVOY-UPSTREAM-SERVICE-TIME)%"')),r.createElement("dt",null,"TCP"),r.createElement("dd",null,r.createElement("p",null,"Not implemented (\u201c-\u201c).")))));case"timestamp":return r.createElement(r.Fragment,null,r.createElement("dt",null,"%START_TIME%"),r.createElement("dd",null,r.createElement("dl",{className:"simple"},r.createElement("dt",null,"HTTP"),r.createElement("dd",null,r.createElement("p",null,"Request start time including milliseconds.")),r.createElement("dt",null,"TCP"),r.createElement("dd",null,r.createElement("p",null,"Downstream connection start time including milliseconds."))),r.createElement("p",null,"START_TIME can be customized using a"," ",r.createElement("a",{className:"reference external",href:"https://en.cppreference.com/w/cpp/io/manip/put_time"},"format string"),". In addition to that, START_TIME also accepts following specifiers:"),r.createElement("table",{className:"docutils align-default"},r.createElement("colgroup",null,r.createElement("col",{style:{width:"28%"}}),r.createElement("col",{style:{width:"72%"}})),r.createElement("thead",null,r.createElement("tr",{className:"row-odd"},r.createElement("th",{className:"head"},r.createElement("p",null,"Specifier")),r.createElement("th",{className:"head"},r.createElement("p",null,"Explanation")))),r.createElement("tbody",null,r.createElement("tr",{className:"row-even"},r.createElement("td",null,r.createElement("p",null,r.createElement("code",{className:"docutils literal notranslate"},r.createElement("span",{className:"pre"},"%s")))),r.createElement("td",null,r.createElement("p",null,"The number of seconds since the Epoch"))),r.createElement("tr",{className:"row-odd"},r.createElement("td",{rowSpan:2},r.createElement("p",null,r.createElement("code",{className:"docutils literal notranslate"},r.createElement("span",{className:"pre"},"%f")),","," ",r.createElement("code",{className:"docutils literal notranslate"},r.createElement("span",{className:"pre"},"%[1-9]f")))),r.createElement("td",null,r.createElement("p",null,"Fractional seconds digits, default is 9 digits (nanosecond)"))),r.createElement("tr",{className:"row-even"},r.createElement("td",null,r.createElement("ul",{className:"simple"},r.createElement("li",null,r.createElement("p",null,r.createElement("code",{className:"docutils literal notranslate"},r.createElement("span",{className:"pre"},"%3f"))," ","millisecond (3 digits)")),r.createElement("li",null,r.createElement("p",null,r.createElement("code",{className:"docutils literal notranslate"},r.createElement("span",{className:"pre"},"%6f"))," ","microsecond (6 digits)")),r.createElement("li",null,r.createElement("p",null,r.createElement("code",{className:"docutils literal notranslate"},r.createElement("span",{className:"pre"},"%9f"))," ","nanosecond (9 digits)"))))))),r.createElement("p",null,"Examples of formatting START_TIME is as follows:"),r.createElement("div",{className:"highlight-none notranslate"},r.createElement("div",{className:"highlight"},r.createElement("pre",null,r.createElement("span",null),"%START_TIME(%Y/%m/%dT%H:%M:%S%z %s)% # To include millisecond fraction of the second (.000 ... .999). E.g. 1527590590.528. %START_TIME(%s.%3f)% %START_TIME(%s.%6f)% %START_TIME(%s.%9f)%"))),r.createElement("p",null,"In typed JSON logs, START_TIME is always rendered as a string.")));case"upstream cluster":return r.createElement(r.Fragment,null,r.createElement("dt",null,"%UPSTREAM_CLUSTER%"),r.createElement("dd",null,r.createElement("p",null,"Upstream cluster to which the upstream host belongs to. If runtime feature",r.createElement("cite",null,"envoy.reloadable_features.use_observable_cluster_name")," is enabled, then"," ",r.createElement("a",{className:"reference internal",href:"/docs/envoy/latest/api-v3/config/cluster/v3/cluster.proto#envoy-v3-api-field-config-cluster-v3-cluster-alt-stat-name"},r.createElement("span",{className:"std std-ref"},"alt_stat_name"))," ","will be used if provided.")));case"upstream failure reason":return r.createElement(r.Fragment,null,r.createElement("dt",null,"%UPSTREAM_TRANSPORT_FAILURE_REASON%"),r.createElement("dd",null,r.createElement("dl",{className:"simple"},r.createElement("dt",null,"HTTP"),r.createElement("dd",null,r.createElement("p",null,"If upstream connection failed due to transport socket (e.g. TLS handshake), provides the failure reason from the transport socket. The format of this field depends on the configured upstream transport socket. Common TLS failures are in"," ",r.createElement("a",{className:"reference internal",href:"/docs/envoy/latest/intro/arch_overview/security/ssl#arch-overview-ssl-trouble-shooting"},r.createElement("span",{className:"std std-ref"},"TLS trouble shooting")),".")),r.createElement("dt",null,"TCP"),r.createElement("dd",null,r.createElement("p",null,"Not implemented (\u201c-\u201c)")))));case"upstream local":return r.createElement(r.Fragment,null,r.createElement("dt",null,"%UPSTREAM_LOCAL_ADDRESS%"),r.createElement("dd",null,r.createElement("p",null,"Local address of the upstream connection. If the address is an IP address it includes both address and port.")));case"upstream service":return r.createElement(r.Fragment,null,r.createElement("dt",null,"%UPSTREAM_HOST%"),r.createElement("dd",null,r.createElement("p",null,"Upstream host URL (e.g.,"," ",r.createElement("a",{className:"reference external",href:"tcp://ip:port"},"tcp://ip:port")," ","for TCP connections).")));case"uri path":return r.createElement(r.Fragment,null,r.createElement("dt",null,"%REQ(X?Y):Z%"),r.createElement("dd",null,r.createElement("dl",{className:"simple"},r.createElement("dt",null,"HTTP"),r.createElement("dd",null,r.createElement("p",null,'An HTTP request header: "%REQ(X-ENVOY-ORIGINAL-PATH?):PATH"')),r.createElement("dt",null,"TCP"),r.createElement("dd",null,r.createElement("p",null,"Not implemented (\u201c-\u201c).")))));case"user agent":return r.createElement(r.Fragment,null,r.createElement("dt",null,"%REQ(X?Y):Z%"),r.createElement("dd",null,r.createElement("dl",{className:"simple"},r.createElement("dt",null,"HTTP"),r.createElement("dd",null,r.createElement("p",null,'An HTTP request header: "%REQ(USER-AGENT)')),r.createElement("dt",null,"TCP"),r.createElement("dd",null,r.createElement("p",null,"Not implemented (\u201c-\u201c).")))));default:return r.createElement(r.Fragment,null,"No documentation available")}},n.state={description:r.createElement("div",{style:{width:"100%",textAlign:"center"}},r.createElement("dt",null,"Click Field Name for Description"))},n}return Object(l.a)(a,[{key:"render",value:function(){return r.createElement(ih.a,{className:Zy,style:{overflow:"auto",overflowY:"hidden"},disableFocusTrap:!0,title:"Envoy Access Log Entry",isOpen:!0,onClose:this.props.onClose},r.createElement("div",{style:{height:"100%"}},r.createElement("div",{className:$y},this.props.accessLogMessage," "),r.createElement(Bh.a,{style:{height:"100%"}},r.createElement(Wh.a,{className:eC,style:{overflow:"auto",marginRight:"10px"}},this.accessLogContent(this.props.accessLog)),r.createElement(Wh.a,{className:eC,style:{overflow:"auto",backgroundColor:nt.Black150}},this.state.description))))}}]),a}(r.Component),aC=[nt.White,nt.LightGreen400,nt.Purple100,nt.LightBlue400],nC=nt.Gold400,rC=nt.Cyan300,iC={"-1":"All lines",10:"10 lines",50:"50 lines",100:"100 lines",300:"300 lines",500:"500 lines",1e3:"1000 lines",5e3:"5000 lines"},oC=Object(Jn.a)({display:"inline-block",margin:"0px 5px 0px 0px",width:"10px"}),sC=Object(Jn.a)({display:"flex"}),lC=Object(Jn.a)({marginLeft:"0.5em",width:"24px"}),cC=Object(Jn.a)({margin:"0 0 10px 0"}),uC=Object(Jn.a)({marginLeft:"1em"}),pC=Object(Jn.a)({marginLeft:"auto"}),dC=Object(Jn.a)({marginTop:"2px"}),mC=Object(Jn.a)({height:"40px",margin:"0 10px 0 0"}),hC=Object(Jn.a)({marginRight:"5px"}),fC=Object(Jn.a)({fontFamily:"monospace",margin:0,overflow:"auto",padding:"10px",resize:"none",whiteSpace:"pre",width:"100%"}),gC=function(e,t){var a=e?"0px":"49px";return{height:t?"calc(100vh - 130px + ".concat(a,")"):"calc(var(--kiali-details-pages-tab-content-height) - 155px + ".concat(a,")")}},vC=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;Object(s.a)(this,a),(n=t.call(this,e)).promises=new yr,n.podOptions=[],n.logsRef=void 0,n.renderItem=function(e){return r.createElement(or.a,{className:sC},e)},n.toggleSpans=function(e){var t=new URLSearchParams(U.location.search);t.set(P.SHOW_SPANS,String(e)),U.replace(U.location.pathname+"?"+t.toString()),n.setState({showSpans:!n.state.showSpans})},n.getContainerLegend=function(){return r.createElement(dp.a,null,r.createElement(mp.a,{fieldId:"container-log-selection",isInline:!0},r.createElement(pc,{badge:{badge:cc.Container.badge,tt:"Containers"},style:{marginRight:"10px"},position:lo.b.top}),n.state.containerOptions.map((function(e,t){return r.createElement("div",{key:"c-d-".concat(t),className:"pf-c-check"},r.createElement("input",{key:"c-i-".concat(t),id:"container-".concat(t),className:"pf-c-check__input",style:{marginBottom:"3px"},type:"checkbox",checked:e.isSelected,onChange:function(){return n.toggleSelected(e)}}),r.createElement("label",{key:"c-l-".concat(t),htmlFor:"container-".concat(t),className:"pf-c-check__label",style:{backgroundColor:nt.Black1000,color:e.color,paddingLeft:"5px",paddingRight:"5px"}},e.displayName))}))))},n.toggleSelected=function(e){e.isSelected=!e.isSelected,n.setState({containerOptions:Object(mt.a)(n.state.containerOptions)})},n.getLogsDiv=function(){var e,t=[r.createElement(up.a,{key:"toggleToolbar",onClick:n.toggleToolbar},"".concat(n.state.showToolbar?"Collapse":"Expand"," Toolbar")),r.createElement(up.a,{key:"toggleRegex",onClick:n.toggleUseRegex},"Match via ".concat(n.state.useRegex?"Substring":"Regex")),r.createElement(up.a,{key:"toggleTimestamps",onClick:n.toggleShowTimestamps},"".concat(n.state.showTimestamps?"Remove":"Show"," Timestamps"))];return r.createElement("div",{key:"logsDiv",id:"logsDiv",className:hC},r.createElement(dr.a,{className:mC},r.createElement(ir.a,null,r.createElement(or.a,null,n.getContainerLegend())),r.createElement(ir.a,{className:pC},r.createElement(or.a,null,r.createElement(lo.a,{key:"copy_logs",position:"top",content:"Copy logs to clipboard"},r.createElement(Yy.CopyToClipboard,{text:n.entriesToString(n.state.entries)},r.createElement(vr.a,{variant:vr.b.link,isInline:!0},r.createElement(fi.Copy,{className:mi}))))),r.createElement(or.a,{className:uC},r.createElement(lo.a,{key:"fullscreen_logs",position:"top",content:"Expand logs full screen"},r.createElement(vr.a,{variant:vr.b.link,onClick:n.toggleFullscreen,isDisabled:!n.hasEntries(n.state.entries),isInline:!0},r.createElement(fi.Expand,{className:mi})))),r.createElement(or.a,null,r.createElement(Ru.a,{style:{width:"20px"},toggle:r.createElement(Wf.a,{onToggle:n.setKebabOpen}),dropdownItems:t,isPlain:!0,isOpen:n.state.kebabOpen,position:"right"})))),r.createElement("div",{key:"logsText",id:"logsText",className:fC,style:Object(C.a)(Object(C.a)({},gC(n.state.showToolbar,n.state.fullscreen)),(e=n.hasEntries(n.state.entries),{backgroundColor:e?nt.Black1000:"gray"})),ref:n.logsRef},n.hasEntries(n.state.entries)?n.state.entries.filter((function(e){return!e.isHidden})).map((function(e,t){if(e.span)return r.createElement("div",{key:"s-".concat(t),style:{height:"22px",lineHeight:"22px"}},n.state.showTimestamps&&r.createElement("span",{key:"al-s-".concat(t),style:{color:rC,fontSize:"12px",marginRight:"5px"}},e.timestamp),r.createElement(lo.a,{key:"al-tt-".concat(t),position:lo.b.auto,entryDelay:1e3,content:"Click to navigate to span detail"},r.createElement(vr.a,{key:"s-b-".concat(t),variant:vr.b.plain,style:{paddingLeft:"6px",width:"10px",height:"10px",fontFamily:"monospace",fontSize:"12px"},onClick:function(){n.gotoSpan(e.span)}},r.createElement(fi.Info,{key:"al-i-".concat(t),className:oC,color:rC}))),r.createElement("p",{key:"al-p-".concat(t),style:{color:rC,fontSize:"12px",verticalAlign:"center",display:"inline-block"}},n.entryToString(e)));var a=e.logEntry;return a.accessLog?r.createElement("div",{key:"al-".concat(t),style:{height:"22px",lineHeight:"22px"}},n.state.showTimestamps&&r.createElement("span",{key:"al-s-".concat(t),style:{color:a.color,fontSize:"12px",marginRight:"5px"}},e.timestamp),r.createElement(lo.a,{key:"al-tt-".concat(t),position:lo.b.auto,entryDelay:1e3,content:"Click for Envoy Access Log details"},r.createElement(vr.a,{key:"al-b-".concat(t),variant:vr.b.plain,style:{paddingLeft:"6px",width:"10px",height:"10px",fontFamily:"monospace",fontSize:"12px"},onClick:function(){n.addAccessLogModal(a.message,a.accessLog)}},r.createElement(fi.Info,{key:"al-i-".concat(t),className:oC,color:a.color}))),r.createElement("p",{key:"al-p-".concat(t),style:{color:a.color,fontSize:"12px",verticalAlign:"center",display:"inline-block"}},a.message)):r.createElement(r.Fragment,null,r.createElement("p",{key:"le-".concat(t),style:{color:a.color,fontSize:"12px"}},n.entryToString(e)))})):"No container logs found for the time period."))},n.getAccessLogModals=function(){var e=[],t=0;return n.state.accessLogModals.forEach((function(a,i){e.push(r.createElement(tC,{key:"alm-".concat(t++),accessLog:a,accessLogMessage:i,onClose:function(){return n.removeAccessLogModal(i)}}))})),e},n.setPod=function(e){var t=n.props.pods[Number(e)],a=n.getContainerOptions(t);n.setState({containerOptions:a,podValue:Number(e)})},n.setTailLines=function(e){n.setState({tailLines:e})},n.setKebabOpen=function(e){n.setState({kebabOpen:e})},n.gotoSpan=function(e){var t="/namespaces/".concat(n.props.namespace,"/workloads/").concat(n.props.workload)+"?tab=traces&".concat(P.JAEGER_TRACE_ID,"=").concat(e.traceID,"&").concat(P.JAEGER_SPAN_ID,"=").concat(e.spanID);U.push(t)},n.addAccessLogModal=function(e,t){var a=new Map(n.state.accessLogModals);a.set(e,t),n.setState({accessLogModals:a})},n.removeAccessLogModal=function(e){n.state.accessLogModals.delete(e);var t=new Map(n.state.accessLogModals);n.setState({accessLogModals:t})},n.toggleShowTimestamps=function(){n.setState({showTimestamps:!n.state.showTimestamps,kebabOpen:!1})},n.toggleToolbar=function(){n.setState({showToolbar:!n.state.showToolbar,kebabOpen:!1})},n.toggleUseRegex=function(){n.setState({useRegex:!n.state.useRegex,kebabOpen:!1})},n.doShowAndHide=function(){n.filterEntries(n.state.entries,n.state.showLogValue,n.state.hideLogValue),n.setState({entries:Object(mt.a)(n.state.entries),showClearShowLogButton:!!n.state.showLogValue,showClearHideLogButton:!!n.state.hideLogValue})},n.checkSubmitShow=function(e){13===(e.keyCode?e.keyCode:e.which)&&(e.preventDefault(),n.doShowAndHide())},n.updateShow=function(e){""===e?n.clearShow():n.setState({showLogValue:e})},n.filterEntries=function(e,t,a){if(e.forEach((function(e){return e.isHidden=void 0})),t)if(n.state.useRegex)try{var r=RegExp(t);e.forEach((function(e){return e.isHidden=e.logEntry&&!r.test(e.logEntry.message)})),n.state.showError&&n.setState({showError:void 0})}catch(o){n.setState({showError:"Show: ".concat(o.message)})}else e.forEach((function(e){return e.isHidden=e.logEntry&&!e.logEntry.message.includes(t)}));if(a)if(n.state.useRegex)try{var i=RegExp(a);e.forEach((function(e){return e.isHidden=e.isHidden||e.logEntry&&i.test(e.logEntry.message)})),n.state.hideError&&n.setState({hideError:void 0})}catch(o){n.setState({hideError:"Hide: ".concat(o.message)})}else e.forEach((function(e){return e.isHidden=e.isHidden||e.logEntry&&e.logEntry.message.includes(a)}))},n.clearShow=function(){var e=document.getElementById("log_show");null!==e&&(e.value=""),n.filterEntries(n.state.entries,"",n.state.hideLogValue),n.setState({showError:void 0,showLogValue:"",showClearShowLogButton:!1,entries:Object(mt.a)(n.state.entries)})},n.checkSubmitHide=function(e){13===(e.keyCode?e.keyCode:e.which)&&(e.preventDefault(),n.doShowAndHide())},n.updateHide=function(e){""===e?n.clearHide():n.setState({hideLogValue:e})},n.clearHide=function(){var e=document.getElementById("log_hide");null!==e&&(e.value=""),n.filterEntries(n.state.entries,n.state.showLogValue,""),n.setState({hideError:void 0,hideLogValue:"",showClearHideLogButton:!1,entries:Object(mt.a)(n.state.entries)})},n.toggleFullscreen=function(){var e=Xy.a;if(e.isFullscreen)e.exit();else{var t=document.getElementById("logs");e.isEnabled&&t&&e.request(t)}},n.getContainerOptions=function(e){var t,a=Object(mt.a)(e.istioContainers||[]);(t=a).push.apply(t,Object(mt.a)(e.containers||[])),a=a.sort((function(e,t){return e.isProxy!==t.isProxy?e.isProxy?0:1:e.name<t.name?0:1}));var n=0;return a.map((function(e){var t=e.name;return e.isProxy?{color:nC,displayName:t,isProxy:!0,isSelected:!0,name:t}:{color:aC[n++%aC.length],displayName:t,isProxy:!1,isSelected:!0,name:t}}))},n.fetchEntries=function(e,t,a,r,i,o){var s=Date.now(),l=ue(o),c=Math.floor(l[0].getTime()/1e3),u=l[1].getTime(),p=0;u<s&&(p=Math.floor(l[1].getTime()/1e3)-c);var d=a.filter((function(e){return e.isSelected})),m=d.map((function(a){return function(e,t,a,n,r,i,o){var s={};return a&&(s.container=a),r&&(s.sinceTime=r),n&&n>0&&(s.tailLines=n),i&&i>0&&(s.duration="".concat(i,"s")),s.isProxy=!!o,Xa(K.GET,qa.podLogs(e,t),s,{})}(e,t,a.name,i,c,p,a.isProxy)}));if(r){var h={endMicros:1e3*u,startMicros:1e6*c};m.unshift(Rn(e,n.props.workload,h))}n.promises.registerAll("logs",m).then((function(e){var t=[];if(r){var a=r?e[0].data:[];t=a.map((function(e){return e.startTime=Math.floor(e.startTime/1e6),{timestamp:TE()(1e3*e.startTime).utc().format("YYYY-MM-DD HH:mm:ss"),timestampUnix:e.startTime,span:e}})),e.shift()}for(var i=function(a){var n=e[a].data.entries;if(!n)return"continue";var r=d[a].color;n.forEach((function(e){e.color=r,t.push({timestamp:e.timestamp,timestampUnix:e.timestampUnix,logEntry:e})}))},o=0;o<e.length;o++)i(o);n.filterEntries(t,n.state.showLogValue,n.state.hideLogValue);var s=t.sort((function(e,t){return e.timestampUnix-t.timestampUnix}));n.setState({entries:s,loadingLogs:!1})})).catch((function(e){if(e.isCanceled)return console.debug("Logs: Ignore fetch error (canceled)."),void n.setState({loadingLogs:!1});var t=e.response&&e.response.data.error?e.response.data.error:e.message,a=Date.now();n.setState({loadingLogs:!1,entries:[{timestamp:a.toString(),timestampUnix:a,logEntry:{severity:"Error",timestamp:a.toString(),timestampUnix:a,message:"Failed to fetch workload logs: ".concat(t)}}]})})),n.setState({loadingLogs:!0,entries:[]})},n.entriesToString=function(e){return e.map((function(e){return n.entryToString(e)})).join("\n")},n.entryToString=function(e){if(e.logEntry){var t=e.logEntry;return n.state.showTimestamps?"".concat(e.timestamp," ").concat(t.message):t.message}var a=e.span,r=a.duration,i=a.operationName;return"duration: ".concat(YE(r),", operationName: ").concat(i)},n.hasEntries=function(e){return!!e&&e.length>0},n.logsRef=r.createRef();var i=new URLSearchParams(U.location.search).get(P.SHOW_SPANS),o={accessLogModals:new Map,entries:[],fullscreen:!1,hideLogValue:"",kebabOpen:!1,loadingLogs:!1,logWindowSelections:[],showClearHideLogButton:!1,showClearShowLogButton:!1,showLogValue:"",showSpans:"true"===i,showTimestamps:!1,showToolbar:!0,tailLines:100,useRegex:!1};if(n.props.pods.length<1)return n.state=Object(C.a)(Object(C.a)({},o),{},{loadingLogsError:"There are no logs to display because no pods are available."}),Object(zy.a)(n);if(n.props.pods.length>0)for(var l=0;l<n.props.pods.length;++l)n.podOptions["".concat(l)]=n.props.pods[l].name;var c=n.props.pods[0],u=n.getContainerOptions(c);return n.state=Object(C.a)(Object(C.a)({},o),{},{containerOptions:u,podValue:0}),n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this;if(Xy.a.onchange((function(){return e.setState({fullscreen:!e.state.fullscreen})})),this.state.containerOptions){var t=this.props.pods[this.state.podValue];this.fetchEntries(this.props.namespace,t.name,this.state.containerOptions,this.state.showSpans,this.state.tailLines,this.props.timeRange)}}},{key:"componentDidUpdate",value:function(e,t){var a=t.containerOptions?t.containerOptions:void 0,n=this.state.containerOptions?this.state.containerOptions:void 0,r=n&&n!==a,i=this.state.tailLines&&t.tailLines!==this.state.tailLines,o=e.lastRefreshAt!==this.props.lastRefreshAt,s=t.showSpans!==this.state.showSpans,l=!me(this.props.timeRange,e.timeRange);if(r||i||o||s||l){var c=this.props.pods[this.state.podValue];this.fetchEntries(this.props.namespace,c.name,n,this.state.showSpans,this.state.tailLines,this.props.timeRange)}t.useRegex!==this.state.useRegex&&this.doShowAndHide(),t.loadingLogs&&!this.state.loadingLogs&&0===this.logsRef.current.scrollTop&&(this.logsRef.current.scrollTop=this.logsRef.current.scrollHeight)}},{key:"componentWillUnmount",value:function(){this.promises.cancelAll()}},{key:"render",value:function(){var e=this;return r.createElement(r.Fragment,null,r.createElement(Zn,null,this.state.containerOptions&&r.createElement(Df.a,{key:"logs",id:"logs",style:{height:"100%"}},r.createElement(Ff.a,{span:12},r.createElement(Ef.a,{style:{height:"100%"}},r.createElement(yf.a,null,this.state.showToolbar&&r.createElement(dr.a,{className:cC},r.createElement(ir.a,null,r.createElement(pc,{badge:cc.Pod,position:lo.b.top}),r.createElement(or.a,{className:sC},r.createElement(ul,{id:"wpl_pods",tooltip:"Display logs for the selected pod",handleSelect:function(t){return e.setPod(t)},value:this.state.podValue,label:this.props.pods[this.state.podValue].name,options:this.podOptions}))),r.createElement(ir.a,null,r.createElement(or.a,null,r.createElement(Ae.a,{id:"log_show",name:"log_show",style:{width:"8em"},isValid:!this.state.showError,autoComplete:"on",type:"text",onKeyPress:this.checkSubmitShow,onChange:this.updateShow,defaultValue:this.state.showLogValue,"aria-label":"show log text",placeholder:"Show..."}),this.state.showClearShowLogButton&&r.createElement(lo.a,{key:"clear_show_log",position:"top",content:"Clear Show Log Entries..."},r.createElement(vr.a,{variant:vr.b.control,onClick:this.clearShow},r.createElement(fi.Close,null))),r.createElement(Ae.a,{id:"log_hide",name:"log_hide",style:{width:"8em"},isValid:!this.state.hideError,autoComplete:"on",type:"text",onKeyPress:this.checkSubmitHide,onChange:this.updateHide,defaultValue:this.state.hideLogValue,"aria-label":"hide log text",placeholder:"Hide..."}),this.state.showClearHideLogButton&&r.createElement(lo.a,{key:"clear_hide_log",position:"top",content:"Clear Hide Log Entries..."},r.createElement(vr.a,{variant:vr.b.control,onClick:this.clearHide},r.createElement(fi.Close,null))),this.state.showError&&r.createElement("div",{style:{color:"red"}},this.state.showError),this.state.hideError&&r.createElement("div",{style:{color:"red"}},this.state.hideError)),r.createElement(or.a,null,r.createElement(lo.a,{key:"show_hide_log_help",position:"top",content:"Show only, or Hide all, matching log entries. Match by case-sensitive substring (default) or regular expression (as set in the kebab menu)."},r.createElement(fi.Info,{className:lC})))),r.createElement(ir.a,null,r.createElement(or.a,{className:sC},r.createElement("div",{className:"pf-c-check"},r.createElement("input",{key:"spans-show-chart",id:"spans-show-",className:"pf-c-check__input",style:{marginBottom:"3px"},type:"checkbox",checked:this.state.showSpans,onChange:function(t){return e.toggleSpans(t.target.checked)}}),r.createElement("label",{className:"pf-c-check__label",style:{backgroundColor:nt.Black1000,color:rC,paddingLeft:"5px",paddingRight:"5px"}},"spans")))),r.createElement(ir.a,{className:pC},r.createElement(or.a,{className:sC},r.createElement(ul,{id:"wpl_tailLines",handleSelect:function(t){return e.setTailLines(Number(t))},value:this.state.tailLines,label:iC[this.state.tailLines],options:iC,tooltip:"Show up to last N log lines",classNameSelect:dC})))),this.getLogsDiv(),this.getAccessLogModals())))),this.state.loadingLogsError&&r.createElement("div",null,this.state.loadingLogsError)))}}]),a}(r.Component),EC=Object(h.b)((function(e){return{timeRange:gl(e),lastRefreshAt:e.globalState.lastRefreshAt}}))(vC),bC=Object(Jn.a)({color:nt.Black600,padding:4,fontSize:12}),yC=Object(Jn.a)({color:nt.Black600,paddingLeft:10,fontSize:14}),CC=function(){function e(t){Object(s.a)(this,e),this.trace=t,this.mDate=void 0,this.numErrors=void 0,this.mDate=TE()(t.startTime/1e3),this.numErrors=this.trace.spans.filter((function(e){return e.tags.some(PE)})).length}return Object(l.a)(e,[{key:"name",value:function(){return this.trace.traceName?this.trace.traceName:"(Missing root span)"}},{key:"fullID",value:function(){return this.trace.traceID}},{key:"shortID",value:function(){return this.trace.traceID.slice(0,6)}},{key:"duration",value:function(){return YE(this.trace.duration)}},{key:"hasErrors",value:function(){return 0!==this.numErrors}},{key:"relativeDate",value:function(){return function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=TE.a.isMoment(e)?e:TE()(e),n=t?"MMMM":"MMM",r=new Date;if(r.getFullYear()!==a.year())return a.format("".concat(n," D, YYYY"));var i=a.month(),o=a.date(),s=r.getDate();return i===r.getMonth()&&o===s?"Today":(r.setDate(s-1),i===r.getMonth()&&o===r.getDate()?"Yesterday":a.format("".concat(n," D")))}(this.trace.startTime/1e3)}},{key:"absTime",value:function(){var e=this.mDate.format("h:mm:ss a");return e.slice(0,-3)+" "+e.slice(-2)}},{key:"fromNow",value:function(){return this.mDate.fromNow()}}]),e}(),SC=function(e){var t=[r.createElement(up.a,{onClick:function(){return U.push(e.graphURL)}},"View on Graph")];e.externalURL&&t.push(r.createElement(up.a,{onClick:function(){return window.open(e.externalURL,"_blank")}},"View in Tracing ",r.createElement(Jf.a,null))),e.comparisonURL&&t.push(r.createElement(up.a,{onClick:function(){return window.open(e.comparisonURL,"_blank")}},"Compare with similar traces ",r.createElement(Jf.a,null)));var a=r.useState(!1),n=Object(T.a)(a,2),i=n[0],o=n[1];return r.createElement(bf.a,null,r.createElement(Ro.a,{component:Ro.b.h3,style:{margin:0,position:"relative"}},e.formattedTrace.name(),r.createElement("span",{className:yC},e.formattedTrace.fullID()),r.createElement("span",{style:{float:"right",position:"relative",top:-9}},e.formattedTrace.relativeDate(),r.createElement("span",{style:{padding:"0 10px 0 10px"}},"|"),e.formattedTrace.absTime()," (",e.formattedTrace.fromNow(),")",r.createElement(Ru.a,{toggle:r.createElement(Wf.a,{onToggle:function(){return o(!i)}}),dropdownItems:t,isPlain:!0,isOpen:i,position:"right",style:{top:3}}))))},AC=function(e){return Ib(e),function(t){var a;e?(a=e,Xa(K.GET,qa.jaegerTrace(a),{},{})).then((function(e){if(e.data.data){var a=NE(e.data.data);a&&t(kt.setTrace(a))}})).catch((function(e){var a;404===(null===(a=e.response)||void 0===a?void 0:a.status)&&Ib(void 0),t(kt.setTrace(void 0)),Fn(Object(C.a)(Object(C.a)({},Mn("Could not fetch trace",e)),{},{showNotification:!1}))})):t(kt.setTrace(void 0))}},TC=function(e){return OC(e.target,e.peerTarget,e.direction,e.interval)},OC=function(e,t,a,n){var r=t?IC(t):"";return"".concat(IC(e),":").concat(r,":").concat(a,":").concat(n)},IC=function(e){return"".concat(e.namespace,":").concat(e.kind,":").concat(e.name)},wC=function(e){var t=e.spans.filter((function(e){return e.duration&&e.duration>0}));return Qf(t,(function(e){return e.duration}))},RC=function(e,t){return Math.abs(e-t)/Math.max(1,Math.max(e,t))},kC=["0.5","0.9","0.99"],xC=["avg"].concat(kC),NC=["10m","60m","6h"],jC=["60m","6h"],PC=function(e){var t=Math.floor(Date.now()/1e3),a=e.filter((function(e){return"envoy"===e.type})).slice(0,10).flatMap((function(e){var a=e.info;if(!a.direction)return console.warn("Could not determine direction from Envoy span."),[];var n=e.workload;if(!n)return console.warn("Could not determine workload from Envoy span."),[];var r={queryTime:t,target:{namespace:e.namespace,name:n,kind:"workload"},peerTarget:void 0,interval:"",direction:a.direction,avg:!0,quantiles:kC};return NC.map((function(e){return Object(C.a)(Object(C.a)({},r),{},{interval:e})}))}));return LC(a)},LC=function(e){var t=new Map;return e.forEach((function(e){var a=TC(e);a&&t.set(a,e)})),Array.from(t.values())},DC=function(e){return new Array(xC.length).fill(0).map((function(){return new Array(e.length).fill(0).map((function(){}))}))},FC=function(e,t){var a=DC(t);return e.forEach((function(e){e.responseTimes.forEach((function(t){var n=xC.indexOf(t.name);n>=0&&(a[n][e.intervalIndex]=t.value)}))})),a},_C=function(e,t,a){return t.flatMap((function(t,n){var r=e.info,i={namespace:e.namespace,name:e.workload,kind:"workload"},o=OC(i,void 0,r.direction,t);if(o){var s=a.get(o);if(s){var l=e.duration/1e3;return[{responseTimes:s.responseTimes.map((function(e){return{name:e.name,value:l-e.value}})),intervalIndex:n}]}}return[]}))},MC=function(e,t,a){var n=!0,r=new Map;e.spans.filter((function(e){return"envoy"===e.type})).forEach((function(e){var i=_C(e,t,a);i.length>0?i.forEach((function(e){e.responseTimes.forEach((function(t){var a=t.name+"@"+e.intervalIndex,n=r.get(a);n?n.values.push(t.value):r.set(a,{name:t.name,intervalIndex:e.intervalIndex,values:[t.value]})}))})):n=!1}));var i=DC(t);return r.forEach((function(e){var t=xC.indexOf(e.name);if(t>=0){var a=e.values.length;a>0&&(i[t][e.intervalIndex]=e.values.reduce((function(e,t){return e+t}),0)/a)}})),{matrix:i,isComplete:n}},HC=a(11),GC=function(e){var t=new Set;return e.forEach((function(e){return t.add(e.process.serviceName)})),t.size},VC=function(e){return e.filter((function(e){return e.tags.some(PE)})).length},UC=function(e){var t=VC(e.spans),a=e.filteredSpans?VC(e.filteredSpans):void 0;return r.createElement(r.Fragment,null,r.createElement(Ph.a,{style:{margin:10}},e.filteredSpans&&"".concat(e.filteredSpans.length," / "),Object(HC.pluralize)(e.spans.length,"Span")),r.createElement(Ph.a,{style:{margin:10}},e.filteredSpans&&"".concat(GC(e.filteredSpans)," / "),Object(HC.pluralize)(GC(e.spans),"App")," involved"),!e.oneline&&r.createElement("br",null),0===t?r.createElement(Ph.a,{style:{margin:10,backgroundColor:nt.Success}},"0 Spans with error"):r.createElement(Ph.a,{style:{margin:10,backgroundColor:0===a?nt.Warning:nt.Danger}},e.filteredSpans&&"".concat(a," / "),Object(HC.pluralize)(t,"Span")," with error"))},BC={load:function(e){return function(t,a){var n=a().metricsStats.data,r=Date.now(),i=new Map(Array.from(n).filter((function(e){var t=Object(T.a)(e,2),a=(t[0],t[1]);return r-a.timestamp<12e4}))),o=e.filter((function(e){return!i.has(TC(e))}));o.length>0&&Pn(o).then((function(e){Object.entries(e.data.stats).forEach((function(e){return i.set(e[0],Object(C.a)(Object(C.a)({},e[1]),{},{timestamp:r}))})),t(jt.setStats(i)),e.data.warnings&&e.data.warnings.length>0&&Hn(e.data.warnings.join("; "),!1)})).catch((function(e){_n("Could not fetch metrics stats.",e)}))}}},WC=Object(Jn.a)({overflow:"hidden",fontSize:".7rem",borderRadius:3,display:"flex",justifyContent:"center",alignItems:"center"}),qC=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).getGridStyle=function(){if("compact"===e.props.displayMode)return{display:"grid",gridTemplateColumns:"0 repeat(".concat(e.props.xLabels.length,", 1fr)"),gridTemplateRows:"0 repeat(".concat(e.props.yLabels.length,", 1rem)"),gridGap:2,maxWidth:"".concat(e.props.xLabels.length,"rem")};var t="large"===e.props.displayMode?3:2;return{display:"grid",gridTemplateColumns:"".concat(t,"rem repeat(").concat(e.props.xLabels.length,", 1fr)"),gridTemplateRows:new Array(e.props.yLabels.length+1).fill("2rem").join(" "),gridGap:2,maxWidth:"".concat(t*(1+e.props.xLabels.length),"rem")}},e.getCellColors=function(t){var a=e.props.dataRange,n=a.from,r=a.to,i=(Math.max(n,Math.min(r,t))-n)/(r-n)*(e.props.colorMap.length-1),o=e.props.colorMap[Math.floor(i)],s=e.props.colorMap[Math.ceil(i)],l=i-Math.floor(i),c=Math.floor((s.r-o.r)*l+o.r),u=Math.floor((s.g-o.g)*l+o.g),p=Math.floor((s.b-o.b)*l+o.b);return{color:.21*c+.72*u+.07*p>128?nt.Black1000:nt.Black100,backgroundColor:"rgb(".concat(c,",").concat(u,",").concat(p,")")}},e}return Object(l.a)(a,[{key:"render",value:function(){var e=this,t="compact"===this.props.displayMode;return i.a.createElement("div",{style:this.getGridStyle()},i.a.createElement("div",null),this.props.xLabels.map((function(e,a){return i.a.createElement("div",{key:"xlabel_"+a,className:WC},t?"":e)})),this.props.yLabels.map((function(a,n){return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{key:"ylabel_"+n,className:WC},t?"":a),e.props.xLabels.map((function(a,r){var o=e.props.data[r][n];if(o){var s=e.getCellColors(o);return i.a.createElement("div",{key:"heatmap_".concat(r,"-").concat(n),className:WC,style:s,title:e.props.tooltip(r,n,o)},!t&&e.props.valueFormat(o))}return i.a.createElement("div",{key:"heatmap_".concat(r,"-").concat(n),className:WC,style:{backgroundColor:e.props.colorUndefined,color:nt.Black1000}},!t&&"n/a")})))})))}}]),a}(i.a.Component);qC.HealthColorMap=[{r:62,g:134,b:53},{r:146,g:212,b:0},{r:228,g:245,b:188},{r:240,g:171,b:0},{r:201,g:25,b:11}];var KC={avg:{short:"avg",long:"average"},.5:{short:"p50",long:"median"},.75:{short:"p75",long:"75th percentile"},.8:{short:"p80",long:"80th percentile"},.9:{short:"p90",long:"90th percentile"},.99:{short:"p99",long:"99th percentile"},.999:{short:"p99.9",long:"99.9th percentile"}},zC=function(e,t,a,n){var i=t?jC:NC,o=_C(e,i,a);return o.length>0?r.createElement(r.Fragment,null,!t&&r.createElement(lo.a,{content:"This heatmap is a comparison matrix of this request duration against duration statistics aggregated over time. Move the pointer over cells to get more details."},r.createElement(r.Fragment,null,r.createElement(Br.a,null)," ",r.createElement("strong",null,"Comparison map: "))),function(e,t,a,n){return r.createElement(qC,{xLabels:xC.map((function(e){var t;return(null===(t=KC[e])||void 0===t?void 0:t.short)||e})),yLabels:a,data:FC(t,a),displayMode:n?"compact":"normal",colorMap:qC.HealthColorMap,dataRange:{from:-10,to:10},colorUndefined:nt.Black200,valueFormat:function(e){return(e>0?"+":"")+SE()(e,1)},tooltip:function(t,n,r){var i,o=r>0?"slower":"faster",s=(null===(i=KC[xC[t]])||void 0===i?void 0:i.long)||xC[t],l=a[n],c=e.info,u="from";"inbound"===c.direction&&(u="to");var p=e.workload;return"This request has been ".concat(SE()(Math.abs(r),2),"ms ").concat(o," than the ").concat(s," of all ").concat(c.direction," requests ").concat(u," ").concat(p," ").concat(""," in the last ").concat(l)}})}(e,o,i,t)):r.createElement(lo.a,{content:"Click to load more statistics for this request"},r.createElement(vr.a,{onClick:n,variant:vr.b.link},r.createElement("strong",null,"Load statistics")))},YC=function(e,t,a){return r.createElement(qC,{xLabels:xC.map((function(e){var t;return(null===(t=KC[e])||void 0===t?void 0:t.short)||e})),yLabels:t,data:e,displayMode:a?"compact":"normal",colorMap:qC.HealthColorMap,dataRange:{from:-10,to:10},colorUndefined:nt.Black200,valueFormat:function(e){return(e>0?"+":"")+SE()(e,1)},tooltip:function(e,a,n){var r,i=n>0?"slower":"faster",o=(null===(r=KC[xC[e]])||void 0===r?void 0:r.long)||xC[e],s=t[a];return"Trace requests have been, in average, ".concat(SE()(Math.abs(n),2),"ms ").concat(i," than the ").concat(o," of the requests involving the same services in the last ").concat(s)}})},QC=["10m","60m","6h"],XC=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n,i;Object(s.a)(this,a),(i=t.call(this,e)).getGraphURL=function(e){var t=(new Sb).namespace(i.props.namespace),a=Xe.APP;switch(i.props.targetKind){case"app":t=t.app(i.props.target).nodeType(Ze.APP);break;case"service":a=Xe.SERVICE,t=t.service(i.props.target);break;case"workload":a=Xe.WORKLOAD,t=t.workload(i.props.target)}return"/graph/namespaces?graphType=".concat(a,"&injectServiceNodes=true&namespaces=").concat(i.props.namespace,"&traceId=").concat(e,"&focusSelector=").concat(encodeURI(t.build()))},i.renderSimilarHeatmap=function(e,t,a){var n=Qf(e,(function(e){return e.duration})),o=e.map((function(e){return wC(e)})).filter((function(e){return void 0!==e})),s=Qf(o,(function(e){return e})),l=function(e,t){return e&&t?(e-t)/1e3:void 0},c=e.slice(0,8),u=c.map((function(e){var t=new CC(e);return r.createElement(lo.a,{content:r.createElement(r.Fragment,null,t.name(),r.createElement("span",{className:bC},t.shortID()),r.createElement("small",null,"(",t.fromNow(),")"))},r.createElement(vr.a,{style:{paddingLeft:0,paddingRight:3,fontSize:"0.7rem"},variant:vr.b.link,onClick:function(){return i.props.setTraceId(e.traceID)}},t.shortID()))})).concat([r.createElement(r.Fragment,null,"Mean")]),p=c.map((function(e){var n=wC(e);return[l(t,e.duration),l(a,n)]})).concat([[l(t,n),l(a,s)]]);return r.createElement(qC,{xLabels:u,yLabels:["Full duration","Spans average"],data:p,displayMode:"large",colorMap:qC.HealthColorMap,dataRange:{from:-10,to:10},colorUndefined:nt.Black200,valueFormat:function(e){return(e>0?"+":"")+SE()(e,1)},tooltip:function(e,t,a){var n=a>0?"slower":"faster",r=SE()(Math.abs(a),2),i=e===c.length?"the mean of all similar traces on chart":c[e].traceID;return"This trace was ".concat(r,"ms ").concat(n," than ").concat(i)}})};var o=Ob();return o&&o!==(null===(n=e.trace)||void 0===n?void 0:n.traceID)?e.setTraceId(o):!o&&e.trace&&e.setTraceId(void 0),i.state={completeMetricsStats:!1},i}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.props.trace&&this.fetchComparisonMetrics(this.props.trace.spans)}},{key:"componentDidUpdate",value:function(e){var t;this.props.trace&&!zE((null===(t=e.trace)||void 0===t?void 0:t.spans)||[],this.props.trace.spans)&&this.fetchComparisonMetrics(this.props.trace.spans)}},{key:"fetchComparisonMetrics",value:function(e){var t=PC(e);this.props.loadMetricsStats(t)}},{key:"render",value:function(){var e=this.props,t=e.trace,a=e.otherTraces,n=e.jaegerURL;if(!t)return null;var i=new CC(t),o=wC(t),s=a.filter((function(e){return e.traceID!==t.traceID&&function(e,t){if(0===e.spans.length||0===t.spans.length)return!1;var a=RC(e.spans.length,t.spans.length),n=new Map;e.spans.forEach((function(e){var t=n.get(e.operationName);t?t.t1++:n.set(e.operationName,{op:e.operationName,t1:1,t2:0})})),t.spans.forEach((function(e){var t=n.get(e.operationName);t?t.t2++:n.set(e.operationName,{op:e.operationName,t1:0,t2:1})}));var r=Array.from(n.values()),i=function(e){for(var t=r.sort((function(t,a){return e(a)-e(t)})),a=0,n=Math.min(4,t.length),i=0;i<n;i++)a+=RC(t[i].t1,t[i].t2);return a/n};return(a+i((function(e){return e.t1}))+i((function(e){return e.t2})))/3<.3}(e,t)})),l=this.props.jaegerURL&&s.length>0?"".concat(this.props.jaegerURL,"/trace/").concat(t.traceID,"...").concat(s[0].traceID,"?cohort=").concat(t.traceID).concat(s.slice(0,10).map((function(e){return"&cohort=".concat(e.traceID)})).join("")):void 0;return r.createElement(Ef.a,{isCompact:!0,style:{border:"1px solid #e6e6e6"}},r.createElement(SC,{formattedTrace:i,externalURL:n?"".concat(n,"/trace/").concat(t.traceID):void 0,graphURL:this.getGraphURL(t.traceID),comparisonURL:l}),r.createElement(yf.a,null,r.createElement(Df.a,{style:{marginTop:"20px"}},r.createElement(Ff.a,{span:3},r.createElement(UC,{spans:t.spans,oneline:!1})),r.createElement(Ff.a,{span:3},r.createElement(lo.a,{content:r.createElement(r.Fragment,null,"The full trace duration is (trace end time) - (trace start time).")},r.createElement("strong",null,"Full duration: ")),YE(t.duration),r.createElement("br",null),r.createElement(lo.a,{content:r.createElement(r.Fragment,null,"The average duration of all spans within the trace. It differs from full duration, as spans can run in parallel, or there can be dead time between spans.")},r.createElement("strong",null,"Spans average duration: ")),o?YE(o):"n/a",r.createElement("br",null),r.createElement("br",null),this.props.statsMatrix&&r.createElement(r.Fragment,null,r.createElement("strong",null,"Compared with metrics: "),YC(this.props.statsMatrix,QC,!1),!this.props.isStatsMatrixComplete&&r.createElement(r.Fragment,null,r.createElement(li.a,null)," Incomplete data, check Spans Details"))),r.createElement(Ff.a,{span:6},r.createElement(lo.a,{content:"Traces are identified as similar based on counting the number of spans and the occurrences of operation names. Only traces currently on the chart are processed."},r.createElement(r.Fragment,null,r.createElement(Br.a,null)," ",r.createElement("strong",null,"Similar traces"),r.createElement("br",null))),s.length>0?this.renderSimilarHeatmap(s,t.duration,o):"No similar traces found"))))}}]),a}(r.Component),JC=Object(h.b)((function(e){if(e.jaegerState.selectedTrace){var t=MC(e.jaegerState.selectedTrace,QC,e.metricsStats.data),a=t.matrix,n=t.isComplete;return{trace:e.jaegerState.selectedTrace,statsMatrix:a,isStatsMatrixComplete:n}}return{trace:e.jaegerState.selectedTrace,isStatsMatrixComplete:!1}}),(function(e){return{setTraceId:function(t){return e(AC(t))},loadMetricsStats:function(t){return e(BC.load(t))}}}))(XC),ZC=Object(Jn.a)({color:nt.Black100,width:260,height:110}),$C=Object(Jn.a)({whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}),eS=Object(Jn.a)({width:"100%",height:"100%"}),tS=Object(Jn.a)({width:"35%",height:"100%",float:"left"}),aS=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=PC(this.props.trace.spans);this.props.loadMetricsStats(e)}},{key:"render",value:function(){var e=10+(this.props.x||0)-140,t=10+(this.props.y||0)-65,a=wC(this.props.trace),n=this.props.statsMatrix&&this.props.statsMatrix.some((function(e){return e.some((function(e){return void 0!==e}))}));return r.createElement("foreignObject",{width:260,height:110,x:e,y:t},r.createElement("div",{className:ZC},r.createElement("div",{className:$C},this.props.trace.traceName||"(Missing root span)"),r.createElement("br",null),r.createElement("div",{className:eS},r.createElement("div",{className:tS},n?YC(this.props.statsMatrix,NC,!0):"n/a"),r.createElement("div",null,YE(this.props.trace.duration),r.createElement("br",null),"".concat(Object(HC.pluralize)(this.props.trace.spans.length,"span"),", avg=").concat(a?YE(a):"n/a")))))}}]),a}(r.Component),nS=Object(h.b)((function(e,t){var a=MC(t.trace,NC,e.metricsStats.data);return{statsMatrix:a.matrix,isStatsMatrixComplete:a.isComplete}}),(function(e){return{loadMetricsStats:function(t){return e(BC.load(t))}}}))(aS),rS=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){if(this.props.activePoints&&this.props.activePoints.length>0){var e=this.props.activePoints[0].trace;return r.createElement(Vs,Object.assign({},this.props,{flyoutWidth:280,flyoutHeight:130,flyoutComponent:r.createElement(Fs.a,{style:{stroke:"none",fillOpacity:.6}}),labelComponent:r.createElement(nS,{trace:e}),constrainToVisibleArea:!0}))}return null}}]),a}(r.Component),iS=Object(Jn.a)({paddingTop:15,paddingLeft:25,paddingRight:25,paddingBottom:15}),oS=Object(Jn.a)({display:"flex",justifyContent:"center",alignItems:"center",overflow:"hidden",height:"350px",textAlign:"center"}),sS=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).renderFetchEmtpy=function(e,t){return r.createElement("div",{className:oS},r.createElement(Cu.a,{variant:Cu.b.small},r.createElement(Eo.a,{headingLevel:"h5",size:"lg"},e),r.createElement(Su.a,null,t)))},e}return Object(l.a)(a,[{key:"render",value:function(){var e=this,t=[],a=[],n=ue({rangeDuration:this.props.duration}),i=this.props.traces;this.props.selectedTrace&&!i.some((function(t){return t.traceID===e.props.selectedTrace.traceID}))&&this.props.selectedTrace.startTime>=1e3*n[0].getTime()&&this.props.selectedTrace.startTime<=1e3*n[1].getTime()&&i.push(this.props.selectedTrace),i.forEach((function(n){var r=e.props.selectedTrace&&n.traceID===e.props.selectedTrace.traceID,i=n.spans.filter((function(e){return e.tags.some(PE)})).length>0,o=e.props.showSpansAverage?wC(n)||0:n.duration,s={x:new Date(n.startTime/1e3),y:o/1e6,name:"".concat(""!==n.traceName?n.traceName:"<trace-without-root-span>"," (").concat(n.traceID.slice(0,7),")"),color:r?nt.Blue500:nt.Blue200,unit:"seconds",trace:n,size:Math.min(30,n.spans.length+2)};i?(s.color=r?nt.Red500:nt.Red200,a.push(s)):t.push(s)}));var o={datapoints:t,color:function(e){return e.datum.color},legendItem:qs("Traces",nt.Blue200)},s={datapoints:a,color:function(e){return e.datum.color},legendItem:qs("Error Traces",nt.Red200)};return this.props.errorFetchTraces&&this.props.errorFetchTraces.length>0?this.renderFetchEmtpy("Error fetching traces",this.props.errorFetchTraces[0].msg):this.props.traces.length>0?r.createElement("div",{className:iS},r.createElement("div",{style:{marginTop:20}},r.createElement(Ry,{data:[o,s],fill:!0,unit:"seconds",seriesComponent:r.createElement(xs.a,null),onClick:function(t){return e.props.setTraceId(t.trace.traceID)},labelComponent:r.createElement(rS,null)}))):this.renderFetchEmtpy("No traces","No trace results. Try another query.")}}]),a}(r.Component),lS=Object(h.b)((function(e){return{duration:fl(e),selectedTrace:e.jaegerState.selectedTrace}}),(function(e){return{setTraceId:function(t){return e(AC(t))}}}))(sS),cS=function(){function e(t,a){var n=this;Object(s.a)(this,e),this.onChange=t,this.onErrors=a,this.lastFetchMicros=void 0,this.fetch=function(e,t){var a=LE();a.to&&(n.lastFetchMicros=void 0);var r=n.lastFetchMicros?t.filter((function(e){return e.startTime>=a.from})):[],i={startMicros:n.lastFetchMicros||a.from,endMicros:a.to,tags:e.tags,limit:e.spanLimit,minDuration:e.minDuration?Math.floor(1e3*e.minDuration):void 0};("app"===e.targetKind?yn:"service"===e.targetKind?Cn:Sn)(e.namespace,e.target,i).then((function(e){var t=e.data.data?e.data.data.map((function(e){return NE(e)})).filter((function(e){return null!==e})):[];(r=r.filter((function(e){return!t.map((function(e){return e.traceID})).includes(e.traceID)})).concat(t)).length>0&&(n.lastFetchMicros=Math.max.apply(Math,Object(mt.a)(r.map((function(e){return e.startTime}))))),n.onChange(r,e.data.jaegerServiceName),e.data.errors&&e.data.errors.length>0&&n.onErrors(e.data.errors)})).catch((function(e){_n("Could not fetch traces.",e),n.onErrors([{msg:String(e)}])}))}}return Object(l.a)(e,[{key:"resetLastFetchTime",value:function(){this.lastFetchMicros=void 0}}]),e}(),uS=a(781),pS=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).state={isExpanded:e.isExpanded},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.props.listeners.push((function(t){return e.setState({isExpanded:t})}))}},{key:"render",value:function(){var e=this,t=this.props.innerComponent,a=r.createElement(t,Object.assign({},this.props,{isExpanded:this.state.isExpanded}));return this.props.clickToExpand?r.createElement("span",{style:{cursor:"pointer"},onClick:function(){return t=e.props.listeners,a=!e.state.isExpanded,t.forEach((function(e){return e(a)}));var t,a}},a):a}}]),a}(r.Component),dS=Object(Jn.a)({borderLeft:"3px solid var(--pf-global--danger-color--100)"}),mS=Object(Jn.a)({borderRight:"3px solid var(--pf-global--info-color--100)",borderLeft:"3px solid var(--pf-global--danger-color--100)"}),hS=Object(Jn.a)({borderRight:"3px solid var(--pf-global--info-color--100)"}),fS=Object(Jn.a)({whiteSpace:"nowrap"}),gS=Object(Jn.a)({fontSize:14}),vS=function(e,t){return t?e?mS:hS:e?dS:void 0},ES=function(e){return r.createElement(r.Fragment,null,r.createElement("strong",null,"Application: "),e.linkToApp&&r.createElement(ar.a,{to:e.linkToApp},e.app)||e.app,r.createElement("br",null),r.createElement("strong",null,"Workload: "),e.linkToWorkload&&r.createElement(ar.a,{to:e.linkToWorkload},e.workload)||"unknown",e.isExpanded&&r.createElement(r.Fragment,null,r.createElement("br",null),r.createElement("strong",null,"Pod: "),e.pod||"unknown",r.createElement("br",null)))},bS=function(e){var t=e.info.responseFlags;return r.createElement(r.Fragment,null,e.info.hasError&&r.createElement("div",null,r.createElement(ea.a,{color:nt.Danger})," ",r.createElement("strong",null,"This span reported an error")),r.createElement("div",null,r.createElement("strong",null,"Operation: "),t?r.createElement(r.Fragment,null,e.operationName," (",t," ",r.createElement(ea.a,{color:nt.Danger}),")"):r.createElement(r.Fragment,null,e.operationName)),r.createElement("div",null,r.createElement("strong",null,"Component: "),e.component),e.isExpanded&&("envoy"===e.type&&yS(e)||"http"===e.type&&CS(e)||"tcp"===e.type&&SS(e)))},yS=function(e){var t=e.info,a="Request",n=void 0;"inbound"===t.direction?(a="Received request",t.peer&&(n=r.createElement(r.Fragment,null," from ",r.createElement(ar.a,{to:"/namespaces/"+t.peer.namespace+"/workloads/"+t.peer.name},t.peer.name)))):"outbound"===t.direction&&(a="Sent request",t.peer&&(n=r.createElement(r.Fragment,null," to ",r.createElement(ar.a,{to:"/namespaces/"+t.peer.namespace+"/services/"+t.peer.name},t.peer.name))));var i=[];t.statusCode&&i.push(String(t.statusCode));var o,s=void 0;t.responseFlags&&(i.push(t.responseFlags),s=(null===(o=$[t.responseFlags])||void 0===o?void 0:o.help)||"Unknown flag");return r.createElement(r.Fragment,null,r.createElement("div",null,r.createElement("strong",null,a,n,":"," "),t.method," ",t.url),r.createElement("div",null,r.createElement("strong",null,"Response status: "),i.join(", ")),s)},CS=function(e){var t=e.info,a="inbound"===t.direction?"Received request":"outbound"===t.direction?"Sent request":"Request";return r.createElement(r.Fragment,null,r.createElement("div",null,r.createElement("strong",null,a,": "),t.method," ",t.url),t.statusCode&&r.createElement("div",null,r.createElement("strong",null,"Response status: "),t.statusCode))},SS=function(e){var t=e.info;return r.createElement(r.Fragment,null,t.topic&&r.createElement("div",null,r.createElement("strong",null,"Topic: "),t.topic))},AS=function(e){return r.createElement(r.Fragment,null,r.createElement("div",null,r.createElement("strong",null,"Duration: "),YE(e.duration)),"envoy"===e.type&&zC(e,!e.isExpanded,e.metricsStats,e.onClickFetchStats))},TS=function(e){var t=[r.createElement(cp.a,{label:"Application (".concat(e.app,")"),className:fS},r.createElement(up.a,{className:gS,onClick:function(){return U.push(e.linkToApp+"?tab=in_metrics")}},"Inbound metrics"),r.createElement(up.a,{className:gS,onClick:function(){return U.push(e.linkToApp+"?tab=out_metrics")}},"Outbound metrics"))];if(e.linkToWorkload&&t.push(r.createElement(cp.a,{label:"Workload (".concat(e.workload,")"),className:fS},r.createElement(up.a,{className:gS,onClick:function(){return U.push(e.linkToWorkload+"?tab=logs")}},"Logs"),r.createElement(up.a,{className:gS,onClick:function(){return U.push(e.linkToWorkload+"?tab=in_metrics")}},"Inbound metrics"),r.createElement(up.a,{className:gS,onClick:function(){return U.push(e.linkToWorkload+"?tab=out_metrics")}},"Outbound metrics"))),e.externalURL){var a="".concat(e.externalURL,"/trace/").concat(e.traceID,"?uiFind=").concat(e.spanID);t.push(r.createElement(cp.a,{label:"Tracing",className:fS},r.createElement(up.a,{className:gS,onClick:function(){return window.open(a,"_blank")}},"More span details ",r.createElement(Jf.a,null))))}return r.createElement(Ru.a,{toggle:r.createElement(Wf.a,{onToggle:function(){return e.setToggledLinks(e.spanID)}}),dropdownItems:t,isPlain:!0,isOpen:e.toggledLinks===e.spanID,position:"right"})},OS=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;Object(s.a)(this,a),(n=t.call(this,e)).cells=function(){return[{title:"Timeline",transforms:[io.a,Object(oo.a)("5%")],compare:function(e,t){return e.startTime-t.startTime}},{title:"App / Workload",transforms:[io.a,Object(oo.a)("20%")],compare:function(e,t){return function(e,t,a){return e?t?a(e,t):-1:t?1:0}(e.workload,t.workload,(function(e,t){return e.localeCompare(t)}))}},{title:"Summary",transforms:[Object(oo.a)("50%")]},{title:"Statistics",transforms:[io.a,Object(oo.a)("20%")],compare:function(e,t){return e.duration-t.duration}},{title:"",transforms:[Object(oo.a)("5%")]}]},n.rows=function(e){var t=e[n.state.sortIndex].compare;return(t?n.props.items.sort(n.state.sortDirection===Eu.a.asc?t:function(e,a){return t(a,e)}):n.props.items).map((function(e){return function(e){var t,a,n=[],i=e.spanID===Tb();return n.push(e.onExpand),{className:vS(e.tags.some(PE),i),isOpen:!1,cells:[{title:r.createElement(r.Fragment,null,(t=n,a=e.isExpanded,r.createElement(pS,{listeners:t,isExpanded:a,clickToExpand:!0,innerComponent:function(e){return e.isExpanded?r.createElement(Ir.a,null):r.createElement(Rr.a,null)}}))," ",YE(e.relativeStartTime))},{title:r.createElement(pS,Object.assign({},e,{clickToExpand:!1,listeners:n,innerComponent:ES}))},{title:r.createElement(pS,Object.assign({},e,{clickToExpand:!0,listeners:n,innerComponent:bS}))},{title:r.createElement(pS,Object.assign({},e,{clickToExpand:!0,listeners:n,innerComponent:AS}))},{title:r.createElement(pS,Object.assign({},e,{clickToExpand:!1,listeners:n,innerComponent:TS}))}],spanID:e.spanID}}(Object(C.a)({externalURL:n.props.externalURL,toggledLinks:n.state.toggledLinks,setToggledLinks:function(e){return n.setState({toggledLinks:e})},onClickFetchStats:function(){return n.fetchComparisonMetrics([e])},metricsStats:n.props.metricsStats,isExpanded:n.state.expandedSpans.get(e.spanID)||!1,onExpand:function(t){n.state.expandedSpans.set(e.spanID,t),n.setState({expandedSpans:n.state.expandedSpans})}},e))}))};var i=new Map,o=Tb();return o&&i.set(o,!0),n.state={sortIndex:0,sortDirection:Eu.a.asc,expandedSpans:i},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.fetchComparisonMetrics(this.props.items)}},{key:"componentDidUpdate",value:function(e,t){t.toggledLinks&&this.setState({toggledLinks:void 0}),zE(e.items,this.props.items)||this.fetchComparisonMetrics(this.props.items)}},{key:"fetchComparisonMetrics",value:function(e){var t=PC(e);this.props.loadMetricsStats(t)}},{key:"render",value:function(){var e=this,t=this.cells();return r.createElement(Eu.b,{variant:Eu.e.compact,"aria-label":"list_spans",cells:t,rows:this.rows(t),sortBy:{index:this.state.sortIndex,direction:this.state.sortDirection},onSort:function(t,a,n){return e.setState({sortIndex:a,sortDirection:n})},className:"table",rowWrapper:function(e){return r.createElement(uS.a,Object.assign({},e,{className:e.row.className}))}},r.createElement(bu.a,null),this.props.items.length>0?r.createElement(kp.a,null):r.createElement("tbody",null,r.createElement("tr",null,r.createElement("td",{colSpan:t.length},r.createElement(Cu.a,{variant:Cu.b.full},r.createElement(Eo.a,{headingLevel:"h5",size:"lg"},"No spans found"),r.createElement(Su.a,null,"No spans match the current filters"))))))}}]),a}(r.Component),IS=Object(h.b)((function(e){return{metricsStats:e.metricsStats.data}}),(function(e){return{loadMetricsStats:function(t){return e(BC.load(t))}}}))(OS),wS=function(e){return{id:"workload",title:"Workload",placeholder:"Filter by Workload",filterType:Oe.typeAhead,action:"append",filterValues:e,run:function(e,t){return t.filters.some((function(t){return t.value===e.workload}))}}},RS=function(e){return{id:"app",title:"App",placeholder:"Filter by App",filterType:Oe.typeAhead,action:"append",filterValues:e,run:function(e,t){return t.filters.some((function(t){return t.value===e.app}))}}},kS=function(e){return{id:"type",title:"Component",placeholder:"Filter by Span Component",filterType:Oe.typeAhead,action:"append",filterValues:e,run:function(e,t){return t.filters.some((function(t){return t.value===e.component}))}}},xS={id:"error",title:"Error",placeholder:"Filter by Error",filterType:Oe.select,action:"update",filterValues:[{id:"yes",title:"With errors"},{id:"no",title:"Without errors"}],run:function(e,t){return t.filters.some((function(t){return t.value===(e.info.hasError?"With errors":"Without errors")}))}},NS=function(e){var t,a=new Set,n=new Set,r=new Set,i=new Set;return e.forEach((function(e){a.add(e.workload||"unknown"),n.add(e.app),r.add(e.component),i.add(e.operationName)})),[wS(Array.from(a).map((function(e){return{id:e,title:e}}))),RS(Array.from(n).map((function(e){return{id:e,title:e}}))),kS(Array.from(r).map((function(e){return{id:e,title:e}}))),(t=Array.from(i).map((function(e){return{id:e,title:e}})),{id:"operation",title:"Operation",placeholder:"Filter by Operation Name",filterType:Oe.typeAhead,action:"append",filterValues:t,run:function(e,t){return t.filters.some((function(t){return t.value===e.operationName}))}}),xS]},jS=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;Object(s.a)(this,a),n=t.call(this,e);var r=NS(e.items);return n.state={activeFilters:xi.init(r)},n}return Object(l.a)(a,[{key:"render",value:function(){var e=this,t=NS(this.props.items),a=Qn(this.props.items,t,this.state.activeFilters);return r.createElement(Ef.a,{isCompact:!0,style:{border:"1px solid #e6e6e6"}},r.createElement(yf.a,null,r.createElement(Li,{initialFilters:t,onFilterChange:function(t){return e.setState({activeFilters:t})}},r.createElement(UC,{spans:this.props.items,filteredSpans:this.state.activeFilters.filters.length>0?a:void 0,oneline:!0})),r.createElement(IS,{items:a,namespace:this.props.namespace,externalURL:this.props.externalURL})))}}]),a}(r.Component),PS=a(1498),LS=Object(Jn.a)({overflow:"auto"}),DS=Object(Jn.a)({fontSize:"14px"}),FS=Object(Jn.a)({display:"inline-block",width:"100%"}),_S=Object(Jn.a)({padding:"8px 16px 2px 16px",fontWeight:700,color:nt.Black600}),MS={alignItems:"center",whiteSpace:"nowrap",margin:0,padding:"6px 16px",$nest:{"& > div > input.pf-c-radio__input":{margin:0},"& > div > input.pf-c-check__input":{margin:0}}},HS=Object(Jn.a)(MS),GS=Object(Jn.a)(Object(C.a)(Object(C.a)({},MS),{},{padding:"6px 0px 6px 16px"})),VS=Object(Jn.a)({margin:"0px 5px 2px 4px"}),US=[{id:"all",labelText:"All"},{id:"0.75",labelText:"p75"},{id:"0.9",labelText:"p90"},{id:"0.99",labelText:"p99"}],BS=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;Object(s.a)(this,a),(n=t.call(this,e)).computedPercentiles=void 0,n.onToggle=function(e){n.setState({isOpen:e})},n.onPercentileChanged=function(e,t){t&&(n.saveValue(P.JAEGER_PERCENTILE,e),n.setState({percentile:e},(function(){return n.props.onQuerySettingsChanged(n.state)})))},n.onErrorsOnlyChanged=function(e){n.saveValue(P.JAEGER_ERRORS_ONLY,String(e)),n.setState({errorsOnly:e},(function(){return n.props.onQuerySettingsChanged(n.state)}))},n.onLimitChanged=function(e,t){t&&(n.saveValue(P.JAEGER_LIMIT_TRACES,String(e)),n.setState({limit:e},(function(){return n.props.onQuerySettingsChanged(n.state)})))},n.onValueAxisChanged=function(e){n.saveValue(P.JAEGER_SHOW_SPANS_AVG,String(e)),n.setState({showSpansAverage:e},(function(){return n.props.onDisplaySettingsChanged(n.state)}))},n.saveValue=function(e,t){sessionStorage.setItem(e,t),q.setParam(e,t)};var r=a.retrieveDisplaySettings(),i=a.retrieveQuerySettings();return n.state=Object(C.a)(Object(C.a)(Object(C.a)({},r),i),{},{isOpen:!1}),e.percentilesPromise.then((function(e){return n.computedPercentiles=e})),n}return Object(l.a)(a,[{key:"render",value:function(){var e=this.state.isOpen;return r.createElement(Ru.a,{toggle:r.createElement(ku.a,{id:"traces-display-settings",isDisabled:this.props.disabled,onToggle:this.onToggle},"Display"),isOpen:e},this.getPopoverContent())}},{key:"getPopoverContent",value:function(){var e=this;return r.createElement("div",{id:"traces-display-menu",className:DS},r.createElement(lo.a,{content:"\n          These percentiles are computed from metrics. To refresh them, reload the page.\n          The filter applies on span durations.\n          Thus, the filtered traces are the ones where at least one span for the service satisfies the duration criteria.\n        "},r.createElement("div",{className:_S},"Filter by percentile ",r.createElement(Br.a,null))),US.map((function(t){var a=t.labelText;if(e.computedPercentiles){var n=e.computedPercentiles.get(t.id);n&&(a+=" (".concat(n.toFixed(2),"ms+)"))}return r.createElement("div",{key:t.id},r.createElement("label",{key:t.id,className:HS},r.createElement(qp.a,{id:t.id,name:"percentiles"+t.id,isChecked:t.id===e.state.percentile||"all"===t.id&&!e.state.percentile,label:a,onChange:function(a){return e.onPercentileChanged(t.id,a)},value:t.id})))})),r.createElement("div",{className:_S},"Errors"),r.createElement("div",null,r.createElement("label",{className:HS},r.createElement(PS.a,{id:"errors-only",name:"errors-only",isChecked:this.state.errorsOnly,label:"Show only traces with errors",onChange:this.onErrorsOnlyChanged,value:"errors-only"}))),r.createElement("div",{className:_S},"Limit per query"),[20,100,500,1e3].map((function(t){return r.createElement("div",{key:"limit-"+t},r.createElement("label",{key:"limit-"+t,className:HS},r.createElement(qp.a,{id:"limit-"+t,name:"limit-"+t,isChecked:e.state.limit===t,label:String(t),onChange:function(a){return e.onLimitChanged(t,a)},value:String(t)})))})),r.createElement("div",{className:_S},"Value axis"),r.createElement("div",null,r.createElement("label",{className:HS},r.createElement(qp.a,{id:"yaxis-full",name:"yaxis-full",isChecked:!this.state.showSpansAverage,label:"Full trace duration",onChange:function(){return e.onValueAxisChanged(!1)},value:"yaxis-full"}))),r.createElement("div",null,r.createElement("label",{className:HS},r.createElement(qp.a,{id:"yaxis-avg",name:"yaxis-avg",isChecked:this.state.showSpansAverage,label:"Spans average duration",onChange:function(){return e.onValueAxisChanged(!0)},value:"yaxis-avg"}))))}}],[{key:"retrieveDisplaySettings",value:function(){return{showSpansAverage:"true"===(q.getParam(P.JAEGER_SHOW_SPANS_AVG)||sessionStorage.getItem(P.JAEGER_SHOW_SPANS_AVG)||"false")}}},{key:"retrieveQuerySettings",value:function(){var e=q.getParam(P.JAEGER_LIMIT_TRACES)||sessionStorage.getItem(P.JAEGER_LIMIT_TRACES)||"100",t=q.getParam(P.JAEGER_ERRORS_ONLY)||sessionStorage.getItem(P.JAEGER_ERRORS_ONLY)||"false",a=q.getParam(P.JAEGER_PERCENTILE)||sessionStorage.getItem(P.JAEGER_PERCENTILE)||void 0;return{errorsOnly:"true"===t,limit:Number(e),percentile:a}}}]),a}(r.Component),WS=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;Object(s.a)(this,a),(n=t.call(this,e)).fetcher=void 0,n.percentilesPromise=void 0,n.getTags=function(){return n.state.querySettings.errorsOnly?'{"error":"true"}':""},n.fetchTraces=Object(Zt.a)(Jt.a.mark((function e(){var t,a;return Jt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t={namespace:n.props.namespace,target:n.props.target,targetKind:n.props.targetKind,spanLimit:n.state.querySettings.limit,tags:n.getTags()},!n.state.querySettings.percentile||"all"===n.state.querySettings.percentile){e.next=13;break}return e.prev=2,e.next=5,n.percentilesPromise;case 5:a=e.sent,t.minDuration=a.get(n.state.querySettings.percentile),t.minDuration||Vn("Cannot perform query above the requested percentile (value unknown)."),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),_n("Could not fetch percentiles.",e.t0);case 13:n.fetcher.fetch(t,n.state.traces);case 14:case"end":return e.stop()}}),e,null,[[2,10]])}))),n.fetchPercentiles=function(){var e={queryTime:Math.floor(Date.now()/1e3),target:{namespace:n.props.namespace,name:n.props.target,kind:n.props.targetKind},interval:"1h",direction:"inbound",avg:!1,quantiles:US.map((function(e){return e.id})).filter((function(e){return"all"!==e}))},t="service"===n.props.targetKind?[e]:[e,Object(C.a)(Object(C.a)({},e),{},{direction:"outbound"})];return Pn(t).then((function(t){return n.percentilesFetched(e,t.data)}))},n.percentilesFetched=function(e,t){t.warnings&&Vn(t.warnings.join(", "));var a=["inbound","outbound"].map((function(a){var n=new Map,r=OC(e.target,void 0,a,e.interval);if(r){var i=t.stats[r];i&&i.responseTimes.forEach((function(t){e.quantiles.includes(t.name)&&n.set(t.name,t.value)}))}return n})),n=Object(T.a)(a,2),r=n[0],i=n[1],o=new Map;return r.forEach((function(e,t){var a=i.get(t);a?(o.set(t,(e+a)/2),i.delete(t)):o.set(t,e)})),i.forEach((function(e,t){return o.set(t,e)})),o},n.onTracesUpdated=function(e,t){var a={traces:e,jaegerErrors:void 0,toolbarDisabled:!1};void 0===n.state.targetApp&&t&&(a.targetApp=t),n.setState(a)},n.getJaegerUrl=function(){if(""!==n.props.urlJaeger&&n.state.targetApp){var e=LE(),t="".concat(n.props.urlJaeger,"/search?service=").concat(n.state.targetApp,"&start=").concat(e.from,"&limit=").concat(n.state.querySettings.limit);e.to&&(t+="&end=".concat(e.to));var a=n.getTags();return a&&(t+="&tags=".concat(a)),t}},n.onQuerySettingsChanged=function(e){n.fetcher.resetLastFetchTime(),n.setState({querySettings:e},n.fetchTraces)},n.onDisplaySettingsChanged=function(e){n.setState({displaySettings:e})};var r=void 0;return"app"===n.props.targetKind&&(r=n.props.namespaceSelector?n.props.target+"."+n.props.namespace:n.props.target),n.state={url:"",width:0,querySettings:BS.retrieveQuerySettings(),displaySettings:BS.retrieveDisplaySettings(),traces:[],jaegerErrors:[],targetApp:r,activeTab:Tb()?1:0,toolbarDisabled:!1},n.fetcher=new cS(n.onTracesUpdated,(function(e){0===n.state.traces.length&&n.setState({jaegerErrors:e,toolbarDisabled:!0})})),n.percentilesPromise=n.fetchPercentiles(),n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.fetchTraces()}},{key:"componentDidUpdate",value:function(e){if(this.props.selectedTrace&&e.selectedTrace!==this.props.selectedTrace){var t=this.state.traces,a=this.props.selectedTrace,n=t.findIndex((function(e){return e.traceID===a.traceID}));n>=0&&(t[n]=this.props.selectedTrace,this.setState({traces:t}))}var r=!me(this.props.timeRange,e.timeRange);(this.props.lastRefreshAt!==e.lastRefreshAt||r)&&(r&&this.fetcher.resetLastFetchTime(),this.fetchTraces())}},{key:"render",value:function(){var e=this,t=this.getJaegerUrl();return r.createElement(r.Fragment,null,r.createElement(Zn,null,r.createElement(Ef.a,null,r.createElement(yf.a,null,r.createElement(dr.a,null,r.createElement(ir.a,null,r.createElement(or.a,null,r.createElement(BS,{onDisplaySettingsChanged:this.onDisplaySettingsChanged,onQuerySettingsChanged:this.onQuerySettingsChanged,percentilesPromise:this.percentilesPromise,disabled:this.state.toolbarDisabled}))),t&&r.createElement(ir.a,{style:{marginLeft:"auto"}},r.createElement(or.a,null,r.createElement(lo.a,{content:r.createElement(r.Fragment,null,"Open Chart in Jaeger UI")},r.createElement("a",{href:t,target:"_blank",rel:"noopener noreferrer",style:{marginLeft:"10px"}},"View in Tracing ",r.createElement(Jf.a,null)))))),r.createElement(lS,{showSpansAverage:this.state.displaySettings.showSpansAverage,traces:this.state.traces,errorFetchTraces:this.state.jaegerErrors,errorTraces:!0}))),this.props.selectedTrace&&r.createElement("div",{style:{marginTop:25}},r.createElement(ch.a,{id:"trace-details",activeKey:this.state.activeTab,onSelect:function(t,a){return e.setState({activeTab:a})}},r.createElement(bh.a,{eventKey:0,title:"Trace Details"},r.createElement(JC,{namespace:this.props.namespace,target:this.props.target,targetKind:this.props.targetKind,jaegerURL:this.props.urlJaeger,otherTraces:this.state.traces})),r.createElement(bh.a,{eventKey:1,title:"Spans Details"},r.createElement(jS,{namespace:this.props.namespace,target:this.props.target,externalURL:this.props.urlJaeger,items:this.props.selectedTrace.spans}))))))}}]),a}(r.Component),qS=Object(h.b)((function(e){return{timeRange:gl(e),urlJaeger:e.jaegerState.info?e.jaegerState.info.url:"",namespaceSelector:!e.jaegerState.info||e.jaegerState.info.namespaceSelector,selectedTrace:e.jaegerState.selectedTrace,lastRefreshAt:e.globalState.lastRefreshAt}}))(WS),KS=[{id:"trafficstatus",title:"Traffic Status",isNumeric:!1,param:"ts",compare:function(e,t){return t.healthStatus.status.priority-e.healthStatus.status.priority}},{id:"name",title:"Name",isNumeric:!1,param:"na",compare:function(e,t){return e.node.name.localeCompare(t.node.name)}},{id:"rate",title:"Rate",isNumeric:!1,param:"ra",compare:function(e,t){return e.trafficRate.localeCompare(t.trafficRate)}},{id:"percent",title:"Percent Success",isNumeric:!1,param:"pe",compare:function(e,t){return e.trafficPercentSuccess.localeCompare(t.trafficPercentSuccess)}},{id:"protocol",title:"Protocol",isNumeric:!1,param:"pr",compare:function(e,t){return e.protocol.localeCompare(t.protocol)}}],zS=[{title:"Status",transforms:[io.a,Object(oo.a)(10)]},{title:"Name",transforms:[io.a,Object(oo.a)(30)]},{title:"Rate",transforms:[io.a,Object(oo.a)(12)]},{title:"Percent Success",transforms:[io.a,Object(oo.a)(12)]},{title:"Protocol",transforms:[io.a,Object(oo.a)(12)]},{title:"Actions"}],YS=Object(Jn.a)({padding:"20px"}),QS=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).onSort=function(e,t,a){var r=KS[t],i=a===Eu.a.asc;r.id===n.state.currentSortField.id&&i===n.state.isSortAscending||n.updateSort(r,i)},n.getHealthStatus=function(e){var t=e.traffic;return"tcp"!==t.protocol&&ot(t)?function(e,t){var a=e.node.type!==Ze.APP&&e.node.healthAnnotation?new sa(e.node.healthAnnotation):void 0,n=(a&&a.toleranceConfig?a.toleranceConfig:Aa(e.node.namespace,e.node.name,e.node.type).tolerance).filter((function(e){return Ca(e.direction,t)})),r=e.traffic,i=Oa(Ta(r.responses,r.protocol),n,!0);return fa(i,r.responses).status}(e,e.direction):{value:0,status:Na}},n.getTraffic=function(e){var t="0",a="0";if(ot(e))switch(e.protocol){case"http":t=e.rates.http,a=e.rates.httpPercentErr||"0";break;case"grpc":t=e.rates.grpc,a=e.rates.grpcPercentErr||"0";break;case"tcp":t=e.rates.tcp}return{trafficRate:"".concat(Number(t).toFixed(2)).concat("rps"),trafficPercentSuccess:"".concat((100-Number(a)).toFixed(1),"%")}},n.rows=function(e){return n.state.listItems.filter((function(t){return t.direction===e})).map((function(e,t){var a=e.node.name,i=n.getLinks(e);return{cells:[r.createElement(r.Fragment,null,r.createElement(lo.a,{key:"tt_status_".concat(t),position:lo.b.top,content:r.createElement(r.Fragment,null,"Traffic Status: ",e.healthStatus.status.name)},gi(vo(e.healthStatus.status,"sm")))),r.createElement(r.Fragment,null,r.createElement(pc,{badge:e.badge,position:lo.b.top,key:"tt_badge_".concat(t)}),i.detail?r.createElement(ar.a,{key:"link_d_".concat(e.badge,"_").concat(a),to:i.detail,className:"virtualitem_definition_link"},a):a),r.createElement(r.Fragment,null,e.trafficRate),r.createElement(r.Fragment,null,e.trafficPercentSuccess),r.createElement(r.Fragment,null,e.protocol),r.createElement(r.Fragment,null,!!i.metrics&&r.createElement(ar.a,{key:"link_m_".concat(e.badge,"_").concat(a),to:i.metrics,className:"virtualitem_definition_link"},"View metrics"))]}}))},n.getLinks=function(e){if(e.node.isInaccessible)return{detail:"",metrics:""};var t="/namespaces/".concat(e.node.namespace,"/").concat(n.nodeTypeToType(e.node.type,!0),"/").concat(e.node.name),a="inbound"===e.direction?"in_metrics":"out_metrics",r="".concat(U.location.pathname,"?tab=").concat(a);switch(e.node.type){case Ze.APP:var i="inbound"===e.direction?"source":"destination";r+="&".concat(P.BY_LABELS,"=").concat(encodeURIComponent(i+"_canonical_service="+e.node.name));break;case Ze.SERVICE:if(e.node.isServiceEntry)if("inbound"!==e.direction&&e.node.destServices&&e.node.destServices.length>0){var o=e.node.destServices.map((function(e){return e.name})).join(",");r+="&".concat(P.BY_LABELS,"=").concat(encodeURIComponent("destination_service_name="+o))}else r="";else"outbound"===e.direction?r+="&".concat(P.BY_LABELS,"=").concat(encodeURIComponent("destination_service_name="+e.node.name)):r="".concat(t,"?tab=metrics");break;case Ze.WORKLOAD:var s="inbound"===e.direction?"out_metrics":"in_metrics";r="".concat(t,"?tab=").concat(s);break;default:r=""}return{detail:t,metrics:r}},n.nodeTypeToType=function(e,t){switch(e){case Ze.APP:return t?"applications":"Application";case Ze.SERVICE:return t?"services":"Service";default:return t?"workloads":"Workload"}},n.state={currentSortField:e.currentSortField,isSortAscending:e.isSortAscending,listItems:n.trafficToListItems(e.trafficItems)},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.sortItemList(this.state.listItems,this.state.currentSortField,this.state.isSortAscending)}},{key:"componentDidUpdate",value:function(e,t,a){var n=this;if(e.trafficItems!==this.props.trafficItems){var r=this.trafficToListItems(this.props.trafficItems);this.sortItemList(r,this.state.currentSortField,this.state.isSortAscending).then((function(e){n.setState({listItems:e})}))}}},{key:"render",value:function(){var e=this,t=this.rows("inbound"),a=this.rows("outbound"),n=t.length>0,i=a.length>0,o={index:KS.findIndex((function(t){return t.id===e.props.currentSortField.id})),direction:this.props.isSortAscending?Eu.a.asc:Eu.a.desc};return r.createElement(r.Fragment,null,r.createElement("div",{className:YS},r.createElement(Eo.a,{headingLevel:"h5",size:"lg"},n?"":"No "," Inbound Traffic"),n&&r.createElement(Eu.b,{"aria-label":"Sortable Table",cells:zS,onSort:this.onSort,rows:t,sortBy:o},r.createElement(bu.a,null),r.createElement(kp.a,null))),r.createElement("div",{className:YS},r.createElement(Eo.a,{headingLevel:"h5",size:"lg"},i?"":"No "," Outbound Traffic"),i&&r.createElement(Eu.b,{"aria-label":"Sortable Table",cells:zS,onSort:this.onSort,rows:a,sortBy:o},r.createElement(bu.a,null),r.createElement(kp.a,null))))}},{key:"updateListItems",value:function(){}},{key:"sortItemList",value:function(e,t,a){var n=e.sort(a?t.compare:function(e,a){return t.compare(a,e)});return Promise.resolve(n)}},{key:"trafficToListItems",value:function(e){var t=this;return e.map((function(e){var a;switch(e.node.type){case Ze.APP:a=cc.App;break;case Ze.SERVICE:a=cc.Service;break;default:a=cc.Workload}return Object(C.a)({direction:e.direction,badge:a,node:e.node,protocol:(e.traffic.protocol||"N/A").toUpperCase(),healthStatus:t.getHealthStatus(e)},t.getTraffic(e.traffic))}))}}]),a}(vu),XS=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).graphDataSource=new Vf,n.fetchDataSource=function(){switch(n.props.itemType){case Cb.SERVICE:var e=n.graphDataSource.fetchForServiceParams(n.props.duration,n.props.namespace,n.props.itemName);e.includeHealth=!1,n.graphDataSource.fetchGraphData(e);break;case Cb.WORKLOAD:var t=n.graphDataSource.fetchForWorkloadParams(n.props.duration,n.props.namespace,n.props.itemName);t.includeHealth=!1,t.injectServiceNodes=!1,n.graphDataSource.fetchGraphData(t);break;case Cb.APP:var a=n.graphDataSource.fetchForAppParams(n.props.duration,n.props.namespace,n.props.itemName);a.includeHealth=!1,a.injectServiceNodes=!1,n.graphDataSource.fetchGraphData(a)}},n.graphDsFetchSuccess=function(){n.processTrafficData(n.graphDataSource.graphDefinition)},n.graphDsFetchError=function(e){_n(e=""!==e?"Could not fetch traffic data: "+e:"Could not fetch traffic data.")},n.buildTrafficNode=function(e,t){switch(t.nodeType){case Ze.APP:return{id:"".concat(e,"-").concat(t.id),type:t.nodeType,namespace:t.namespace,name:t.app||"unknown",version:t.version||"",isInaccessible:t.isInaccessible||!1};case Ze.SERVICE:return{id:"".concat(e,"-").concat(t.id),type:t.nodeType,namespace:t.namespace,name:t.service||"unknown",isServiceEntry:t.isServiceEntry,isInaccessible:t.isInaccessible||!1,destServices:t.destServices,healthAnnotation:t.hasHealthConfig};default:return{id:"".concat(e,"-").concat(t.id),type:Ze.WORKLOAD,namespace:t.namespace,name:t.workload||"unknown",isInaccessible:t.isInaccessible||!1,healthAnnotation:t.hasHealthConfig}}},n.processTraffic=function(e,t,a){var r=[];return e.forEach((function(e){var i=t["id-"+e.data.source],o=t["id-"+e.data.target];if(a.id===e.data.source){var s={direction:"outbound",node:n.buildTrafficNode("out",o),traffic:e.data.traffic};r.push(s)}else if(a.id===e.data.target){var l={direction:"inbound",node:n.buildTrafficNode("in",i),traffic:e.data.traffic};r.push(l)}})),{traffic:r}},n.processTrafficData=function(e){if(e&&e.elements.nodes&&e.elements.edges&&0!==e.elements.nodes.length&&0!==e.elements.edges.length){var t={},a={id:"",nodeType:Ze.UNKNOWN,cluster:"",namespace:""};e.elements.nodes.forEach((function(e){if(!e.data.isBox&&(t["id-"+e.data.id]=e.data,e.data.namespace)){var r=n.props.itemType===Cb.WORKLOAD&&e.data.nodeType===Ze.WORKLOAD&&n.props.itemName===e.data.workload,i=n.props.itemType===Cb.APP&&e.data.nodeType===Ze.APP&&n.props.itemName===e.data.app,o=n.props.itemType===Cb.SERVICE&&e.data.nodeType===Ze.SERVICE&&n.props.itemName===e.data.service;(r||i||o)&&(a=e.data)}})),""!==a.id?n.setState(n.processTraffic(e.elements.edges,t,a)):n.setState({traffic:[]})}else n.setState({traffic:[]})},n.state={traffic:[]},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.graphDataSource.on("fetchSuccess",this.graphDsFetchSuccess),this.graphDataSource.on("fetchError",this.graphDsFetchError),this.fetchDataSource()}},{key:"componentWillUnmount",value:function(){this.graphDataSource.removeListener("fetchSuccess",this.graphDsFetchSuccess),this.graphDataSource.removeListener("fetchError",this.graphDsFetchError)}},{key:"componentDidUpdate",value:function(e){var t=e.duration!==this.props.duration,a=e.itemName!==this.props.itemName,n=e.itemType!==this.props.itemType,r=e.namespace!==this.props.namespace,i=e.lastRefreshAt!==this.props.lastRefreshAt;(t||a||n||r||i)&&this.fetchDataSource()}},{key:"render",value:function(){return r.createElement(r.Fragment,null,r.createElement(Zn,null,r.createElement(Df.a,null,r.createElement(Ff.a,{span:12},r.createElement(Ef.a,null,r.createElement(yf.a,null,r.createElement(QS,{currentSortField:Yn(KS),isSortAscending:Kn(),trafficItems:this.state.traffic})))))))}}]),a}(r.Component),JS=Object(h.b)((function(e){return{duration:fl(e),lastRefreshAt:e.globalState.lastRefreshAt}}))(XS),ZS=a(1499),$S=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).onActionsSelect=function(){n.setState({isActionsOpen:!n.state.isActionsOpen})},n.onActionsToggle=function(e){n.setState({isActionsOpen:e})},n.onWizardToggle=function(e){n.setState({showWizard:e})},n.onAction=function(e){switch(e){case"enable_auto_injection":case"disable_auto_injection":case"remove_auto_injection":var t="remove_auto_injection"===e,a="enable_auto_injection"===e,r=function(e,t,a){var n={},r={};return r[j.istioAnnotations.istioInjectionAnnotation]=a?null:t?"true":"false","Pod"===e?n.annotations=r:n.spec={template:{metadata:{annotations:r}}},JSON.stringify(n)}(n.props.workload.type,a,t);(i=n.props.namespace,o=n.props.workload.name,s=n.props.workload.type,l=r,Xa(K.PATCH,qa.workload(i,o),{type:s},l)).then((function(e){Dn("Workload "+n.props.workload.name+" updated","default",Te.SUCCESS),n.setState({showWizard:!1},(function(){return n.props.onChange()}))})).catch((function(e){_n("Could not update workload "+n.props.workload.name,e),n.setState({showWizard:!1},(function(){return n.props.onChange()}))}));break;default:console.log("key "+e+" not supported")}var i,o,s,l},n.onClose=function(e){n.setState({showWizard:!1}),e&&n.props.onChange()},n.renderDropdownItems=function(){var e=[];if(j.kialiFeatureFlags.istioInjectionAction){var t=r.createElement(up.a,{key:"enable_auto_injection",component:"button",onClick:function(){return n.onAction("enable_auto_injection")}},"Enable Auto Injection"),a=r.createElement(up.a,{key:"disable_auto_injection",component:"button",onClick:function(){return n.onAction("disable_auto_injection")}},"Disable Auto Injection"),i=r.createElement(up.a,{key:"remove_auto_injection",component:"button",onClick:function(){return n.onAction("remove_auto_injection")}},"Remove Auto Injection");void 0!==n.props.workload.istioInjectionAnnotation&&n.props.workload.istioInjectionAnnotation?(e.push(a),e.push(i)):void 0===n.props.workload.istioInjectionAnnotation||n.props.workload.istioInjectionAnnotation?e.push(n.props.workload.istioSidecar?a:t):(e.push(t),e.push(i))}return e},n.state={isActionsOpen:!1,showWizard:!1,type:""},n}return Object(l.a)(a,[{key:"render",value:function(){var e=this.renderDropdownItems().length>0,t=r.createElement(Ru.a,{position:pp.d.right,onSelect:this.onActionsSelect,toggle:r.createElement(ku.a,{onToggle:this.onActionsToggle,iconComponent:ZS.a},"Actions"),isOpen:this.state.isActionsOpen,dropdownItems:this.renderDropdownItems(),disabled:!e,style:{pointerEvents:e?"auto":"none"}});return r.createElement(r.Fragment,null,t)}}]),a}(r.Component),eA=a(805),tA=a.n(eA),aA=Object(Jn.a)({height:"36px",paddingLeft:".75em",width:"10em"}),nA=function(e){return r.createElement(tA.a,Object.assign({className:aA,dateFormat:"MMM dd, hh:mm aa",popperPlacement:"bottom-start",popperModifiers:{offset:{enabled:!0,offset:"5px, 10px"},preventOverflow:{enabled:!0,escapeWithReference:!1,boundariesElement:"viewport"}},showTimeSelect:!0,timeCaption:"Time",timeFormat:"hh:mm aa",timeIntervals:5},e))},rA=Object(Jn.a)({margin:"5px 5px 0px 5px"}),iA=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;Object(s.a)(this,a),(n=t.call(this,e)).onDurationChanged=function(e){var t={};"custom"===e?(t=le(t,de,(function(e){return e}))).rangeDuration=void 0:(t.rangeDuration=Number(e),t.from=void 0,t.to=void 0),n.props.setTimeRange(t)},n.onStartPickerChanged=function(e){var t={};e&&((t=le(t,de,(function(e){return e}))).from=e.getTime(),t.to&&t.from>t.to&&(t.from=t.to),t.rangeDuration=void 0,n.props.setTimeRange(t))},n.onEndPickerChanged=function(e){var t=le(n.props.timeRange,de,(function(e){return e}));t.to=e?e.getTime():void 0,t.to&&t.from&&t.from>t.to&&(t.to=t.from),n.props.setTimeRange(t)};var r=OE();return void 0===r.rangeDuration&&void 0===r.from||me(e.timeRange,r)||n.props.setTimeRange(r),IE(n.props.timeRange),n}return Object(l.a)(a,[{key:"componentDidUpdate",value:function(){IE(this.props.timeRange)}},{key:"render",value:function(){var e=this;return le(this.props.timeRange,(function(t){return e.renderDuration(t)}),(function(t){return e.renderWithCustom(t)}))}},{key:"renderDuration",value:function(e){var t=R(j,"Last",void 0),a=Object(C.a)({custom:"Custom"},t);return r.createElement(ul,{id:"metrics_filter_interval_duration",handleSelect:this.onDurationChanged,initialValue:e||"custom",value:e||"custom",initialLabel:e?j.durations[e]:"Custom",options:a,tooltip:this.props.tooltip})}},{key:"renderWithCustom",value:function(e){var t=this;return r.createElement(r.Fragment,null,this.renderDuration(),r.createElement("div",{className:rA},"From"),r.createElement(nA,{selected:e.from,onChange:function(e){return t.onStartPickerChanged(e)},maxDate:e.to}),r.createElement("div",{className:rA},"To"),r.createElement(nA,{selected:e.to,onChange:function(e){return t.onEndPickerChanged(e)},minDate:e.from}))}}]),a}(r.Component),oA=Object(h.b)((function(e){return{timeRange:gl(e)}}),(function(e){return{setTimeRange:Object(Ie.b)(vt.setTimeRange,e)}}))(iA),sA=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=r.createElement(Zl,{key:"DurationDropdown",id:"app-info-duration-dropdown",disabled:!1}),t=r.createElement("div",{style:{display:"flex"}},r.createElement(oA,{tooltip:"Time range"}),r.createElement(Xl,{id:"metrics-refresh",hideLabel:!0,manageURL:!0}));return this.props.customDuration?t:e}}]),a}(r.Component),lA=function(e,t){var a=e.split(".");return 2===a.length?r.createElement(r.Fragment,null,r.createElement(gc,{name:a[0],namespace:a[1],type:t},e)):e},cA=function(e,t,a,n){if(void 0!==a){var i=e.match(/Route: ([a-z-.:\d]*)/);if(i&&i[1])return r.createElement(r.Fragment,null,r.createElement(ar.a,{onClick:n,to:"/namespaces/".concat(t,"/workloads/").concat(a,"?tab=envoy&name=").concat(i[1])},e))}return e},uA=function(e,t,a){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i="/namespaces/",o=e.service,s=!1,l=1===e.service.split(".").length&&"*"!==e.service;return e.service&&!e.namespace&&n&&l?(i+=a+"/"+ce.SERVICES+"/"+e.service,s=!0):e.service&&e.namespace&&t&&(i+=e.namespace+"/"+ce.SERVICES+"/"+e.service,o+="."+e.namespace,e.cluster&&(o+="."+e.cluster),s=t.findIndex((function(t){return t.name===e.namespace}))>=0),s?r.createElement(r.Fragment,null,r.createElement(ar.a,{to:i},o)):o},pA=function(e,t){var a=xi.getSelected();if(0===a.filters.length)return!0;var n=a.filters.reduce((function(e,t){var a=e[t.id];return a||(a=[]),e[t.id]=a.concat(t),e}),[]);return Object.keys(n).reduce((function(a,r){return a&&n[r].some((function(a){return t[a.id](e,a)}))}),!0)},dA=function(){function e(t,a,n,r){var i=this;Object(s.a)(this,e),this.summaries=void 0,this.sortingIndex=void 0,this.sortingDirection=void 0,this.namespaces=void 0,this.namespace=void 0,this.availableFilters=function(){return[{id:"fqdn",title:"FQDN",placeholder:"FQDN",filterType:Oe.text,action:"append",filterValues:[]},{id:"port",title:"Port",placeholder:"Port",filterType:Oe.text,action:"append",filterValues:[]},{id:"subset",title:"Subset",placeholder:"Subset",filterType:Oe.text,action:"append",filterValues:[]},{id:"direction",title:"Direction",placeholder:"Direction",filterType:Oe.select,action:"append",filterValues:[{id:"inbound",title:"inbound"},{id:"outbound",title:"outbound"}]}]},this.filterMethods=function(){return{fqdn:function(e,t){return[e.service_fqdn.service,e.service_fqdn.namespace,e.service_fqdn.cluster].join(".").includes(t.value)},port:function(e,t){return e.port.toString().includes(t.value)},subset:function(e,t){return e.subset.toString().includes(t.value)},direction:function(e,t){return e.direction.toString().includes(t.value)}}},this.sortFields=function(){return[{id:"fqdn",title:"FQDN",isNumeric:!1,param:"fqdn",compare:function(e,t){return[e.service_fqdn.service,e.service_fqdn.namespace,e.service_fqdn.cluster].join(".").localeCompare([t.service_fqdn.service,t.service_fqdn.namespace,t.service_fqdn.cluster].join("."))}},{id:"port",title:"Port",isNumeric:!0,param:"port",compare:function(e,t){return e.port-t.port}},{id:"subset",title:"Subset",isNumeric:!1,param:"subset",compare:function(e,t){return e.subset.localeCompare(t.subset)}},{id:"direction",title:"Direction",isNumeric:!1,param:"direction",compare:function(e,t){return e.direction.localeCompare(t.direction)}},{id:"type",title:"Type",isNumeric:!0,param:"type",compare:function(e,t){return e.type-t.type}},{id:"dr",title:"Destination Rule",isNumeric:!0,param:"dr",compare:function(e,t){return e.destination_rule.localeCompare(t.destination_rule)}}]},this.head=function(){return[{title:"Service FQDN",transforms:[io.a]},{title:"Port",transforms:[io.a]},{title:"Subset",transforms:[io.a]},{title:"Direction",transforms:[io.a]},{title:"Type",transforms:[io.a]},{title:"DestinationRule",transforms:[io.a]}]},this.resource=function(){return"clusters"},this.setSorting=function(e,t){i.sortingIndex=e,i.sortingDirection=t},this.sortBy=function(){return{index:i.sortingIndex,direction:i.sortingDirection||"asc"}},this.summaries=t,this.sortingIndex=a.index||0,this.sortingDirection=a.direction||Eu.a.asc,this.namespaces=n,this.namespace=r}return Object(l.a)(e,[{key:"rows",value:function(){var e=this;return this.summaries.filter((function(t){return pA(t,e.filterMethods())})).sort((function(t,a){var n=e.sortFields().find((function(t){return t.id===e.sortFields()[e.sortingIndex].id}));return"asc"===e.sortingDirection?n.compare(t,a):n.compare(a,t)})).map((function(t){return[uA(t.service_fqdn,e.namespaces,e.namespace),t.port,t.subset,t.direction,t.type,lA(t.destination_rule,"destinationrule")]}))}}]),e}(),mA=bA(),hA=function(){function e(t,a,n,r){var i=this;Object(s.a)(this,e),this.summaries=void 0,this.sortingIndex=void 0,this.sortingDirection=void 0,this.namespaces=void 0,this.namespace=void 0,this.availableFilters=function(){return[{id:"name",title:"Name",placeholder:"Name",filterType:Oe.text,action:"append",filterValues:[]},{id:"domains",title:"Domains",placeholder:"Domains",filterType:Oe.text,action:"append",filterValues:[]}]},this.filterMethods=function(){return{name:function(e,t){return e.name.toString().includes(t.value)},domains:function(e,t){return[e.domains.service,e.domains.namespace,e.domains.cluster].join(".").includes(t.value)}}},this.sortFields=function(){return[{id:"name",title:"Name",isNumeric:!1,param:"name",compare:function(e,t){return e.name.localeCompare(t.name)}},{id:"domains",title:"Domains",isNumeric:!1,param:"doms",compare:function(e,t){return[e.domains.service,e.domains.namespace,e.domains.cluster].join(".").localeCompare([t.domains.service,t.domains.namespace,t.domains.cluster].join("."))}},{id:"match",title:"Match",isNumeric:!1,param:"match",compare:function(e,t){return e.match.localeCompare(t.match)}},{id:"vs",title:"Virtual Service",isNumeric:!1,param:"vs",compare:function(e,t){return e.virtual_service.localeCompare(t.virtual_service)}}]},this.resource=function(){return"routes"},this.setSorting=function(e,t){i.sortingDirection=t,i.sortingIndex=e},this.sortBy=function(){return{index:i.sortingIndex,direction:i.sortingDirection}},this.summaries=t,this.sortingIndex=a.index||0,this.sortingDirection=a.direction||"asc",this.namespaces=n,this.namespace=r}return Object(l.a)(e,[{key:"head",value:function(){return[{title:"Name",transforms:[io.a]},{title:"Domains",transforms:[io.a]},{title:"Match",transforms:[io.a]},{title:"Virtual Service",transforms:[io.a]}]}},{key:"rows",value:function(){var e=this;return this.summaries.filter((function(t){return pA(t,e.filterMethods())})).sort((function(t,a){var n=e.sortFields().find((function(t){return t.id===e.sortFields()[e.sortingIndex].id}));return"asc"===e.sortingDirection?n.compare(t,a):n.compare(a,t)})).map((function(t){return[t.name,uA(t.domains,e.namespaces,e.namespace,!0),t.match,lA(t.virtual_service,"virtualservice")]}))}}]),e}(),fA=bA(),gA=function(){function e(t,a,n,r,i,o){var l=this;Object(s.a)(this,e),this.summaries=void 0,this.sortingIndex=void 0,this.sortingDirection=void 0,this.namespaces=void 0,this.namespace=void 0,this.workload=void 0,this.routeLinkHandler=void 0,this.availableFilters=function(){return[{id:"address",title:"Address",placeholder:"Address",filterType:Oe.text,action:"append",filterValues:[]},{id:"port",title:"Port",placeholder:"Port",filterType:Oe.text,action:"append",filterValues:[]},{id:"match",title:"Match",placeholder:"Match",filterType:Oe.text,action:"append",filterValues:[]},{id:"destination",title:"Destination",placeholder:"Destination",filterType:Oe.text,action:"append",filterValues:[]}]},this.filterMethods=function(){return{address:function(e,t){return e.address.includes(t.value)},port:function(e,t){return e.port.toString().includes(t.value)},match:function(e,t){return e.match.includes(t.value)},destination:function(e,t){return e.destination.includes(t.value)}}},this.sortFields=function(){return[{id:"address",title:"Address",isNumeric:!1,param:"addess",compare:function(e,t){return e.address.localeCompare(t.address)}},{id:"port",title:"Port",isNumeric:!0,param:"port",compare:function(e,t){return e.port-t.port}},{id:"match",title:"Match",isNumeric:!1,param:"match",compare:function(e,t){return e.match.localeCompare(t.match)}},{id:"destination",title:"Destination",isNumeric:!1,param:"destination",compare:function(e,t){return e.destination.localeCompare(t.destination)}}]},this.head=function(){return[{title:"Address",transforms:[io.a]},{title:"Port",transforms:[io.a]},{title:"Match",transforms:[io.a]},{title:"Destination",transforms:[io.a]}]},this.resource=function(){return"listeners"},this.setSorting=function(e,t){l.sortingDirection=t,l.sortingIndex=e},this.sortBy=function(){return{index:l.sortingIndex,direction:l.sortingDirection}},this.summaries=t,this.sortingIndex=a.index||0,this.sortingDirection=a.direction||"asc",this.namespaces=n,this.namespace=r,this.workload=i,this.routeLinkHandler=o}return Object(l.a)(e,[{key:"rows",value:function(){var e=this;return this.summaries.filter((function(t){return pA(t,e.filterMethods())})).sort((function(t,a){var n=e.sortFields().find((function(t){return t.id===e.sortFields()[e.sortingIndex].id}));return"asc"===e.sortingDirection?n.compare(t,a):n.compare(a,t)})).map((function(t){return[t.address,t.port,t.match,cA(t.destination,e.namespace,e.workload,e.routeLinkHandler)]}))}}]),e}(),vA=bA(),EA=Object(Jn.a)({display:"inline-block",verticalAlign:"2px !important"});function bA(){return function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).onSort=function(t,a,n){e.props.writer.setSorting(a,n),e.props.onSort(e.props.writer.resource(),a,n)},e.onFilterApplied=function(t){e.setState({activeFilters:t})},e}return Object(l.a)(a,[{key:"render",value:function(){var e=this;return r.createElement(r.Fragment,null,r.createElement(Li,{initialFilters:this.props.writer.availableFilters(),onFilterChange:this.onFilterApplied,childrenFirst:!0},r.createElement("span",null,r.createElement("div",{key:"service-icon",className:EA},r.createElement(pc,{badge:cc.Pod,position:lo.b.top})),r.createElement(pl,{id:"envoy_pods_list",tooltip:"Display envoy config for the selected pod",handleSelect:function(t){return e.props.setPod(t)},value:this.props.pod,label:this.props.pod,options:this.props.pods.sort()}))),r.createElement(Eu.b,{"aria-label":"Sortable Table",cells:this.props.writer.head(),rows:this.props.writer.rows(),sortBy:this.props.writer.sortBy(),onSort:this.onSort},r.createElement(bu.a,null),r.createElement(kp.a,null)))}}]),a}(r.Component)}a(702);var yA,CA=["clusters","listeners","routes","bootstrap","config","metrics"],SA=Object(Jn.a)({display:"inline-block",paddingTop:"5px"}),AA={clusters:0,listeners:1,routes:2,bootstrap:3,config:4,metrics:5},TA=Object(Jn.a)({height:"100%"}),OA=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).aceEditorRef=void 0,n.envoyHandleTabClick=function(e,t){var a=CA[+t];a!==n.state.resource&&n.setState({config:{},fetch:!0,resource:a,activeKey:t})},n.fetchEnvoyProxyResourceEntries=function(e){(function(e,t,a){return Xa(K.GET,qa.podEnvoyProxyResourceEntries(e,t,a),{},{})})(n.props.namespace,n.state.pod.name,e).then((function(e){n.setState({config:e.data,fetch:!1})})).catch((function(t){_n("Could not fetch envoy config ".concat(e," entries for ").concat(n.state.pod.name,"."),t)}))},n.fetchEnvoyProxy=function(){var e,t;(e=n.props.namespace,t=n.state.pod.name,Xa(K.GET,qa.podEnvoyProxy(e,t),{},{})).then((function(e){n.setState({config:e.data,fetch:!1})})).catch((function(e){_n("Could not fetch envoy config for ".concat(n.state.pod.name,"."),e)}))},n.fetchContent=function(){!0===n.state.fetch&&("config"===n.state.resource?n.fetchEnvoyProxy():n.fetchEnvoyProxyResourceEntries(n.state.resource))},n.setPod=function(e){var t=+e,a=n.sortedPods()[t];a.name!==n.state.pod.name&&n.setState({config:{},pod:a,fetch:!0})},n.sortedPods=function(){return n.props.workload.pods.sort((function(e,t){return e.name>=t.name?1:-1}))},n.onSort=function(e,t,a){if(n.state.tableSortBy[e].index!==t||n.state.tableSortBy[e].direction!==a){var r=n.state.tableSortBy;r[e].index=t,r[e].direction=a,n.setState({tableSortBy:r})}},n.editorContent=function(){return JSON.stringify(n.state.config,null,"  ")},n.onCopyToClipboard=function(e,t){var a=n.aceEditorRef.current.editor;a&&a.selectconfig()},n.showEditor=function(){return"config"===n.state.resource||"bootstrap"===n.state.resource},n.showMetrics=function(){return"metrics"===n.state.resource},n.getEnvoyMetricsDashboardRef=function(){var e=void 0;return n.props.workload.runtimes.forEach((function(t){t.dashboardRefs.forEach((function(t){"envoy"===t.template&&(e=t)}))})),e},n.isLoadingConfig=function(){return Object.keys(n.state.config).length<1},n.onRouteLinkClick=function(){n.setState({config:{},fetch:!0,resource:"routes",activeKey:2}),xi.resetFilters()},n.aceEditorRef=r.createRef(),n.state={pod:n.sortedPods()[0],config:{},tabHeight:300,fetch:!0,activeKey:0,resource:"clusters",tableSortBy:{clusters:{index:0,direction:"asc"},listeners:{index:0,direction:"asc"},routes:{index:0,direction:"asc"}}},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.fetchContent()}},{key:"componentDidUpdate",value:function(e,t){this.state.pod.name===t.pod.name&&this.state.resource===t.resource||this.fetchContent()}},{key:"render",value:function(){var e=this,t=function(e,t,a,n,r,i,o){var s,l;switch(e){case"clusters":s=mA,l=new dA(t.clusters||[],a.clusters,n,r);break;case"listeners":s=vA,l=new gA(t.listeners||[],a.listeners,n,r,o,i);break;case"routes":s=fA,l=new hA(t.routes||[],a.routes,n,r)}return[s,l]}(this.state.resource,this.state.config,this.state.tableSortBy,this.props.namespaces,this.props.namespace,this.onRouteLinkClick,this.props.workload.name),a=t[0],n=t[1],i=this.state.tabHeight-226,o=this.props.workload.labels[j.istioLabels.appLabelName],s=this.props.workload.labels[j.istioLabels.versionLabelName],l=this.getEnvoyMetricsDashboardRef(),c=Object.keys(AA).map((function(t,c){var u=t.charAt(0).toUpperCase()+t.slice(1);return r.createElement(bh.a,{style:{backgroundColor:"white"},key:"tab_"+u,eventKey:c,title:u},r.createElement(Ef.a,{className:TA},r.createElement(yf.a,null,e.showEditor()?r.createElement("div",{className:TA},r.createElement("div",{style:{marginBottom:"20px"}},r.createElement("div",{key:"service-icon",className:SA},r.createElement(pc,{badge:cc.Pod,position:lo.b.top})),r.createElement(pl,{id:"envoy_pods_list",tooltip:"Display envoy config for the selected pod",handleSelect:function(t){return e.setPod(t)},value:e.state.pod.name,label:e.state.pod.name,options:e.props.workload.pods.map((function(e){return e.name})).sort()}),r.createElement("span",{style:{float:"right"}},r.createElement(Yy.CopyToClipboard,{onCopy:e.onCopyToClipboard,text:e.editorContent()},r.createElement(vr.a,{variant:vr.b.link,isInline:!0},r.createElement(fi.Copy,{className:mi}))))),r.createElement(Zm.a,{ref:e.aceEditorRef,mode:"yaml",theme:"eclipse",width:"100%",height:i.toString()+"px",className:"istio-ace-editor",wrapEnabled:!0,readOnly:!0,setOptions:Qm||{foldStyle:"markbegin"},value:e.editorContent()})):e.showMetrics()&&l?r.createElement(Ky,{namespace:e.props.namespace,app:o,version:s,workload:e.props.workload.name,template:l.template,embedded:!0,height:e.state.tabHeight-40-24+13}):r.createElement(a,{writer:n,sortBy:e.state.tableSortBy,onSort:e.onSort,pod:e.state.pod.name,pods:e.props.workload.pods.map((function(e){return e.name})),setPod:e.setPod}))))}));return r.createElement(Zn,{onResize:function(t){return e.setState({tabHeight:t})}},r.createElement(Df.a,null,r.createElement(Ff.a,{span:12},r.createElement(ch.a,{id:"envoy-details",activeKey:this.state.activeKey,onSelect:this.envoyHandleTabClick,mountOnEnter:!0,unmountOnExit:!0},c))))}}]),a}(r.Component),IA=Object(h.b)((function(e){return{namespaces:Sl(e)}}))(OA),wA={info:0,traffic:1,logs:2,in_metrics:3,out_metrics:4,traces:5},RA=6,kA=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).fetchWorkload=function(){var e,t;(e=n.props.match.params.namespace,t=n.props.match.params.workload,Xa(K.GET,qa.workload(e,t),{},{})).then((function(e){n.setState({workload:e.data})})).catch((function(e){return _n("Could not fetch Workload.",e)}))},n.state={currentTab:uh("tab","info")},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.fetchWorkload()}},{key:"componentDidUpdate",value:function(e){var t=uh("tab","info");this.props.match.params.namespace===e.match.params.namespace&&this.props.match.params.workload===e.match.params.workload&&this.props.lastRefreshAt===e.lastRefreshAt&&t===this.state.currentTab||("info"!==t&&"logs"!==t&&"envoy"!==t||this.fetchWorkload(),t!==this.state.currentTab&&this.setState({currentTab:t}))}},{key:"staticTabs",value:function(){var e,t=null===(e=this.state.workload)||void 0===e?void 0:e.pods.length,a=[],n=r.createElement(bh.a,{title:"Overview",eventKey:0,key:"Overview"},r.createElement(Yb,{workload:this.state.workload,namespace:this.props.match.params.namespace,refreshWorkload:this.fetchWorkload}));a.push(n);var i=r.createElement(bh.a,{title:"Traffic",eventKey:1,key:"Traffic"},r.createElement(JS,{itemName:this.props.match.params.workload,itemType:Cb.WORKLOAD,namespace:this.props.match.params.namespace}));a.push(i);var o=r.createElement(bh.a,{title:"Logs",eventKey:2,key:"Logs"},t?r.createElement(EC,{namespace:this.props.match.params.namespace,workload:this.props.match.params.workload,pods:this.state.workload.pods}):r.createElement(Cu.a,{variant:Cu.b.full},r.createElement(Eo.a,{headingLevel:"h5",size:"lg"},"No logs for Workload ",this.props.match.params.workload),r.createElement(Su.a,null,"There are no logs to display because the workload has no pods.")));a.push(o);var s=r.createElement(bh.a,{title:"Inbound Metrics",eventKey:3,key:"Inbound Metrics"},r.createElement(Vy,{namespace:this.props.match.params.namespace,object:this.props.match.params.workload,objectType:Cb.WORKLOAD,direction:"inbound"}));a.push(s);var l=r.createElement(bh.a,{title:"Outbound Metrics",eventKey:4,key:"Outbound Metrics"},r.createElement(Vy,{namespace:this.props.match.params.namespace,object:this.props.match.params.workload,objectType:Cb.WORKLOAD,direction:"outbound"}));if(a.push(l),this.props.jaegerInfo&&this.props.jaegerInfo.enabled&&this.props.jaegerInfo.integration&&a.push(r.createElement(bh.a,{eventKey:5,title:"Traces",key:"Traces"},r.createElement(qS,{namespace:this.props.match.params.namespace,target:this.props.match.params.workload,targetKind:"workload"}))),this.state.workload&&this.hasIstioSidecars(this.state.workload)){var c=r.createElement(bh.a,{title:"Envoy",eventKey:10,key:"Envoy"},this.state.workload&&r.createElement(IA,{namespace:this.props.match.params.namespace,workload:this.state.workload}));a.push(c),wA.envoy=10}return RA=a.length+1,a}},{key:"hasIstioSidecars",value:function(e){var t=!1;return e.pods.length>0&&e.pods.forEach((function(e){e.istioContainers&&e.istioContainers.length>0&&(t=!0)})),t}},{key:"runtimeTabs",value:function(){var e=this,t=[];if(this.state.workload){var a=this.state.workload.labels[j.istioLabels.appLabelName],n=this.state.workload.labels[j.istioLabels.versionLabelName];if(a&&n){var i=0;this.state.workload.runtimes.forEach((function(o){o.dashboardRefs.forEach((function(o){if("envoy"!==o.template){var s=i+RA;wA[o.template]=s;var l=r.createElement(bh.a,{key:o.template,title:o.title,eventKey:s},r.createElement(Ky,{namespace:e.props.match.params.namespace,app:a,version:n,workload:e.state.workload.name,workloadType:e.state.workload.type,template:o.template}));t.push(l),i++}}))}))}}return t}},{key:"renderTabs",value:function(){return this.staticTabs().concat(this.runtimeTabs())}},{key:"render",value:function(){var e=this,t=!0;switch(this.state.currentTab){case"info":case"traffic":t=!1;break;case"in_metrics":case"out_metrics":case"logs":case"traces":t=!0}var a="info"===this.state.currentTab&&this.state.workload?r.createElement($S,{namespace:this.props.match.params.namespace,workload:this.state.workload,onChange:this.fetchWorkload}):void 0;return r.createElement(r.Fragment,null,r.createElement(Qi,{location:this.props.location,rightToolbar:r.createElement(sA,{customDuration:t}),actionsToolbar:a}),this.state.workload&&r.createElement(ph,{id:"basic-tabs",onSelect:function(t){e.setState({currentTab:t})},tabMap:wA,tabName:"tab",defaultTab:"info",activeTab:this.state.currentTab,mountOnEnter:!0,unmountOnExit:!0},this.renderTabs()))}}]),a}(r.Component),xA=Object(h.b)((function(e){return{jaegerInfo:e.jaegerState.info,lastRefreshAt:e.globalState.lastRefreshAt}}))(kA),NA=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;Object(s.a)(this,a),(n=t.call(this,e)).promises=new yr;var r=Yn(nu),i=Kn();return n.state={listItems:[],currentSortField:r,isSortAscending:i},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.updateListItems()}},{key:"componentDidUpdate",value:function(e){var t=Yn(nu),a=Kn();yi(this.props.activeNamespaces,e.activeNamespaces)&&this.props.duration===e.duration&&this.state.currentSortField===t&&this.state.isSortAscending===a||(this.setState({currentSortField:t,isSortAscending:a}),this.updateListItems())}},{key:"componentWillUnmount",value:function(){this.promises.cancelAll()}},{key:"sortItemList",value:function(e,t,a){return this.promises.registerChained("sort",e,(function(e){return function(e,t,a){if("Health"===t.title){var n=e.map((function(e){return e.healthPromise.then((function(t){return Object(C.a)(Object(C.a)({},e),{},{health:t})}))}));return Promise.all(n).then((function(e){return e.sort(a?t.compare:function(e,a){return t.compare(a,e)})}))}var r=e.sort(a?t.compare:function(e,a){return t.compare(a,e)});return Promise.resolve(r)}(e,t,a)}))}},{key:"updateListItems",value:function(){this.promises.cancelAll();var e=xi.getSelected(),t=this.props.activeNamespaces.map((function(e){return e.name}));0!==t.length?this.fetchApps(t,e,this.props.duration):this.setState({listItems:[]})}},{key:"fetchApps",value:function(e,t,a){var n=this,r=e.map((function(e){return function(e){return Xa(K.GET,qa.apps(e),{},{})}(e)}));this.promises.registerAll("apps",r).then((function(e){var n=[];return e.forEach((function(e){n=n.concat(function(e,t){return e.applications?e.applications.map((function(a){return{namespace:e.namespace.name,name:a.name,istioSidecar:a.istioSidecar,healthPromise:hn(e.namespace.name,a.name,t,a.istioSidecar),labels:a.labels,istioReferences:lu(a.istioReferences,!0)}})):[]}(e.data,a))})),function(e,t){var a=e,n=Ii(Si,t);void 0!==n&&(a=function(e,t){return e.filter((function(e){return e.istioSidecar===t}))}(a,n));var r,i=Oi(ru,t);i.length>0&&(r=i,a=a.filter((function(e){var t=!0;if(r.length>0){t=!1;for(var a=0;a<r.length;a++)if(e.name.includes(r[a])){t=!0;break}}return t})));var o=Oi(Ti,t);o.length>0&&(a=Qc(a,o,t.op));var s=Oi(Ai,t);if(s.length>0)return wi(a,s);var l=Oi($c,t);return l.length>0?function(e,t){return e.filter((function(e){return 0!==e.istioReferences.filter((function(e){return t.includes(e.objectType)})).length}))}(a,l):a}(n,t)})).then((function(e){n.promises.cancel("sort"),n.sortItemList(e,n.state.currentSortField,n.state.isSortAscending).then((function(e){n.setState({listItems:e})})).catch((function(e){e.isCanceled||console.debug(e)}))})).catch((function(e){e.isCanceled||n.handleAxiosError("Could not fetch apps list",e)}))}},{key:"render",value:function(){return r.createElement(r.Fragment,null,r.createElement("div",{style:{backgroundColor:"#fff"}},r.createElement($u,{rightToolbar:r.createElement(Zl,{key:"DurationDropdown",id:"app-list-duration-dropdown",handleRefresh:this.updateListItems,disabled:!1})})),r.createElement(tr,null,r.createElement(Ou,{rows:this.state.listItems},r.createElement(Li,{initialFilters:iu,onFilterChange:this.onFilterChange}))))}}]),a}(vu),jA=Object(h.b)((function(e){return{activeNamespaces:hl(e),duration:fl(e)}}))(NA),PA=Object(Jn.a)({margin:"0 0 0 0",padding:"0 0 0 0",display:"inline-block",verticalAlign:"2px !important"}),LA=Object(Jn.a)({marginLeft:"10px",verticalAlign:"-1px !important"}),DA=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e={};return this.props.app&&(e[j.istioLabels.appLabelName]=this.props.app.name),this.props.app?r.createElement(Ef.a,{id:"AppDescriptionCard"},r.createElement(bf.a,null,r.createElement(Eo.a,{headingLevel:"h5",size:"lg"},r.createElement("div",{key:"service-icon",className:PA},r.createElement(pc,{badge:cc.App,position:lo.b.top})),this.props.app.name,r.createElement("span",{className:LA},r.createElement(Co,{id:this.props.app.name,health:this.props.health})))),r.createElement(yf.a,null,r.createElement(Vh,{labels:e,tooltipMessage:"Workloads and Services grouped by "+j.istioLabels.appLabelName+" label"}),r.createElement(Tf,{namespace:this.props.app?this.props.app.namespace.name:"",workloads:this.props.app?this.props.app.workloads:[],services:this.props.app?this.props.app.serviceNames:[],health:this.props.health}))):"Loading"}}]),a}(r.Component),FA=Object(Jn.a)({height:"100%"}),_A=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).graphDataSource=new Vf,n.fetchBackend=function(){if(n.props.app){n.graphDataSource.fetchForVersionedApp(n.props.duration,n.props.app.namespace.name,n.props.app.name);var e=n.props.app.workloads.some((function(e){return e.istioSidecar}));hn(n.props.app.namespace.name,n.props.app.name,n.props.duration,e).then((function(e){return n.setState({health:e})})).catch((function(e){return _n("Could not fetch Health.",e)}))}},n.goToMetrics=function(e){if(e.source!==e.target&&n.props.app){var t=e.source===n.props.app.name?"outbound":"inbound",a="inbound"===t?"source_canonical_service":"destination_canonical_service",r=new URLSearchParams(U.location.search);r.set("tab","inbound"===t?"in_metrics":"out_metrics"),r.set(P.BY_LABELS,a+"="+(e.source===n.props.app.name?e.target:e.source)),U.replace(U.location.pathname+"?"+r.toString())}},n.state={},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.fetchBackend()}},{key:"componentDidUpdate",value:function(e){this.props.duration===e.duration&&this.props.app===e.app||this.fetchBackend()}},{key:"render",value:function(){var e=this,t=this.state.tabHeight?this.state.tabHeight-115:300,a=Object(Jn.a)({width:"100%",height:t});return r.createElement(Zn,{onResize:function(t){return e.setState({tabHeight:t})}},r.createElement(Df.a,{gutter:"md",className:FA},r.createElement(Ff.a,{span:4},r.createElement(DA,{app:this.props.app,health:this.state.health})),r.createElement(Ff.a,{span:8},r.createElement(xb,{onEdgeTap:this.goToMetrics,dataSource:this.graphDataSource,mtlsEnabled:this.props.mtlsEnabled,graphContainerStyle:a}))))}}]),a}(r.Component),MA=Object(h.b)((function(e){return{duration:fl(e),lastRefreshAt:e.globalState.lastRefreshAt,mtlsEnabled:Nl(e)}}))(_A),HA={info:0,traffic:1,in_metrics:2,out_metrics:3,traces:4},GA=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).fetchApp=function(){var e,t;(e=n.props.match.params.namespace,t=n.props.match.params.app,Xa(K.GET,qa.app(e,t),{},{})).then((function(e){n.setState({app:e.data})})).catch((function(e){return _n("Could not fetch App Details.",e)}))},n.state={currentTab:uh("tab","info")},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.fetchApp()}},{key:"componentDidUpdate",value:function(e){var t=uh("tab","info");this.props.match.params.namespace===e.match.params.namespace&&this.props.match.params.app===e.match.params.app&&this.props.lastRefreshAt===e.lastRefreshAt&&t===this.state.currentTab||("info"===t&&this.fetchApp(),t!==this.state.currentTab&&this.setState({currentTab:t}))}},{key:"runtimeTabs",value:function(){var e=this,t=0,a=[];return this.state.app&&this.state.app.runtimes.forEach((function(n){n.dashboardRefs.forEach((function(n){if("envoy"!==n.template){var i=t+5;HA["cd-"+n.template]=i;var o=r.createElement(bh.a,{title:n.title,key:"cd-"+n.template,eventKey:i},r.createElement(Ky,{namespace:e.props.match.params.namespace,app:e.props.match.params.app,template:n.template}));a.push(o),t++}}))})),a}},{key:"staticTabs",value:function(){var e=[r.createElement(bh.a,{title:"Overview",eventKey:0,key:"Overview"},r.createElement(MA,{app:this.state.app})),r.createElement(bh.a,{title:"Traffic",eventKey:1,key:"Traffic"},r.createElement(JS,{itemName:this.props.match.params.app,itemType:Cb.APP,namespace:this.props.match.params.namespace})),r.createElement(bh.a,{title:"Inbound Metrics",eventKey:2,key:"Inbound Metrics"},r.createElement(Vy,{namespace:this.props.match.params.namespace,object:this.props.match.params.app,objectType:Cb.APP,direction:"inbound"})),r.createElement(bh.a,{title:"Outbound Metrics",eventKey:3,key:"Outbound Metrics"},r.createElement(Vy,{namespace:this.props.match.params.namespace,object:this.props.match.params.app,objectType:Cb.APP,direction:"outbound"}))];if(this.props.jaegerInfo&&this.props.jaegerInfo.enabled)if(this.props.jaegerInfo.integration)e.push(r.createElement(bh.a,{eventKey:4,style:{textAlign:"center"},title:"Traces",key:"traces"},r.createElement(qS,{namespace:this.props.match.params.namespace,target:this.props.match.params.app,targetKind:"app"})));else{var t=this.props.jaegerInfo.namespaceSelector?this.props.match.params.app+"."+this.props.match.params.namespace:this.props.match.params.app;e.push(r.createElement(bh.a,{eventKey:4,href:this.props.jaegerInfo.url+"/search?service=".concat(t),target:"_blank",title:r.createElement(r.Fragment,null,"Traces ",r.createElement(Jf.a,null))}))}return e}},{key:"renderTabs",value:function(){return this.staticTabs().concat(this.runtimeTabs())}},{key:"render",value:function(){var e=this,t=!0;switch(this.state.currentTab){case"info":case"traffic":t=!1;break;case"in_metrics":case"out_metrics":case"traces":t=!0}return r.createElement(r.Fragment,null,r.createElement(Qi,{location:this.props.location,rightToolbar:r.createElement(sA,{customDuration:t})}),this.state.app&&r.createElement(ph,{id:"basic-tabs",onSelect:function(t){e.setState({currentTab:t})},tabMap:HA,tabName:"tab",defaultTab:"info",activeTab:this.state.currentTab,mountOnEnter:!0,unmountOnExit:!0},this.renderTabs()))}}]),a}(r.Component),VA=Object(h.b)((function(e){return{jaegerInfo:e.jaegerState.info,lastRefreshAt:e.globalState.lastRefreshAt}}))(GA),UA=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e,t=Is(this.props.type,ce.APPLICATIONS,ce.SERVICES,ce.WORKLOADS),a=this.props.name,n=this.props.status,i=n.inError.length+n.inWarning.length+n.inSuccess.length+n.notAvailable.length+n.inNotReady.length;return e=1===i?Is(this.props.type,"1 Application","1 Service","1 Workload"):i+Is(this.props.type," Applications"," Services"," Workloads"),r.createElement(r.Fragment,null,r.createElement("div",{style:{textAlign:"left"}},r.createElement("span",null,r.createElement("div",{style:{display:"inline-block",width:"125px"}},e),r.createElement("div",{style:{display:"inline-block"}},n.inNotReady.length>0&&r.createElement(Os,{id:a+"-not-ready",namespace:a,status:ka,items:n.inNotReady,targetPage:t}),n.inError.length>0&&r.createElement(Os,{id:a+"-failure",namespace:a,status:wa,items:n.inError,targetPage:t}),n.inWarning.length>0&&r.createElement(Os,{id:a+"-degraded",namespace:a,status:Ra,items:n.inWarning,targetPage:t}),n.inSuccess.length>0&&r.createElement(Os,{id:a+"-healthy",namespace:a,status:xa,items:n.inSuccess,targetPage:t}),i===n.notAvailable.length&&r.createElement("div",{style:{display:"inline-block",marginLeft:"5px"}},"N/A")))))}}]),a}(r.Component),BA=a(1500),WA=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).onKebabToggle=function(e){n.setState({isKebabOpen:e})},n.renderTooltip=function(e,t,a,n){return r.createElement(lo.a,{key:"tooltip_"+e,position:t,content:r.createElement(r.Fragment,null,a)},r.createElement("div",{style:{display:"inline-block",cursor:"not-allowed"}},n))},n.state={isKebabOpen:!1},n}return Object(l.a)(a,[{key:"componentDidUpdate",value:function(e,t){t.isKebabOpen&&this.setState({isKebabOpen:!1})}},{key:"render",value:function(){var e=this,t=this.props.actions.map((function(t,a){if(t.isSeparator)return r.createElement(BA.a,{key:"separator_"+a});if(t.isGroup&&t.children)return r.createElement(cp.a,{key:"group_"+a,label:t.title,className:"kiali-group-menu",children:t.children.map((function(t,n){var i="subaction_"+a+"_"+n,o=r.createElement(up.a,{key:i,isDisabled:t.isDisabled,onClick:function(){return t.action?t.action(e.props.namespace):void 0}},t.title);return t.isDisabled?e.renderTooltip("tooltip_"+i,lo.b.left,"User has not enough permissions for this action",o):o}))});if(t.title&&t.action){var n=r.createElement(up.a,{key:"action_"+a,isDisabled:t.isDisabled,onClick:function(){return t.action?t.action(e.props.namespace):void 0}},t.title," ",t.isExternal?r.createElement(Jf.a,null):void 0);return t.isDisabled?e.renderTooltip("tooltip_action_"+a,lo.b.left,"User has not enough permissions for this action",n):n}}));return r.createElement(Ru.a,{toggle:r.createElement(Wf.a,{onToggle:this.onKebabToggle}),dropdownItems:t,isPlain:!0,isOpen:this.state.isKebabOpen,position:"right"})}}]),a}(r.Component),qA=["Istio Mesh Dashboard","Istio Control Plane Dashboard","Istio Performance Dashboard","Istio Wasm Extension Dashboard"],KA=Object(Jn.a)({backgroundColor:"#f5f5f5",paddingBottom:"20px",marginTop:"0px"}),zA=Object(Jn.a)({backgroundColor:"#f5f5f5",padding:"0 !important",marginTop:"0px"}),YA=Object(Jn.a)({borderTop:"2px solid #39a5dc",textAlign:"center",marginTop:"0px"}),QA=Object(Jn.a)({height:"300px",marginRight:5,marginBottom:10,marginTop:10}),XA=Object(Jn.a)({width:"75%",textAlign:"left"}),JA=Object(Jn.a)({display:"inline-block",verticalAlign:"middle"}),ZA=Object(Jn.a)({display:"inline-block",maxWidth:"calc(100% - 75px)",overflow:"hidden",textOverflow:"ellipsis",verticalAlign:"middle",whiteSpace:"nowrap"});!function(e){e[e.GRAPH=0]="GRAPH",e[e.APPLICATIONS=1]="APPLICATIONS",e[e.WORKLOADS=2]="WORKLOADS",e[e.SERVICES=3]="SERVICES",e[e.ISTIO_CONFIG=4]="ISTIO_CONFIG"}(yA||(yA={}));var $A=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;Object(s.a)(this,a),(n=t.call(this,e)).sFOverviewToolbar=r.createRef(),n.promises=new yr,n.getStartDisplayMode=function(e){var t=q.getParam(P.DISPLAY_MODE);return t?Number(t):e?Hs.COMPACT:Hs.EXPAND},n.load=function(){n.promises.cancelAll(),n.promises.register("namespaces",tn()).then((function(e){var t=xi.getSelected().filters.filter((function(e){return e.id===Fl.id})),a=e.data.filter((function(e){return 0===t.length||t.some((function(t){return e.name.includes(t.value)}))})).map((function(e){var t=n.state.namespaces.find((function(t){return t.name===e.name}));return{name:e.name,status:t?t.status:void 0,tlsStatus:t?t.tlsStatus:void 0,metrics:t?t.metrics:void 0,validations:t?t.validations:void 0,labels:e.labels}})),r=Kn(),i=Yn(Ll),o=sc.currentOverviewType(),s=n.getStartDisplayMode(a.length>16);n.setState((function(e){return{type:o,namespaces:Dl(a,i,r),displayMode:s,showConfirmModal:e.showConfirmModal,nsTarget:e.nsTarget,opTarget:e.opTarget}}),(function(){n.fetchHealth(r,i,o),n.fetchTLS(r,i),n.fetchValidations(r,i),n.fetchPermissions(),s!==Hs.COMPACT&&n.fetchMetrics()}))})).catch((function(e){e.isCanceled||n.handleAxiosError("Could not fetch namespace list",e)}))},n.sort=function(e,t){var a=Dl(n.state.namespaces,e,t);n.setState({namespaces:a})},n.setDisplayMode=function(e){n.setState({displayMode:e}),q.setParam(P.DISPLAY_MODE,String(e)),e===Hs.EXPAND&&n.fetchMetrics()},n.isNamespaceEmpty=function(e){return!!e.status&&e.status.inError.length+e.status.inSuccess.length+e.status.inWarning.length+e.status.notAvailable.length===0},n.show=function(e,t,a){var n="";switch(e){case yA.GRAPH:n="/graph/namespaces?namespaces=".concat(t,"&graphType=").concat(a);break;case yA.APPLICATIONS:n="/".concat(ce.APPLICATIONS,"?namespaces=")+t;break;case yA.WORKLOADS:n="/".concat(ce.WORKLOADS,"?namespaces=")+t;break;case yA.SERVICES:n="/".concat(ce.SERVICES,"?namespaces=")+t;break;case yA.ISTIO_CONFIG:n="/".concat(ce.ISTIO,"?namespaces=")+t}U.push(n)},n.getNamespaceActions=function(e){var t=[{isGroup:!0,isSeparator:!1,isDisabled:!1,title:"Show",children:[{isGroup:!0,isSeparator:!1,isDisabled:!1,title:"Graph",action:function(e){return n.show(yA.GRAPH,e,n.state.type)}},{isGroup:!0,isSeparator:!1,isDisabled:!1,title:"Applications",action:function(e){return n.show(yA.APPLICATIONS,e,n.state.type)}},{isGroup:!0,isSeparator:!1,isDisabled:!1,title:"Workloads",action:function(e){return n.show(yA.WORKLOADS,e,n.state.type)}},{isGroup:!0,isSeparator:!1,isDisabled:!1,title:"Services",action:function(e){return n.show(yA.SERVICES,e,n.state.type)}},{isGroup:!0,isSeparator:!1,isDisabled:!1,title:"Istio Config",action:function(e){return n.show(yA.ISTIO_CONFIG,e,n.state.type)}}]}],a=!1;if(n.state.permissions&&n.state.permissions[e.name]&&n.state.permissions[e.name].authorizationpolicies){var r=n.state.permissions[e.name].authorizationpolicies;a=r.create&&r.update&&r.delete}if(j.istioNamespace!==e.name){var i;if(j.kialiFeatureFlags.istioInjectionAction&&!j.kialiFeatureFlags.istioUpgradeAction){t.push({isGroup:!1,isSeparator:!0,isDisabled:!1});var o={isGroup:!1,isSeparator:!1,isDisabled:!a,title:"Enable Auto Injection",action:function(e){return n.onAddRemoveAutoInjection(e,!0,!1)}},s={isGroup:!1,isSeparator:!1,isDisabled:!a,title:"Disable Auto Injection",action:function(e){return n.onAddRemoveAutoInjection(e,!1,!1)}},l={isGroup:!1,isSeparator:!1,isDisabled:!a,title:"Remove Auto Injection",action:function(e){return n.onAddRemoveAutoInjection(e,!1,!0)}};e.labels&&(e.labels[j.istioLabels.injectionLabelName]&&"enabled"===e.labels[j.istioLabels.injectionLabelName]||e.labels[j.istioLabels.injectionLabelRev])?(t.push(s),t.push(l)):e.labels&&e.labels[j.istioLabels.injectionLabelName]&&"disabled"===e.labels[j.istioLabels.injectionLabelName]?(t.push(o),t.push(l)):t.push(o),t.push({isGroup:!1,isSeparator:!0,isDisabled:!1})}if(j.kialiFeatureFlags.istioUpgradeAction&&j.istioCanaryRevision.upgrade&&j.istioCanaryRevision.current){t.push({isGroup:!1,isSeparator:!0,isDisabled:!1});var c={isGroup:!1,isSeparator:!1,isDisabled:!a,title:"Upgrade to "+j.istioCanaryRevision.upgrade+" revision",action:function(e){return n.onUpgradeDowngradeIstio(e,j.istioCanaryRevision.upgrade)}},u={isGroup:!1,isSeparator:!1,isDisabled:!a,title:"Downgrade to "+j.istioCanaryRevision.current+" revision",action:function(e){return n.onUpgradeDowngradeIstio(e,j.istioCanaryRevision.current)}};e.labels&&(e.labels[j.istioLabels.injectionLabelRev]&&e.labels[j.istioLabels.injectionLabelRev]===j.istioCanaryRevision.current||e.labels[j.istioLabels.injectionLabelName]&&"enabled"===e.labels[j.istioLabels.injectionLabelName])?(t.push(c),t.push({isGroup:!1,isSeparator:!0,isDisabled:!1})):e.labels&&e.labels[j.istioLabels.injectionLabelRev]&&e.labels[j.istioLabels.injectionLabelRev]===j.istioCanaryRevision.upgrade&&(t.push(u),t.push({isGroup:!1,isSeparator:!0,isDisabled:!1}))}var p=(null===(i=e.istioConfig)||void 0===i?void 0:i.authorizationPolicies)||[],d={isGroup:!1,isSeparator:!1,isDisabled:!a,title:(0===p.length?"Create ":"Update")+" Traffic Policies",action:function(e){0===p.length?n.onCreateTrafficPolicies(e):n.onUpdateTrafficPolicies(e)}},m={isGroup:!1,isSeparator:!1,isDisabled:!a,title:"Delete Traffic Policies",action:function(e){return n.onDeleteTrafficPolicies(e)}};t.push(d),p.length>0&&t.push(m)}else n.state.grafanaLinks.length>0&&(t.push({isGroup:!1,isSeparator:!0,isDisabled:!1}),n.state.grafanaLinks.forEach((function(e){var a={isGroup:!1,isSeparator:!1,isDisabled:!1,isExternal:!0,title:e.name,action:function(t){window.open(e.url,"_blank"),n.load()}};t.push(a)})));return t},n.onAddRemoveAutoInjection=function(e,t,a){var r=Em(t,a,null);sn(e,r).then((function(t){Dn("Namespace "+e+" updated","default",Te.SUCCESS),n.load()})).catch((function(t){_n("Could not update namespace "+e,t)}))},n.onUpgradeDowngradeIstio=function(e,t){var a=Em(!1,!1,t);sn(e,a).then((function(t){Dn("Namespace "+e+" updated","default",Te.SUCCESS),n.load()})).catch((function(t){_n("Could not update namespace "+e,t)}))},n.onCreateTrafficPolicies=function(e){n.onAddRemoveAuthorizationPolicy(e,[],!1)},n.onUpdateTrafficPolicies=function(e){n.setState({showConfirmModal:!0,nsTarget:e,opTarget:"update"})},n.onDeleteTrafficPolicies=function(e){n.setState({showConfirmModal:!0,nsTarget:e,opTarget:"delete"})},n.onAddRemoveAuthorizationPolicy=function(e,t,a){t.length>0?n.promises.registerAll("authorizationPoliciesDelete",t.map((function(t){return cn(e,"authorizationpolicies",t.metadata.name)}))).then((function(t){a?n.load():n.createAuthorizationPolicies(e,n.load)})).catch((function(e){e.isCanceled||_n("Could not delete AuthorizationPolicies.",e)})):a?Hn("Namespace "+e+" doesn't have AuthorizationPolicy config."):n.createAuthorizationPolicies(e,n.load)},n.createAuthorizationPolicies=function(e,t){var a=new Vf;a.on("fetchSuccess",(function(){var r=function(e,t){var a=[{metadata:{name:"deny-all-"+e,namespace:e,labels:Object(Ei.a)({},"kiali_wizard","AuthorizationPolicy")},spec:{}}];if(t.elements.nodes)for(var n=0;n<t.elements.nodes.length;n++){var r=t.elements.nodes[n];if(r.data.namespace===e&&r.data.nodeType===Ze.WORKLOAD&&r.data.workload&&r.data.app&&r.data.version){var i={metadata:{name:r.data.workload,namespace:e,labels:Object(Ei.a)({},"kiali_wizard","AuthorizationPolicy")},spec:{selector:{matchLabels:{app:r.data.app,version:r.data.version}},rules:[{from:[{source:{principals:[]}}]}]}},o=0;if(t.elements.edges)for(var s=0;s<t.elements.edges.length;s++){var l=t.elements.edges[s];if(r.data.id===l.data.target&&i.spec.rules&&i.spec.rules[0]&&i.spec.rules[0].from&&i.spec.rules[0].from[0]&&i.spec.rules[0].from[0].source&&i.spec.rules[0].from[0].source.principals&&l.data.sourcePrincipal){var c=l.data.sourcePrincipal.startsWith("spiffe://")?l.data.sourcePrincipal.substring(9):l.data.sourcePrincipal;i.spec.rules[0].from[0].source.principals.push(c),o++}}o>0&&a.push(i)}}return a}(e,a.graphDefinition);n.promises.registerAll("authorizationPoliciesCreate",r.map((function(t){return pn(e,"authorizationpolicies",JSON.stringify(t))}))).then((function(a){a.length>0&&Dn("AuthorizationPolicies created for "+e+" namespace.","default",Te.SUCCESS),t()})).catch((function(e){e.isCanceled||_n("Could not create AuthorizationPolicies.",e)}))})),a.on("fetchError",(function(e){_n(e=""!==e?"Could not fetch traffic data: "+e:"Could not fetch traffic data.")})),a.fetchForNamespace(n.props.duration,e)},n.hideConfirmModal=function(){n.setState({showConfirmModal:!1,nsTarget:"",opTarget:""})},n.onConfirmModal=function(){for(var e=[],t=0;t<n.state.namespaces.length;t++){var a=n.state.namespaces[t];if(n.state.namespaces[t].name===n.state.nsTarget){var r;e=(null===(r=a.istioConfig)||void 0===r?void 0:r.authorizationPolicies)||[];break}}var i=n.state.nsTarget,o="delete"===n.state.opTarget;n.setState({showConfirmModal:!1,nsTarget:"",opTarget:""},(function(){return n.onAddRemoveAuthorizationPolicy(i,e,o)}))};var i=q.getParam(P.DISPLAY_MODE);return n.state={namespaces:[],type:sc.currentOverviewType(),displayMode:i?Number(i):Hs.EXPAND,permissions:{},showConfirmModal:!1,nsTarget:"",opTarget:"",grafanaLinks:[]},n}return Object(l.a)(a,[{key:"componentDidUpdate",value:function(e){e.duration===this.props.duration&&e.navCollapse===this.props.navCollapse||this.load()}},{key:"componentDidMount",value:function(){this.fetchGrafanaInfo(),this.load()}},{key:"componentWillUnmount",value:function(){this.promises.cancelAll()}},{key:"sortFields",value:function(){return Ll}},{key:"fetchHealth",value:function(e,t,a){var n=this,r=zn();A.a.chunk(this.state.namespaces,10).forEach((function(i){n.promises.registerChained("healthchunks",void 0,(function(){return n.fetchHealthChunk(i,r,a)})).then((function(){n.setState((function(a){var n=a.namespaces.slice();return"health"===t.id&&(n=Dl(n,t,e)),{namespaces:n}}))}))}))}},{key:"fetchGrafanaInfo",value:function(){var e=this;a.grafanaInfoPromise||(a.grafanaInfoPromise=bn().then((function(e){if(204!==e.status)return e.data}))),a.grafanaInfoPromise.then((function(t){t?e.setState({grafanaLinks:t.externalLinks.filter((function(e){return qA.indexOf(e.name)>-1}))}):e.setState({grafanaLinks:[]})})).catch((function(e){Fn(Object(C.a)(Object(C.a)({},Mn("Could not fetch Grafana info. Turning off links to Grafana.",e)),{},{group:"default",type:Te.INFO,showNotification:!1}))}))}},{key:"fetchHealthChunk",value:function(e,t,a){var n=this,r=Is(a,gn,vn,En);return Promise.all(e.map((function(e){return r(e.name,t).then((function(t){return{health:t,nsInfo:e}}))}))).then((function(e){e.forEach((function(e){var t={inNotReady:[],inError:[],inWarning:[],inSuccess:[],notAvailable:[]};Object.keys(e.health).forEach((function(a){var n=e.health[a].getGlobalStatus();n===wa?t.inError.push(a):n===Ra?t.inWarning.push(a):n===xa?t.inSuccess.push(a):n===ka?t.inNotReady.push(a):t.notAvailable.push(a)})),e.nsInfo.status=t}))})).catch((function(e){return n.handleAxiosError("Could not fetch health",e)}))}},{key:"fetchMetrics",value:function(){var e=this,t=zn();A.a.chunk(this.state.namespaces,10).forEach((function(a){e.promises.registerChained("metricschunks",void 0,(function(){return e.fetchMetricsChunk(a,t)})).then((function(){e.setState((function(e){return{namespaces:e.namespaces.slice()}}))}))}))}},{key:"fetchMetricsChunk",value:function(e,t){var a=this,n=Z(t,10),r={filters:["request_count"],duration:t,step:n.step,rateInterval:n.rateInterval,direction:"inbound",reporter:"destination"};return Promise.all(e.map((function(e){return an(e.name,r).then((function(t){return e.metrics=t.data.request_count,e}))}))).catch((function(e){return a.handleAxiosError("Could not fetch health",e)}))}},{key:"fetchTLS",value:function(e,t){var a=this;A.a.chunk(this.state.namespaces,10).forEach((function(n){a.promises.registerChained("tlschunks",void 0,(function(){return a.fetchTLSChunk(n)})).then((function(){a.setState((function(a){var n=a.namespaces.slice();return"mtls"===t.id&&(n=Dl(n,t,e)),{namespaces:n}}))}))}))}},{key:"fetchTLSChunk",value:function(e){var t=this;return Promise.all(e.map((function(e){return(t=e.name,Xa(K.GET,qa.namespaceTls(t),{},{})).then((function(t){return{status:t.data,nsInfo:e}}));var t}))).then((function(e){e.forEach((function(e){e.nsInfo.tlsStatus={status:Cs(e.status.status,t.props.meshStatus)}}))})).catch((function(e){return t.handleAxiosError("Could not fetch TLS status",e)}))}},{key:"fetchValidations",value:function(e,t){var a=this;A.a.chunk(this.state.namespaces,10).forEach((function(n){a.promises.registerChained("validationchunks",void 0,(function(){return a.fetchValidationChunk(n)})).then((function(){a.setState((function(a){var n=a.namespaces.slice();return"validations"===t.id&&(n=Dl(n,t,e)),{namespaces:n}}))}))}))}},{key:"fetchValidationChunk",value:function(e){var t=this;return Promise.all(e.map((function(e){return Promise.all([on(e.name),ln(e.name,["authorizationpolicies"],!1,"","")]).then((function(t){return{validations:t[0].data,istioConfig:t[1].data,nsInfo:e}}))}))).then((function(e){e.forEach((function(e){e.nsInfo.validations=e.validations,e.nsInfo.istioConfig=e.istioConfig}))})).catch((function(e){return t.handleAxiosError("Could not fetch validations status",e)}))}},{key:"fetchPermissions",value:function(){var e=this;this.promises.register("namespacepermissions",kn(this.state.namespaces.map((function(e){return e.name})))).then((function(t){e.setState({permissions:t.data})}))}},{key:"handleAxiosError",value:function(e,t){Un("".concat(e,": ").concat(On(t)))}},{key:"render",value:function(){var e=this,t=this.state.displayMode===Hs.COMPACT?3:6,a=this.state.displayMode===Hs.COMPACT?3:4,n=Qn(this.state.namespaces,Ul,xi.getSelected()),i=n.map((function(t,a){var n=e.getNamespaceActions(t);return r.createElement(WA,{key:"namespaceAction_"+a,namespace:t.name,actions:n})})),o=this.state.opTarget.length>0?this.state.opTarget.charAt(0).toLocaleUpperCase()+this.state.opTarget.slice(1):"";return r.createElement(r.Fragment,null,r.createElement(lc,{onRefresh:this.load,onError:Un,sort:this.sort,displayMode:this.state.displayMode,setDisplayMode:this.setDisplayMode,statefulFilterRef:this.sFOverviewToolbar}),n.length>0?r.createElement(Zn,{className:this.state.displayMode===Hs.LIST?zA:KA},this.state.displayMode===Hs.LIST?r.createElement(Ou,{rows:n,sort:this.sort,statefulProps:this.sFOverviewToolbar,actions:i}):r.createElement(Df.a,null,n.map((function(n,o){var s=n.name.length>20;return r.createElement(Ff.a,{sm:t,md:a,key:"CardItem_"+n.name,style:{margin:"0px 5px 0 5px"}},r.createElement(Ef.a,{isCompact:!0,className:YA},r.createElement(Uf.a,null,r.createElement(Bf.a,null,i[o]),r.createElement(bf.a,{className:XA},r.createElement(Eo.a,{headingLevel:"h5",size:"lg"},r.createElement("span",{className:s?ZA:JA,title:n.name},n.name)))),r.createElement(yf.a,null,e.renderLabels(n),r.createElement("div",{style:{textAlign:"left"}},r.createElement("div",{style:{display:"inline-block",width:"125px"}},"Istio Config"),n.tlsStatus&&r.createElement("span",null,r.createElement(Ts,{status:n.tlsStatus.status})),e.renderIstioConfigStatus(n)),e.renderStatuses(n))))})))):r.createElement("div",{style:{backgroundColor:"#f5f5f5"}},r.createElement(Cu.a,{className:QA,variant:Cu.b.full},r.createElement(Eo.a,{headingLevel:"h5",size:"lg",style:{marginTop:"50px"}},"No unfiltered namespaces"),r.createElement(Su.a,null,"Either all namespaces are being filtered or the user has no permission to access namespaces."))),r.createElement(ih.a,{isSmall:!0,title:"Confirm "+o+" Traffic Policies ?",isOpen:this.state.showConfirmModal,onClose:this.hideConfirmModal,actions:[r.createElement(vr.a,{key:"cancel",variant:"secondary",onClick:this.hideConfirmModal},"Cancel"),r.createElement(vr.a,{key:"confirm",variant:"danger",onClick:this.onConfirmModal},o)]},"Namespace "+this.state.nsTarget+" has existing AuthorizationPolicy objects. Do you want to "+this.state.opTarget+" them ?"))}},{key:"renderLabels",value:function(e){var t=this,a=e.labels?"".concat(Object.entries(e.labels).length):"No";return e.labels?r.createElement("div",{style:{color:nt.Blue400,textAlign:"left",cursor:"pointer"},onClick:function(){return t.setDisplayMode(Hs.LIST)}},r.createElement(lo.a,{"aria-label":"Labels list",position:lo.b.right,enableFlip:!0,distance:5,content:r.createElement("ul",null,Object.entries(e.labels||[]).map((function(e){var t=Object(T.a)(e,2),a=t[0],n=t[1];return r.createElement("li",{key:a},a,": ",n)})))},r.createElement("div",{id:"labels_info",style:{display:"inline"}},a," Label","1"!==a?"s":""))):r.createElement("div",{style:{textAlign:"left"}},"No labels")}},{key:"renderStatuses",value:function(e){return e.status?this.state.displayMode===Hs.COMPACT?r.createElement(UA,{key:e.name,name:e.name,status:e.status,type:this.state.type}):r.createElement(al,{key:e.name,name:e.name,duration:zn(),status:e.status,type:this.state.type,metrics:e.metrics}):r.createElement("div",{style:{height:70}})}},{key:"renderIstioConfigStatus",value:function(e){var t={objectCount:0,errors:0,warnings:0};return e.validations&&(t=e.validations),r.createElement(Ec,{namespace:e.name,objectCount:t.objectCount,errors:t.errors,warnings:t.warnings},r.createElement(_o,{id:"ns-val-"+e.name,errors:t.errors,warnings:t.warnings,objectCount:t.objectCount}))}}]),a}(r.Component);$A.grafanaInfoPromise=void 0;var eT=Object(h.b)((function(e){return{duration:fl(e),meshStatus:xl(e),navCollapse:e.userSettings.interface.navCollapse,refreshInterval:Al(e)}}))($A),tT=a(604),aT=a.n(tT),nT=a(1501),rT=a(1502),iT=a(1503),oT=a(1504),sT=Object(Jn.a)({backgroundColor:nt.White,marginRight:"1px"}),lT=Object(Jn.a)({color:nt.Active}),cT=Object(Jn.a)({padding:"7px 10px"}),uT=Object(Jn.a)({marginLeft:"9px"}),pT=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;Object(s.a)(this,a),(n=t.call(this,e)).getCy=function(){return n.props.cytoscapeGraphRef.current?n.props.cytoscapeGraphRef.current.getCy():null},n.toggleDrag=function(){var e=n.getCy();e&&(e.autoungrabify(n.state.allowGrab),n.setState({allowGrab:!n.state.allowGrab}))},n.zoom=function(e){var t=n.getCy(),a=t?t.container():void 0;t&&a&&t.zoom({level:t.zoom()*(1+e),renderedPosition:{x:a.offsetWidth/2,y:a.offsetHeight/2}})},n.zoomIn=function(){n.zoom(.2)},n.zoomOut=function(){n.zoom(-.2)},n.fit=function(){var e=n.getCy();e&&Sv(e)};var r=q.getParam(P.GRAPH_LAYOUT);return r?r!==e.layout.name&&e.setLayout(mg(r)):q.setParam(P.GRAPH_LAYOUT,e.layout.name),n.state={allowGrab:!1},n}return Object(l.a)(a,[{key:"componentDidUpdate",value:function(){q.setParam(P.GRAPH_LAYOUT,this.props.layout.name)}},{key:"render",value:function(){var e=this;return r.createElement(dr.a,{className:cT},r.createElement(or.a,null,r.createElement(lo.a,{content:this.state.allowGrab?"Disable Drag":"Enable Drag"},r.createElement(vr.a,{id:"toolbar_grab","aria-label":"Toggle Drag",className:sT,variant:"plain",onClick:function(){return e.toggleDrag()},isActive:this.state.allowGrab},r.createElement(nT.a,{className:this.state.allowGrab?lT:void 0})))),r.createElement(or.a,null,r.createElement(lo.a,{content:"Zoom In"},r.createElement(vr.a,{id:"toolbar_zoom_in","aria-label":"Zoom In",className:[uT,sT].join(" "),variant:"plain",onClick:function(){return e.zoomIn()}},r.createElement(rT.a,null)))),r.createElement(or.a,null,r.createElement(lo.a,{content:"Zoom Out"},r.createElement(vr.a,{id:"toolbar_zoom_out","aria-label":"Zoom Out",className:sT,variant:"plain",onClick:function(){return e.zoomOut()}},r.createElement(iT.a,null)))),r.createElement(or.a,null,r.createElement(lo.a,{content:"Zoom to Fit"},r.createElement(vr.a,{id:"toolbar_graph_fit","aria-label":"Zoom to Fit",className:[uT,sT].join(" "),variant:"plain",onClick:function(){return e.fit()}},r.createElement(oT.a,null)))),r.createElement(or.a,{className:uT},r.createElement(lo.a,{content:"Layout default "+lt.getLayout().name},r.createElement(vr.a,{id:"toolbar_layout_default","aria-label":"Graph Layout Default Style",className:sT,variant:"plain",onClick:function(){e.props.setLayout(lt.getLayout())},isActive:this.props.layout.name===lt.getLayout().name},r.createElement(ii.a,{className:this.props.layout.name===lt.getLayout().name?lT:void 0})))),r.createElement(Mu,{info:Hu.Layout},r.createElement(or.a,null,r.createElement(lo.a,{content:"Layout 1 "+pg.getLayout().name},r.createElement(vr.a,{id:"toolbar_layout1","aria-label":"Graph Layout Style 1",className:sT,variant:"plain",onClick:function(){e.props.setLayout(pg.getLayout())},isActive:this.props.layout.name===pg.getLayout().name},r.createElement(ii.a,{className:this.props.layout.name===pg.getLayout().name?lT:void 0})," ","1")))),r.createElement(or.a,null,r.createElement(lo.a,{content:"Layout 2 "+ug.getLayout().name},r.createElement(vr.a,{id:"toolbar_layout2","aria-label":"Graph Layout Style 2",className:sT,variant:"plain",onClick:function(){e.props.setLayout(ug.getLayout())},isActive:this.props.layout.name===ug.getLayout().name},r.createElement(ii.a,{className:this.props.layout.name===ug.getLayout().name?lT:void 0})," ","2"))),r.createElement(Mu,{info:Hu.Legend},r.createElement(or.a,null,r.createElement(vr.a,{variant:"primary",id:"toolbar_toggle_legend","aria-label":"Show Legend",onClick:this.props.toggleLegend,isActive:this.props.showLegend,className:uT},"Legend"))))}}]),a}(r.PureComponent),dT=Object(h.b)((function(e){return{layout:e.graph.layout,showLegend:e.graph.toolbarState.showLegend}}),(function(e){return{setLayout:Object(Ie.b)(Ke.setLayout,e),toggleLegend:Object(Ie.b)(st.toggleLegend,e)}}))(pT),mT=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).cleanError=function(){n.setState((function(e){return e.hasError?{hasError:!1}:null}))},n.state={hasError:!1},n}return Object(l.a)(a,[{key:"componentDidCatch",value:function(e,t){this.props.onError&&this.props.onError(e,t),this.setState({hasError:!0})}},{key:"render",value:function(){return this.state.hasError?this.props.fallBackComponent:this.props.children}}]),a}(r.Component),hT=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).handleTabSelect=function(e,t){n.setState({activeTab:t})},n.state={activeTab:e.defaultTab},n}return Object(l.a)(a,[{key:"render",value:function(){return r.createElement(ch.a,{id:this.props.id,style:this.props.style?this.props.style:{},isFilled:!this.props.isFilled||this.props.isFilled,activeKey:this.state.activeTab,onSelect:this.handleTabSelect,mountOnEnter:void 0===this.props.mountOnEnter||this.props.mountOnEnter,unmountOnExit:void 0===this.props.unmountOnExit||this.props.unmountOnExit},this.props.children)}}]),a}(r.Component),fT={fontSize:"14px"},gT=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).onResize=function(){e.forceUpdate()},e.edgeColumns=function(){return[{title:"Expression"},{title:"Notes"}]},e.edgeRows=function(){return[["destprincipal <op> <principal>"],["grpc <op> <number>","unit: requests per second"],["%grpcerr <op> <number>","range: [0..100]"],["%grpctraffic <op> <number>","range: [0..100]"],["http <op> <number>","unit: requests per second"],["%httperr <op> <number>","range: [0..100]"],["%httptraffic <op> <number>","range: [0..100]"],["mtls","will auto-enable 'security' display option"],["protocol <op> <protocol>","grpc, http, tcp, etc.."],["responsetime <op> <number>","unit: millis, will auto-enable 'P95 response time' edge labels"],["sourceprincipal <op> <principal>"],["tcp <op> <number>","unit: bytes per second"],["throughput <op> <number>","unit: bytes per second, will auto-enable 'request throughput' edge labels"],["traffic","any traffic for any protocol"]]},e.exampleColumns=function(){return[{title:"Expression"},{title:"Description"}]},e.exampleRows=function(){return[["name = reviews","\"by name\": nodes with app label, service name or workload name equal to 'reviews'"],["name not contains rev","\"by name\": nodes with app label, service name and workload name not containing 'rev'"],["app startswith product","nodes with app label starting with 'product'"],["app != details and version=v1","nodes with app label not equal to 'details' and with version equal to 'v1'"],["!sc","nodes without a sidecar"],["httpin > 0.5","nodes with inbound http rate > 0.5 rps"],["tcpout >= 1000","nodes with outbound tcp rates >= 1000 bps"],["!traffic","edges with no traffic"],["http > 0.5","edges with http rate > 0.5 rps"],["rt > 500","edges with response time > 500ms. (requires response time edge labels)"],["%httptraffic >= 50.0","edges with >= 50% of the outbound http request traffic of the parent"],["node = svc and svc startswith det or !traffic",'service node starting with "det" or edges with no traffic']]},e.nodeColumns=function(){return[{title:"Expression"},{title:"Notes"}]},e.nodeRows=function(){return[["grpcin <op> <number>","unit: requests per second"],["grpcout <op> <number>","unit: requests per second"],["httpin <op> <number>","unit: requests per second"],["httpout <op> <number>","unit: requests per second"],["app <op> <appName>"],["cluster <op> <clusterName>"],["name <op> <string>","tests against app label, operation, service and workload names"],["namespace <op> <namespaceName>"],["node <op> <nodeType>","nodeType: app | operation | service | workload | unknown"],["operation <op> <operationName>"],["service <op> <serviceName>"],["version <op> <string>"],["tcpin <op> <number>","unit: bytes per second"],["tcpout <op> <number>","unit: bytes per second"],["workload <op> <workloadName>"],["circuitbreaker"],["faultinjection"],["healthy","is not degraded or failing."],["idle","will auto-enable 'idle nodes' display option"],["outside","is outside of requested namespaces"],["requestrouting"],["requesttimeout"],["sidecar"],["serviceentry"],["tcptrafficshifting"],["trafficshifting"],["trafficsource","has only outbound edges"],["virtualservice"]]},e.noteColumns=function(){return[{title:"Usage Note",transforms:[Object(oo.a)(10)],props:{style:{align:"text-left"}}}]},e.noteRows=function(){return[["Press Tab key to autocomplete operands."],["OR has precedence over AND.  Parentheses are not supported."],["Use OR to combine node and edge criteria."],['Use "<operand> = NaN" to test for no activity. Use "!= NaN" for any activity. (e.g. httpout = NaN)'],['Unary operands may optionally be prefixed with "is" or "has". (i.e. "has mtls")'],['The "name" operand expands internally to an "OR" expression (an "AND" when negated).'],["Abbreviate: ns|namespace, svc|service, se|serviceentry, wl|workload, op|operation"],["Abbreviate: rt|responsetime, sc|sidecar, vs|virtualservice"],["Abbreviate: cb|circuitbreaker, fi|faultinjection, rr|requestrouting, rto|requesttimeout, ts|trafficshifting"],["Hiding nodes will automatically hide connected edges."],["Hiding edges will automatically hide nodes left with no visible edges."],['Hiding "healthy" nodes may still leave valid, healthy edges in the graph.']]},e.operatorColumns=function(){return[{title:"Operator"},{title:"Description"}]},e.operatorRows=function(){return[["! | not <unary expression>","negation"],["=","equals"],["!=","not equals"],["endswith | $=","ends with, strings only"],["!endswith | !$=","not ends with, strings only"],["startswith | ^=","starts with, strings only"],["!startswith | !^=","not starts with, strings only"],["contains | *=","contains, strings only"],["!contains | !*=","not contains, strings only"],[">","greater than"],[">=","greater than or equals"],["<","less than"],["<=","less than or equals"]]},e}return Object(l.a)(a,[{key:"render",value:function(){var e=Object(Jn.a)({width:"600px",maxWidth:"604px",height:"550px",overflow:"hidden",overflowX:"auto",overflowY:"auto"}),t=Object(Jn.a)({fontSize:"12px",color:"#fff",backgroundColor:"#003145",width:"540px",height:"80px",padding:"5px",resize:"none",overflowY:"hidden"});return r.createElement(r.Fragment,null,r.createElement(Pu.a,{refreshMode:"debounce",refreshRate:100,skipOnMount:!0,handleWidth:!0,handleHeight:!0,onResize:this.onResize}),r.createElement(Cr.a,{className:e,position:Cr.b.auto,isVisible:!0,hideOnOutsideClick:!1,shouldClose:this.props.onClose,headerContent:r.createElement("div",null,r.createElement("span",null,"Graph Find/Hide")),bodyContent:r.createElement(r.Fragment,null,r.createElement("textarea",{className:"".concat(t),readOnly:!0,value:'You can use the Find and Hide fields to highlight or hide graph edges and nodes. Each field accepts expressions using the language described below. Preset expressions are available via the dropdown. Hide takes precedence when using Find and Hide together. Uncheck the "Compressed Hide" Display option for hidden elements to retain their space.'}),r.createElement(hT,{id:"graph_find_help_tabs",defaultTab:0,style:{width:"540px"}},r.createElement(bh.a,{style:fT,eventKey:0,title:"Examples"},r.createElement(Eu.b,{header:r.createElement(r.Fragment,null),variant:Eu.e.compact,cells:this.exampleColumns(),rows:this.exampleRows()},r.createElement(bu.a,null),r.createElement(kp.a,null))),r.createElement(bh.a,{style:fT,eventKey:1,title:"Nodes"},r.createElement(Eu.b,{header:r.createElement(r.Fragment,null),variant:Eu.e.compact,cells:this.nodeColumns(),rows:this.nodeRows()},r.createElement(bu.a,null),r.createElement(kp.a,null))),r.createElement(bh.a,{style:fT,eventKey:2,title:"Edges"},r.createElement(Eu.b,{header:r.createElement(r.Fragment,null),variant:Eu.e.compact,cells:this.edgeColumns(),rows:this.edgeRows()},r.createElement(bu.a,null),r.createElement(kp.a,null))),r.createElement(bh.a,{style:fT,eventKey:3,title:"Operators"},r.createElement(Eu.b,{header:r.createElement(r.Fragment,null),variant:Eu.e.compact,cells:this.operatorColumns(),rows:this.operatorRows()},r.createElement(bu.a,null),r.createElement(kp.a,null))),r.createElement(bh.a,{style:fT,eventKey:4,title:"Usage Notes"},r.createElement(Eu.b,{header:r.createElement(r.Fragment,null),variant:Eu.e.compact,cells:this.noteColumns(),rows:this.noteRows()},r.createElement(bu.a,null),r.createElement(kp.a,null)))))},r.createElement(r.Fragment,null,this.props.children)))}}]),a}(r.Component),vT=function(){function e(t){Object(s.a)(this,e),this.options=t,this.endings=void 0,this.start=void 0,this.endings=Object(mt.a)(t),this.start=""}return Object(l.a)(e,[{key:"setInput",value:function(e,t){t=t||[" "];var a,n=-1,r=Object($t.a)(t);try{for(r.s();!(a=r.n()).done;){var i=a.value,o=e.lastIndexOf(i);n=o>n?o:n}}catch(l){r.e(l)}finally{r.f()}this.start=n<0?"":e.slice(0,n+1);var s=n<0?e:e.slice(n+1);this.endings=s?this.options.filter((function(e){return e.startsWith(s)&&e!==s})):Object(mt.a)(this.options),this.endings.length||(this.start=e)}},{key:"next",value:function(){if(!this.endings.length)return this.start;var e=this.endings.shift();return this.endings.push(e),"".concat(this.start).concat(e)}}]),e}(),ET=Object(Jn.a)({minWidth:"20px",width:"20px",paddingLeft:"5px",paddingRight:0,bottom:"1px"}),bT=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).options=void 0,n.close=function(){n.setState({isOpen:!1})},n.getOptionItems=function(e){return("find"===e?j.kialiFeatureFlags.uiDefaults.graph.findOptions:j.kialiFeatureFlags.uiDefaults.graph.hideOptions).map((function(e){return r.createElement(up.a,{key:e.description,onClick:function(){return n.props.onSelect(e.expression)}},e.description)}))},n.onToggle=function(e){n.setState({isOpen:e})},n.options=n.getOptionItems(e.kind),n.state={isOpen:!1},n}return Object(l.a)(a,[{key:"render",value:function(){return r.createElement(Ru.a,{key:"graph-".concat(this.props.kind,"-presets"),id:"graph-findhide-presets",toggle:r.createElement(ku.a,{className:ET,iconComponent:null,onToggle:this.onToggle},r.createElement(fi.AngleDown,null)),isOpen:this.state.isOpen,dropdownItems:this.options,onSelect:this.close})}}]),a}(r.PureComponent),yT={width:"var(--graph-find-input--width)"},CT=Object(Jn.a)({paddingLeft:"10px",paddingRight:"10px"}),ST=["%grpcerr","%grpctraffic","%httperr","%httptraffic","app","circuitbreaker","cluster","destprincipal","faultinjection","grpc","grpcerr","grpcin","grpcout","healthy","http","httpin","httpout","idle","mtls","name","namespace","node","operation","outside","protocol","requestrouting","requesttimeout","responsetime","service","serviceentry","sidecar","sourceprincipal","tcp","tcptrafficshifting","throughput","traffic","trafficshifting","trafficsource","version","virtualservice","tcpin","tcpout","workload"],AT=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;Object(s.a)(this,a),(n=t.call(this,e)).findAutoComplete=void 0,n.findInputRef=void 0,n.hiddenElements=void 0,n.hideAutoComplete=void 0,n.hideInputRef=void 0,n.removedElements=void 0,n.toggleFindHelp=function(){n.props.toggleFindHelp()},n.checkSpecialKeyFind=function(e){switch(e.keyCode?e.keyCode:e.which){case 9:e.preventDefault();var t=n.findAutoComplete.next();t&&(n.findInputRef.value=t,n.findInputRef.scrollLeft=n.findInputRef.scrollWidth,n.setState({findInputValue:t,findError:void 0}));break;case 13:e.preventDefault(),n.submitFind()}},n.updateFindOption=function(e){n.setFind(e)},n.updateFind=function(e){if(""===e)n.setFind("");else{var t=Math.abs(e.length-n.state.findInputValue.length);n.findAutoComplete.setInput(e,[" ","!"]),n.setState({findInputValue:e,findError:void 0}),t>1&&n.props.setFindValue(e)}},n.setFind=function(e){n.findInputRef.value=e;var t=document.getElementById("graph_find");null!==t&&(t.value=e),n.findAutoComplete.setInput(e),n.setState({findInputValue:e,findError:void 0}),n.props.setFindValue(e)},n.submitFind=function(){n.props.findValue!==n.state.findInputValue&&n.props.setFindValue(n.state.findInputValue)},n.checkSpecialKeyHide=function(e){switch(e.keyCode?e.keyCode:e.which){case 9:e.preventDefault();var t=n.hideAutoComplete.next();t&&(n.hideInputRef.value=t,n.hideInputRef.scrollLeft=n.hideInputRef.scrollWidth,n.setState({hideInputValue:t,hideError:void 0}));break;case 13:e.preventDefault(),n.submitHide()}},n.updateHideOption=function(e){n.setHide(e)},n.updateHide=function(e){if(""===e)n.setHide("");else{var t=Math.abs(e.length-n.state.hideInputValue.length);n.hideAutoComplete.setInput(e,[" ","!"]),n.setState({hideInputValue:e,hideError:void 0}),t>1&&n.props.setHideValue(e)}},n.submitHide=function(){n.props.hideValue!==n.state.hideInputValue&&n.props.setHideValue(n.state.hideInputValue)},n.setHide=function(e){n.hideInputRef.value=e;var t=document.getElementById("graph_hide");null!==t&&(t.value=e),n.hideAutoComplete.setInput(e),n.setState({hideInputValue:e,hideError:void 0}),n.props.setHideValue(e)},n.handleHide=function(e,t,a,r){var i=n.parseValue(n.props.hideValue,!1);if(console.debug("Hide selector=[".concat(i,"]")),e.startBatch(),n.hiddenElements&&!a&&n.hiddenElements.style({visibility:"visible"}),n.hiddenElements=void 0,n.removedElements&&!a&&n.removedElements.restore(),n.removedElements=void 0,i){var o=e.$(i),s=(o=o.add(o.connectedEdges())).absoluteComplement(),l=s.edges().connectedNodes(),c=s.nodes("[^".concat(sv,"]")).subtract(l);if(o=(o=o.add(c)).subtract(o.filter("$node[isBox]")),n.props.compressOnHide){n.removedElements=e.remove(o);var u=e.$("$node[isBox]").subtract(e.$("$node[isBox] > :inside"));n.removedElements=n.removedElements.add(e.remove(u))}else{n.hiddenElements=o,n.hiddenElements.style({visibility:"hidden"});var p=e.$("$node[isBox]").subtract(e.$("$node[isBox] > :visible"));p.style({visibility:"hidden"}),n.hiddenElements=n.hiddenElements.add(p)}}e.endBatch();var d=!!n.removedElements&&n.removedElements.length>0;(t||r&&i||d)&&Av(e,n.props.layout)},n.handleFind=function(e){var t=n.parseValue(n.props.findValue,!0);console.debug("Find selector=[".concat(t,"]")),e.startBatch(),e.elements("*.find").removeClass("find"),t&&e.elements(t).addClass("find"),e.endBatch()},n.parseValue=function(e,t){var a=n.prepareValue(e);if(a){var r,i,o=a.split(" OR "),s=Object($t.a)(o);try{for(s.s();!(i=s.n()).done;){var l,c=i.value.split(" AND "),u=c.length>1,p=void 0,d=Object($t.a)(c);try{for(d.s();!(l=d.n()).done;){var m=l.value,h=n.parseExpression(m,u,t);if(!h)return;if(!(p=n.appendSelector(p,h,t)))return}}catch(f){d.e(f)}finally{d.f()}n.setError(void 0,t),r=r?"".concat(r,",").concat(p):p}}catch(f){s.e(f)}finally{s.f()}return r}},n.prepareValue=function(e){return(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=" "+(e=e.replace(/ +(?= )/g,""))).replace(/ is /gi," ")).replace(/ has /gi," ")).replace(/ !\s*is /gi," ! ")).replace(/ !\s*has /gi," ! ")).replace(/ not /gi," !")).replace(/ !\s*contains /gi," !*= ")).replace(/ !\s*startswith /gi," !^= ")).replace(/ !\s*endswith /gi," !$= ")).replace(/ contains /gi," *= ")).replace(/ startswith /gi," ^= ")).replace(/ endswith /gi," $= ")).replace(/ and /gi," AND ")).replace(/ or /gi," OR ")).trim()},n.parseExpression=function(e,t,a){var r;if(e.includes("!=")?r="!=":e.includes("!*=")?r="!*=":e.includes("!$=")?r="!$=":e.includes("!^=")?r="!^=":e.includes(">=")?r=">=":e.includes("<=")?r="<=":e.includes("*=")?r="*=":e.includes("$=")?r="$=":e.includes("^=")?r="^=":e.includes("=")?r="=":e.includes(">")?r=">":e.includes("<")?r="<":e.includes("!")&&(r="!"),!r){if(e.split(" ").length>1)return n.setError("No valid operator found in expression",a);var i=n.parseUnaryFindExpression(e.trim(),!1);return i||n.setError("Invalid Node or Edge operand",a)}var o=e.split(r);if("!"===r){var s=n.parseUnaryFindExpression(o[1].trim(),!0);return s||n.setError("Invalid Node or Edge operand",a)}var l=o[0].trim(),c=o[1].trim();switch(l.toLowerCase()){case"app":return{target:"node",selector:"[".concat(Fg," ").concat(r,' "').concat(c,'"]')};case"cluster":return{target:"node",selector:"[".concat(_g," ").concat(r,' "').concat(c,'"]')};case"grpcin":var u=n.getNumericSelector(Hg,r,c,e,a);return u?{target:"node",selector:u}:void 0;case"grpcout":var p=n.getNumericSelector(Ug,r,c,e,a);return p?{target:"node",selector:p}:void 0;case"httpin":var d=n.getNumericSelector(Zg,r,c,e,a);return d?{target:"node",selector:d}:void 0;case"httpout":var m=n.getNumericSelector(nv,r,c,e,a);return m?{target:"node",selector:m}:void 0;case"name":var h=r.startsWith("!");if(t)return n.setError("Can not use 'AND' with 'name' operand",a);var f="[".concat(Dg," ").concat(r,' "').concat(c,'"]'),g="[".concat(Fg," ").concat(r,' "').concat(c,'"]'),v="[".concat(fv," ").concat(r,' "').concat(c,'"]'),E="[".concat(bv," ").concat(r,' "').concat(c,'"]');return{target:"node",selector:h?"".concat(f).concat(g).concat(v).concat(E):"".concat(f,",").concat(g,",").concat(v,",").concat(E)};case"node":var b=c.toLowerCase();switch(b){case"op":case"operation":b=Ze.AGGREGATE;break;case"svc":b=Ze.SERVICE;break;case"wl":b=Ze.WORKLOAD}switch(b){case Ze.AGGREGATE:case Ze.APP:case Ze.SERVICE:case Ze.WORKLOAD:case Ze.UNKNOWN:return{target:"node",selector:"[".concat(hv," ").concat(r,' "').concat(b,'"]')};default:n.setError("Invalid node type [".concat(b,"]. Expected app | operation | service | unknown | workload"),a)}return;case"ns":case"namespace":return{target:"node",selector:"[".concat(mv," ").concat(r,' "').concat(c,'"]')};case"op":case"operation":return{target:"node",selector:"[".concat(Dg," ").concat(r,' "').concat(c,'"]')};case"svc":case"service":return{target:"node",selector:"[".concat(fv," ").concat(r,' "').concat(c,'"]')};case"tcpin":var y=n.getNumericSelector(gv,r,c,e,a);return y?{target:"node",selector:y}:void 0;case"tcpout":var C=n.getNumericSelector(vv,r,c,e,a);return C?{target:"node",selector:C}:void 0;case"version":return{target:"node",selector:"[".concat(Ev," ").concat(r,' "').concat(c,'"]')};case"wl":case"workload":return{target:"node",selector:"[".concat(bv," ").concat(r,' "').concat(c,'"]')};case"destprincipal":return n.props.showSecurity||(Gn('Enabling "security" display option for graph find/hide expression'),n.props.toggleGraphSecurity()),{target:"edge",selector:"[".concat(hg," ").concat(r,' "').concat(c,'"]')};case"grpc":var S=n.getNumericSelector(fg,r,c,e,a);return S?{target:"edge",selector:S}:void 0;case"%grpcerror":case"%grpcerr":var A=n.getNumericSelector(Eg,r,c,e,a);return A?{target:"edge",selector:A}:void 0;case"%grpctraffic":var T=n.getNumericSelector(bg,r,c,e,a);return T?{target:"edge",selector:T}:void 0;case"http":var O=n.getNumericSelector(Cg,r,c,e,a);return O?{target:"edge",selector:O}:void 0;case"%httperror":case"%httperr":var I=n.getNumericSelector(Ig,r,c,e,a);return I?{target:"edge",selector:I}:void 0;case"%httptraffic":var w=n.getNumericSelector(wg,r,c,e,a);return w?{target:"edge",selector:w}:void 0;case"protocol":return{target:"edge",selector:"[".concat(kg," ").concat(r,' "').concat(c,'"]')};case"rt":case"responsetime":n.props.edgeLabels.includes(De.RESPONSE_TIME_GROUP)||(Gn('Enabling [P95] "Response Time" edge labels for this graph find/hide expression'),n.props.setEdgeLabels([].concat(Object(mt.a)(n.props.edgeLabels),[De.RESPONSE_TIME_GROUP,De.RESPONSE_TIME_P95])));var R=n.getNumericSelector(xg,r,c,e,a);return R?{target:"edge",selector:R}:void 0;case"sourceprincipal":return n.props.showSecurity||(Gn('Enabling "security" display option for this graph find/hide expression'),n.props.toggleGraphSecurity()),{target:"edge",selector:"[".concat(Ng," ").concat(r,' "').concat(c,'"]')};case"tcp":var k=n.getNumericSelector(jg,r,c,e,a);return k?{target:"edge",selector:k}:void 0;case"throughput":n.props.edgeLabels.includes(De.THROUGHPUT_GROUP)||(Gn('Enabling [Request] "Throughput" edge labels for this graph find/hide expression'),n.props.setEdgeLabels([].concat(Object(mt.a)(n.props.edgeLabels),[De.THROUGHPUT_GROUP,De.THROUGHPUT_REQUEST])));var x=n.getNumericSelector(Pg,r,c,e,a);return x?{target:"edge",selector:x}:void 0;default:return n.setError("Invalid operand [".concat(l,"]"),a)}},n.parseUnaryFindExpression=function(e,t){switch(e.toLowerCase()){case"cb":case"circuitbreaker":return{target:"node",selector:t?"[^".concat(Bg,"]"):"[?".concat(Bg,"]")};case"dead":return{target:"node",selector:t?"[^".concat(ov,"]"):"[?".concat(ov,"]")};case"fi":case"faultinjection":return{target:"node",selector:t?"[^".concat(Wg,"]"):"[?".concat(Wg,"]")};case"inaccessible":return{target:"node",selector:t?"[^".concat(lv,"]"):"[?".concat(lv,"]")};case"healthy":return{target:"node",selector:t?"[".concat(Jg,' = "').concat(wa.name,'"],[').concat(Jg,' = "').concat(Ra.name,'"]'):"[".concat(Jg,' = "').concat(xa.name,'"]')};case"idle":return n.props.showIdleNodes||(Gn('Enabling "idle nodes" display option for graph find/hide expression'),n.props.toggleIdleNodes()),{target:"node",selector:t?"[^".concat(sv,"]"):"[?".concat(sv,"]")};case"outside":case"outsider":return{target:"node",selector:t?"[^".concat(uv,"]"):"[?".concat(uv,"]")};case"rr":case"requestrouting":return{target:"node",selector:t?"[^".concat(Kg,"]"):"[?".concat(Kg,"]")};case"rto":case"requesttimeout":return{target:"node",selector:t?"[^".concat(zg,"]"):"[?".concat(zg,"]")};case"se":case"serviceentry":return{target:"node",selector:t?"[^".concat(dv,"]"):"[?".concat(dv,"]")};case"sc":case"sidecar":return{target:"node",selector:t?"[?".concat(qg,"]"):"[^".concat(qg,"]")};case"tcpts":case"tcptrafficshifting":return{target:"node",selector:t?"[^".concat(Yg,"]"):"[?".concat(Yg,"]")};case"ts":case"trafficshifting":return{target:"node",selector:t?"[^".concat(Qg,"]"):"[?".concat(Qg,"]")};case"trafficsource":case"root":return{target:"node",selector:t?"[^".concat(pv,"]"):"[?".concat(pv,"]")};case"vs":case"virtualservice":return{target:"node",selector:t?"[^".concat(Xg,"]"):"[?".concat(Xg,"]")};case"mtls":return n.props.showSecurity||(Gn('Enabling "security" display option for graph find/hide expression'),n.props.toggleGraphSecurity()),{target:"edge",selector:"[".concat(Rg,t?" <= 0]":" > 0]")};case"traffic":return{target:"edge",selector:t?"[^".concat(yg,"]"):"[?".concat(yg,"]")};default:return}},n.appendSelector=function(e,t,a){return e?e.startsWith(t.target)?e+t.selector:n.setError("Invalid expression. Can not AND node and edge criteria.",a):t.target+t.selector};var r=e.findValue?e.findValue:"",i=e.hideValue?e.hideValue:"";return n.findAutoComplete=new vT(ST),n.hideAutoComplete=new vT(ST),n.state={findInputValue:r,hideInputValue:i},e.showFindHelp&&e.toggleFindHelp(),n}return Object(l.a)(a,[{key:"shouldComponentUpdate",value:function(e,t){var a=this.props.cy!==e.cy,n=this.props.findValue!==e.findValue,r=this.props.hideValue!==e.hideValue,i=this.props.updateTime!==e.updateTime,o=this.props.showFindHelp!==e.showFindHelp,s=this.state.findError!==t.findError,l=this.state.hideError!==t.hideError;return a||n||r||i||o||s||l}},{key:"componentDidUpdate",value:function(e){if(!this.props.cy)return this.hiddenElements=void 0,void(this.removedElements=void 0);var t=this.props.findValue!==e.findValue,a=this.props.hideValue!==e.hideValue,n=this.props.updateTime!==e.updateTime;if((t||n&&this.props.findValue)&&this.handleFind(this.props.cy),a||n&&this.props.hideValue){var r=this.props.compressOnHide!==e.compressOnHide;this.handleHide(this.props.cy,a,n,r)}}},{key:"render",value:function(){var e=this;return r.createElement(Mu,{info:Hu.Find},r.createElement(dp.a,{style:{float:"left"},isHorizontal:!0},r.createElement("span",{className:CT},r.createElement(Ae.a,{id:"graph_find",name:"graph_find",ref:function(t){e.findInputRef=t},style:Object(C.a)({},yT),type:"text",autoComplete:"on",isValid:!this.state.findError,onChange:this.updateFind,defaultValue:this.state.findInputValue,onKeyDownCapture:this.checkSpecialKeyFind,placeholder:"Find..."}),r.createElement(bT,{kind:"find",onSelect:this.updateFindOption}),this.props.findValue&&r.createElement(lo.a,{key:"ot_clear_find",position:"top",content:"Clear Find..."},r.createElement(vr.a,{style:{minWidth:"20px",width:"20px",paddingLeft:"5px",paddingRight:"5px",bottom:"1px"},variant:vr.b.control,onClick:function(){return e.setFind("")}},r.createElement(fi.Close,null))),r.createElement(Ae.a,{id:"graph_hide",name:"graph_hide",ref:function(t){e.hideInputRef=t},style:Object(C.a)({},yT),autoComplete:"on",isValid:!this.state.hideError,type:"text",onChange:this.updateHide,defaultValue:this.state.hideInputValue,onKeyDownCapture:this.checkSpecialKeyHide,placeholder:"Hide..."}),r.createElement(bT,{kind:"hide",onSelect:this.updateHideOption}),this.props.hideValue&&r.createElement(lo.a,{key:"ot_clear_hide",position:"top",content:"Clear Hide..."},r.createElement(vr.a,{style:{minWidth:"20px",width:"20px",paddingLeft:"5px",paddingRight:"5px",bottom:"1px"},variant:vr.b.control,onClick:function(){return e.setHide("")}},r.createElement(fi.Close,null))),this.props.showFindHelp?r.createElement(gT,{onClose:this.toggleFindHelp},r.createElement(vr.a,{variant:vr.b.link,style:{paddingLeft:"6px"},onClick:this.toggleFindHelp},r.createElement(fi.Info,{className:mi}))):r.createElement(lo.a,{key:"ot_graph_find_help",position:"top",content:"Find/Hide Help..."},r.createElement(vr.a,{variant:vr.b.link,style:{paddingLeft:"6px"},onClick:this.toggleFindHelp},r.createElement(fi.Info,{className:mi}))),this.state.findError&&r.createElement("div",{style:{color:"red"}},this.state.findError),this.state.hideError&&r.createElement("div",{style:{color:"red"}},this.state.hideError))))}},{key:"setError",value:function(e,t){if(t&&e!==this.state.findError){var a=e?"Find: ".concat(e):void 0;this.setState({findError:a})}else if(e!==this.state.hideError){var n=e?"Hide: ".concat(e):void 0;this.setState({hideError:n})}}},{key:"getNumericSelector",value:function(e,t,a,n,r){switch(t){case">":case"<":case">=":case"<=":return isNaN(a)?this.setError("Invalid value [".concat(a,"]. Expected a numeric value (use '.' for decimals)"),r):"[".concat(e," ").concat(t," ").concat(a,"]");case"=":return isNaN(a)?"[!".concat(e,"]"):"[".concat(e," ").concat(t," ").concat(a,"]");case"!=":return isNaN(a)?"[?".concat(e,"]"):"[".concat(e," ").concat(t," ").concat(a,"]");default:return this.setError("Invalid operator [".concat(t,"] for numeric condition"),r)}}}]),a}(r.Component);AT.contextTypes={router:function(){return null}};var TT=Object(h.b)((function(e){return{compressOnHide:e.graph.toolbarState.compressOnHide,edgeLabels:El(e),findValue:bl(e),hideValue:Cl(e),layout:e.graph.layout,showFindHelp:e.graph.toolbarState.showFindHelp,showIdleNodes:e.graph.toolbarState.showIdleNodes,showSecurity:e.graph.toolbarState.showSecurity,updateTime:e.graph.updateTime}}),(function(e){return{setEdgeLabels:Object(Ie.b)(st.setEdgeLabels,e),setFindValue:Object(Ie.b)(st.setFindValue,e),setHideValue:Object(Ie.b)(st.setHideValue,e),toggleFindHelp:Object(Ie.b)(st.toggleFindHelp,e),toggleGraphSecurity:Object(Ie.b)(st.toggleGraphSecurity,e),toggleIdleNodes:Object(Ie.b)(st.toggleIdleNodes,e)}}))(AT),OT=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;Object(s.a)(this,a),(n=t.call(this,e)).onToggle=function(e){n.setState({isOpen:e})},n.toggleEdgeLabelMode=function(e,t){var a=t.target.value;if(n.props.edgeLabels.includes(a)){var r;switch(a){case De.RESPONSE_TIME_GROUP:r=n.props.edgeLabels.filter((function(e){return!Ye(e)}));break;case De.THROUGHPUT_GROUP:r=n.props.edgeLabels.filter((function(e){return!Qe(e)}));break;default:r=n.props.edgeLabels.filter((function(e){return e!==a}))}n.props.setEdgeLabels(r)}else switch(a){case De.RESPONSE_TIME_GROUP:n.props.setEdgeLabels([].concat(Object(mt.a)(n.props.edgeLabels),[a,De.RESPONSE_TIME_P95]));break;case De.THROUGHPUT_GROUP:n.props.setEdgeLabels([].concat(Object(mt.a)(n.props.edgeLabels),[a,De.THROUGHPUT_REQUEST]));break;default:n.props.setEdgeLabels([].concat(Object(mt.a)(n.props.edgeLabels),[a]))}},n.toggleEdgeLabelResponseTimeMode=function(e,t){var a=t.target.value,r=n.props.edgeLabels.filter((function(e){return!Ye(e)}));n.props.setEdgeLabels([].concat(Object(mt.a)(r),[De.RESPONSE_TIME_GROUP,a]))},n.toggleEdgeLabelThroughputMode=function(e,t){var a=t.target.value,r=n.props.edgeLabels.filter((function(e){return!Qe(e)}));n.props.setEdgeLabels([].concat(Object(mt.a)(r),[De.THROUGHPUT_GROUP,a]))},n.state={isOpen:!1};var r=q.getBooleanParam(P.OPERATION_NODES);void 0!==r?r!==e.showOperationNodes&&e.toggleOperationNodes():q.setParam(P.OPERATION_NODES,String(n.props.showOperationNodes));var i=q.getBooleanParam(P.GRAPH_IDLE_EDGES);void 0!==i?i!==e.showIdleEdges&&e.toggleIdleEdges():q.setParam(P.GRAPH_IDLE_EDGES,String(n.props.showIdleEdges));var o=q.getBooleanParam(P.GRAPH_SERVICE_NODES);return void 0!==o?o!==e.showServiceNodes&&e.toggleServiceNodes():q.setParam(P.GRAPH_SERVICE_NODES,String(n.props.showServiceNodes)),n}return Object(l.a)(a,[{key:"componentDidUpdate",value:function(e){q.setParam(P.GRAPH_IDLE_EDGES,String(this.props.showIdleEdges)),q.setParam(P.OPERATION_NODES,String(this.props.showOperationNodes)),q.setParam(P.GRAPH_SERVICE_NODES,String(this.props.showServiceNodes))}},{key:"render",value:function(){return r.createElement(Ru.a,{toggle:r.createElement(ku.a,{id:"display-settings",onToggle:this.onToggle},"Display"),isOpen:this.state.isOpen},this.getPopoverContent())}},{key:"getPopoverContent",value:function(){var e=this,t=this.props,a=t.boxByCluster,n=t.boxByNamespace,i=t.compressOnHide,o=t.edgeLabels,s=t.showIdleEdges,l=t.showIdleNodes,c=t.showMissingSidecars,u=t.showOperationNodes,p=t.showSecurity,d=t.showServiceNodes,m=t.showTrafficAnimation,h=t.showVirtualServices,f=this.props,g=f.toggleBoxByCluster,v=f.toggleBoxByNamespace,E=f.toggleCompressOnHide,b=f.toggleGraphMissingSidecars,y=f.toggleGraphSecurity,C=f.toggleGraphVirtualServices,A=f.toggleIdleEdges,T=f.toggleIdleNodes,O=f.toggleOperationNodes,I=f.toggleServiceNodes,w=f.toggleTrafficAnimation,R=[{id:De.RESPONSE_TIME_GROUP,labelText:S.startCase(De.RESPONSE_TIME_GROUP),isChecked:o.includes(De.RESPONSE_TIME_GROUP),tooltip:r.createElement("div",{style:{textAlign:"left"}},r.createElement("div",null,"Displays the requested response time. The unit is milliseconds (ms) when less than 1000, otherwise seconds (s). Default: 95th Percentile."),r.createElement("div",null,"Response times only apply to request-based traffic (not TCP or gRPC messaging). Additionally, the following edges do not offer a response time label but the information is available in the side panel when selecting the edge:"),r.createElement("div",null,"- edges into service nodes"),r.createElement("div",null,"- edges into or out of operation nodes."))},{id:De.THROUGHPUT_GROUP,labelText:S.startCase(De.THROUGHPUT_GROUP),isChecked:o.includes(De.THROUGHPUT_GROUP),tooltip:r.createElement("div",{style:{textAlign:"left"}},r.createElement("div",null,"Displays the requested HTTP Throughput. The unit is bytes-per-second (bps) when less than 1024, otherwise kilobytes-per-second (kps). Default: Request Throughput"),r.createElement("div",null,"Throughput applies only to request-based, HTTP traffic. Additionally, the following edges do not offer a throughput label:"),r.createElement("div",null,"- edges into service nodes"),r.createElement("div",null,"- edges into or out of operation nodes."))},{id:De.TRAFFIC_DISTRIBUTION,labelText:S.startCase(De.TRAFFIC_DISTRIBUTION),isChecked:o.includes(De.TRAFFIC_DISTRIBUTION),tooltip:r.createElement("div",{style:{textAlign:"left"}},"HTTP and gRPC Edges display the percentage of traffic for that edge, when less than 100%. For a source node, the sum for outbound edges (per protocol) should be equal to or near 100%, given rounding. TCP edges are not included in the distribution because their rates reflect bytes.")},{id:De.TRAFFIC_RATE,labelText:S.startCase(De.TRAFFIC_RATE),isChecked:o.includes(De.TRAFFIC_RATE),tooltip:r.createElement("div",{style:{textAlign:"left"}},"HTTP rates are in requests-per-second (rps). gRPC rates may be in requests-per-second (rps) or messages-per-second (mps). For request rates, the percentage of error responses is shown below the rate, when non-zero. TCP rates are in bytes. The unit is bytes-per-second (bps) when less than 1024, otherwise kilobytes-per-second (kps). Rates are rounded to 2 significant digits.")}],k=[{id:De.THROUGHPUT_REQUEST,labelText:"Request",isChecked:o.includes(De.THROUGHPUT_REQUEST),tooltip:r.createElement("div",{style:{textAlign:"left"}},"HTTP request data in bytes-per-second (bps) or kilobytes-per-second (kps)")},{id:De.THROUGHPUT_RESPONSE,labelText:"Response",isChecked:o.includes(De.THROUGHPUT_RESPONSE),tooltip:r.createElement("div",{style:{textAlign:"left"}},"HTTP response data in bytes per second (bps) or kilobytes-per-second (kps)")}],x=[{id:De.RESPONSE_TIME_AVERAGE,labelText:"Average",isChecked:o.includes(De.RESPONSE_TIME_AVERAGE),tooltip:r.createElement("div",{style:{textAlign:"left"}},"Average request response time")},{id:De.RESPONSE_TIME_P50,labelText:"Median",isChecked:o.includes(De.RESPONSE_TIME_P50),tooltip:r.createElement("div",{style:{textAlign:"left"}},"Median request response time (50th Percentile)")},{id:De.RESPONSE_TIME_P95,labelText:"95th Percentile",isChecked:o.includes(De.RESPONSE_TIME_P95),tooltip:r.createElement("div",{style:{textAlign:"left"}},"Max response time for 95% of requests (95th Percentile)")},{id:De.RESPONSE_TIME_P99,labelText:"99th Percentile",isChecked:o.includes(De.RESPONSE_TIME_P99),tooltip:r.createElement("div",{style:{textAlign:"left"}},"Max response time for 99% of requests (99th Percentile)")}],N=[{id:"boxByCluster",labelText:"Cluster Boxes",isChecked:a,onChange:g,tooltip:r.createElement("div",{style:{textAlign:"left"}},"When enabled the graph will box nodes in the same cluster.")},{id:"boxByNamespace",labelText:"Namespace Boxes",isChecked:n,onChange:v,tooltip:r.createElement("div",{style:{textAlign:"left"}},"When enabled the graph will box nodes in the same namespace, within the same cluster.")},{id:"filterHide",labelText:"Compressed Hide",isChecked:i,onChange:E,tooltip:r.createElement("div",{style:{textAlign:"left"}},"Compress the graph after graph-hide removes matching elements. Otherwise the graph maintains the space consumed by the hidden elements.")},{id:"filterIdleEdges",labelText:"Idle Edges",isChecked:s,onChange:A,tooltip:r.createElement("div",{style:{textAlign:"left"}},"Idle edges have no request traffic for the time period. Disabled by default to provide cleaner graphs. Enable to help detect unexpected traffic omissions, or to confirm expected edges with no traffic (due to routing, mirroring, etc).")},{id:"filterIdleNodes",labelText:"Idle Nodes",isChecked:l,onChange:T,tooltip:r.createElement("div",{style:{textAlign:"left"}},'With "Idle Edges" enabled this displays nodes for defined services that have *never* received traffic. With "Idle Edges" disabled this displays nodes for defined services that have not received traffic during the current time period. Disabled by default to provide cleaner graphs. Enable to help locate unused, misconfigured or obsolete services.')},{id:"filterOperationNodes",disabled:this.props.graphType===Xe.SERVICE,labelText:"Operation Nodes",isChecked:u,onChange:O,tooltip:r.createElement("div",{style:{textAlign:"left"}},r.createElement("div",null,"When both operation and service nodes are enabled then the operation is displayed specific to each service to which it applies, and therefore may be duplicated for different services. When enabled independently each operation will have a single node representing the total traffic for that operation."),r.createElement("div",null,"- Operations with no traffic are ignored."),r.createElement("div",null,"- This is not applicable to Service graphs."),r.createElement("div",null,'- Operation nodes require additional "Request Classification" Istio configuration for workloads in the selected namespaces.'))},{id:"filterServiceNodes",disabled:this.props.graphType===Xe.SERVICE,labelText:"Service Nodes",isChecked:d,onChange:I,tooltip:r.createElement("div",{style:{textAlign:"left"}},"Reflect service routing by injecting the destination service nodes into the graph. This can be useful for grouping requests for the same service, but routed to different workloads. Edges leading into service nodes are logical aggregations and will not show response time labels, but if selected the side panel will provide a response time chart.")},{id:"filterTrafficAnimation",labelText:"Traffic Animation",isChecked:m,onChange:w,tooltip:r.createElement("div",{style:{textAlign:"left"}},"Animate the graph to reflect traffic flow. The particle density and speed roughly reflects an edge's request load relevant to the other edges. Animation can be CPU intensive.")}],j=[{id:"filterSidecars",labelText:"Missing Sidecars",isChecked:c,onChange:b},{id:"filterSecurity",labelText:"Security",isChecked:p,onChange:y,tooltip:r.createElement("div",{style:{textAlign:"left"}},r.createElement("div",null,"Show closed or open lock icons on edges with traffic that differs from the global mTLS policy. The percentage of mTLS traffic can be seen in the side-panel when selecting the edge. Note that the global masthead will show a lock icon when global mTLS is enabled. The side-panel will also display source and destination principals, if available. mTLS status is not offered for gRPC-message traffic."))},{id:"filterVS",labelText:"Virtual Services",isChecked:h,onChange:C,tooltip:r.createElement("div",{style:{textAlign:"left"}},r.createElement("div",null,"Show virtual service related icons. Additional icons are displayed if a circuit breaker is present on the virtual service or if the virtual service was created through one of the Kiali service wizards."))}];return r.createElement(ju,{className:LS,maxHeight:{type:Oc.VIEWPORT_HEIGHT_MINUS_TOP,margin:20}},r.createElement("div",{id:"graph-display-menu",className:DS,style:{width:"15em"}},r.createElement("div",{style:{marginTop:"10px"}},r.createElement("span",{className:_S,style:{position:"relative",bottom:"3px",paddingRight:0}},"Show Edge Labels"),r.createElement(lo.a,{key:"tooltip_show_edge_labels",position:lo.b.right,content:r.createElement("div",{style:{textAlign:"left"}},r.createElement("div",null,"Values for multiple label selections are stacked in the same order as the options below. Hover or selection will always show units, an additionally show protocol."))},r.createElement(fi.Info,{className:VS}))),R.map((function(t){return r.createElement("div",{key:t.id,className:FS},r.createElement("label",{key:t.id,className:t.tooltip?GS:HS},r.createElement(PS.a,{id:t.id,name:"edgeLabelOptions",isChecked:t.isChecked,label:t.labelText,onChange:e.toggleEdgeLabelMode,value:t.id})),!!t.tooltip&&r.createElement(lo.a,{key:"tooltip_".concat(t.id),position:lo.b.right,content:t.tooltip},r.createElement(fi.Info,{className:VS})),t.id===De.RESPONSE_TIME_GROUP&&x.some((function(e){return e.isChecked}))&&r.createElement("div",null,x.map((function(t){return r.createElement("div",{key:t.id,className:FS},r.createElement("label",{key:t.id,className:t.tooltip?GS:HS,style:{paddingLeft:"35px"}},r.createElement(qp.a,{id:t.id,style:{paddingLeft:"5px"},name:"rtOptions",isChecked:t.isChecked,label:t.labelText,onChange:e.toggleEdgeLabelResponseTimeMode,value:t.id})),!!t.tooltip&&r.createElement(lo.a,{key:"tooltip_".concat(t.id),position:lo.b.right,content:t.tooltip},r.createElement(fi.Info,{className:VS})))}))),t.id===De.THROUGHPUT_GROUP&&k.some((function(e){return e.isChecked}))&&r.createElement("div",null,k.map((function(t){return r.createElement("div",{key:t.id,className:FS},r.createElement("label",{key:t.id,className:t.tooltip?GS:HS,style:{paddingLeft:"35px"}},r.createElement(qp.a,{id:t.id,style:{paddingLeft:"5px"},name:"throughputOptions",isChecked:t.isChecked,label:t.labelText,onChange:e.toggleEdgeLabelThroughputMode,value:t.id})),!!t.tooltip&&r.createElement(lo.a,{key:"tooltip_".concat(t.id),position:lo.b.right,content:t.tooltip},r.createElement(fi.Info,{className:VS})))}))))})),r.createElement("div",{className:_S},"Show"),N.map((function(e){return r.createElement("div",{key:e.id,style:{display:"inline-block"}},r.createElement("label",{key:e.id,className:e.tooltip?GS:HS},r.createElement(PS.a,{id:e.id,isChecked:e.isChecked,label:e.labelText,onChange:e.onChange,isDisabled:e.disabled})),!!e.tooltip&&r.createElement(lo.a,{key:"tooltip_".concat(e.id),position:lo.b.right,content:e.tooltip},r.createElement(fi.Info,{className:VS})))})),r.createElement("div",{className:_S},"Show Badges"),j.map((function(e){return r.createElement("div",{key:e.id,style:{display:"inline-block"}},r.createElement("label",{key:e.id,className:e.tooltip?GS:HS},r.createElement(PS.a,{id:e.id,isChecked:e.isChecked,label:e.labelText,onChange:e.onChange})),!!e.tooltip&&r.createElement(lo.a,{key:"tooltip_".concat(e.id),position:lo.b.right,content:e.tooltip},r.createElement(fi.Info,{className:VS})))}))))}}]),a}(r.PureComponent),IT=Object(h.b)((function(e){return{boxByCluster:e.graph.toolbarState.boxByCluster,boxByNamespace:e.graph.toolbarState.boxByNamespace,compressOnHide:e.graph.toolbarState.compressOnHide,edgeLabels:El(e),showIdleEdges:e.graph.toolbarState.showIdleEdges,showIdleNodes:e.graph.toolbarState.showIdleNodes,showMissingSidecars:e.graph.toolbarState.showMissingSidecars,showOperationNodes:e.graph.toolbarState.showOperationNodes,showSecurity:e.graph.toolbarState.showSecurity,showServiceNodes:e.graph.toolbarState.showServiceNodes,showTrafficAnimation:e.graph.toolbarState.showTrafficAnimation,showVirtualServices:e.graph.toolbarState.showVirtualServices}}),(function(e){return{setEdgeLabels:Object(Ie.b)(st.setEdgeLabels,e),toggleBoxByCluster:Object(Ie.b)(st.toggleBoxByCluster,e),toggleBoxByNamespace:Object(Ie.b)(st.toggleBoxByNamespace,e),toggleCompressOnHide:Object(Ie.b)(st.toggleCompressOnHide,e),toggleGraphMissingSidecars:Object(Ie.b)(st.toggleGraphMissingSidecars,e),toggleGraphSecurity:Object(Ie.b)(st.toggleGraphSecurity,e),toggleGraphVirtualServices:Object(Ie.b)(st.toggleGraphVirtualServices,e),toggleIdleEdges:Object(Ie.b)(st.toggleIdleEdges,e),toggleIdleNodes:Object(Ie.b)(st.toggleIdleNodes,e),toggleOperationNodes:Object(Ie.b)(st.toggleOperationNodes,e),toggleServiceNodes:Object(Ie.b)(st.toggleServiceNodes,e),toggleTrafficAnimation:Object(Ie.b)(st.toggleTrafficAnimation,e)}}))(OT),wT=function(e){return e.map((function(e){return e.name})).join(",")},RT=a(808),kT=a.n(RT),xT="horizontal",NT=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).slider=void 0,e.sliderDiv=void 0,e}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.slider=new kT.a(this.sliderDiv,Object(C.a)({},this.props));this.slider.on("slide",(function(t){t=t>=e.props.max?e.props.max:t,e.props.onSlide(t),e.slider.setValue(t)})),this.slider.on("slideStop",(function(t){t=A.a.min([t,e.props.max]),e.props.onSlideStop(t),e.slider.setValue(t)})),this.slider.setAttribute("min",this.props.min),this.slider.setAttribute("max",this.props.maxLimit),this.props.locked?this.slider.disable():this.slider.enable()}},{key:"componentDidUpdate",value:function(e){var t=this;if(this.props.min!==e.min||this.props.max!==e.max||this.props.maxLimit!==e.maxLimit||this.props.locked!==e.locked){this.slider.setAttribute("min",this.props.min),this.slider.setAttribute("max",this.props.maxLimit),this.slider.refresh();this.slider.on("slide",(function(e){e=e>=t.props.max?t.props.max:e,t.props.onSlide(e),t.slider.setValue(e)})),this.slider.on("slideStop",(function(e){e=A.a.min([e,t.props.max]),t.props.onSlideStop(e),t.slider.setValue(e)})),this.slider.setAttribute("formatter",this.props.formatter),this.props.locked?this.slider.disable():this.slider.enable()}this.slider.setValue(this.props.value),this.props&&this.props.orientation===xT?(this.slider.tooltip.style.marginLeft="-".concat(this.slider.tooltip.offsetWidth/2,"px"),this.props.ticks_labels&&this.slider.tickLabelContainer&&(this.slider.tickLabelContainer.style.marginTop="0px")):this.slider.tooltip.style.marginTop="-".concat(this.slider.tooltip.offsetHeight/2,"px")}},{key:"render",value:function(){var e=this;return i.a.createElement("input",{className:"slider-pf",type:"range",ref:function(t){e.sliderDiv=t}})}}]),a}(i.a.Component);NT.defaultProps={formatter:function(e){return e},onSlide:function(e){return e},orientation:"horizontal",ticks:[],ticks_labels:[],locked:!1};var jT=NT,PT=a(1509),LT=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props,t=e.children,a=e.min,n=e.max,r=e.reversed,o=e.showBoundaries,s=e.slider,l=i.a.createElement("b",null,a),c=i.a.createElement("b",null,n),u=null,p=null;return o&&(r?(u=c,p=l):(u=l,p=c)),i.a.createElement("div",{className:this.props.mirrored?"slider-pf-mirrored":"slider-pf"},u,s,p,t)}}]),a}(i.a.Component);LT.defaultProps={min:0,max:100,reversed:!1,showBoundaries:!1};var DT=LT,FT=a(1505),_T=a(1506),MT=a(1507),HT=a(1508),GT=(a(1308),Function.prototype),VT=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).onSlide=function(e){n.setState({value:e},(function(){return n.props.onSlide(e)}))},n.onSlideStop=function(e){n.setState({value:e},(function(){return n.props.onSlideStop(e)}))},n.onPlus=function(){var e=Number(n.state.value||0);n.updateNewValue(e+1)},n.onMinus=function(){var e=Number(n.state.value||0);n.updateNewValue(e-1)},n.onInputChange=function(e){var t=Number(e);n.updateNewValue(Number.isNaN(t)?0:t)},n.updateNewValue=function(e){e>n.props.max&&(e=n.props.max),e<0&&(e=0),n.setState({value:e},(function(){return n.props.onSlide(e)}))},n.onFormatChange=function(e){n.setState({tooltipFormat:e})},n.formatter=function(e){return n.props.tooltipFormatter!==GT?n.props.tooltipFormatter(e):"".concat(e," ").concat(n.state.tooltipFormat," ").concat(n.props.mirrored?" mirrored traffic":"")},n.state={value:n.props.value,tooltipFormat:n.props.inputFormat},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.setState({})}},{key:"componentDidUpdate",value:function(e){e.value===this.props.value&&this.state.value===this.props.value||this.setState({value:this.props.value})}},{key:"render",value:function(){var e=this,t=i.a.createElement(jT,Object.assign({},this.props,{formatter:this.formatter,value:this.state.value,onSlide:this.onSlide,onSlideStop:this.onSlideStop})),a=Object(Jn.a)({width:"20px",paddingLeft:0,paddingRight:0,marginLeft:0,marginRight:5}),n=Object(Jn.a)({width:"3em",textAlign:"center",marginLeft:0,marginRight:0}),r=Object(Jn.a)({width:"20px",paddingLeft:0,paddingRight:0,marginLeft:5,marginRight:5}),o=Object(Jn.a)({paddingLeft:8,paddingRight:8}),s=i.a.createElement(lo.a,{position:lo.b.top,content:i.a.createElement(i.a.Fragment,null,this.props.locked?"Unlock":"Lock"," Weight for this Workload")},i.a.createElement(vr.a,{className:o,isDisabled:this.props.mirrored,variant:this.props.locked?vr.b.primary:vr.b.secondary,onClick:function(){return e.props.onLock(!e.props.locked)}},i.a.createElement(FT.a,null))),l=i.a.createElement(lo.a,{position:lo.b.top,content:i.a.createElement(i.a.Fragment,null,"Mirror % traffic to this Workload")},i.a.createElement(vr.a,{className:o,variant:this.props.mirrored?vr.b.primary:vr.b.secondary,onClick:function(){return e.props.onMirror(!e.props.mirrored)}},i.a.createElement(_T.a,null)));return i.a.createElement(i.a.Fragment,null,i.a.createElement(DT,Object.assign({slider:t},this.props),this.props.input&&i.a.createElement(i.a.Fragment,null,i.a.createElement(vr.a,{className:a,variant:"link",isDisabled:this.props.locked,onClick:function(){return e.onMinus()}},i.a.createElement(MT.a,null)),i.a.createElement(Ae.a,{className:n,id:"slider-text","aria-label":"slider-text",value:this.state.value,onChange:this.onInputChange,isDisabled:this.props.locked}),i.a.createElement(vr.a,{className:r,variant:"link",isDisabled:this.props.locked,onClick:function(){return e.onPlus()}},i.a.createElement(HT.a,null)),i.a.createElement(PT.a,null,this.props.inputFormat)),this.props.showMirror?l:i.a.createElement(i.a.Fragment,null),this.props.showLock?s:i.a.createElement(i.a.Fragment,null)))}}]),a}(i.a.Component);VT.defaultProps={id:null,orientation:"horizontal",min:0,max:100,maxLimit:100,value:0,step:1,ticks:[],ticks_labels:[],toolTip:!1,tooltipFormatter:GT,onSlide:GT,onSlideStop:GT,label:null,labelClass:null,input:!1,sliderClass:null,inputFormat:"",locked:!1,showLock:!0,onLock:GT,showMirror:!0,onMirror:GT};var UT=VT,BT=Object(Jn.a)({borderLeft:"solid 5px ".concat(nt.Replay)}),WT={6e4:"1 minute",3e5:"5 minutes",6e5:"10 minutes",18e5:"30 minutes"},qT=A.a.mapValues(WT,(function(e){return"Last ".concat(e)})),KT=[{speed:5e3,text:"slow"},{speed:3e3,text:"medium"},{speed:1e3,text:"fast"}],zT=Object(Jn.a)({display:"flex",margin:"5px 0 0 15px"}),YT=Object(Jn.a)({margin:"-5px -5px 0 33%",height:"37px"}),QT=Object(Jn.a)({fontSize:"1.5em"}),XT=Object(Jn.a)({margin:"2px 20px 0 0"}),JT=Object(Jn.a)({height:"36px"}),ZT=Object(Jn.a)({color:nt.Active}),$T=Object(Jn.a)({display:"flex",width:"100%",padding:"5px 5px 0 10px",marginTop:"-5px"}),eO=Object(Jn.a)({width:"100%",margin:"0 -10px 0 20px"}),tO=Object(Jn.a)({height:"1.5em",margin:"1px 5px 0 5px",padding:"0 2px 2px 2px"}),aO=Object(Jn.a)({color:nt.ActiveText,fontWeight:"bolder"}),nO=Object(Jn.a)({border:"1px inset",height:"20px",marginTop:"4px",width:"1px"}),rO=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).pickerTime=0,n.formatTooltip=function(e){var t=If(a.frameToQueryTime(e,n.props),{second:"2-digit"});return"".concat(t," [").concat(e,"/").concat(n.state.replayFrameCount,"]")},n.formatFrame=function(e){var t=1e4*e,a=Math.floor(t/1e3%60),n=Math.floor((t/1e3-a)/60),r=a<10?"0":"";return"".concat(n<10?"0":"").concat(n,":").concat(r).concat(a)},n.toggleCustomStartTime=function(){n.setState({isCustomStartTime:!n.state.isCustomStartTime})},n.onPickerChange=function(e){n.pickerTime=e.getTime()},n.onPickerClose=function(){n.pickerTime!==n.props.replayWindow.startTime&&n.setReplayStartTime(n.pickerTime)},n.onPickerOpen=function(){n.pickerTime=n.props.replayWindow.startTime},n.initReplay=function(){var e=n.props.replayWindow.interval?n.props.replayWindow.interval:3e5,t=n.state.isCustomStartTime?(new Date).setSeconds(0,0)-e:(new Date).getTime()-e;n.setState({status:"init"}),n.setReplayWindow({interval:e,startTime:t})},n.setReplayStartTime=function(e){n.setReplayWindow({interval:n.props.replayWindow.interval,startTime:e})},n.setReplayInterval=function(e){var t=n.state.isCustomStartTime?n.props.replayWindow.startTime:Date.now()-e;n.setReplayWindow({interval:e,startTime:t})},n.setReplayWindow=function(e){var t=a.getFrameCount(e.interval);n.setState({replayFrame:0,replayFrameCount:t}),n.props.setReplayWindow(e)},n.setReplaySpeed=function(e){n.setState({replaySpeed:e})},n.done=function(){n.setState({status:"done"})},n.pause=function(){n.setState({status:"paused"})},n.play=function(){var e=n.state.replayFrame>=n.state.replayFrameCount;n.setState({replayFrame:e?0:n.state.replayFrame,status:"playing"})},n.setReplayFrame=function(e){if(e!==n.state.replayFrame){var t="init"===n.state.status?"init":"paused";t=e===n.state.replayFrameCount?"done":t,n.setState({replayFrame:e,status:t})}},n.updateRefresher=function(){if(n.state.refresherRef&&clearInterval(n.state.refresherRef),"playing"===n.state.status&&n.props.replayWindow.interval){var e;e=window.setInterval(n.handleRefresh,n.state.replaySpeed),n.setState({refresherRef:e})}},n.handleRefresh=function(){var e=n.state.replayFrame+1;e>n.state.replayFrameCount?n.done():(n.setState({replayFrame:e}),n.props.setReplayQueryTime(a.frameToQueryTime(e,n.props)))},n.speedButton=function(e,t){var a=n.state.replaySpeed===e.speed;return r.createElement(r.Fragment,null,r.createElement(vr.a,{key:"speed-".concat(e.text),className:tO,variant:vr.b.plain,isActive:a,onClick:function(){return n.setReplaySpeed(e.speed)}},r.createElement(Ro.a,{className:a?aO:void 0},e.text)),!t&&r.createElement("div",{className:nO}))},n.state={isCustomStartTime:!1,refresherRef:void 0,replayFrame:a.queryTimeToFrame(e),replayFrameCount:a.getFrameCount(e.replayWindow.interval),replaySpeed:3e3,status:"init"},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.props.replayWindow.startTime||this.initReplay()}},{key:"componentDidUpdate",value:function(e,t){var n=this.state.isCustomStartTime!==t.isCustomStartTime,r=this.props.replayWindow.interval!==e.replayWindow.interval;if(n||r)this.initReplay();else{var i=this.state.status!==t.status;if((i=i||this.state.replaySpeed!==t.replaySpeed)&&this.updateRefresher(),"init"!==this.state.status){var o=a.frameToQueryTime(this.state.replayFrame,this.props);o!==this.props.replayQueryTime&&this.props.setReplayQueryTime(o)}}}},{key:"componentWillUnmount",value:function(){this.state.refresherRef&&clearInterval(this.state.refresherRef)}},{key:"render",value:function(){var e=this;if(!this.props.replayWindow.startTime)return null;var t=new Date(this.props.replayWindow.startTime),a=t.getTime()+this.props.replayWindow.interval,n=If(a,{month:void 0,day:void 0,second:"2-digit"}),i=Array.from(Array(this.state.replayFrameCount).keys()),o=Date.now(),s=new Date(o-this.props.replayWindow.interval),l=new Date(o-(1e3*j.prometheus.storageTsdbRetention+this.props.replayWindow.interval));return r.createElement("div",{className:"".concat($T," ").concat(BT)},this.state.isCustomStartTime&&r.createElement(lo.a,{content:"Replay start time"},r.createElement(nA,{injectTimes:[s],maxDate:s,maxTime:s,minDate:l,minTime:l,onCalendarClose:function(){return e.onPickerClose()},onCalendarOpen:function(){return e.onPickerOpen()},onChange:function(t){return e.onPickerChange(t)},selected:t})),r.createElement(pl,{id:"replay-interval",handleSelect:function(t){return e.setReplayInterval(Number(t))},value:String(this.props.replayWindow.interval),label:WT[this.props.replayWindow.interval],options:this.state.isCustomStartTime?WT:qT,tooltip:"Replay length"}),r.createElement(lo.a,{key:"toggle-is-custom",position:"top",content:"Set ".concat(this.state.isCustomStartTime?"simple":"custom"," start time")},r.createElement(vr.a,{className:JT,variant:vr.b.control,onClick:this.toggleCustomStartTime},r.createElement(fi.UserClock,{className:this.state.isCustomStartTime?"".concat(mi," ").concat(ZT):mi}))),r.createElement("span",{className:eO},r.createElement("div",{id:"replay-slider-div"},r.createElement(UT,{key:n,id:"replay-slider",orientation:"horizontal",min:0,max:this.state.replayFrameCount,maxLimit:this.state.replayFrameCount,step:1,value:this.state.replayFrame,ticks:i,tooltip:!0,tooltipFormatter:this.formatTooltip,onSlideStop:this.setReplayFrame,input:!1,locked:!1,showLock:!1,mirrored:!1,showMirror:!1})),r.createElement("span",{className:zT},"playing"===this.state.status?r.createElement(lo.a,{key:"replay-pause",position:"top",content:"Pause",entryDelay:1e3},r.createElement(vr.a,{className:YT,variant:vr.b.link,onClick:this.pause},r.createElement(fi.PauseCircle,{className:QT}))):r.createElement(lo.a,{key:"replay-play",position:"top",content:"done"===this.state.status?"Play again":"Play",entryDelay:1e3},r.createElement(vr.a,{className:YT,variant:vr.b.link,onClick:this.play},r.createElement(fi.PlayCircle,{className:QT}))),r.createElement(Ro.a,{className:XT},this.formatFrame(this.state.replayFrame)),KT.map((function(t,a,n){return e.speedButton(t,a===n.length-1)})))))}}]),a}(r.PureComponent);rO.getFrameCount=function(e){return e>0?Math.floor(e/1e4):0},rO.queryTimeToFrame=function(e){var t=e.replayQueryTime-e.replayWindow.startTime;return rO.getFrameCount(t)},rO.frameToQueryTime=function(e,t){return t.replayWindow.startTime+1e4*e};var iO=Object(h.b)((function(e){return{duration:fl(e),replayQueryTime:Il(e),replayWindow:Ol(e)}}),(function(e){return{setReplayQueryTime:Object(Ie.b)(vt.setReplayQueryTime,e),setReplayWindow:Object(Ie.b)(vt.setReplayWindow,e),toggleReplayActive:Object(Ie.b)(vt.toggleReplayActive,e)}}))(rO),oO=Object(Jn.a)({margin:"10px 20px 0 0"}),sO=Object(Jn.a)({position:"sticky",zIndex:10,marginLeft:0,marginRight:0}),lO=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=Object(Jn.a)({height:"42px"});return this.props.title&&(e=Object(Jn.a)({height:"unset"})),i.a.createElement("div",{id:"global-namespace-selector",className:"container-fluid ".concat(sO," ").concat(e)},i.a.createElement("div",{className:oO},this.props.children))}}]),a}(i.a.Component),cO=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).onToggle=function(e){n.setState({isOpen:e})},n.toggleTrafficRate=function(e,t){var a=t.target.value;if(n.props.trafficRates.includes(a)){var r;switch(a){case ze.GRPC_GROUP:r=n.props.trafficRates.filter((function(e){return!et(e)}));break;case ze.HTTP_GROUP:r=n.props.trafficRates.filter((function(e){return!tt(e)}));break;case ze.TCP_GROUP:r=n.props.trafficRates.filter((function(e){return!at(e)}));break;default:r=n.props.trafficRates.filter((function(e){return e!==a}))}n.props.setTrafficRates(r)}else switch(a){case ze.GRPC_GROUP:n.props.setTrafficRates([].concat(Object(mt.a)(n.props.trafficRates),[a,ze.GRPC_REQUEST]));break;case ze.HTTP_GROUP:n.props.setTrafficRates([].concat(Object(mt.a)(n.props.trafficRates),[a,ze.HTTP_REQUEST]));break;case ze.TCP_GROUP:n.props.setTrafficRates([].concat(Object(mt.a)(n.props.trafficRates),[a,ze.TCP_SENT]));break;default:n.props.setTrafficRates([].concat(Object(mt.a)(n.props.trafficRates),[a]))}},n.toggleTrafficRateGrpc=function(e,t){var a=t.target.value,r=n.props.trafficRates.filter((function(e){return!et(e)}));n.props.setTrafficRates([].concat(Object(mt.a)(r),[ze.GRPC_GROUP,a]))},n.toggleTrafficRateHttp=function(e,t){var a=t.target.value,r=n.props.trafficRates.filter((function(e){return!tt(e)}));n.props.setTrafficRates([].concat(Object(mt.a)(r),[ze.HTTP_GROUP,a]))},n.toggleTrafficRateTcp=function(e,t){var a=t.target.value,r=n.props.trafficRates.filter((function(e){return!at(e)}));n.props.setTrafficRates([].concat(Object(mt.a)(r),[ze.TCP_GROUP,a]))},n.state={isOpen:!1},n}return Object(l.a)(a,[{key:"render",value:function(){return r.createElement(Ru.a,{toggle:r.createElement(ku.a,{id:"graph-traffic-dropdown",onToggle:this.onToggle},"Traffic"),disabled:this.props.disabled,isOpen:this.state.isOpen},this.getPopoverContent())}},{key:"getPopoverContent",value:function(){var e=this,t=this.props.trafficRates,a=[{id:ze.GRPC_GROUP,labelText:S.startCase(ze.GRPC_GROUP),isChecked:t.includes(ze.GRPC_GROUP),tooltip:r.createElement("div",{style:{textAlign:"left"}},'Displays active gRPC Edges for the time period, using the selected gRPC rate. To see idle gRPC Edges enable the "Idle Edges" Display menu option. Default: Requests.')},{id:ze.HTTP_GROUP,labelText:S.startCase(ze.HTTP_GROUP),isChecked:t.includes(ze.HTTP_GROUP),tooltip:r.createElement("div",{style:{textAlign:"left"}},'Displays active HTTP Edges for the time period, using the selected HTTP rate. To see idle HTTP Edges enable the "Idle Edges" Display menu option. Default: Requests.')},{id:ze.TCP_GROUP,labelText:S.startCase(ze.TCP_GROUP),isChecked:t.includes(ze.TCP_GROUP),tooltip:r.createElement("div",{style:{textAlign:"left"}},'Displays active TCP Edges for the time period, using the selected TCP rate. To see inactive TCP Edges enable the "Idle Edges" Display menu option. Default: Sent Bytes.')}],n=[{id:ze.GRPC_RECEIVED,labelText:"Received Messages",isChecked:t.includes(ze.GRPC_RECEIVED),tooltip:r.createElement("div",{style:{textAlign:"left"}},"Received (i.e. Response) message rate in messages-per-second (mps). Captures server streaming RPCs.")},{id:ze.GRPC_REQUEST,labelText:"Requests",isChecked:t.includes(ze.GRPC_REQUEST),tooltip:r.createElement("div",{style:{textAlign:"left"}},"Request message rate in requests-per-second (rps). Captures unary RPC, with status codes.")},{id:ze.GRPC_SENT,labelText:"Sent Messages",isChecked:t.includes(ze.GRPC_SENT),tooltip:r.createElement("div",{style:{textAlign:"left"}},"Sent (i.e. Request) message rate in messages-per-second (mps). Captures client streaming RPCs.")},{id:ze.GRPC_TOTAL,labelText:"Total Messages",isChecked:t.includes(ze.GRPC_TOTAL),tooltip:r.createElement("div",{style:{textAlign:"left"}},"Combined (Sent + Received) message rate in messages-per-second (mps). Captures all streaming RPCs.")}],i=[{id:ze.HTTP_REQUEST,labelText:"Requests",isChecked:t.includes(ze.HTTP_REQUEST),tooltip:r.createElement("div",{style:{textAlign:"left"}},"Request message rate in requests-per-second (rps). Captures status codes.")}],o=[{id:ze.TCP_RECEIVED,labelText:"Received Bytes",isChecked:t.includes(ze.TCP_RECEIVED),tooltip:r.createElement("div",{style:{textAlign:"left"}},"Received bytes rate in bytes-per-second (bps).")},{id:ze.TCP_SENT,labelText:"Sent Bytes",isChecked:t.includes(ze.TCP_SENT),tooltip:r.createElement("div",{style:{textAlign:"left"}},"Sent bytes rate in bytes-per-second (bps).")},{id:ze.TCP_TOTAL,labelText:"Total Bytes",isChecked:t.includes(ze.TCP_TOTAL),tooltip:r.createElement("div",{style:{textAlign:"left"}},"Combined (Sent + Received) byte rate in bytes-per-second (mps).")}];return r.createElement(ju,{className:LS,maxHeight:{type:Oc.VIEWPORT_HEIGHT_MINUS_TOP,margin:20}},r.createElement("div",{id:"graph-traffic-menu",className:DS,style:{width:"16.5em"}},a.map((function(t){return r.createElement("div",{key:t.id,className:FS},r.createElement("label",{key:t.id,className:t.tooltip?GS:HS},r.createElement(PS.a,{id:t.id,name:"trafficRateOptions",isChecked:t.isChecked,label:t.labelText,onChange:e.toggleTrafficRate,value:t.id})),!!t.tooltip&&r.createElement(lo.a,{key:"tooltip_".concat(t.id),position:lo.b.right,content:t.tooltip},r.createElement(fi.Info,{className:VS})),t.id===ze.GRPC_GROUP&&n.some((function(e){return e.isChecked}))&&r.createElement("div",null,n.map((function(t){return r.createElement("div",{key:t.id,className:FS},r.createElement("label",{key:t.id,className:t.tooltip?GS:HS,style:{paddingLeft:"35px"}},r.createElement(qp.a,{id:t.id,style:{paddingLeft:"5px"},name:"grpcOptions",isChecked:t.isChecked,label:t.labelText,onChange:e.toggleTrafficRateGrpc,value:t.id})),!!t.tooltip&&r.createElement(lo.a,{key:"tooltip_".concat(t.id),position:lo.b.right,content:t.tooltip},r.createElement(fi.Info,{className:VS})))}))),t.id===ze.HTTP_GROUP&&i.some((function(e){return e.isChecked}))&&r.createElement("div",null,i.map((function(t){return r.createElement("div",{key:t.id,className:FS},r.createElement("label",{key:t.id,className:t.tooltip?GS:HS,style:{paddingLeft:"35px"}},r.createElement(qp.a,{id:t.id,style:{paddingLeft:"5px"},name:"httpOptions",isChecked:t.isChecked,label:t.labelText,onChange:e.toggleTrafficRateHttp,value:t.id})),!!t.tooltip&&r.createElement(lo.a,{key:"tooltip_".concat(t.id),position:lo.b.right,content:t.tooltip},r.createElement(fi.Info,{className:VS})))}))),t.id===ze.TCP_GROUP&&o.some((function(e){return e.isChecked}))&&r.createElement("div",null,o.map((function(t){return r.createElement("div",{key:t.id,className:FS},r.createElement("label",{key:t.id,className:t.tooltip?GS:HS,style:{paddingLeft:"35px"}},r.createElement(qp.a,{id:t.id,style:{paddingLeft:"5px"},name:"tcpOptions",isChecked:t.isChecked,label:t.labelText,onChange:e.toggleTrafficRateTcp,value:t.id})),!!t.tooltip&&r.createElement(lo.a,{key:"tooltip_".concat(t.id),position:lo.b.right,content:t.tooltip},r.createElement(fi.Info,{className:VS})))}))))}))))}}]),a}(r.PureComponent),uO=Object(h.b)((function(e){return{trafficRates:kl(e)}}),(function(e){return{setTrafficRates:Object(Ie.b)(st.setTrafficRates,e)}}))(cO),pO=Object(Jn.a)({marginLeft:"-20px",marginRight:"-40px"}),dO=Object(Jn.a)({marginLeft:"10px"}),mO=Object(Jn.a)({border:"1px inset",height:"20px",margin:"4px 0 0 10px",width:"1px"}),hO=Object(Jn.a)({float:"right"}),fO=S.mapValues(Xe,(function(e){return"".concat(S.capitalize(S.startCase(e))," graph")})),gO=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).setGraphType=function(t){var a=Xe[t];e.props.graphType!==a&&e.props.onGraphTypeChange(a)},e}return Object(l.a)(a,[{key:"render",value:function(){var e=this,t=S.findKey(Xe,(function(t){return t===e.props.graphType}));return i.a.createElement(lO,{title:!1},i.a.createElement("div",{className:pO},i.a.createElement(zu,{disabled:this.props.isNodeGraph}),i.a.createElement("span",{className:mO}),i.a.createElement(Mu,{info:Hu.GraphTraffic},i.a.createElement("span",{className:dO},i.a.createElement(uO,{disabled:this.props.disabled}))),i.a.createElement("span",{className:mO}),i.a.createElement(Mu,{info:Hu.GraphType},i.a.createElement("span",{className:dO},i.a.createElement(pl,{id:"graph_type_dropdown",disabled:this.props.disabled,handleSelect:this.setGraphType,value:t,label:fO[t],options:fO}))),i.a.createElement("div",{className:hO},i.a.createElement(Mu,{info:Hu.TimeRange},i.a.createElement(Zl,{id:"graph_time_range",disabled:this.props.disabled,handleRefresh:this.props.onHandleRefresh,supportsReplay:!0})))))}}]),a}(i.a.PureComponent),vO=Object(Jn.a)({marginBottom:"20px",marginTop:"20px"}),EO=Object(Jn.a)({marginLeft:"auto"}),bO=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;Object(s.a)(this,a),(n=t.call(this,e)).handleRefresh=function(){n.props.onRefresh&&n.props.onRefresh()},n.handleNamespaceReturn=function(){if(!n.props.summaryData||"node"!==n.props.summaryData.summaryType&&"box"!==n.props.summaryData.summaryType)U.push("/graph/namespaces");else{var e='node[id = "'.concat(n.props.summaryData.summaryTarget.data(rv),'"]');n.props.setNode(void 0),U.push("/graph/namespaces?focusSelector=".concat(encodeURI(e)))}};var r=new URLSearchParams(U.location.search),i=q.getParam(P.GRAPH_EDGES,r);if(i)i!==e.edgeLabels.join(",")&&e.setEdgeLabels(i.split(","));else{var o=e.edgeLabels.join(",");q.setParam(P.GRAPH_EDGES,o)}var l=q.getParam(P.GRAPH_TRAFFIC,r);if(l)l!==e.trafficRates.join(",")&&e.setTrafficRates(l.split(","));else{var c=e.trafficRates.join(",");q.setParam(P.GRAPH_TRAFFIC,c)}var u=q.getParam(P.GRAPH_TYPE,r);u?u!==e.graphType&&e.setGraphType(u):q.setParam(P.GRAPH_TYPE,String(n.props.graphType));var p=q.getParam(P.NAMESPACES,r);if(p)p!==wT(e.activeNamespaces)&&e.setActiveNamespaces(p.split(",").map((function(e){return{name:e}})));else{var d=wT(e.activeNamespaces);q.setParam(P.NAMESPACES,d)}var m=q.getBooleanParam(P.GRAPH_IDLE_NODES);return void 0!==m?e.showIdleNodes!==m&&e.setIdleNodes(m):q.setParam(P.GRAPH_IDLE_NODES,String(n.props.showIdleNodes)),n}return Object(l.a)(a,[{key:"componentDidUpdate",value:function(){var e=wT(this.props.activeNamespaces);0===this.props.activeNamespaces.length?q.deleteParam(P.NAMESPACES,!0):q.setParam(P.NAMESPACES,e),q.setParam(P.GRAPH_EDGES,String(this.props.edgeLabels)),q.setParam(P.GRAPH_IDLE_NODES,String(this.props.showIdleNodes)),q.setParam(P.GRAPH_TRAFFIC,String(this.props.trafficRates)),q.setParam(P.GRAPH_TYPE,String(this.props.graphType))}},{key:"componentWillUnmount",value:function(){this.props.replayActive&&this.props.toggleReplayActive()}},{key:"render",value:function(){return r.createElement(r.Fragment,null,r.createElement(gO,{disabled:this.props.disabled,graphType:this.props.graphType,isNodeGraph:!!this.props.node,onToggleHelp:this.props.onToggleHelp,onGraphTypeChange:this.props.setGraphType,onHandleRefresh:this.handleRefresh}),r.createElement(dr.a,{className:vO},r.createElement("div",{style:{display:"flex"}},this.props.node&&r.createElement(lo.a,{key:"graph-tour-help-ot",position:lo.b.right,content:"Back to full graph"},r.createElement(vr.a,{variant:vr.b.link,onClick:this.handleNamespaceReturn},r.createElement(fi.Back,{className:mi}))),r.createElement(Mu,{info:Hu.Display},r.createElement(IT,{graphType:this.props.graphType}))),r.createElement(TT,{cy:this.props.cy}),r.createElement(ir.a,{className:EO,"aria-label":"graph_refresh_toolbar"},r.createElement(lo.a,{key:"graph-tour-help-ot",position:lo.b.right,content:"Graph help tour..."},r.createElement(vr.a,{className:EO,variant:"link",style:{paddingLeft:"6px",paddingRight:"0px"},onClick:this.props.onToggleHelp},r.createElement(fi.Help,{className:mi})," Graph tour")))),this.props.replayActive&&r.createElement(iO,{id:"time-range-replay"}))}}]),a}(r.PureComponent);bO.contextTypes={router:function(){return null}};var yO,CO=Object(h.b)((function(e){return{activeNamespaces:hl(e),edgeLabels:El(e),graphType:yl(e),node:e.graph.node,replayActive:Tl(e),showIdleNodes:Rl(e),summaryData:e.graph.summaryData,trafficRates:kl(e)}}),(function(e){return{setActiveNamespaces:Object(Ie.b)(ht.setActiveNamespaces,e),setEdgeLabels:Object(Ie.b)(st.setEdgeLabels,e),setGraphType:Object(Ie.b)(st.setGraphType,e),setIdleNodes:Object(Ie.b)(st.setIdleNodes,e),setNode:Object(Ie.b)(Ke.setNode,e),setTrafficRates:Object(Ie.b)(st.setTrafficRates,e),toggleReplayActive:Object(Ie.b)(vt.toggleReplayActive,e)}}))(bO),SO=a(809),AO=a.n(SO),TO=a(810),OO=a.n(TO),IO=a(811),wO=a.n(IO),RO=a(812),kO=a.n(RO),xO=a(813),NO=a.n(xO),jO=a(814),PO=a.n(jO),LO=a(815),DO=a.n(LO),FO=a(816),_O=a.n(FO),MO=a(817),HO=a.n(MO),GO=a(818),VO=a.n(GO),UO=a(819),BO=a.n(UO),WO=a(820),qO=a.n(WO),KO=a(821),zO=a.n(KO),YO=a(822),QO=a.n(YO),XO=a(823),JO=a.n(XO),ZO=a(824),$O=a.n(ZO),eI=a(825),tI=a.n(eI),aI=a(826),nI=a.n(aI),rI=a(827),iI=a.n(rI),oI=a(828),sI=a.n(oI),lI=a(829),cI=a.n(lI),uI=a(830),pI=a.n(uI),dI=a(831),mI=a.n(dI),hI=a(832),fI=a.n(hI),gI=a(833),vI=a.n(gI),EI=a(834),bI=a.n(EI),yI=a(835),CI=a.n(yI),SI=a(836),AI=a.n(SI),TI=[{title:"Node Shapes",data:[{label:"Workload",icon:AO.a},{label:"App",icon:OO.a},{label:"Operation",icon:kO.a},{label:"Service",icon:wO.a},{label:"Service Entry",icon:NO.a}]},{title:"Node Colors",data:[{label:"Normal",icon:PO.a},{label:"Warn",icon:DO.a},{label:"Danger",icon:_O.a},{label:"Idle",icon:HO.a}]},{title:"Node Background",data:[{label:"Unselected Namespace",icon:VO.a},{label:"Restricted / External",icon:BO.a}]},{title:"Edges",data:[{label:"Failure",icon:zO.a},{label:"Degraded",icon:QO.a},{label:"Healthy",icon:qO.a},{label:"TCP Connection",icon:$O.a},{label:"Idle",icon:JO.a},{label:"mTLS (badge)",icon:tI.a}]},{title:"Traffic Animation",data:[{label:"Normal Request",icon:nI.a},{label:"Failed Request",icon:iI.a},{label:"TCP Traffic",icon:sI.a}]},{title:"Node Badges",data:[{label:"Circuit Breaker",icon:cI.a},{label:"Fault Injection",icon:pI.a},{label:"Gateway",icon:mI.a},{label:"Missing Sidecar",icon:fI.a},{label:"Request Timeout",icon:vI.a},{label:"Traffic Shifting/TCP Traffic Shifting",icon:bI.a},{label:"Traffic Source",icon:CI.a},{label:"Virtual Service/Request Routing",icon:AI.a}]}],OI=a(837),II=a.n(OI),wI=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=Object(Jn.a)({margin:"0 0 3.8em 0",padding:"1em",border:"1px #ddd solid",overflow:"hidden",overflowX:"auto",overflowY:"auto",backgroundColor:nt.White,zIndex:3}),t=Object(Jn.a)({width:"200px"}),a=Object(Jn.a)({fontWeight:"bold",fontSize:"16px"}),n=Object(Jn.a)({width:"200px",height:"auto"}),i=Object(Jn.a)({display:"flex",flexDirection:"column"}),o=Object(Jn.a)({float:"right",marginTop:"-7px"});return r.createElement("div",{className:e},r.createElement("div",{className:t},r.createElement("span",{className:a},"Legend"),r.createElement("span",{className:o},r.createElement(lo.a,{content:"Close Legend"},r.createElement(vr.a,{id:"legend_close",variant:"plain",onClick:this.props.closeLegend},r.createElement(II.a,null))))),r.createElement("div",{className:n},r.createElement("div",{className:i},this.renderGraphLegendList(TI))))}},{key:"renderGraphLegendList",value:function(e){var t=this,a=Object(Jn.a)({paddingTop:"1.25em",fontSize:"14px"}),n=Object(Jn.a)({height:"100%",width:"200px"});return r.createElement("div",{className:n},e.map((function(e){return r.createElement("div",{key:e.title,className:a},e.title,t.renderLegendRowItems(e.data))})))}},{key:"renderLegendRowItems",value:function(e){return r.createElement(r.Fragment,null,e.map((function(e){return a.renderLegendIconAndLabel(e)})))}}],[{key:"renderLegendIconAndLabel",value:function(e){var t=Object(Jn.a)({fontSize:"1em",display:"flex",flexDirection:"row",justifyContent:"space-between",padding:"5px 5px 0 5px"}),a=Object(Jn.a)({fontSize:"12px",fontWeight:"normal",width:"130px",marginTop:"3px"});return r.createElement("div",{key:e.icon,className:t},r.createElement("span",null,r.createElement("img",{alt:e.label,src:e.icon})),r.createElement("span",{className:a},e.label))}}]),a}(r.Component),RI=a(1510),kI=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).state={hiddenSeries:new Set},n}return Object(l.a)(a,[{key:"render",value:function(){var e=this,t=1===this.props.series[0].datapoints.length,a=this.props.height+20+25,n={top:t?10:15,left:5+this.props.xLabelsWidth,bottom:55,right:10},i=[];this.props.series.forEach((function(t,a){Bs(i,{legendName:e.props.baseName+"-legend",idx:a,serieID:e.props.baseName+"-bars-"+a,onClick:function(t){return e.state.hiddenSeries.delete(a)||e.state.hiddenSeries.add(a),e.setState({hiddenSeries:new Set(e.state.hiddenSeries)}),null},onMouseOver:function(e){return{style:Object(C.a)(Object(C.a)({},e.style),{},{strokeWidth:4,fillOpacity:.5})}}})}));var o=getComputedStyle(document.body).getPropertyValue("--graph-side-panel--font-size"),s=getComputedStyle(document.body).getPropertyValue("--graph-side-panel--font-size-px"),l={tickLabels:{fontSize:o,padding:3}},c=t?{tickLabels:{fill:"none",fontSize:o}}:{tickLabels:{padding:2,fontSize:o}};return r.createElement(Rs.a,{height:a,width:250,padding:n,domainPadding:{x:t?[15,15]:[30,25]},domain:{y:[0,100]},events:i},r.createElement(RI.a,{colorScale:this.props.series.filter((function(t,a){return!e.state.hiddenSeries.has(a)})).map((function(e){return e.color})),horizontal:!0},this.props.series.map((function(t,a){if(!e.state.hiddenSeries.has(a))return r.createElement(sy.a,{key:e.props.baseName+"-bars-"+a,name:e.props.baseName+"-bars-"+a,data:t.datapoints.map((function(e){return Object(C.a)(Object(C.a)({},e),{},{label:"".concat(e.name,": ").concat(e.y.toFixed(2)," %")})})),barWidth:10,labelComponent:r.createElement(Ps.a,{constrainToVisibleArea:!0,flyoutStyle:{stroke:"none",fillOpacity:.6}})})}))),r.createElement(ks.a,{style:c}),r.createElement(ks.a,{style:l,dependentAxis:!0,showGrid:!0,crossAxis:!1,tickValues:[0,25,50,75,100]}),r.createElement(js.a,{style:{labels:{fontSize:Number(s)}},name:this.props.baseName+"-legend",data:this.props.series.map((function(t,a){return e.state.hiddenSeries.has(a)?Object(C.a)(Object(C.a)({},t.legendItem),{},{symbol:{fill:nt.Black600}}):t.legendItem})),x:this.props.xLabelsWidth,y:a-25,height:25,width:250,gutter:14,symbolSpacer:8}))}}]),a}(r.Component),xI=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e="gRPC Traffic (".concat(this.props.isRequests?"requests":"messages"," per second)"),t=this.props.rateGrpcErr+this.props.rateNR,a=0===this.props.rate?0:t/this.props.rate*100,n=100-a;return r.createElement("div",null,r.createElement("strong",null,e),r.createElement("table",{className:"table"},r.createElement("thead",null,r.createElement("tr",null,r.createElement("th",null,"Total"),r.createElement("th",null,"%Success"),r.createElement("th",null,"%Error"))),r.createElement("tbody",null,r.createElement("tr",null,r.createElement("td",null,this.props.rate.toFixed(2)),r.createElement("td",null,this.props.isRequests?n.toFixed(2):"-"),r.createElement("td",null,this.props.isRequests?a.toFixed(2):"-")))),this.props.isRequests&&function(e,t){var a=[{name:"OK",x:"rate",y:e,color:nt.Success},{name:"Err",x:"rate",y:t,color:nt.Danger}].map((function(e){return{datapoints:[e],color:e.color,legendItem:{name:e.name,symbol:{fill:e.color}}}}));return r.createElement(kI,{baseName:"rate-grpc",height:80,xLabelsWidth:0,series:a})}(n,a))}}]),a}(r.Component),NI=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props.rate4xx+this.props.rate5xx+this.props.rateNR,t=0===this.props.rate?0:e/this.props.rate*100,a=100-t,n=0===this.props.rate?0:this.props.rate-this.props.rate3xx-this.props.rate4xx-this.props.rate5xx-this.props.rateNR,i=0===this.props.rate?0:n/this.props.rate*100,o=0===this.props.rate?0:this.props.rate3xx/this.props.rate*100,s=0===this.props.rate?0:this.props.rate4xx/this.props.rate*100,l=0===this.props.rate?0:this.props.rate5xx/this.props.rate*100,c=0===this.props.rate?0:this.props.rateNR/this.props.rate*100;return r.createElement("div",null,r.createElement("strong",null,this.props.title),r.createElement("table",{className:"table",style:{marginBottom:"10px"}},r.createElement("thead",null,r.createElement("tr",{style:{backgroundColor:"white"}},r.createElement("th",null,"Total"),r.createElement("th",null,"%Success"),r.createElement("th",null,"%Error"))),r.createElement("tbody",null,r.createElement("tr",null,r.createElement("td",null,this.props.rate.toFixed(2)),r.createElement("td",null,a.toFixed(2)),r.createElement("td",null,t.toFixed(2))))),function(e,t,a,n,i){var o=[{name:"OK",x:"rate",y:e,color:nt.Success},{name:"3xx",x:"rate",y:t,color:nt.Info},{name:"4xx",x:"rate",y:a,color:nt.ChartWarning},{name:"5xx",x:"rate",y:n,color:nt.ChartDanger},{name:"No Response",x:"rate",y:i,color:nt.ChartOther}].map((function(e){return{datapoints:[e],color:e.color,legendItem:{name:"No Response"===e.name?"NR":e.name,symbol:{fill:e.color}}}}));return r.createElement(kI,{baseName:"rate-http",height:80,xLabelsWidth:0,series:o})}(i,o,s,l,c))}}]),a}(r.Component),jI=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){return r.createElement("div",null,r.createElement("strong",null,"TCP Traffic (bytes per second)"),r.createElement("table",{className:"table"},r.createElement("thead",null,r.createElement("tr",null,r.createElement("th",null,"Total"),r.createElement("th",null,"%Success"),r.createElement("th",null,"%Error"))),r.createElement("tbody",null,r.createElement("tr",null,r.createElement("td",null,this.props.rate.toFixed(2)),r.createElement("td",null,"-"),r.createElement("td",null,"-")))))}}]),a}(r.Component),PI=a(1511),LI=Object(Jn.a)({marginTop:"0.5em",marginBottom:"0.5em"}),DI=function(){return r.createElement("div",null,r.createElement(Br.a,null)," Not enough traffic to generate chart.")},FI=function(e){return e.datapoints.reduce((function(e,t){return e+t.y}),0)>0},_I=function(e,t){var a=t||function(e){return"".concat(e," rps")};return r.createElement(Ws,{name:"rps",height:41,width:250,showLegend:!1,padding:{top:5},tooltipFormat:function(e){return"".concat(e.x.toLocaleTimeString(),"\n").concat(a(e.y))},series:e})},MI=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).renderContent=function(){var t=Zs(e.props.dataRps,"RPS",nt.Info),a=Zs(e.props.dataErrors,"Error",nt.Danger);return FI(t)?r.createElement(r.Fragment,null,e.renderMinMaxStats(t.datapoints,a.datapoints),_I([t,a])):DI()},e.renderMinMaxStats=function(e,t){for(var a=e.length>0?e[0].y:0,n=a,i=t.length>0?t[0].y:0,o=100*i/a,s=o,l=1;l<e.length;++l){var c=e[l].y;if(a=c<a?c:a,n=c>n?c:n,0!==c){var u=100*(i=l<t.length?t[l].y:0)/c;(isNaN(o)||u<o)&&(o=u),(isNaN(s)||u>s)&&(s=u)}}return r.createElement("div",null,"RPS: ",a.toFixed(2)," / ",n.toFixed(2)," , %Error ",o.toFixed(2)," / ",s.toFixed(2))},e}return Object(l.a)(a,[{key:"render",value:function(){return r.createElement(r.Fragment,null,!this.props.hide&&r.createElement("div",{className:LI},r.createElement("div",null,r.createElement("strong",null,this.props.label," min / max:")),this.renderContent()))}}]),a}(r.Component),HI=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).renderContent=function(){var t=Zs(e.props.sentRates,"Sent",nt.Blue400),a=Zs(e.props.receivedRates,"Received",nt.Green400);return FI(t)||FI(a)?r.createElement(r.Fragment,null,e.renderMinMaxStats(t.datapoints.map((function(e){return e.y})),a.datapoints.map((function(e){return e.y}))),_I([t,a],(function(t){return"bytes"===e.props.unit?e.abbreviateBytes(t).format(!0)+"/s":"".concat(t.toFixed(2)," msg/s")}))):DI()},e.renderMinMaxStats=function(t,a){var n=0,i=0,o=0,s=0;return t.length>0&&(n=Math.min.apply(Math,Object(mt.a)(t)),i=Math.max.apply(Math,Object(mt.a)(t))),a.length>0&&(o=Math.min.apply(Math,Object(mt.a)(a)),s=Math.max.apply(Math,Object(mt.a)(a))),r.createElement("div",null,r.createElement(PI.a,{style:{color:nt.Blue400}})," Sent: ",e.formatMinMaxStats(n,i),r.createElement("br",null),r.createElement(PI.a,{style:{color:nt.Green400}})," Received:"," ",e.formatMinMaxStats(o,s))},e.abbreviateBytes=function(e){var t={originalValue:e,multiplier:1,unit:"B",abbreviatedValue:function(){return t.originalValue/t.multiplier},format:function(e){var a=t.abbreviatedValue().toFixed(2);return e&&(a+=" "+t.unit),a}};return e>=1e9?(t.multiplier=1e9,t.unit="G"):e>=1e6?(t.multiplier=1e6,t.unit="M"):e>=1e3&&(t.multiplier=1e3,t.unit="K"),t},e.formatMinMaxStats=function(t,a){if("bytes"===e.props.unit){var n=e.abbreviateBytes(t),r=e.abbreviateBytes(a);return n.multiplier>r.multiplier?(r.unit=n.unit,r.multiplier=n.multiplier):(n.unit=r.unit,n.multiplier=r.multiplier),n.format(!1)+" / "+r.format(!0)+"/s"}return t.toFixed(2)+" / "+a.toFixed(2)+" msg/s"},e}return Object(l.a)(a,[{key:"render",value:function(){return r.createElement(r.Fragment,null,!this.props.hide&&r.createElement("div",{className:LI},r.createElement("div",null,r.createElement("strong",null,this.props.label," - min / max:")),this.renderContent()))}}]),a}(r.Component),GI=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).thereIsTrafficData=function(){return e.props.rtAvg.length>0},e.toMillis=function(e){return e.map((function(e){return[e[0],1e3*e[1]]}))},e}return Object(l.a)(a,[{key:"render",value:function(){var e="s"===this.props.unit?this.toMillis:function(e){return e},t=[Zs(e(this.props.rtAvg),"avg",nt.Black1000),Zs(e(this.props.rtMed),"p50",nt.Green400),Zs(e(this.props.rt95),"p95",nt.Blue400),Zs(e(this.props.rt99),"p99",nt.Orange400)];return r.createElement(r.Fragment,null,!this.props.hide&&r.createElement("div",null,r.createElement("div",null,r.createElement("strong",null,this.props.label,":")),this.thereIsTrafficData()?r.createElement(Ws,{name:"rt",height:70,width:250,showLegend:!0,padding:{top:5},tooltipFormat:function(e){var t=Math.floor(1e3*e.y)/1e3;return"".concat(e.x.toLocaleTimeString()," - ").concat(e.name,": ").concat(t," ms")},series:t}):r.createElement("div",null,r.createElement(Br.a,null)," Not enough traffic to generate chart.")))}}]),a}(r.Component),VI=function(e){var t,a;if(void 0===e.cluster)return r.createElement(ar.a,{to:e.href},e.children);if(!(null===(t=j.clusterInfo)||void 0===t?void 0:t.name)||e.cluster===j.clusterInfo.name)return r.createElement(ar.a,{to:e.href},e.children);var n=j.clusters[e.cluster],i=null===n||void 0===n||null===(a=n.kialiInstances)||void 0===a?void 0:a.find((function(e){return 0!==e.url.length}));if(void 0===i)return e.children;var o=i.url.replace(/\/$/g,"")+"/console"+e.href;return r.createElement("a",{href:o,rel:"noreferrer noopener",target:"_blank"},e.children," ",r.createElement(Jf.a,null))},UI=function(e,t){var a,n=t.isBox!==Je.NAMESPACE,i=t.isBox!==Je.CLUSTER&&"Kubernetes"!==t.cluster&&(null===j||void 0===j||null===(a=j.clusterInfo)||void 0===a?void 0:a.name)!==t.cluster;return r.createElement("div",{style:{textAlign:"left"}},r.createElement("span",null,e),n&&r.createElement("div",null,"Namespace: ".concat(t.namespace)),i&&r.createElement("div",null,"Cluster: ".concat(t.cluster)))},BI=function(e,t,a){var n=function(e,t){var a=e.app,n=e.cluster,i=e.namespace,o=e.service,s=e.workload;t&&e.nodeType!==Ze.UNKNOWN||(t=e.nodeType);var l,c,u="unknown";switch(t){case Ze.AGGREGATE:u=e.aggregateValue;break;case Ze.APP:l="/namespaces/".concat(encodeURIComponent(i),"/applications/").concat(encodeURIComponent(a)),c="".concat(i,".app.").concat(a),u=a;break;case Ze.BOX:switch(e.isBox){case Je.APP:l="/namespaces/".concat(encodeURIComponent(i),"/applications/").concat(encodeURIComponent(a)),c="".concat(i,".app.").concat(a),u=a;break;case Je.CLUSTER:u=n;break;case Je.NAMESPACE:u=i}break;case Ze.SERVICE:l=e.isServiceEntry?"/namespaces/".concat(encodeURIComponent(e.isServiceEntry.namespace),"/istio/serviceentries/").concat(encodeURIComponent(o)):"/namespaces/".concat(encodeURIComponent(i),"/services/").concat(encodeURIComponent(o)),c="".concat(i,".svc.").concat(o),u=o;break;case Ze.WORKLOAD:l="/namespaces/".concat(encodeURIComponent(i),"/workloads/").concat(encodeURIComponent(s)),c="".concat(i,".wl.").concat(s),u=s}return l&&!e.isInaccessible?r.createElement(VI,{key:c,href:l,cluster:n},u):r.createElement("span",{key:c},u)}(e,t);return r.createElement(r.Fragment,null,r.createElement("span",{style:{marginRight:"1em",marginBottom:"3px",display:"inline-block"}},a&&r.createElement("span",{style:{whiteSpace:"pre"}},r.createElement("b",null,a)),function(e,t){switch(t||e.nodeType){case Ze.AGGREGATE:return dc(cc.Operation.badge,UI("Operation: ".concat(e.aggregate),e));case Ze.APP:return dc(cc.App.badge,UI(cc.App.tt,e));case Ze.BOX:switch(e.isBox){case Je.APP:return dc(cc.App.badge,UI(cc.App.tt,e));case Je.CLUSTER:return dc(cc.Cluster.badge,UI(cc.Cluster.tt,e));case Je.NAMESPACE:return dc(cc.Namespace.badge,UI(cc.Namespace.tt,e));default:return r.createElement(pc,{badge:cc.Unknown})}case Ze.SERVICE:return e.isServiceEntry?dc(cc.ServiceEntry.badge,UI("MESH_EXTERNAL"===e.isServiceEntry.location?"External Service Entry":"Internal Service Entry",e)):dc(cc.Service.badge,UI(cc.Service.tt,e));case Ze.WORKLOAD:return dc(cc.Workload.badge,UI(cc.Workload.tt,e));default:return r.createElement(pc,{badge:cc.Unknown})}}(e,t),n),e.isInaccessible&&r.createElement(fi.MtlsLock,null))},WI=function(e){return r.createElement(r.Fragment,null,r.createElement(co.a,{style:{fontWeight:"normal",marginTop:"4px",marginBottom:"4px"},isRead:!0},r.createElement("span",{style:{margin:"3px 3px 1px 0"}},e?r.createElement(Co,{id:"graph-health-indicator",health:e,tooltipPlacement:Cr.b.left}):"n/a"),"health"))};!function(e){e[e.APP=1]="APP",e[e.WORKLOAD=2]="WORKLOAD",e[e.SERVICE=3]="SERVICE",e[e.AGGREGATE=4]="AGGREGATE",e[e.CLUSTER=5]="CLUSTER",e[e.NAMESPACE=6]="NAMESPACE"}(yO||(yO={}));var qI=Object(Jn.a)({padding:"10px 15px 0 15px"}),KI={backgroundColor:nt.White},zI=Object(Jn.a)({height:"100%",margin:0,minWidth:"25em",overflowY:"scroll",backgroundColor:nt.White,width:"25em",fontSize:"var(--graph-side-panel--font-size)",padding:0,position:"relative"}),YI={fontSize:"var(--graph-side-panel--font-size)"},QI=function(){return r.createElement("hr",{style:{margin:"10px 0"}})},XI=function(e,t){return e.queryTime!==t.queryTime||!e.data.summaryTarget&&t.data.summaryTarget||e.data.summaryTarget!==t.data.summaryTarget},JI=function(e){switch(e.nodeType){case Ze.AGGREGATE:return yO.AGGREGATE;case Ze.APP:return e.workload?yO.WORKLOAD:yO.APP;case Ze.BOX:switch(e.isBox){case Je.APP:return yO.APP;case Je.CLUSTER:return yO.CLUSTER;case Je.NAMESPACE:default:return yO.NAMESPACE}case Ze.SERVICE:return yO.SERVICE;default:return yO.WORKLOAD}},ZI=function(e,t,a,n,r,i,o,s,l){var c,u,p,d,m=Ov(t),h={queryTime:a.queryTime,duration:a.duration,step:a.step,rateInterval:a.rateInterval,filters:n,quantiles:s,byLabels:l,direction:r,reporter:i,requestProtocol:o};switch(e){case yO.AGGREGATE:return c=m.namespace,u=m.aggregate,p=m.aggregateValue,d=h,Xa(K.GET,qa.aggregateMetrics(c,u,p),d,{});case yO.APP:return function(e,t,a){return Xa(K.GET,qa.appMetrics(e,t),a,{})}(m.namespace,m.app,h);case yO.SERVICE:return function(e,t,a){return Xa(K.GET,qa.serviceMetrics(e,t),a,{})}(m.namespace,m.service,h);case yO.WORKLOAD:return function(e,t,a){return Xa(K.GET,qa.workloadMetrics(e,t),a,{})}(m.namespace,m.workload,h);default:return Promise.reject(new Error("Unknown NodeMetricType: ".concat(e)))}},$I=function(e){return Promise.all(e).then((function(e){var t={};return e.forEach((function(e){Object.keys(e.data).forEach((function(a){t[a]=e.data[a]}))})),{data:t}}))},ew=function(e){return e&&e.length>0?e[0].datapoints:[]},tw=function(e,t,a){var n=new Map;if(e)for(var r=0;r<e.length;++r){var i=e[r];t(i.labels,a)&&i.datapoints.forEach((function(e){var t=Number(e[1]);if(!isNaN(t)){var a=n.get(e[0]);n.set(e[0],a?[e[0],a[1]+t]:[e[0],t])}}))}return Array.from(n.values())},aw=function(e){return r.createElement(r.Fragment,null,r.createElement("div",null,r.createElement(fi.Info,null)," No ",e||""," traffic logged."))},nw=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).getRows=function(e){var t=[];return A.a.keys(e).forEach((function(a){A.a.keys(e[a].flags).forEach((function(n){t.push({key:"".concat(a," ").concat(n),code:a,flags:n,val:e[a].flags[n]})}))})),t},e.getTitle=function(e){return e.split(",").map((function(e){e=e.trim();var t=$[e];return"-"===e?"":"[".concat(e,"] ").concat(t?t.help:"Unknown Flag")})).join("\n")},e}return Object(l.a)(a,[{key:"render",value:function(){var e=this;return r.createElement(r.Fragment,null,r.createElement("strong",null,this.props.title),r.createElement("table",{className:"table"},r.createElement("thead",null,r.createElement("tr",{key:"table-header"},r.createElement("th",null,"Code"),r.createElement("th",null,"Flags"),r.createElement("th",null,"% Req"))),r.createElement("tbody",null,this.getRows(this.props.responses).map((function(t){return r.createElement("tr",{key:t.key},r.createElement("td",null,t.code),r.createElement("td",{title:e.getTitle(t.flags)},t.flags),r.createElement("td",null,t.val))})))))}}]),a}(r.PureComponent),rw=Object(Jn.a)({overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}),iw=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).getRows=function(e){var t=[];return A.a.keys(e).forEach((function(a){A.a.keys(e[a].hosts).forEach((function(n){t.push({key:"".concat(a," ").concat(n),code:a,host:n,val:e[a].hosts[n]})}))})),t},e}return Object(l.a)(a,[{key:"render",value:function(){var e=this.getRows(this.props.responses);return r.createElement(r.Fragment,null,e.length>0?r.createElement(r.Fragment,null,r.createElement("strong",null,this.props.title),r.createElement("table",{className:"table",style:{tableLayout:"fixed",width:"100%"}},r.createElement("thead",null,r.createElement("tr",{key:"table-header"},r.createElement("th",{style:{width:"18%"}},"Code"),r.createElement("th",{style:{width:"52%"}},"Host"),r.createElement("th",{style:{width:"30%"}},"% Req"))),r.createElement("tbody",null,e.map((function(e){return r.createElement("tr",{key:e.key},r.createElement("td",null,e.code),r.createElement(lo.a,{distance:3,maxWidth:"25rem",content:e.host},r.createElement("td",{className:rw},e.host)),r.createElement("td",null,e.val))}))))):r.createElement(r.Fragment,null,"No Host Information Available"))}}]),a}(r.PureComponent),ow={rates:[],errRates:[],rtAvg:[],rtMed:[],rt95:[],rt99:[],sent:[],received:[],unit:"ms"},sw=Object(C.a)({edge:null,loading:!1,metricsLoadError:null},ow),lw=Object(Jn.a)({display:"inline-block",overflow:"hidden",textOverflow:"ellipsis",width:"100%",whiteSpace:"nowrap"}),cw=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).metricsPromise=void 0,n.mainDivRef=void 0,n.getByLabels=function(e,t){var a;switch(e){case yO.AGGREGATE:switch(t){case yO.APP:a="destination_app";break;case yO.SERVICE:a="destination_service_name";break;case yO.WORKLOAD:default:a="destination_workload"}break;case yO.APP:a="source_app";break;case yO.SERVICE:a="destination_service_name";break;case yO.WORKLOAD:default:a="source_workload"}return n.isSpecialServiceDest(t)?[a,"destination_workload"]:[a]},n.getNodeDataPoints=function(e,t,a,r,i){if(i)return tw(e,(function(e){return!!r.destServices&&r.destServices.some((function(t){return t.name===e.destination_service_name}))}));var o,s;switch(t){case yO.AGGREGATE:switch(a){case yO.APP:o="destination_app",s=r.app;break;case yO.SERVICE:o="destination_service_name",s=r.service;break;case yO.WORKLOAD:default:o="destination_workload",s=r.workload}break;case yO.APP:o="source_app",s=r.app;break;case yO.SERVICE:o="destination_service_name",s=r.service;break;case yO.WORKLOAD:default:o="source_workload",s=r.workload}var l=n.isSpecialServiceDest(a)?function(e){return e[o]===s&&e.destination_workload===it}:function(e){return e[o]===s};return tw(e,l)},n.updateCharts=function(e){var t=e.data.summaryTarget,a=Tv(t),r=Ov(t.source()),i=Ov(t.target()),o=JI(r),s=JI(i),l=a.protocol,c=l===Le.GRPC,u=l===Le.HTTP,p=l===Le.TCP,d=u||c&&n.props.trafficRates.includes(ze.GRPC_REQUEST);if(n.metricsPromise&&(n.metricsPromise.cancel(),n.metricsPromise=void 0),s&&o&&n.hasSupportedCharts(t)&&(c||u||p)&&!i.isInaccessible){var m,h,f=r.nodeType===Ze.AGGREGATE,g=!!i.isServiceEntry,v=!g&&!f,E=v?t.target():t.source(),b=v?i:r,y=v||f?"inbound":"outbound",S=v?s:o,A=g?["destination_service_name"]:n.getByLabels(o,s),T=v?r:i,O=["0.5","0.95","0.99"];if(u||c&&d){var I=[Ze.SERVICE,Ze.UNKNOWN].includes(r.nodeType)||Ze.AGGREGATE===b.nodeType||t.source().isIstio||t.target().isIstio?"destination":"source";m=ZI(S,E,e,["request_count","request_duration_millis","request_error_count"],y,I,l,O,A)}else if(c){var w=[Ze.AGGREGATE,Ze.UNKNOWN].includes(r.nodeType)||r.isIstio?"destination":"source";h=ZI(S,E,e,["grpc_sent","grpc_received"],y,w,void 0,O,A)}else{var R=[Ze.AGGREGATE,Ze.UNKNOWN].includes(r.nodeType)||r.isIstio?"destination":"source";h=ZI(S,E,e,["tcp_sent","tcp_received"],y,R,void 0,O,A)}n.metricsPromise=br(m||h),n.metricsPromise.promise.then((function(e){var t=e.data,a=ow.rates,r=ow.errRates,i=ow.rtAvg,l=ow.rtMed,m=ow.rt95,h=ow.rt99,f=ow.sent,v=ow.received,E=ow.unit;if(u||c&&d){a=n.getNodeDataPoints(t.request_count,o,s,T,g),r=n.getNodeDataPoints(t.request_error_count,o,s,T,g);var b=t.request_duration_millis||[];i=n.getNodeDataPoints(b.filter((function(e){return"avg"===e.stat})),o,s,T,g),l=n.getNodeDataPoints(b.filter((function(e){return"0.5"===e.stat})),o,s,T,g),m=n.getNodeDataPoints(b.filter((function(e){return"0.95"===e.stat})),o,s,T,g),h=n.getNodeDataPoints(b.filter((function(e){return"0.99"===e.stat})),o,s,T,g)}else f=n.getNodeDataPoints(p?t.tcp_sent:t.grpc_sent,o,s,T,g),v=n.getNodeDataPoints(p?t.tcp_received:t.grpc_received,o,s,T,g);n.setState({loading:!1,rates:a,errRates:r,rtAvg:i,rtMed:l,rt95:m,rt99:h,sent:f,received:v,unit:E})})).catch((function(e){if(e.isCanceled)console.debug("SummaryPanelEdge: Ignore fetch error (canceled).");else{var t=e.response&&e.response.data.error?e.response.data.error:e.message;n.setState(Object(C.a)({loading:!1,metricsLoadError:t},ow))}})),n.setState({loading:!0,metricsLoadError:null})}else n.setState({loading:!1})},n.safeRate=function(e){return isNaN(e)?0:Number(e)},n.renderCharts=function(e,t,a,i,o){if(!n.hasSupportedCharts(e))return t||a?r.createElement(r.Fragment,null,r.createElement(fi.Info,null)," Service graphs do not support service-to-service aggregate sparklines. See the chart above for aggregate traffic or use the workload graph type to observe individual workload-to-service edge sparklines."):r.createElement(r.Fragment,null,r.createElement(fi.Info,null)," Service graphs do not support service-to-service aggregate sparklines. Use the workload graph type to observe individual workload-to-service edge sparklines.");var s,l;if(Ov(e.target()).isInaccessible)return r.createElement(r.Fragment,null,r.createElement(fi.Info,null)," Sparkline charts cannot be shown because the destination is inaccessible.");if(n.state.loading)return r.createElement("strong",null,"Loading charts...");if(n.state.metricsLoadError)return r.createElement("div",null,r.createElement(fi.Warning,null)," ",r.createElement("strong",null,"Error loading metrics: "),n.state.metricsLoadError);if(t||a)if(o){var c=t?"gRPC Request Traffic":"HTTP Request Traffic",u=t?"gRPC Request Response Time (ms)":"HTTP Request Response Time (ms)";s=r.createElement(r.Fragment,null,r.createElement(MI,{label:c,dataRps:n.state.rates,dataErrors:n.state.errRates}),QI(),r.createElement(GI,{label:u,rtAvg:n.state.rtAvg,rtMed:n.state.rtMed,rt95:n.state.rt95,rt99:n.state.rt99,unit:n.state.unit}))}else s=r.createElement(r.Fragment,null,r.createElement(HI,{label:"gRPC Message Traffic",sentRates:n.state.sent,receivedRates:n.state.received,unit:"messages"}));else i&&(l=r.createElement(HI,{label:"TCP Traffic",sentRates:n.state.sent,receivedRates:n.state.received,unit:"bytes"}));return r.createElement(r.Fragment,null,s,l)},n.hasSupportedCharts=function(e){var t=Ov(e.source()),a=Ov(e.target()),n=JI(t),r=JI(a);return n!==yO.SERVICE||r!==yO.SERVICE},n.renderMTLSSummary=function(e){var t="mTLS Enabled",a=e>0;return a&&e<100&&(t="".concat(t," [").concat(e,"% of request traffic]")),r.createElement(r.Fragment,null,a&&r.createElement("div",null,r.createElement(fi.MtlsLock,null),r.createElement("span",{style:{paddingLeft:"6px"}},t)))},n.state=Object(C.a)({},sw),n.mainDivRef=r.createRef(),n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.updateCharts(this.props)}},{key:"componentDidUpdate",value:function(e){e.data.summaryTarget!==this.props.data.summaryTarget&&this.mainDivRef.current&&(this.mainDivRef.current.scrollTop=0),XI(e,this.props)&&this.updateCharts(this.props)}},{key:"componentWillUnmount",value:function(){this.metricsPromise&&this.metricsPromise.cancel()}},{key:"render",value:function(){var e=this,t=this.props.data.summaryTarget,a=Ov(t.source()),n=Ov(t.target()),i=Tv(t),o=i.isMTLS,s=o&&o>0,l=!!i.sourcePrincipal||!!i.destPrincipal,c=s||l,u=i.protocol,p=u===Le.GRPC,d=u===Le.HTTP,m=u===Le.TCP,h=d||p&&this.props.trafficRates.includes(ze.GRPC_REQUEST),f=function(){return r.createElement("div",{className:"panel-heading",style:KI},s&&e.renderMTLSSummary(o),l&&r.createElement(r.Fragment,null,r.createElement("div",{style:{padding:"5px 0 2px 0"}},r.createElement("strong",null,"Principals:")),r.createElement(lo.a,{key:"tt_src_ppl",position:"top",content:"Source principal: ".concat(i.sourcePrincipal)},r.createElement("span",{className:lw},i.sourcePrincipal||"unknown")),r.createElement(lo.a,{key:"tt_src_ppl",position:"top",content:"Destination principal: ".concat(i.destPrincipal)},r.createElement("span",{className:lw},i.destPrincipal||"unknown"))))};return r.createElement("div",{ref:this.mainDivRef,className:"panel panel-default ".concat(zI)},r.createElement("div",{className:"panel-heading",style:KI},BI(a,void 0,"From:  "),BI(n,void 0,"To:        ")),c&&r.createElement(f,null),(d||p)&&r.createElement("div",{className:qI},r.createElement(hT,{id:"edge_summary_rate_tabs",defaultTab:0,style:{paddingBottom:"10px"}},r.createElement(bh.a,{style:YI,title:"Traffic",eventKey:0},r.createElement("div",{style:YI},p&&r.createElement(r.Fragment,null,r.createElement(xI,{isRequests:h,rate:this.safeRate(i.grpc),rateGrpcErr:this.safeRate(i.grpcErr),rateNR:this.safeRate(i.grpcNoResponse)})),d&&r.createElement(r.Fragment,null,r.createElement(NI,{title:"HTTP requests per second:",rate:this.safeRate(i.http),rate3xx:this.safeRate(i.http3xx),rate4xx:this.safeRate(i.http4xx),rate5xx:this.safeRate(i.http5xx),rateNR:this.safeRate(i.httpNoResponse)})))),h&&r.createElement(bh.a,{style:YI,title:"Flags",eventKey:1},r.createElement("div",{style:YI},r.createElement(nw,{title:"Response flags by "+(p?"GRPC code:":"HTTP code:"),responses:i.responses}))),r.createElement(bh.a,{style:YI,title:"Hosts",eventKey:2},r.createElement("div",{style:YI},r.createElement(iw,{title:"Hosts by "+(p?"GRPC code:":"HTTP code:"),responses:i.responses})))),QI(),this.renderCharts(t,p,d,m,h)),m&&r.createElement("div",{className:qI},r.createElement(hT,{id:"edge_summary_flag_hosts_tabs",defaultTab:0,style:{paddingBottom:"10px"}},r.createElement(bh.a,{style:YI,eventKey:0,title:"Flags"},r.createElement("div",{style:YI},r.createElement(nw,{title:"Response flags by code:",responses:i.responses}))),r.createElement(bh.a,{style:YI,eventKey:1,title:"Hosts"},r.createElement("div",{style:YI},r.createElement(iw,{title:"Hosts by code:",responses:i.responses})))),QI(),this.renderCharts(t,p,d,m,h)),!p&&!d&&!m&&r.createElement("div",{className:"panel-body"},aw()))}},{key:"isSpecialServiceDest",value:function(e){return e===yO.SERVICE&&!this.props.injectServiceNodes&&this.props.graphType!==Xe.SERVICE}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.data.summaryTarget!==t.edge?Object(C.a)({edge:e.data.summaryTarget,loading:!0},ow):null}}]),a}(r.Component),uw=function(e){return isNaN(e)?0:Number(e)},pw={RATE:Hg,RATEGRPCERR:Gg,RATENORESPONSE:Vg},dw={RATE:fg,RATEGRPCERR:gg,RATENORESPONSE:vg},mw=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:pw;return{rate:uw(e.data(t.RATE)),rateGrpcErr:uw(e.data(t.RATEGRPCERR)),rateNoResponse:uw(e.data(t.RATENORESPONSE))}},hw=function(e){return e.reduce((function(e,t){var a=mw(t,dw);return e.rate+=a.rate,e.rateGrpcErr+=a.rateGrpcErr,e.rateNoResponse+=a.rateNoResponse,e}),{rate:0,rateGrpcErr:0,rateNoResponse:0})},fw={RATE:Zg,RATE3XX:$g,RATE4XX:ev,RATE5XX:tv,RATENORESPONSE:av},gw={RATE:Cg,RATE3XX:Sg,RATE4XX:Ag,RATE5XX:Tg,RATENORESPONSE:Og},vw=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:fw;return{rate:uw(e.data(t.RATE)),rate3xx:uw(e.data(t.RATE3XX)),rate4xx:uw(e.data(t.RATE4XX)),rate5xx:uw(e.data(t.RATE5XX)),rateNoResponse:uw(e.data(t.RATENORESPONSE))}},Ew=function(e){return e.reduce((function(e,t){var a=vw(t,gw);return e.rate+=a.rate,e.rate3xx+=a.rate3xx,e.rate4xx+=a.rate4xx,e.rate5xx+=a.rate5xx,e.rateNoResponse+=a.rateNoResponse,e}),{rate:0,rate3xx:0,rate4xx:0,rate5xx:0,rateNoResponse:0})},bw={RATE:gv},yw={RATE:jg},Cw=function(e){return e.reduce((function(e,t){var a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:bw;return{rate:uw(e.data(t.RATE))}}(t,yw);return e.rate+=a.rate,e}),{rate:0})},Sw={grpcRequestIn:[],grpcRequestOut:[],grpcRequestErrIn:[],grpcRequestErrOut:[],grpcSentIn:[],grpcSentOut:[],grpcReceivedIn:[],grpcReceivedOut:[],httpRequestIn:[],httpRequestOut:[],httpRequestErrIn:[],httpRequestErrOut:[],tcpSentIn:[],tcpSentOut:[],tcpReceivedIn:[],tcpReceivedOut:[]},Aw=Object(C.a)({graph:null,loading:!1,metricsLoadError:null,validationsMap:new Map},Sw),Tw=Object(Jn.a)({margin:"0 1em"}),Ow=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).graphTraffic=void 0,n.metricsPromise=void 0,n.validationSummaryPromises=new yr,n.getGraphTraffic=function(){var e=n.props.data.summaryTarget,t=e.$('node[nodeType != "'.concat(Ze.SERVICE,'"][!isBox]')).edgesTo("*"),a=e.$("node[?".concat(pv,"]")).edgesTo("*"),r=e.nodes().leaves("node[?".concat(uv,"],[?").concat(dv,"]")).connectedEdges();return{grpcIn:hw(a),grpcOut:hw(r),grpcTotal:hw(t),httpIn:Ew(a),httpOut:Ew(r),httpTotal:Ew(t),isGrpcRequests:n.props.trafficRates.includes(ze.GRPC_REQUEST),tcpIn:Cw(a),tcpOut:Cw(r),tcpTotal:Cw(t)}},n.countApps=function(e){var t={};return e.$('node[nodeType = "'.concat(Ze.APP,'"]')).forEach((function(e){var a=e.data(Fg);void 0===t[a]&&(t[a]=new Set),t[a].add(e.data(Ev))})),{numApps:Object.getOwnPropertyNames(t).length,numVersions:Object.getOwnPropertyNames(t).reduce((function(e,a){return e+t[a].size}),0)}},n.renderNamespacesSummary=function(){return n.props.namespaces.map((function(e){return n.renderNamespace(e.name)}))},n.renderValidations=function(e){var t=n.state.validationsMap[e];if(t)return r.createElement(Ec,{namespace:e,objectCount:t.objectCount,errors:t.errors,warnings:t.warnings},r.createElement(_o,{id:"ns-val-"+e,errors:t.errors,warnings:t.warnings,objectCount:t.objectCount,style:{marginLeft:"5px"}}))},n.renderNamespace=function(e){return r.createElement(r.Fragment,{key:e},r.createElement("span",null,r.createElement(pc,{badge:cc.Namespace,style:{marginBottom:"2px"}}),e," ",n.renderValidations(e)),r.createElement("br",null))},n.renderTopologySummary=function(e,t,a,n,i){return r.createElement(r.Fragment,null,a>0&&r.createElement(r.Fragment,null,r.createElement(fi.Applications,{className:Tw}),a.toString()," ",1===a?"app ":"apps ",n>0&&"(".concat(n," versions)"),r.createElement("br",null)),e>0&&r.createElement(r.Fragment,null,r.createElement(fi.Services,{className:Tw}),e.toString()," ",1===e?"service":"services",r.createElement("br",null)),t>0&&r.createElement(r.Fragment,null,r.createElement(fi.Workloads,{className:Tw}),t.toString()," ",1===t?"workload":"workloads",r.createElement("br",null)),i>0&&r.createElement(r.Fragment,null,r.createElement(fi.Topology,{className:Tw}),i.toString()," ",1===i?"edge":"edges"))},n.renderCharts=function(){var e=n.props.data.summaryTarget.data(mv);if(n.state.loading)return r.createElement("strong",null,"Loading chart...");if(n.state.metricsLoadError)return r.createElement("div",null,r.createElement(fi.Warning,null)," ",r.createElement("strong",null,"Error loading metrics: "),n.state.metricsLoadError);if(e===it)return r.createElement(r.Fragment,null);var t=n.graphTraffic,a=t.grpcTotal,i=t.httpTotal,o=t.isGrpcRequests,s=t.tcpTotal;return r.createElement(r.Fragment,null,a.rate>0&&o&&r.createElement(r.Fragment,null,r.createElement(MI,{label:"gRPC - Inbound Request Traffic",dataRps:n.state.grpcRequestIn,dataErrors:n.state.grpcRequestErrIn}),r.createElement(MI,{label:"gRPC - Outbound Request Traffic",dataRps:n.state.grpcRequestOut,dataErrors:n.state.grpcRequestErrOut})),a.rate>0&&!o&&r.createElement(r.Fragment,null,r.createElement(HI,{label:"gRPC - Inbound Traffic",receivedRates:n.state.grpcReceivedIn,sentRates:n.state.grpcSentIn,unit:"messages"}),r.createElement(HI,{label:"gRPC - Outbound Traffic",receivedRates:n.state.grpcReceivedOut,sentRates:n.state.grpcSentOut,unit:"messages"})),i.rate>0&&r.createElement(r.Fragment,null,r.createElement(MI,{label:"HTTP - Inbound Request Traffic",dataRps:n.state.httpRequestIn,dataErrors:n.state.httpRequestErrIn}),r.createElement(MI,{label:"HTTP - Outbound Request Traffic",dataRps:n.state.httpRequestOut,dataErrors:n.state.httpRequestErrOut})),s.rate>0&&r.createElement(r.Fragment,null,r.createElement(HI,{label:"TCP - Inbound Traffic",receivedRates:n.state.tcpReceivedIn,sentRates:n.state.tcpSentIn,unit:"bytes"}),r.createElement(HI,{label:"TCP - Outbound Traffic",receivedRates:n.state.tcpReceivedOut,sentRates:n.state.tcpSentOut,unit:"bytes"})))},n.updateCharts=function(){var e=n.props,t=e.namespaces[0].name;if(t!==it){var a=n.graphTraffic,r=a.grpcTotal,i=a.httpTotal,o=a.isGrpcRequests,s=a.tcpTotal;n.metricsPromise&&(n.metricsPromise.cancel(),n.metricsPromise=void 0);var l=Promise.resolve({data:{}}),c=Promise.resolve({data:{}}),u=[];r.rate>0&&!o&&u.push("grpc_sent","grpc_received"),(i.rate>0||r.rate>0&&o)&&u.push("request_count","request_error_count"),s.rate>0&&u.push("tcp_sent","tcp_received"),u.length>0&&(l=an(t,{byLabels:["request_protocol"],direction:"inbound",duration:e.duration,filters:u,queryTime:e.queryTime,rateInterval:e.rateInterval,reporter:"destination",step:e.step}),c=an(t,{byLabels:["request_protocol"],direction:"outbound",duration:e.duration,filters:u,queryTime:e.queryTime,rateInterval:e.rateInterval,reporter:"source",step:e.step})),n.metricsPromise=br(Promise.all([l,c])),n.metricsPromise.promise.then((function(e){var t=function(e,t){return!t||e.request_protocol===t},a=e[0].data,r=e[1].data;n.setState({loading:!1,grpcReceivedIn:ew(a.grpc_received),grpcReceivedOut:ew(r.grpc_received),grpcRequestIn:tw(a.request_count,t,Le.GRPC),grpcRequestOut:tw(r.request_count,t,Le.GRPC),grpcRequestErrIn:tw(a.request_error_count,t,Le.GRPC),grpcRequestErrOut:tw(r.request_error_count,t,Le.GRPC),grpcSentIn:ew(a.grpc_sent),grpcSentOut:ew(r.grpc_sent),httpRequestIn:tw(a.request_count,t,Le.HTTP),httpRequestOut:tw(r.request_count,t,Le.HTTP),httpRequestErrIn:tw(a.request_error_count,t,Le.HTTP),httpRequestErrOut:tw(r.request_error_count,t,Le.HTTP),tcpReceivedIn:ew(a.tcp_received),tcpReceivedOut:ew(r.tcp_received),tcpSentIn:ew(a.tcp_sent),tcpSentOut:ew(r.tcp_sent)})})).catch((function(e){if(e.isCanceled)console.debug("SummaryPanelGraph: Ignore fetch error (canceled).");else{var t=e.response&&e.response.data.error?e.response.data.error:e.message;n.setState(Object(C.a)({loading:!1,metricsLoadError:t},Sw))}})),n.setState({loading:!0,metricsLoadError:null})}else n.setState({loading:!1})},n.updateValidations=function(){var e=new Map;A.a.chunk(n.props.namespaces,10).forEach((function(t){n.validationSummaryPromises.registerChained("validationSummaryChunks",void 0,(function(){return n.fetchValidationsChunk(t,e)})).then((function(){n.setState({validationsMap:e})}))}))},n.state=Object(C.a)({},Aw),n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.shouldShowCharts()&&(this.graphTraffic=this.getGraphTraffic(),this.updateCharts()),this.updateValidations()}},{key:"componentDidUpdate",value:function(e){XI(e,this.props)&&(this.shouldShowCharts()&&(this.graphTraffic=this.getGraphTraffic(),this.updateCharts()),this.updateValidations())}},{key:"componentWillUnmount",value:function(){this.metricsPromise&&this.metricsPromise.cancel(),this.validationSummaryPromises&&this.validationSummaryPromises.cancelAll()}},{key:"render",value:function(){var e=this.props.data.summaryTarget;if(!e)return null;var t=e.$('node[nodeType = "'.concat(Ze.SERVICE,'"]')).size(),n=e.$('node[nodeType = "'.concat(Ze.WORKLOAD,'"]')).size(),i=this.countApps(e),o=i.numApps,s=i.numVersions,l=e.edges().size(),c=this.graphTraffic||this.getGraphTraffic(),u=c.grpcIn,p=c.grpcOut,d=c.grpcTotal,m=c.httpIn,h=c.httpOut,f=c.httpTotal,g=c.isGrpcRequests,v=c.tcpIn,E=c.tcpOut,b=c.tcpTotal;return r.createElement("div",{className:"panel panel-default",style:a.panelStyle},r.createElement("div",{className:"panel-heading",style:KI},r.createElement("strong",null,"Current Graph:"),r.createElement("br",null),r.createElement("br",null),this.renderNamespacesSummary(),r.createElement("br",null),this.renderTopologySummary(t,n,o,s,l)),r.createElement("div",{className:qI},r.createElement(hT,{id:"graph_summary_tabs",defaultTab:0,style:{paddingBottom:"10px"}},r.createElement(bh.a,{style:YI,title:"Inbound",eventKey:0},r.createElement("div",{style:YI},0===u.rate&&0===m.rate&&0===v.rate&&r.createElement(r.Fragment,null,r.createElement(fi.Info,null)," No inbound traffic."),u.rate>0&&g&&r.createElement(xI,{isRequests:g,rate:u.rate,rateGrpcErr:u.rateGrpcErr,rateNR:u.rateNoResponse}),m.rate>0&&r.createElement(NI,{title:"HTTP (requests per second):",rate:m.rate,rate3xx:m.rate3xx,rate4xx:m.rate4xx,rate5xx:m.rate5xx,rateNR:m.rateNoResponse}),v.rate>0&&r.createElement(jI,{rate:v.rate}))),r.createElement(bh.a,{style:YI,title:"Outbound",eventKey:1},r.createElement("div",{style:YI},0===p.rate&&0===h.rate&&0===E.rate&&r.createElement(r.Fragment,null,r.createElement(fi.Info,null)," No outbound traffic."),p.rate>0&&r.createElement(xI,{isRequests:g,rate:p.rate,rateGrpcErr:p.rateGrpcErr,rateNR:p.rateNoResponse}),h.rate>0&&r.createElement(NI,{title:"HTTP (requests per second):",rate:h.rate,rate3xx:h.rate3xx,rate4xx:h.rate4xx,rate5xx:h.rate5xx,rateNR:h.rateNoResponse}),E.rate>0&&r.createElement(jI,{rate:E.rate}))),r.createElement(bh.a,{style:YI,title:"Total",eventKey:2},r.createElement("div",{style:YI},0===d.rate&&0===f.rate&&0===b.rate&&r.createElement(r.Fragment,null,r.createElement(fi.Info,null)," No traffic."),d.rate>0&&r.createElement(xI,{isRequests:g,rate:d.rate,rateGrpcErr:d.rateGrpcErr,rateNR:d.rateNoResponse}),f.rate>0&&r.createElement(NI,{title:"HTTP (requests per second):",rate:f.rate,rate3xx:f.rate3xx,rate4xx:f.rate4xx,rate5xx:f.rate5xx,rateNR:f.rateNoResponse}),b.rate>0&&r.createElement(jI,{rate:b.rate}),this.shouldShowCharts()&&r.createElement("div",null,QI(),this.renderCharts()))))))}},{key:"shouldShowCharts",value:function(){return 1===this.props.namespaces.length}},{key:"fetchValidationsChunk",value:function(e,t){return Promise.all(e.map((function(e){return on(e.name).then((function(t){return{validation:t.data,ns:e}}))}))).then((function(e){e.forEach((function(e){t[e.ns.name]=e.validation}))})).catch((function(e){e.isCanceled||console.log("SummaryPanelGraph: Error fetching validation status: ".concat(On(e)))}))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.data.summaryTarget!==t.graph?Object(C.a)({graph:e.data.summaryTarget,loading:!0},Sw):null}}]),a}(r.Component);Ow.panelStyle={height:"100%",margin:0,minWidth:"25em",overflowY:"auto",backgroundColor:nt.White,width:"25em"};var Iw=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props.inRateGrpcErr+this.props.inRateNR,t=this.props.outRateGrpcErr+this.props.outRateNR,a=0===this.props.inRate?0:e/this.props.inRate*100,n=0===this.props.outRate?0:t/this.props.outRate*100,i=100-a,o=100-n;return r.createElement("div",null,r.createElement("strong",null,this.props.title),r.createElement("table",{className:"table"},r.createElement("thead",null,r.createElement("tr",null,r.createElement("th",null),r.createElement("th",null,"Total"),r.createElement("th",null,"%Success"),r.createElement("th",null,"%Error"))),r.createElement("tbody",null,r.createElement("tr",null,r.createElement("td",null,"In"),r.createElement("td",null,this.props.inRate.toFixed(2)),r.createElement("td",null,i.toFixed(2)),r.createElement("td",null,a.toFixed(2))),r.createElement("tr",null,r.createElement("td",null,"Out"),r.createElement("td",null,this.props.outRate.toFixed(2)),r.createElement("td",null,o.toFixed(2)),r.createElement("td",null,n.toFixed(2))))),function(e,t,a,n){var i=[{name:"OK",dp:[{x:"In",y:e},{x:"Out",y:a}],color:nt.Success},{name:"Err",dp:[{x:"In",y:t},{x:"Out",y:n}],color:nt.Danger}].map((function(e){return{datapoints:e.dp.map((function(t){return Object(C.a)({name:e.name,color:e.color},t)})),color:e.color,legendItem:{name:e.name,symbol:{fill:e.color}}}}));return r.createElement(kI,{baseName:"in-out-rate-grpc",height:132,xLabelsWidth:25,series:i})}(i,a,o,n))}}]),a}(r.Component),ww=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props.inRate4xx+this.props.inRate5xx+this.props.inRateNR,t=this.props.outRate4xx+this.props.outRate5xx+this.props.outRateNR,a=0===this.props.inRate?0:e/this.props.inRate*100,n=0===this.props.outRate?0:t/this.props.outRate*100,i=100-a,o=100-n,s=0===this.props.inRate?0:this.props.inRate-this.props.inRate3xx-this.props.inRate4xx-this.props.inRate5xx-this.props.inRateNR,l=0===this.props.outRate?0:this.props.outRate-this.props.outRate3xx-this.props.outRate4xx-this.props.outRate5xx-this.props.outRateNR,c=0===this.props.inRate?0:s/this.props.inRate*100,u=0===this.props.inRate?0:this.props.inRate3xx/this.props.inRate*100,p=0===this.props.inRate?0:this.props.inRate4xx/this.props.inRate*100,d=0===this.props.inRate?0:this.props.inRate5xx/this.props.inRate*100,m=0===this.props.inRate?0:this.props.inRateNR/this.props.inRate*100,h=0===this.props.outRate?0:l/this.props.outRate*100,f=0===this.props.outRate?0:this.props.outRate3xx/this.props.outRate*100,g=0===this.props.outRate?0:this.props.outRate4xx/this.props.outRate*100,v=0===this.props.outRate?0:this.props.outRate5xx/this.props.outRate*100,E=0===this.props.outRate?0:this.props.outRateNR/this.props.outRate*100;return r.createElement("div",null,r.createElement("strong",null,this.props.title),r.createElement("table",{className:"table",style:{marginBottom:"10px"}},r.createElement("thead",null,r.createElement("tr",{style:{backgroundColor:"white"}},r.createElement("th",null),r.createElement("th",null,"Total"),r.createElement("th",null,"%Success"),r.createElement("th",null,"%Error"))),r.createElement("tbody",null,r.createElement("tr",null,r.createElement("td",null,"In"),r.createElement("td",null,this.props.inRate.toFixed(2)),r.createElement("td",null,i.toFixed(2)),r.createElement("td",null,a.toFixed(2))),r.createElement("tr",null,r.createElement("td",null,"Out"),r.createElement("td",null,this.props.outRate.toFixed(2)),r.createElement("td",null,o.toFixed(2)),r.createElement("td",null,n.toFixed(2))))),function(e,t,a,n,i,o,s,l,c,u){var p=[{name:"OK",dp:[{x:"In",y:e},{x:"Out",y:o}],color:nt.Success},{name:"3xx",dp:[{x:"In",y:t},{x:"Out",y:s}],color:nt.Info},{name:"4xx",dp:[{x:"In",y:a},{x:"Out",y:l}],color:nt.ChartWarning},{name:"5xx",dp:[{x:"In",y:n},{x:"Out",y:c}],color:nt.ChartDanger},{name:"No Response",dp:[{x:"In",y:i},{x:"Out",y:u}],color:nt.ChartOther}].map((function(e){return{datapoints:e.dp.map((function(t){return Object(C.a)({name:e.name,color:e.color},t)})),color:e.color,legendItem:{name:"No Response"===e.name?"NR":e.name,symbol:{fill:e.color}}}}));return r.createElement(kI,{baseName:"in-out-rate-http",height:80,xLabelsWidth:25,series:p})}(c,u,p,d,m,h,f,g,v,E))}}]),a}(r.Component),Rw={grpcRequestIn:[],grpcRequestOut:[],grpcRequestErrIn:[],grpcRequestErrOut:[],grpcSentIn:[],grpcSentOut:[],grpcReceivedIn:[],grpcReceivedOut:[],httpRequestIn:[],httpRequestOut:[],httpRequestErrIn:[],httpRequestErrOut:[],tcpSentIn:[],tcpSentOut:[],tcpReceivedIn:[],tcpReceivedOut:[]},kw=Object(C.a)({appBox:null,isOpen:!1,loading:!1,metricsLoadError:null},Rw),xw=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).metricsPromise=void 0,n.mainDivRef=void 0,n.onToggleActions=function(e){n.setState({isOpen:e})},n.updateCharts=function(e){var t=e.data.summaryTarget,a=Ov(t),r=JI(a),i=n.isGrpcRequests();if(n.metricsPromise&&(n.metricsPromise.cancel(),n.metricsPromise=void 0),n.hasGrpcTraffic(t)||n.hasHttpTraffic(t)||n.hasTcpTraffic(t)){var o=Promise.resolve({data:{}}),s=Promise.resolve({data:{}});if(n.hasHttpIn(t)||n.hasGrpcIn(t)&&i){o=ZI(r,t,e,["request_count","request_error_count"],"inbound","destination",void 0,void 0,["request_protocol"])}if(n.hasTcpIn(t)||n.hasGrpcIn(t)&&!i){var l=[];if(n.hasGrpcIn(t)&&!i&&l.push("grpc_sent","grpc_received"),n.hasTcpIn(t)&&l.push("tcp_sent","tcp_received"),l.length>0){var c=a.isOutside?["source_workload_namespace"]:[];s=ZI(r,t,e,l,"inbound","source",void 0,void 0,c)}}var u=$I([o,s]),p=Promise.resolve({data:{}});if(!a.isOutside){var d=[];if((n.hasHttpOut(t)||n.hasGrpcOut(t)&&i)&&d.push("request_count","request_error_count"),n.hasGrpcOut(t)&&!i&&d.push("grpc_sent","grpc_received"),n.hasTcpOut(t)&&d.push("tcp_sent","tcp_received"),d.length>0){var m=a.isIstio?"destination":"source",h=a.isOutside?["destination_service_namespace","request_protocol"]:["request_protocol"];p=ZI(r,t,e,d,"outbound",m,void 0,void 0,h)}}n.metricsPromise=br(Promise.all([p,u])),n.metricsPromise.promise.then((function(e){var t=a.isOutside?function(e,t){return!t||e.request_protocol===t}:function(e,t){return(!t||e.request_protocol===t)&&(!(e.destination_service_namespace&&!n.isActiveNamespace(e.destination_service_namespace))&&!(e.source_workload_namespace&&!n.isActiveNamespace(e.source_workload_namespace)))},r=e[0].data,i=e[1].data;n.setState({loading:!1,grpcRequestErrIn:tw(i.request_error_count,t,Le.GRPC),grpcRequestErrOut:tw(r.request_error_count,t,Le.GRPC),grpcReceivedIn:tw(i.grpc_received,t),grpcReceivedOut:tw(r.grpc_received,t),grpcRequestIn:tw(i.request_count,t,Le.GRPC),grpcRequestOut:tw(r.request_count,t,Le.GRPC),grpcSentIn:tw(i.grpc_sent,t),grpcSentOut:tw(r.grpc_sent,t),httpRequestErrIn:tw(i.request_error_count,t,Le.HTTP),httpRequestErrOut:tw(r.request_error_count,t,Le.HTTP),httpRequestIn:tw(i.request_count,t,Le.HTTP),httpRequestOut:tw(r.request_count,t,Le.HTTP),tcpReceivedOut:tw(r.tcp_received,t),tcpReceivedIn:tw(i.tcp_received,t),tcpSentIn:tw(i.tcp_sent,t),tcpSentOut:tw(r.tcp_sent,t)})})).catch((function(e){if(e.isCanceled)console.debug("SummaryPanelAppBox: Ignore fetch error (canceled).");else{var t=e.response&&e.response.data.error?e.response.data.error:e.message;n.setState(Object(C.a)({loading:!1,metricsLoadError:t},Rw))}})),n.setState({loading:!0,metricsLoadError:null})}else n.setState({loading:!1})},n.isActiveNamespace=function(e){if(!e)return!1;var t,a=Object($t.a)(n.props.namespaces);try{for(a.s();!(t=a.n()).done;){if(t.value.name===e)return!0}}catch(r){a.e(r)}finally{a.f()}return!1},n.renderBadgeSummary=function(e){var t=!0===e.data(Bg),a=!0===e.data(Xg);return e.children("node[".concat(Bg,"],[").concat(Xg,"]")).nodes().forEach((function(e){t=t||e.data(Bg),a=a||e.data(Xg)})),r.createElement("div",{style:{marginTop:"10px",marginBottom:"10px"}},t&&r.createElement("div",null,r.createElement(fi.CircuitBreaker,null),r.createElement("span",{style:{paddingLeft:"4px"}},"Has Circuit Breaker")),a&&r.createElement("div",null,r.createElement(fi.VirtualService,null),r.createElement("span",{style:{paddingLeft:"4px"}},"Has Virtual Service")))},n.renderGrpcRequests=function(e){var t=e.children('node[nodeType != "'.concat(Ze.SERVICE,'"][nodeType != "').concat(Ze.AGGREGATE,'"]')),a=hw(t.incomers("edge")),n=hw(t.edgesTo("*"));return r.createElement(r.Fragment,null,r.createElement(Iw,{title:"GRPC Traffic (requests per second):",inRate:a.rate,inRateGrpcErr:a.rateGrpcErr,inRateNR:a.rateNoResponse,outRate:n.rate,outRateGrpcErr:n.rateGrpcErr,outRateNR:n.rateNoResponse}))},n.renderHttpRequests=function(e){var t=e.children('node[nodeType != "'.concat(Ze.SERVICE,'"][nodeType != "').concat(Ze.AGGREGATE,'"]')),a=Ew(t.incomers("edge")),n=Ew(t.edgesTo("*"));return r.createElement(r.Fragment,null,r.createElement(ww,{title:"HTTP (requests per second):",inRate:a.rate,inRate3xx:a.rate3xx,inRate4xx:a.rate4xx,inRate5xx:a.rate5xx,inRateNR:a.rateNoResponse,outRate:n.rate,outRate3xx:n.rate3xx,outRate4xx:n.rate4xx,outRate5xx:n.rate5xx,outRateNR:n.rateNoResponse}))},n.renderSparklines=function(e){if(n.state.loading)return r.createElement("strong",null,"Loading charts...");if(n.state.metricsLoadError)return r.createElement("div",null,r.createElement(fi.Warning,null)," ",r.createElement("strong",null,"Error loading metrics: "),n.state.metricsLoadError);var t,a,i,o=n.hasGrpcTraffic(e),s=o&&n.isGrpcRequests(),l=o&&n.hasGrpcIn(e),c=o&&n.hasGrpcOut(e),u=n.hasHttpTraffic(e),p=u&&n.hasHttpIn(e),d=u&&n.hasHttpOut(e),m=n.hasTcpTraffic(e),h=m&&n.hasTcpIn(e),f=m&&n.hasTcpOut(e);return o&&(t=s?r.createElement(r.Fragment,null,l&&r.createElement(MI,{key:"grpc-inbound-request",label:"gRPC - Inbound Request Traffic",dataRps:n.state.grpcRequestIn,dataErrors:n.state.grpcRequestErrIn}),c&&r.createElement(MI,{key:"grpc-outbound-request",label:"gRPC - Outbound Request Traffic",dataRps:n.state.grpcRequestOut,dataErrors:n.state.grpcRequestErrOut})):r.createElement(r.Fragment,null,l&&r.createElement(HI,{label:"gRPC - Inbound Traffic",receivedRates:n.state.grpcReceivedIn,sentRates:n.state.grpcSentIn,unit:"messages"}),c&&r.createElement(HI,{label:"gRPC - Outbound Traffic",receivedRates:n.state.grpcReceivedOut,sentRates:n.state.grpcSentOut,unit:"messages"}))),u&&(a=r.createElement(r.Fragment,null,p&&r.createElement(MI,{key:"http-inbound-request",label:"HTTP - Inbound Request Traffic",dataRps:n.state.httpRequestIn,dataErrors:n.state.httpRequestErrIn}),d&&r.createElement(MI,{key:"http-outbound-request",label:"HTTP - Outbound Request Traffic",dataRps:n.state.httpRequestOut,dataErrors:n.state.httpRequestErrOut}))),m&&(i=r.createElement(r.Fragment,null,h&&r.createElement(HI,{key:"tcp-inbound-request",label:"TCP - Inbound Traffic",receivedRates:n.state.tcpReceivedIn,sentRates:n.state.tcpSentIn,unit:"bytes"}),f&&r.createElement(HI,{key:"tcp-outbound-request",label:"TCP - Outbound Traffic",receivedRates:n.state.tcpReceivedOut,sentRates:n.state.tcpSentOut,unit:"bytes"}))),r.createElement(r.Fragment,null,t,a,i)},n.renderServiceList=function(e){var t=[];return e.children('node[nodeType = "'.concat(Ze.SERVICE,'"]')).forEach((function(a){var n=Ov(a);t.push(BI(n,Ze.SERVICE));var i=e.children('node[nodeType = "'.concat(Ze.AGGREGATE,'"][service = "').concat(n.service,'"]'));if(i&&i.length>0){var o=[];i.forEach((function(e){var t=Ov(e);o.push(BI(t,Ze.AGGREGATE))})),t.push(r.createElement("div",null,o))}})),t},n.renderWorkloadList=function(e){var t=[];return e.children("node[workload]").forEach((function(e){var a=Ov(e);t.push(BI(a,Ze.WORKLOAD))})),t},n.isGrpcRequests=function(){return n.props.trafficRates.includes(ze.GRPC_REQUEST)},n.hasGrpcTraffic=function(e){return e.children().filter('[nodeType != "service"]').filter("[grpcIn > 0],[grpcOut > 0]").size()>0},n.hasGrpcIn=function(e){return e.children().filter('[nodeType != "service"]').filter("[grpcIn > 0]").size()>0},n.hasGrpcOut=function(e){return e.children().filter('[nodeType != "service"]').filter("[grpcOut > 0]").size()>0},n.hasHttpTraffic=function(e){return e.children().filter('[nodeType != "service"]').filter("[httpIn > 0],[httpOut > 0]").size()>0},n.hasHttpIn=function(e){return e.children().filter('[nodeType != "service"]').filter("[httpIn > 0]").size()>0},n.hasHttpOut=function(e){return e.children().filter('[nodeType != "service"]').filter("[httpOut > 0]").size()>0},n.hasTcpTraffic=function(e){return e.children().filter('[nodeType != "service"]').filter("[tcpIn > 0],[tcpOut > 0]").size()>0},n.hasTcpIn=function(e){return e.children().filter('[nodeType != "service"]').filter("[tcpIn > 0]").size()>0},n.hasTcpOut=function(e){return e.children().filter('[nodeType != "service"]').filter("[tcpOut > 0]").size()>0},n.state=Object(C.a)({},kw),n.mainDivRef=r.createRef(),n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.updateCharts(this.props)}},{key:"componentDidUpdate",value:function(e){e.data.summaryTarget!==this.props.data.summaryTarget&&this.mainDivRef.current&&(this.mainDivRef.current.scrollTop=0),XI(e,this.props)&&this.updateCharts(this.props)}},{key:"componentWillUnmount",value:function(){this.metricsPromise&&this.metricsPromise.cancel()}},{key:"render",value:function(){var e=this.props.data.summaryTarget,t=Ov(e),a=this.renderServiceList(e),n=this.renderWorkloadList(e),i=this.hasGrpcTraffic(e),o=i&&this.isGrpcRequests(),s=i&&this.hasGrpcIn(e),l=i&&this.hasGrpcOut(e),c=this.hasHttpTraffic(e),u=c&&this.hasHttpIn(e),p=c&&this.hasHttpOut(e),d=this.hasTcpTraffic(e),m=d&&this.hasTcpIn(e),h=d&&this.hasTcpOut(e),f=og(t).map((function(e){return r.createElement(up.a,{key:e.text,onClick:function(){return ig(e)}},e.text," ","_blank"===e.target&&r.createElement(Jf.a,null))})),g=f.length>0?[r.createElement(cp.a,{label:"Show",className:"kiali-appbox-menu",children:f})]:void 0;return r.createElement("div",{ref:this.mainDivRef,className:"panel panel-default ".concat(zI)},r.createElement("div",{className:"panel-heading",style:KI},r.createElement("div",null,BI(t),g&&r.createElement(Ru.a,{id:"summary-appbox-actions",isPlain:!0,style:{float:"right"},dropdownItems:g,isOpen:this.state.isOpen,position:pp.d.right,toggle:r.createElement(Wf.a,{id:"summary-appbox-kebab",onToggle:this.onToggleActions}),isGrouped:!0})),r.createElement("div",null,WI(t.health)),r.createElement("div",null,this.renderBadgeSummary(e),a.length>0&&r.createElement("div",null,a),n.length>0&&r.createElement("div",null," ",n))),r.createElement("div",{className:"panel-body"},i&&o&&r.createElement(r.Fragment,null,this.renderGrpcRequests(e),QI()),c&&r.createElement(r.Fragment,null,this.renderHttpRequests(e),QI()),r.createElement("div",null,this.renderSparklines(e),QI()),i&&!s&&aw("gRPC inbound"),i&&!l&&aw("gRPC outbound"),!i&&aw("gRPC"),c&&!u&&aw("HTTP inbound"),c&&!p&&aw("HTTP outbound"),!c&&aw("HTTP"),d&&!m&&aw("TCP inbound"),d&&!h&&aw("TCP outbound"),!d&&aw("TCP")))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.data.summaryTarget!==t.appBox?Object(C.a)({appBox:e.data.summaryTarget,loading:!0},Rw):null}}]),a}(r.Component),Nw=a(1513),jw={grpcRequestCountIn:[],grpcRequestCountOut:[],grpcErrorCountIn:[],grpcErrorCountOut:[],grpcSentIn:[],grpcSentOut:[],grpcReceivedIn:[],grpcReceivedOut:[],httpRequestCountIn:[],httpRequestCountOut:[],httpErrorCountIn:[],httpErrorCountOut:[],tcpSentIn:[],tcpSentOut:[],tcpReceivedIn:[],tcpReceivedOut:[]},Pw=Object(C.a)({node:null,loading:!1,metricsLoadError:null},jw),Lw=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).metricsPromise=void 0,n.isActiveNamespace=function(e){if(!e)return!1;var t,a=Object($t.a)(n.props.namespaces);try{for(a.s();!(t=a.n()).done;){if(t.value.name===e)return!0}}catch(r){a.e(r)}finally{a.f()}return!1},n.renderGrpcRates=function(e){var t=mw(e),a=hw(n.props.data.summaryTarget.edgesTo("*"));return r.createElement(r.Fragment,null,r.createElement(Iw,{title:"gRPC Traffic (requests per second):",inRate:t.rate,inRateGrpcErr:t.rateGrpcErr,inRateNR:t.rateNoResponse,outRate:a.rate,outRateGrpcErr:a.rateGrpcErr,outRateNR:a.rateNoResponse}))},n.renderHttpRates=function(e){var t=vw(e),a=Ew(n.props.data.summaryTarget.edgesTo("*"));return r.createElement(r.Fragment,null,r.createElement(ww,{title:"HTTP (requests per second):",inRate:t.rate,inRate3xx:t.rate3xx,inRate4xx:t.rate4xx,inRate5xx:t.rate5xx,inRateNR:t.rateNoResponse,outRate:a.rate,outRate3xx:a.rate3xx,outRate4xx:a.rate4xx,outRate5xx:a.rate5xx,outRateNR:a.rateNoResponse}))},n.renderSparklines=function(e){var t=Ov(e);if(Ze.UNKNOWN===t.nodeType)return r.createElement(r.Fragment,null,r.createElement("div",null,r.createElement(fi.Info,null)," Sparkline charts not supported for unknown node. Use edge for details."));if(t.isInaccessible)return r.createElement(r.Fragment,null,r.createElement("div",null,r.createElement(fi.Info,null)," Sparkline charts cannot be shown because the selected node is inaccessible."));if(t.isServiceEntry)return r.createElement(r.Fragment,null,r.createElement("div",null,r.createElement(fi.Info,null)," Sparkline charts cannot be shown because the selected node is a serviceEntry."));if(n.state.loading)return r.createElement("strong",null,"Loading charts...");if(n.state.metricsLoadError)return r.createElement("div",null,r.createElement(fi.Warning,null)," ",r.createElement("strong",null,"Error loading metrics: "),n.state.metricsLoadError);var a,i,o,s=t.nodeType===Ze.SERVICE,l=s||t.nodeType===Ze.AGGREGATE,c=!1;return s&&e.incomers().forEach((function(e){if(Ze.UNKNOWN===e.data(hv))return c=!0,!1})),n.hasGrpcTraffic(t)&&(a=n.isGrpcRequests()?r.createElement(r.Fragment,null,n.hasGrpcIn(t)&&r.createElement(r.Fragment,null,r.createElement(MI,{label:l?"gRPC - Request Traffic":"gRPC - Inbound Request Traffic",dataRps:n.state.grpcRequestCountIn,dataErrors:n.state.grpcErrorCountIn}),c&&r.createElement(r.Fragment,null,r.createElement("div",null,r.createElement(fi.Info,null)," Traffic from unknown not included. Use edge for details."))),n.hasGrpcIn(t)&&r.createElement(r.Fragment,null,r.createElement(MI,{label:"gRPC - Outbound Request Traffic",dataRps:n.state.grpcRequestCountOut,dataErrors:n.state.grpcErrorCountOut,hide:l}),n.isIstioOutboundCornerCase(e)&&r.createElement(r.Fragment,null,r.createElement("div",null,r.createElement(fi.Info,null)," Traffic to Istio namespaces not included. Use edge for details.")))):r.createElement(r.Fragment,null,n.hasGrpcIn(t)&&r.createElement(HI,{label:l?"gRPC - Traffic":"gRPC - Inbound Traffic",receivedRates:n.state.grpcReceivedIn,sentRates:n.state.grpcSentIn,unit:"messages"}),n.hasGrpcOut(t)&&r.createElement(HI,{label:"gRPC - Outbound Traffic",receivedRates:n.state.grpcReceivedOut,sentRates:n.state.grpcSentOut,hide:l,unit:"messages"}))),n.hasHttpTraffic(t)&&(i=r.createElement(r.Fragment,null,n.hasHttpIn(t)&&r.createElement(r.Fragment,null,r.createElement(MI,{label:l?"HTTP - Request Traffic":"HTTP - Inbound Request Traffic",dataRps:n.state.httpRequestCountIn,dataErrors:n.state.httpErrorCountIn}),c&&r.createElement(r.Fragment,null,r.createElement("div",null,r.createElement(fi.Info,null)," Traffic from unknown not included. Use edge for details."))),n.hasHttpOut(t)&&r.createElement(r.Fragment,null,r.createElement(MI,{label:"HTTP - Outbound Request Traffic",dataRps:n.state.httpRequestCountOut,dataErrors:n.state.httpErrorCountOut,hide:l}),n.isIstioOutboundCornerCase(e)&&r.createElement(r.Fragment,null,r.createElement("div",null,r.createElement(fi.Info,null),'" Traffic to Istio namespaces not included. Use edge for details.'))))),n.hasTcpTraffic(t)&&(o=r.createElement(r.Fragment,null,n.hasTcpIn(t)&&r.createElement(HI,{label:l?"TCP - Traffic":"TCP - Inbound Traffic",receivedRates:n.state.tcpReceivedIn,sentRates:n.state.tcpSentIn,unit:"bytes"}),n.hasTcpOut(t)&&r.createElement(HI,{label:"TCP - Outbound Traffic",receivedRates:n.state.tcpReceivedOut,sentRates:n.state.tcpSentOut,hide:l,unit:"bytes"}))),r.createElement(r.Fragment,null,a,i,o)},n.isServiceDestCornerCase=function(e){return e===yO.SERVICE&&!n.props.injectServiceNodes&&n.props.graphType!==Xe.SERVICE},n.isIstioOutboundCornerCase=function(e){var t=Ov(e);return t.nodeType!==Ze.UNKNOWN&&!t.isIstio&&e.edgesTo("node[?".concat(cv,"]")).size()>0},n.hasGrpcTraffic=function(e){return n.hasGrpcIn(e)||n.hasGrpcOut(e)},n.isGrpcRequests=function(){return n.props.trafficRates.includes(ze.GRPC_REQUEST)},n.hasHttpTraffic=function(e){return n.hasHttpIn(e)||n.hasHttpOut(e)},n.hasTcpTraffic=function(e){return n.hasTcpIn(e)||n.hasTcpOut(e)},n.hasGrpcIn=function(e){return e.grpcIn>0},n.hasHttpIn=function(e){return e.httpIn>0},n.hasTcpIn=function(e){return e.tcpIn>0},n.hasGrpcOut=function(e){return e.grpcOut>0},n.hasHttpOut=function(e){return e.httpOut>0},n.hasTcpOut=function(e){return e.tcpOut>0},n.showTrafficMetrics=n.showTrafficMetrics.bind(Object(gu.a)(n)),n.state=Object(C.a)({},Pw),n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.updateCharts(this.props)}},{key:"componentDidUpdate",value:function(e){XI(e,this.props)&&this.updateCharts(this.props)}},{key:"componentWillUnmount",value:function(){this.metricsPromise&&this.metricsPromise.cancel()}},{key:"updateCharts",value:function(e){var t=this,a=e.data.summaryTarget,n=Ov(a),r=JI(n),i=this.isGrpcRequests();if(this.metricsPromise&&(this.metricsPromise.cancel(),this.metricsPromise=void 0),this.hasGrpcTraffic(n)||this.hasHttpTraffic(n)||this.hasTcpTraffic(n))if(n.isInaccessible)this.setState({loading:!1});else{var o=Promise.resolve({data:{}}),s=Promise.resolve({data:{}});if(!n.isRoot){var l=this.isServiceDestCornerCase(r),c=Promise.resolve({data:{}}),u=Promise.resolve({data:{}});if(this.hasHttpIn(n)||this.hasGrpcIn(n)&&i){var p=n.nodeType===Ze.SERVICE&&n.isIstio?"source":"destination",d=l?["destination_workload","request_protocol"]:["request_protocol"];n.isOutside&&d.push("source_workload_namespace"),c=ZI(r,a,e,["request_count","request_error_count"],"inbound",p,void 0,void 0,d)}if(n.nodeType!==Ze.AGGREGATE){var m=[];if(this.hasGrpcIn(n)&&m.push("grpc_sent","grpc_received"),this.hasTcpIn(n)&&m.push("tcp_sent","tcp_received"),m.length>0){var h=l?["destination_workload"]:[];n.isOutside&&h.push("source_workload_namespace"),u=ZI(r,a,e,m,"inbound","source",void 0,void 0,h)}}o=$I([c,u])}if(!([Ze.SERVICE,Ze.AGGREGATE].includes(n.nodeType)||n.isOutside&&!n.isRoot)){var f=[];if((this.hasHttpOut(n)||this.hasGrpcOut(n)&&i)&&f.push("request_count","request_error_count"),this.hasGrpcOut(n)&&!i&&f.push("grpc_sent","grpc_received"),this.hasTcpOut(n)&&f.push("tcp_sent","tcp_received"),f.length>0){var g=n.nodeType===Ze.UNKNOWN||n.isIstio?"destination":"source",v=n.isOutside?["destination_service_namespace","request_protocol"]:["request_protocol"];s=ZI(r,a,e,f,"outbound",g,void 0,void 0,v)}}this.metricsPromise=br(Promise.all([s,o])),this.metricsPromise.promise.then((function(e){t.showTrafficMetrics(e[0].data,e[1].data,n,r)})).catch((function(e){if(e.isCanceled)console.debug("SummaryPanelNode: Ignore fetch error (canceled).");else{var a=e.response&&e.response.data.error?e.response.data.error:e.message;t.setState(Object(C.a)({loading:!1,metricsLoadError:a},jw))}})),this.setState({loading:!0,metricsLoadError:null})}else this.setState({loading:!1})}},{key:"showTrafficMetrics",value:function(e,t,a,n){var r=this,i=function(e,t){return!t||e.request_protocol===t};this.isServiceDestCornerCase(n)?i=function(e,t){return(!t||e.request_protocol===t)&&e.destination_workload===it}:a.isOutside&&(i=function(e,t){return(!t||e.request_protocol===t)&&(!(e.destination_service_namespace&&!r.isActiveNamespace(e.destination_service_namespace))&&!(e.source_workload_namespace&&!r.isActiveNamespace(e.source_workload_namespace)))});var o=e.request_count,s=e.request_error_count,l=e.grpc_sent,c=e.grpc_received,u=e.tcp_sent,p=e.tcp_received,d=t.request_count,m=t.request_error_count,h=t.grpc_sent,f=t.grpc_received,g=t.tcp_sent,v=t.tcp_received;this.setState({loading:!1,grpcErrorCountIn:tw(m,i,Le.GRPC),grpcErrorCountOut:tw(s,i,Le.GRPC),grpcReceivedIn:tw(f,i),grpcReceivedOut:tw(c,i),grpcRequestCountIn:tw(d,i,Le.GRPC),grpcRequestCountOut:tw(o,i,Le.GRPC),grpcSentIn:tw(h,i),grpcSentOut:tw(l,i),httpErrorCountIn:tw(m,i,Le.HTTP),httpErrorCountOut:tw(s,i,Le.HTTP),httpRequestCountIn:tw(d,i,Le.HTTP),httpRequestCountOut:tw(o,i,Le.HTTP),tcpReceivedIn:tw(v,i),tcpReceivedOut:tw(p,i),tcpSentIn:tw(g,i),tcpSentOut:tw(u,i)})}},{key:"render",value:function(){var e=this.props.data.summaryTarget,t=Ov(e),a=this.hasGrpcTraffic(t),n=a&&this.hasGrpcIn(t),i=a&&this.hasGrpcOut(t),o=this.hasHttpTraffic(t),s=o&&this.hasHttpIn(t),l=o&&this.hasHttpOut(t),c=this.hasTcpTraffic(t),u=c&&this.hasTcpIn(t),p=c&&this.hasTcpOut(t);return r.createElement(r.Fragment,null,a&&this.isGrpcRequests()&&r.createElement(r.Fragment,null,this.renderGrpcRates(e),QI()),o&&r.createElement(r.Fragment,null,this.renderHttpRates(e),QI()),r.createElement("div",null,this.renderSparklines(e),QI()),a&&!n&&aw("gRPC inbound"),a&&!i&&aw("gRPC outbound"),!a&&aw("gRPC"),o&&!s&&aw("HTTP inbound"),o&&!l&&aw("HTTP outbound"),!o&&aw("HTTP"),c&&!u&&aw("TCP inbound"),c&&!p&&aw("TCP outbound"),!c&&aw("TCP"))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.data.summaryTarget!==t.node?Object(C.a)({node:e.data.summaryTarget,loading:!0},jw):null}}]),a}(r.Component),Dw=a(855),Fw=a(1512),_w=Object(Jn.a)({fontSize:"var(--graph-side-panel--font-size)",lineHeight:1.3}),Mw=Object(Jn.a)({display:"inline-block",maxWidth:175,textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"}),Hw=Object(Jn.a)({color:nt.Danger}),Gw=Object(Jn.a)({color:nt.Black600}),Vw=Object(Jn.a)({color:nt.Black600,float:"right"}),Uw=function(e){var t=new CC(e.trace),a=t.hasErrors()?Mw+" "+Hw:Mw;return r.createElement(lo.a,{content:r.createElement(r.Fragment,null,t.name(),r.createElement("span",{className:bC},t.shortID()))},r.createElement("div",{className:_w},r.createElement("span",{className:a},t.name()),t.duration()?r.createElement("span",{className:Vw},t.duration()):"",r.createElement("br",null),r.createElement("span",{className:Gw},Object(HC.pluralize)(e.trace.spans.length,"Span")),r.createElement("span",{className:Vw},t.fromNow())))},Bw=Object(Jn.a)({display:"inline-flex",width:"100%"}),Ww=Object(Jn.a)({paddingBottom:10,$nest:{"& > label":{fontSize:"var(--graph-side-panel--font-size)",paddingTop:"4px"}}}),qw=Object(Jn.a)({padding:"2px 10px",margin:"5px 0 5px auto",top:-4}),Kw=Object(Jn.a)({paddingBottom:"3px"}),zw=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).promises=new yr,n.state={traces:[],useGraphRefresh:!1},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.loadTraces()}},{key:"componentDidUpdate",value:function(e){(this.state.useGraphRefresh&&e.queryTime!==this.props.queryTime||e.nodeData.namespace!==this.props.nodeData.namespace||e.nodeData.app!==this.props.nodeData.app||e.nodeData.workload!==this.props.nodeData.workload||e.nodeData.service!==this.props.nodeData.service)&&this.loadTraces()}},{key:"componentWillUnmount",value:function(){this.promises.cancelAll()}},{key:"loadTraces",value:function(){var e=this,t={startMicros:1e6*this.props.queryTime,limit:15},a=this.props.nodeData,n=a.workload?Sn(a.namespace,a.workload,t):a.service?Cn(a.namespace,a.service,t):yn(a.namespace,a.app,t);this.promises.cancelAll(),this.promises.register("traces",n).then((function(t){var a=t.data.data?t.data.data.map((function(e){return NE(e)})).filter((function(e){return null!==e})):[];e.props.selectedTrace&&!a.some((function(t){return t.traceID===e.props.selectedTrace.traceID}))&&a.push(e.props.selectedTrace),e.setState({traces:a})})).catch((function(e){_n("Could not fetch traces.",e)}))}},{key:"onClickTrace",value:function(e){var t;(null===(t=this.props.selectedTrace)||void 0===t?void 0:t.traceID)===e.traceID?this.props.setTraceId(void 0):this.props.setTraceId(e.traceID)}},{key:"render",value:function(){var e,t=this,a=this.props.nodeData,n="/namespaces/".concat(a.namespace)+(a.workload?"/workloads/".concat(a.workload):a.service?"/services/".concat(a.service):"/applications/".concat(a.app))+"?tab=traces",i=null===(e=this.props.selectedTrace)||void 0===e?void 0:e.traceID;return r.createElement("div",{style:{marginBottom:8}},r.createElement("div",{className:Bw},r.createElement(PS.a,{id:"use-graph-refresh",label:"Use graph refresh",className:Ww,isChecked:this.state.useGraphRefresh,onChange:function(e){return t.setState({useGraphRefresh:e})}}),r.createElement(vr.a,{id:"manual-refresh",isDisabled:this.state.useGraphRefresh,onClick:function(){return t.loadTraces()},"aria-label":"Refresh",variant:"secondary",className:qw},r.createElement(ql.a,null))),r.createElement(wu.a,{className:Kw}),this.state.traces.length>0&&r.createElement(Dw.a,{style:{marginBottom:8},"aria-label":"Traces list"},this.state.traces.map((function(e){return r.createElement(Fw.a,{key:"trace_"+e.traceID,onClick:function(){return t.onClickTrace(e)},isCurrent:e.traceID===i},r.createElement(Uw,{trace:e}))}))),r.createElement(vr.a,{style:YI,onClick:function(){return U.push(n)}},"Show Traces"))}}],[{key:"getDerivedStateFromProps",value:function(e,t){if(e.selectedTrace){var a=t.traces.findIndex((function(t){return t.traceID===e.selectedTrace.traceID}));a>=0&&(t.traces[a]=e.selectedTrace)}return t}}]),a}(r.Component),Yw=Object(h.b)((function(e){return{selectedTrace:e.jaegerState.selectedTrace}}),(function(e){return{setTraceId:function(t){return e(AC(t))}}}))(zw),Qw={isActionOpen:!1},Xw=Object(Jn.a)({fontSize:"var(--graph-side-panel--font-size)",$nest:{"& > div":{marginLeft:"2em",marginTop:"0 !important",$nest:{"& div":{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}}}}}),Jw=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).mainDivRef=void 0,n.renderGatewayHostnames=function(e){var t,a;return n.renderHostnamesSection(null===(t=e.isGateway)||void 0===t||null===(a=t.ingressInfo)||void 0===a?void 0:a.hostnames)},n.renderVsHostnames=function(e){var t;return n.renderHostnamesSection(null===(t=e.hasVS)||void 0===t?void 0:t.hostnames)},n.renderHostnamesSection=function(e){var t=e.length,a="".concat(t," hosts");return 1===t&&(a="1 host"),r.createElement(Nw.a,{toggleText:a,className:Xw},e.map((function(e){return r.createElement("div",{key:e,title:e},"*"===e?"* (all hosts)":e)})))},n.onToggleActions=function(e){n.setState({isActionOpen:e})},n.renderBadgeSummary=function(e){var t,a,i,o,s=e.hasCB,l=e.hasFaultInjection,c=e.hasMissingSC,u=e.hasRequestRouting,p=e.hasRequestTimeout,d=e.hasTCPTrafficShifting,m=e.hasTrafficShifting,h=e.hasVS,f=e.isDead,g=e.isGateway,v=u||l||m||d||p,E=void 0!==(null===(t=e.isGateway)||void 0===t||null===(a=t.ingressInfo)||void 0===a?void 0:a.hostnames)&&0!==e.isGateway.ingressInfo.hostnames.length,b=void 0!==(null===(i=e.hasVS)||void 0===i?void 0:i.hostnames)&&0!==(null===(o=e.hasVS)||void 0===o?void 0:o.hostnames.length);return r.createElement("div",{style:{marginTop:"10px",marginBottom:"10px"}},s&&r.createElement("div",null,r.createElement(fi.CircuitBreaker,null),r.createElement("span",{style:{paddingLeft:"4px"}},"Has Circuit Breaker")),h&&!v&&r.createElement(r.Fragment,null,r.createElement("div",null,r.createElement(fi.VirtualService,null),r.createElement("span",{style:{paddingLeft:"4px"}},"Has Virtual Service")),b&&n.renderVsHostnames(e)),c&&r.createElement("div",null,r.createElement(fi.MissingSidecar,null),r.createElement("span",{style:{paddingLeft:"4px"}},"Has Missing Sidecar")),f&&r.createElement("div",null,r.createElement("span",{style:{marginRight:"5px"}},r.createElement(fi.Info,null)),r.createElement("span",{style:{paddingLeft:"4px"}},"Has No Running Pods")),u&&r.createElement(r.Fragment,null,r.createElement("div",null,r.createElement(fi.RequestRouting,null),r.createElement("span",{style:{paddingLeft:"4px"}},"Has Request Routing")),b&&n.renderVsHostnames(e)),l&&r.createElement("div",null,r.createElement(fi.FaultInjection,null),r.createElement("span",{style:{paddingLeft:"4px"}},"Has Fault Injection")),m&&r.createElement("div",null,r.createElement(fi.TrafficShifting,null),r.createElement("span",{style:{paddingLeft:"4px"}},"Has Traffic Shifting")),d&&r.createElement("div",null,r.createElement(fi.TrafficShifting,null),r.createElement("span",{style:{paddingLeft:"4px"}},"Has TCP Traffic Shifting")),p&&r.createElement("div",null,r.createElement(fi.RequestTimeout,null),r.createElement("span",{style:{paddingLeft:"4px"}},"Has Request Timeout")),g&&r.createElement(r.Fragment,null,r.createElement("div",null,r.createElement(fi.Gateway,null),r.createElement("span",{style:{paddingLeft:"4px"}},"Is Gateway")),E&&n.renderGatewayHostnames(e)))},n.renderDestServices=function(e){var t=e.destServices,a=[];return t?(t.forEach((function(e){var t;a.push((t=e.name,r.createElement("div",null,r.createElement(pc,{badge:cc.Host}),"*"===t?"* (all hosts)":t)))})),a):a},n.state=Object(C.a)({},Qw),n.mainDivRef=r.createRef(),n}return Object(l.a)(a,[{key:"componentDidUpdate",value:function(e){e.data.summaryTarget!==this.props.data.summaryTarget&&this.mainDivRef.current&&(this.mainDivRef.current.scrollTop=0)}},{key:"render",value:function(){var e=this.props.data.summaryTarget,t=Ov(e),a=t.nodeType,n=t.app,i=t.service,o=t.workload,s=t.isServiceEntry,l=a!==Ze.SERVICE&&function(e){var t=Ov(e),a=e.data(Mg),n=[];return a?(a.forEach((function(e){var a={id:t.id,app:"",cluster:e.cluster,isInaccessible:t.isInaccessible,isOutside:t.isOutside,isRoot:t.isRoot,isServiceEntry:t.isServiceEntry,namespace:t.isServiceEntry?t.isServiceEntry.namespace:t.namespace,nodeType:Ze.SERVICE,service:e.name,version:"",workload:""};n.push(BI(a))})),n):n}(e),c=a===Ze.SERVICE&&s&&this.renderDestServices(t),u=c&&c.length>0,p=l&&l.length>0,d=i&&![Ze.SERVICE,Ze.UNKNOWN].includes(a),m=n&&![Ze.APP,Ze.UNKNOWN].includes(a),h=o&&![Ze.WORKLOAD,Ze.UNKNOWN].includes(a),f=!s&&!t.isInaccessible&&this.props.jaegerState.info&&this.props.jaegerState.info.enabled&&this.props.jaegerState.info.integration,g=og(t,this.props.jaegerState.info).map((function(e){return r.createElement(up.a,{key:e.text,onClick:function(){return ig(e)}},e.text," ","_blank"===e.target&&r.createElement(Jf.a,null))})),v=g.length>0?[r.createElement(cp.a,{label:"Show",className:"kiali-group-menu",children:g})]:void 0;return r.createElement("div",{ref:this.mainDivRef,className:"panel panel-default ".concat(zI)},r.createElement("div",{className:"panel-heading",style:KI},r.createElement("div",null,BI(t),v&&r.createElement(Ru.a,{id:"summary-node-actions",style:{float:"right"},isPlain:!0,dropdownItems:v,isOpen:this.state.isActionOpen,position:pp.d.right,toggle:r.createElement(Wf.a,{id:"summary-node-kebab",onToggle:this.onToggleActions})})),r.createElement("div",null,WI(t.health)),r.createElement("div",null,this.renderBadgeSummary(t),u&&r.createElement("div",null,c),p&&r.createElement("div",null,l),d&&r.createElement("div",null,BI(t,Ze.SERVICE)),m&&r.createElement("div",null,BI(t,Ze.APP)),h&&r.createElement("div",null,BI(t,Ze.WORKLOAD)))),f?this.renderWithTabs(t):this.renderTrafficOnly())}},{key:"renderTrafficOnly",value:function(){return r.createElement("div",{className:"panel-body"},r.createElement(Lw,this.props))}},{key:"renderWithTabs",value:function(e){return r.createElement("div",{className:qI},r.createElement(hT,{id:"graph_summary_tabs",defaultTab:0,style:{paddingBottom:"10px"}},r.createElement(bh.a,{style:YI,title:"Traffic",eventKey:0},r.createElement("div",{style:YI},r.createElement(Lw,this.props))),r.createElement(bh.a,{style:YI,title:"Traces",eventKey:1},r.createElement(Yw,{nodeData:e,queryTime:this.props.queryTime-this.props.duration}))))}}]),a}(r.Component),Zw=Object(h.b)((function(e){return{jaegerState:e.jaegerState}}))(Jw),$w=a(1514),eR=function(e){var t=r.useState(!1),a=Object(T.a)(t,2),n=a[0],i=a[1];return r.createElement(sr.a,Object.assign({},e,{onToggle:function(t){e.onToggle&&e.onToggle(t),i(t)},onSelect:function(t,a,n){i(!1),!n&&e.onSelect&&e.onSelect(a)},isExpanded:n}),e.children)},tR=Object(Jn.a)({fontWeight:"bold",fontSize:"16px"}),aR=Object(Jn.a)({float:"right",marginTop:"-7px"}),nR=Object(Jn.a)({display:"inline-block",maxWidth:"95%",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"}),rR=Object(Jn.a)({paddingTop:9}),iR=Object(Jn.a)({$nest:{"& > button":{fontSize:"var(--graph-side-panel--font-size)",paddingTop:3,paddingBottom:3},"& > ul":{maxWidth:"100%",overflowY:"hidden"},"& > ul > li > button":{fontSize:"var(--graph-side-panel--font-size)",paddingTop:3,paddingBottom:3}}}),oR=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).state={selectedSpanID:void 0},n}return Object(l.a)(a,[{key:"componentDidUpdate",value:function(e){e.trace.traceID!==this.props.trace.traceID&&this.setState({selectedSpanID:void 0})}},{key:"render",value:function(){var e,t=this,a=Ov(this.props.node),n=a.namespace?"/namespaces/".concat(a.namespace)+(a.workload?"/workloads/".concat(a.workload):a.service?"/services/".concat(a.service):"/applications/".concat(a.app))+"?tab=traces&".concat(P.JAEGER_TRACE_ID,"=").concat(this.props.trace.traceID):void 0,i=this.props.jaegerURL?"".concat(this.props.jaegerURL,"/trace/").concat(this.props.trace.traceID):void 0,o=new CC(this.props.trace),s=r.createElement("span",{className:nR},o.name(),r.createElement("span",{className:bC},o.shortID())),l=this.props.node.data("spans")||[],c=l.find((function(e){return e.spanID===t.state.selectedSpanID}));return!c&&l.length>0&&(c=l[0]),r.createElement(r.Fragment,null,r.createElement("span",{className:tR},"Trace"),r.createElement("span",{className:aR},r.createElement(lo.a,{content:"Close and clear trace selection"},r.createElement(vr.a,{id:"close-trace",variant:"plain",onClick:this.props.close},r.createElement(Lr.a,null)))),r.createElement("div",null,n?r.createElement(lo.a,{content:"View trace details for: ".concat(o.name())},r.createElement(ar.a,{to:n},s)):r.createElement(lo.a,{content:"".concat(o.name())},s),r.createElement("div",null,0!==o.numErrors&&r.createElement(r.Fragment,null,r.createElement(ea.a,{color:nt.Danger})," ",r.createElement("strong",null,"This trace has ",Object(HC.pluralize)(o.numErrors,"error"),".")),r.createElement("div",null,r.createElement("strong",null,"Started: "),o.fromNow()),o.duration()&&r.createElement("div",null,r.createElement("strong",null,"Full duration: "),o.duration())),l.length>0&&r.createElement("div",{className:rR},r.createElement("div",null,r.createElement("strong",null,Object(HC.pluralize)(l.length,"span"))," on this node",r.createElement(eR,{selections:null===(e=c)||void 0===e?void 0:e.operationName,className:iR,onSelect:function(e){t.setState({selectedSpanID:e})}},l.map((function(e){return r.createElement(cr.a,{key:e.spanID,value:e.spanID},e.operationName," (t + ",YE(e.relativeStartTime),")")}))))),c&&r.createElement("div",{className:rR},this.renderSpan(c)),i&&r.createElement(r.Fragment,null,r.createElement("br",null),r.createElement("a",{href:i,target:"_blank",rel:"noopener noreferrer"},"Show in Tracing ",r.createElement(Jf.a,{size:"sm"})))))}},{key:"spanViewLink",value:function(e){var t=Ov(this.props.node);return t.namespace?"/namespaces/".concat(t.namespace)+(t.workload?"/workloads/".concat(t.workload):t.service?"/services/".concat(t.service):"/applications/".concat(t.app))+"?tab=traces&".concat(P.JAEGER_TRACE_ID,"=").concat(this.props.trace.traceID,"&").concat(P.JAEGER_SPAN_ID,"=").concat(e.spanID):void 0}},{key:"renderSpan",value:function(e){var t=this.spanViewLink(e);return r.createElement(r.Fragment,null,r.createElement("div",null,r.createElement("strong",null,"Started after: "),YE(e.relativeStartTime)),r.createElement("div",null,r.createElement("strong",null,"Duration: "),YE(e.duration)),("http"===e.type||"envoy"===e.type)&&this.renderHTTPSpan(e),"tcp"===e.type&&this.renderTCPSpan(e),r.createElement("div",null,r.createElement("strong",null,"Related: "),this.renderRelatedSpans(e)),t&&r.createElement("div",null,r.createElement(ar.a,{to:t},"Show span")))}},{key:"renderRelatedSpans",value:function(e){var t=this,a=GE(e),n=function(e,t){return t.spans.filter((function(t){var a;return(null===(a=GE(t))||void 0===a?void 0:a.spanID)===e.spanID})).sort(xE)}(e,this.props.trace),i=(a?[{text:"parent",span:a}]:[]).concat(n.map((function(e,t){return{text:"child "+(t+1),span:e}})));return r.createElement(r.Fragment,null,i.length>0?i.map((function(a){return t.linkToSpan(e,a.span,a.text)})).reduce((function(e,t){return[e,", ",t]})):"none")}},{key:"linkToSpan",value:function(e,t,a){var n=this,i=this.props.graphType===Xe.APP||this.props.graphType===Xe.SERVICE,o=i?e.app:e.workload,s=i?t.app:t.workload,l=r.createElement(r.Fragment,null,a);if(s){var c=this.props.node.cy(),u=(new Sb).namespace(t.namespace).class("span"),p=i?u.app(s).build():u.workload(s).build();l=r.createElement(r.Fragment,null,r.createElement(vr.a,{variant:vr.b.link,onClick:function(){n.setState({selectedSpanID:t.spanID}),s===o&&t.namespace===e.namespace||c.elements(p).trigger("tap")},isInline:!0},r.createElement("span",{style:YI},a))," ",r.createElement(vr.a,{variant:vr.b.link,onClick:function(){return new lb(c).start(c.elements(p))},isInline:!0},r.createElement("span",{style:YI},r.createElement($w.a,null))))}return r.createElement(lo.a,{key:t.spanID,content:r.createElement(r.Fragment,null,"Operation name: ",t.operationName,r.createElement("br",null),"Workload: ",t.workload||"unknown")},l)}},{key:"renderHTTPSpan",value:function(e){var t,a=e.info,n="inbound"===a.direction?"Inbound request":"outbound"===a.direction?"Outbound request":"Request",i=a.responseFlags;return r.createElement(r.Fragment,null,r.createElement("div",null,r.createElement("strong",null,n,": "),a.method," ",a.url),r.createElement("div",null,r.createElement("strong",null,"Response: "),"code ",a.statusCode||"unknown",i&&", flags "+i),i&&r.createElement("div",null,r.createElement(Br.a,null)," ",(null===(t=$[i])||void 0===t?void 0:t.help)||"Unknown flag"))}},{key:"renderTCPSpan",value:function(e){var t=e.info;return r.createElement(r.Fragment,null,t.topic&&r.createElement("div",null,r.createElement("strong",null,"Topic: "),t.topic))}}]),a}(r.Component),sR=Object(h.b)((function(){return{}}),(function(e){return{close:function(){return e(AC(void 0))},setNode:Object(Ie.b)(Ke.setNode,e)}}))(oR),lR={clusterBox:null},cR=Object(Jn.a)({margin:"0 1em"}),uR=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).countApps=function(e){var t={};return e.filter('node[nodeType = "'.concat(Ze.APP,'"]')).forEach((function(e){var a=e.data(Fg);void 0===t[a]&&(t[a]=new Set),t[a].add(e.data(Ev))})),{numApps:Object.getOwnPropertyNames(t).length,numVersions:Object.getOwnPropertyNames(t).reduce((function(e,a){return e+t[a].size}),0)}},n.renderCluster=function(e){return r.createElement(r.Fragment,{key:e},r.createElement("span",null,r.createElement(pc,{badge:cc.Cluster,style:{marginBottom:"2px"}}),r.createElement(VI,{href:"/",cluster:e},e)," "),r.createElement("br",null))},n.renderTopologySummary=function(e,t,a,n,i){return r.createElement(r.Fragment,null,r.createElement("br",null),r.createElement("strong",null,"Current Graph:"),r.createElement("br",null),a>0&&r.createElement(r.Fragment,null,r.createElement(fi.Applications,{className:cR}),a.toString()," ",1===a?"app ":"apps ",n>0&&"(".concat(n," versions)"),r.createElement("br",null)),e>0&&r.createElement(r.Fragment,null,r.createElement(fi.Services,{className:cR}),e.toString()," ",1===e?"service":"services",r.createElement("br",null)),t>0&&r.createElement(r.Fragment,null,r.createElement(fi.Workloads,{className:cR}),t.toString()," ",1===t?"workload":"workloads",r.createElement("br",null)),i>0&&r.createElement(r.Fragment,null,r.createElement(fi.Topology,{className:cR}),i.toString()," ",1===i?"edge":"edges"))},n.state=Object(C.a)({},lR),n}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props.data.summaryTarget,t=e.descendants(),n=e.data(_g),i=t.filter('node[nodeType = "'.concat(Ze.SERVICE,'"]')).size(),o=t.filter('node[nodeType = "'.concat(Ze.WORKLOAD,'"]')).size(),s=this.countApps(t),l=s.numApps,c=s.numVersions,u=t.connectedEdges().size(),p=e.cy().nodes("[".concat(_g,' != "').concat(n,'"]')).edgesTo(t),d=t.edgesTo("[".concat(_g,' != "').concat(n,'"]')),m=p.add(t.filter("[?".concat(bv,"]")).edgesTo("*")),h=hw(p),f=hw(d),g=hw(m),v=Ew(p),E=Ew(d),b=Ew(m),y=this.props.trafficRates.includes(ze.GRPC_REQUEST),C=Cw(p),S=Cw(d),A=Cw(m);return r.createElement("div",{className:"panel panel-default",style:a.panelStyle},r.createElement("div",{className:"panel-heading",style:KI},this.renderCluster(n),this.renderTopologySummary(i,o,l,c,u)),r.createElement("div",{className:qI},r.createElement(hT,{id:"graph_summary_tabs",defaultTab:0,style:{paddingBottom:"10px"}},r.createElement(bh.a,{style:YI,title:"Inbound",eventKey:0},r.createElement("div",{style:YI},0===h.rate&&0===v.rate&&0===C.rate&&r.createElement(r.Fragment,null,r.createElement(fi.Info,null)," No inbound traffic."),h.rate>0&&r.createElement(xI,{isRequests:y,rate:h.rate,rateGrpcErr:h.rateGrpcErr,rateNR:h.rateNoResponse}),v.rate>0&&r.createElement(NI,{title:"HTTP (requests per second):",rate:v.rate,rate3xx:v.rate3xx,rate4xx:v.rate4xx,rate5xx:v.rate5xx,rateNR:v.rateNoResponse}),C.rate>0&&r.createElement(jI,{rate:C.rate}))),r.createElement(bh.a,{style:YI,title:"Outbound",eventKey:1},r.createElement("div",{style:YI},0===f.rate&&0===E.rate&&0===S.rate&&r.createElement(r.Fragment,null,r.createElement(fi.Info,null)," No outbound traffic."),f.rate>0&&r.createElement(xI,{isRequests:y,rate:f.rate,rateGrpcErr:f.rateGrpcErr,rateNR:f.rateNoResponse}),E.rate>0&&r.createElement(NI,{title:"HTTP (requests per second):",rate:E.rate,rate3xx:E.rate3xx,rate4xx:E.rate4xx,rate5xx:E.rate5xx,rateNR:E.rateNoResponse}),S.rate>0&&r.createElement(jI,{rate:S.rate}))),r.createElement(bh.a,{style:YI,title:"Total",eventKey:2},r.createElement("div",{style:YI},0===g.rate&&0===b.rate&&0===A.rate&&r.createElement(r.Fragment,null,r.createElement(fi.Info,null)," No traffic."),g.rate>0&&r.createElement(xI,{isRequests:y,rate:g.rate,rateGrpcErr:g.rateGrpcErr,rateNR:g.rateNoResponse}),b.rate>0&&r.createElement(NI,{title:"HTTP (requests per second):",rate:b.rate,rate3xx:b.rate3xx,rate4xx:b.rate4xx,rate5xx:b.rate5xx,rateNR:b.rateNoResponse}),A.rate>0&&r.createElement(jI,{rate:A.rate}))))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.data.summaryTarget!==t.clusterBox?{clusterBox:e.data.summaryTarget}:null}}]),a}(r.Component);uR.panelStyle={height:"100%",margin:0,minWidth:"25em",overflowY:"auto",backgroundColor:nt.White,width:"25em"};var pR={grpcRequestIn:[],grpcRequestOut:[],grpcRequestErrIn:[],grpcRequestErrOut:[],grpcSentIn:[],grpcSentOut:[],grpcReceivedIn:[],grpcReceivedOut:[],httpRequestIn:[],httpRequestOut:[],httpRequestErrIn:[],httpRequestErrOut:[],tcpSentIn:[],tcpSentOut:[],tcpReceivedIn:[],tcpReceivedOut:[]},dR=Object(C.a)({loading:!1,metricsLoadError:null,namespaceBox:null,validation:void 0},pR),mR=Object(Jn.a)({margin:"0 1em"}),hR=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).boxTraffic=void 0,n.metricsPromise=void 0,n.validationPromise=void 0,n.getBoxTraffic=function(){var e=n.props.data.summaryTarget,t=e.descendants(),a=e.data(mv),r=e.data(_g),i=e.cy().nodes("[".concat(mv,' != "').concat(a,'"],[').concat(_g,' != "').concat(r,'"]')).edgesTo(t),o=t.edgesTo("[".concat(mv,' != "').concat(a,'"],[').concat(_g,' != "').concat(r,'"]')),s=i.add(t.filter("[?".concat(bv,"]")).edgesTo("*"));return{grpcIn:hw(i),grpcOut:hw(o),grpcTotal:hw(s),httpIn:Ew(i),httpOut:Ew(o),httpTotal:Ew(s),isGrpcRequests:n.props.trafficRates.includes(ze.GRPC_REQUEST),tcpIn:Cw(i),tcpOut:Cw(o),tcpTotal:Cw(s)}},n.countApps=function(e){var t={};return e.filter('node[nodeType = "'.concat(Ze.APP,'"]')).forEach((function(e){var a=e.data(Fg);void 0===t[a]&&(t[a]=new Set),t[a].add(e.data(Ev))})),{numApps:Object.getOwnPropertyNames(t).length,numVersions:Object.getOwnPropertyNames(t).reduce((function(e,a){return e+t[a].size}),0)}},n.renderNamespace=function(e){var t=n.state.validation;return r.createElement(r.Fragment,{key:e},r.createElement("span",null,r.createElement(pc,{badge:cc.Namespace,style:{marginBottom:"2px"}}),e," ",!!t&&r.createElement(Ec,{namespace:e,objectCount:t.objectCount,errors:t.errors,warnings:t.warnings},r.createElement(_o,{id:"ns-val-"+e,errors:t.errors,warnings:t.warnings,objectCount:t.objectCount,style:{marginLeft:"5px"}}))),r.createElement("br",null))},n.renderTopologySummary=function(e,t,a,n,i){return r.createElement(r.Fragment,null,a>0&&r.createElement(r.Fragment,null,r.createElement(fi.Applications,{className:mR}),a.toString()," ",1===a?"app ":"apps ",n>0&&"(".concat(n," versions)"),r.createElement("br",null)),e>0&&r.createElement(r.Fragment,null,r.createElement(fi.Services,{className:mR}),e.toString()," ",1===e?"service":"services",r.createElement("br",null)),t>0&&r.createElement(r.Fragment,null,r.createElement(fi.Workloads,{className:mR}),t.toString()," ",1===t?"workload":"workloads",r.createElement("br",null)),i>0&&r.createElement(r.Fragment,null,r.createElement(fi.Topology,{className:mR}),i.toString()," ",1===i?"edge":"edges"))},n.renderCharts=function(){var e=n.props.data.summaryTarget.data(mv);if(n.state.loading)return r.createElement("strong",null,"Loading chart...");if(n.state.metricsLoadError)return r.createElement("div",null,r.createElement(fi.Warning,null)," ",r.createElement("strong",null,"Error loading metrics: "),n.state.metricsLoadError);if(e===it)return r.createElement(r.Fragment,null);var t=n.boxTraffic,a=t.grpcTotal,i=t.httpTotal,o=t.isGrpcRequests,s=t.tcpTotal;return r.createElement(r.Fragment,null,a.rate>0&&o&&r.createElement(r.Fragment,null,r.createElement(MI,{label:"gRPC - Inbound Request Traffic",dataRps:n.state.grpcRequestIn,dataErrors:n.state.grpcRequestErrIn}),r.createElement(MI,{label:"gRPC - Outbound Request Traffic",dataRps:n.state.grpcRequestOut,dataErrors:n.state.grpcRequestErrOut})),a.rate>0&&!o&&r.createElement(r.Fragment,null,r.createElement(HI,{label:"gRPC - Inbound Traffic",receivedRates:n.state.grpcReceivedIn,sentRates:n.state.grpcSentIn,unit:"messages"}),r.createElement(HI,{label:"gRPC - Outbound Traffic",receivedRates:n.state.grpcReceivedOut,sentRates:n.state.grpcSentOut,unit:"messages"})),i.rate>0&&r.createElement(r.Fragment,null,r.createElement(MI,{label:"HTTP - Inbound Request Traffic",dataRps:n.state.httpRequestIn,dataErrors:n.state.httpRequestErrIn}),r.createElement(MI,{label:"HTTP - Outbound Request Traffic",dataRps:n.state.httpRequestOut,dataErrors:n.state.httpRequestErrOut})),s.rate>0&&r.createElement(r.Fragment,null,r.createElement(HI,{label:"TCP - Inbound Traffic",receivedRates:n.state.tcpReceivedIn,sentRates:n.state.tcpSentIn,unit:"bytes"}),r.createElement(HI,{label:"TCP - Outbound Traffic",receivedRates:n.state.tcpReceivedOut,sentRates:n.state.tcpSentOut,unit:"bytes"})))},n.updateCharts=function(){var e=n.props,t=e.data.summaryTarget.data(mv);if(t!==it){var a=n.boxTraffic,r=a.grpcTotal,i=a.httpTotal,o=a.isGrpcRequests,s=a.tcpTotal;n.metricsPromise&&(n.metricsPromise.cancel(),n.metricsPromise=void 0);var l=Promise.resolve({data:{}}),c=Promise.resolve({data:{}}),u=[];r.rate>0&&!o&&u.push("grpc_sent","grpc_received"),(i.rate>0||r.rate>0&&o)&&u.push("request_count","request_error_count"),s.rate>0&&u.push("tcp_sent","tcp_received"),u.length>0&&(l=an(t,{byLabels:["request_protocol"],direction:"inbound",duration:e.duration,filters:u,queryTime:e.queryTime,rateInterval:e.rateInterval,reporter:"destination",step:e.step}),c=an(t,{byLabels:["request_protocol"],direction:"outbound",duration:e.duration,filters:u,queryTime:e.queryTime,rateInterval:e.rateInterval,reporter:"source",step:e.step})),n.metricsPromise=br(Promise.all([l,c])),n.metricsPromise.promise.then((function(e){var t=function(e,t){return!t||e.request_protocol===t},a=e[0].data,r=e[1].data;n.setState({loading:!1,grpcReceivedIn:ew(a.grpc_received),grpcReceivedOut:ew(r.grpc_received),grpcRequestIn:tw(a.request_count,t,Le.GRPC),grpcRequestOut:tw(r.request_count,t,Le.GRPC),grpcRequestErrIn:tw(a.request_error_count,t,Le.GRPC),grpcRequestErrOut:tw(r.request_error_count,t,Le.GRPC),grpcSentIn:ew(a.grpc_sent),grpcSentOut:ew(r.grpc_sent),httpRequestIn:tw(a.request_count,t,Le.HTTP),httpRequestOut:tw(r.request_count,t,Le.HTTP),httpRequestErrIn:tw(a.request_error_count,t,Le.HTTP),httpRequestErrOut:tw(r.request_error_count,t,Le.HTTP),tcpReceivedIn:ew(a.tcp_received),tcpReceivedOut:ew(r.tcp_received),tcpSentIn:ew(a.tcp_sent),tcpSentOut:ew(r.tcp_sent)})})).catch((function(e){if(e.isCanceled)console.debug("SummaryPanelGraph: Ignore fetch error (canceled).");else{var t=e.response&&e.response.data.error?e.response.data.error:e.message;n.setState(Object(C.a)({loading:!1,metricsLoadError:t},pR))}})),n.setState({loading:!0,metricsLoadError:null})}else n.setState({loading:!1})},n.updateValidation=function(){var e=n.props.data.summaryTarget.data(mv);n.validationPromise=br(on(e)),n.validationPromise.promise.then((function(e){n.setState({validation:e.data})})).catch((function(e){e.isCanceled||console.log("SummaryPanelNamespaceBox: Error fetching validation status: ".concat(On(e)))}))},n.state=Object(C.a)({},dR),n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.boxTraffic=this.getBoxTraffic(),this.updateCharts(),this.updateValidation()}},{key:"componentDidUpdate",value:function(e){XI(e,this.props)&&(this.boxTraffic=this.getBoxTraffic(),this.updateCharts(),this.updateValidation())}},{key:"componentWillUnmount",value:function(){this.metricsPromise&&this.metricsPromise.cancel(),this.validationPromise&&this.validationPromise.cancel()}},{key:"render",value:function(){var e=this.props.data.summaryTarget,t=e.descendants(),n=e.data(mv),i=t.filter('node[nodeType = "'.concat(Ze.SERVICE,'"]')).size(),o=t.filter('node[nodeType = "'.concat(Ze.WORKLOAD,'"]')).size(),s=this.countApps(t),l=s.numApps,c=s.numVersions,u=t.connectedEdges().size(),p=this.boxTraffic||this.getBoxTraffic(),d=p.grpcIn,m=p.grpcOut,h=p.grpcTotal,f=p.httpIn,g=p.httpOut,v=p.httpTotal,E=p.isGrpcRequests,b=p.tcpIn,y=p.tcpOut,C=p.tcpTotal;return r.createElement("div",{className:"panel panel-default",style:a.panelStyle},r.createElement("div",{className:"panel-heading",style:KI},this.renderNamespace(n),r.createElement("br",null),this.renderTopologySummary(i,o,l,c,u)),r.createElement("div",{className:qI},r.createElement(hT,{id:"graph_summary_tabs",defaultTab:0,style:{paddingBottom:"10px"}},r.createElement(bh.a,{style:YI,title:"Inbound",eventKey:0},r.createElement("div",{style:YI},0===d.rate&&0===f.rate&&0===b.rate&&r.createElement(r.Fragment,null,r.createElement(fi.Info,null)," No inbound traffic."),d.rate>0&&r.createElement(xI,{isRequests:E,rate:d.rate,rateGrpcErr:d.rateGrpcErr,rateNR:d.rateNoResponse}),f.rate>0&&r.createElement(NI,{title:"HTTP (requests per second):",rate:f.rate,rate3xx:f.rate3xx,rate4xx:f.rate4xx,rate5xx:f.rate5xx,rateNR:f.rateNoResponse}),b.rate>0&&r.createElement(jI,{rate:b.rate}))),r.createElement(bh.a,{style:YI,title:"Outbound",eventKey:1},r.createElement("div",{style:YI},0===m.rate&&0===g.rate&&0===y.rate&&r.createElement(r.Fragment,null,r.createElement(fi.Info,null)," No outbound traffic."),m.rate>0&&r.createElement(xI,{isRequests:E,rate:m.rate,rateGrpcErr:m.rateGrpcErr,rateNR:m.rateNoResponse}),g.rate>0&&r.createElement(NI,{title:"HTTP (requests per second):",rate:g.rate,rate3xx:g.rate3xx,rate4xx:g.rate4xx,rate5xx:g.rate5xx,rateNR:g.rateNoResponse}),y.rate>0&&r.createElement(jI,{rate:y.rate}))),r.createElement(bh.a,{style:YI,title:"Total",eventKey:2},r.createElement("div",{style:YI},0===h.rate&&0===v.rate&&0===C.rate&&r.createElement(r.Fragment,null,r.createElement(fi.Info,null)," No traffic."),h.rate>0&&r.createElement(xI,{isRequests:E,rate:h.rate,rateGrpcErr:h.rateGrpcErr,rateNR:h.rateNoResponse}),v.rate>0&&r.createElement(NI,{title:"HTTP (requests per second):",rate:v.rate,rate3xx:v.rate3xx,rate4xx:v.rate4xx,rate5xx:v.rate5xx,rateNR:v.rateNoResponse}),C.rate>0&&r.createElement(jI,{rate:C.rate}),r.createElement("div",null,QI(),this.renderCharts()))))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.data.summaryTarget!==t.namespaceBox?Object(C.a)({namespaceBox:e.data.summaryTarget,loading:!0},pR):null}}]),a}(r.Component);hR.panelStyle={height:"100%",margin:0,minWidth:"25em",overflowY:"auto",backgroundColor:nt.White,width:"25em"};var fR,gR=Object(Jn.a)({fontSize:"var(--graph-side-panel--font-size)",padding:"0",position:"relative"}),vR=Object(Jn.a)({height:"100%"}),ER=Object(Jn.a)({height:"50%"}),bR=Object(Jn.a)({$nest:{"& > .panel":{display:"none"}}}),yR=Object(Jn.a)({height:"50%",width:"25em",minWidth:"25em",overflowY:"auto"}),CR=Object(Jn.a)({backgroundColor:"white",border:"1px #ddd solid",borderRadius:"3px",cursor:"pointer",left:"-1.6em",minWidth:"5em",position:"absolute",textAlign:"center",top:"6.5em",transform:"rotate(-90deg)",transformOrigin:"left top 0"}),SR=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).togglePanel=function(){n.setState((function(e){return{isVisible:!e.isVisible}}))},n.state={isVisible:!0},n}return Object(l.a)(a,[{key:"componentDidUpdate",value:function(e){e.data.summaryTarget!==this.props.data.summaryTarget&&this.setState({isVisible:!0})}},{key:"render",value:function(){var e;if(!this.props.isPageVisible||!this.props.data.summaryTarget)return null;var t=this.props.data.summaryType,a="box"===t?this.props.data.summaryTarget.data(iv):void 0,n=this.state.isVisible?this.props.jaegerState.selectedTrace?ER:vR:bR;return r.createElement(Mu,{info:[Hu.Graph,Hu.ContextualMenu,Hu.SidePanel]},r.createElement("div",{id:"graph-side-panel",className:gR},r.createElement("div",{className:n},r.createElement("div",{className:CR,onClick:this.togglePanel},this.state.isVisible?r.createElement(r.Fragment,null,r.createElement(fi.AngleDoubleDown,null)," Hide"):r.createElement(r.Fragment,null,r.createElement(fi.AngleDoubleUp,null)," Show")),"box"===t&&"app"===a&&r.createElement(xw,{data:this.props.data,duration:this.props.duration,graphType:this.props.graphType,injectServiceNodes:this.props.injectServiceNodes,namespaces:this.props.data.summaryTarget.namespaces,queryTime:this.props.queryTime,rateInterval:this.props.rateInterval,step:this.props.step,trafficRates:this.props.trafficRates}),"box"===t&&"cluster"===a&&r.createElement(uR,{data:this.props.data,duration:this.props.duration,graphType:this.props.graphType,injectServiceNodes:this.props.injectServiceNodes,namespaces:this.props.data.summaryTarget.namespaces,queryTime:this.props.queryTime,rateInterval:this.props.rateInterval,step:this.props.step,trafficRates:this.props.trafficRates}),"box"===t&&"namespace"===a&&r.createElement(hR,{data:this.props.data,duration:this.props.duration,graphType:this.props.graphType,injectServiceNodes:this.props.injectServiceNodes,namespaces:this.props.data.summaryTarget.namespaces,queryTime:this.props.queryTime,rateInterval:this.props.rateInterval,step:this.props.step,trafficRates:this.props.trafficRates}),"edge"===t&&r.createElement(cw,this.props),"graph"===t&&r.createElement(Ow,{data:this.props.data,duration:this.props.duration,graphType:this.props.graphType,injectServiceNodes:this.props.injectServiceNodes,namespaces:this.props.namespaces,queryTime:this.props.queryTime,rateInterval:this.props.rateInterval,step:this.props.step,trafficRates:this.props.trafficRates}),"node"===this.props.data.summaryType&&r.createElement(Zw,{data:this.props.data,duration:this.props.duration,graphType:this.props.graphType,injectServiceNodes:this.props.injectServiceNodes,namespaces:this.props.namespaces,rateInterval:this.props.rateInterval,queryTime:this.props.queryTime,step:this.props.step,trafficRates:this.props.trafficRates})),this.props.jaegerState.selectedTrace&&this.state.isVisible&&r.createElement("div",{className:"panel panel-default ".concat(yR)},r.createElement("div",{className:"panel-body"},r.createElement(sR,{trace:this.props.jaegerState.selectedTrace,node:this.props.data.summaryTarget,graphType:this.props.graphType,jaegerURL:null===(e=this.props.jaegerState.info)||void 0===e?void 0:e.url})))))}}]),a}(r.Component),AR=Object(h.b)((function(e){return{jaegerState:e.jaegerState}}))(SR),TR={graphReady:function(e){return function(t){t(Ke.updateSummary({summaryType:"graph",summaryTarget:e}))}}},OR=Object(Jn.a)({minHeight:"350px",height:"calc(100vh - 113px)"}),IR=Object(Jn.a)({minHeight:"350px",height:"calc(100vh - 10px)"}),wR=Object(Jn.a)({flex:"1",minWidth:"350px",zIndex:0,paddingRight:"5px"}),RR=Object(Jn.a)({position:"relative",backgroundColor:nt.Black150}),kR=Object(Jn.a)({position:"absolute",bottom:"5px",zIndex:2,borderStyle:"hidden"}),xR=Object(Jn.a)({position:"absolute",top:"10px",left:"10px",width:"auto",zIndex:2,backgroundColor:nt.White}),NR=Object(Jn.a)({backgroundColor:nt.White}),jR=Object(Jn.a)({backgroundColor:nt.Replay}),PR=Object(Jn.a)({right:"0",bottom:"10px",position:"absolute",overflow:"hidden"}),LR=function(){return r.createElement("div",{className:wR},r.createElement(sb,{isError:!0,isMiniGraph:!1,namespaces:[],showIdleNodes:!1,toggleIdleNodes:function(){}}))},DR=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).errorBoundaryRef=void 0,n.cytoscapeGraphRef=void 0,n.focusSelector=void 0,n.graphDataSource=void 0,n.handleEmptyGraphAction=function(){n.loadGraphDataFromBackend()},n.handleGraphDataSourceSuccess=function(e,t,a,r){n.setState({graphData:{elements:a,isLoading:!1,fetchParams:r,timestamp:1e3*e}}),n.props.setGraphDefinition(n.graphDataSource.graphDefinition)},n.handleGraphDataSourceError=function(e,t){n.setState({graphData:{elements:{edges:[],nodes:[]},errorMessage:e||void 0,isError:!0,isLoading:!1,fetchParams:t,timestamp:Date.now()}})},n.handleGraphDataSourceEmpty=function(e){n.setState({graphData:{elements:Gf,isLoading:!1,fetchParams:e,timestamp:Date.now()}})},n.handleGraphDataSourceStart=function(e,t){n.setState({graphData:{elements:e?Gf:n.state.graphData.elements,fetchParams:t,isLoading:!0,timestamp:e?Date.now():n.state.graphData.timestamp}})},n.handleDoubleTap=function(e){if(!(e.isInaccessible||e.isServiceEntry||e.nodeType===Ze.BOX&&e.isBox!==Je.APP))if(e.hasMissingSC)Dn("A node with a missing sidecar provides no node-specific telemetry and can not provide a node detail graph.",void 0,Te.WARNING);else if(e.isIdle)Dn("An idle node has no node-specific traffic and can not provide a node detail graph.",void 0,Te.WARNING);else if(e.isOutside&&n.props.setActiveNamespaces)n.props.setActiveNamespaces([{name:e.namespace}]);else{var t=!1,a=n.state.graphData.fetchParams.node;if(a)switch(t=a&&a.nodeType===e.nodeType,e.nodeType){case Ze.AGGREGATE:t=(t=t&&a.aggregate===e.aggregate)&&a.aggregateValue===e.aggregateValue;break;case Ze.APP:t=(t=t&&a.app===e.app)&&a.version===e.version;break;case Ze.BOX:t=t&&a.app===e.app;break;case Ze.SERVICE:t=t&&a.service===e.service;break;case Ze.WORKLOAD:t=t&&a.workload===e.workload;break;default:t=!0}var r=Object(C.a)(Object(C.a)({},e),{},{namespace:{name:e.namespace}});if(t)n.handleDoubleTapSameNode(r);else{var i={activeNamespaces:n.state.graphData.fetchParams.namespaces,duration:n.state.graphData.fetchParams.duration,edgeLabels:n.state.graphData.fetchParams.edgeLabels,graphLayout:n.props.layout,graphType:n.state.graphData.fetchParams.graphType,node:r,refreshInterval:n.props.refreshInterval,showIdleEdges:n.props.showIdleEdges,showIdleNodes:n.props.showIdleNodes,showOperationNodes:n.props.showOperationNodes,showServiceNodes:n.props.showServiceNodes,trafficRates:n.state.graphData.fetchParams.trafficRates};U.push(Rb(i))}}},n.handleDoubleTapSameNode=function(e){var t=e.nodeType,a=e.nodeType+"s",n=e.app;"service"===t?n=e.service:"workload"===t?n=e.workload:a="applications";var r=function(e,t,a){return"/namespaces/".concat(e,"/").concat(t,"/").concat(a)}(e.namespace.name,a,n);U.push(r)},n.toggleHelp=function(){if(n.props.showLegend&&n.props.toggleLegend(),n.props.activeTour)n.props.endTour();else{var e=Du(Gu,-1,"forward");n.props.startTour({info:Gu,stop:e})}},n.loadGraphDataFromBackend=function(){var e=n.props.replayQueryTime?n.props.replayQueryTime:void 0;n.graphDataSource.fetchGraphData({boxByCluster:n.props.boxByCluster,boxByNamespace:n.props.boxByNamespace,duration:n.props.duration,edgeLabels:n.props.edgeLabels,graphType:n.props.graphType,includeHealth:!0,injectServiceNodes:n.props.showServiceNodes,namespaces:n.props.node?[n.props.node.namespace]:n.props.activeNamespaces,node:n.props.node,queryTime:e,showIdleEdges:n.props.showIdleEdges,showIdleNodes:n.props.showIdleNodes,showOperationNodes:n.props.showOperationNodes,showSecurity:n.props.showSecurity,trafficRates:n.props.trafficRates})},n.notifyError=function(e,t){Dn("There was an error when rendering the graph: ".concat(e.message,", please try a different layout"))},n.displayTimeRange=function(){var e=n.state.graphData.timestamp,t=e-1e3*n.props.duration;return wf(t,e,{second:"2-digit"},{second:"2-digit"})},n.errorBoundaryRef=r.createRef(),n.cytoscapeGraphRef=r.createRef(),n.focusSelector=new URLSearchParams(window.location.search).get(P.FOCUS_SELECTOR)||void 0,n.graphDataSource=new Vf,n.state={graphData:{elements:{edges:[],nodes:[]},fetchParams:n.graphDataSource.fetchParameters,isLoading:!0,timestamp:0}},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e;this.graphDataSource.on("loadStart",this.handleGraphDataSourceStart),this.graphDataSource.on("fetchError",this.handleGraphDataSourceError),this.graphDataSource.on("fetchSuccess",this.handleGraphDataSourceSuccess),this.graphDataSource.on("emptyNamespaces",this.handleGraphDataSourceEmpty);var t=a.getNodeParamsFromProps(this.props);a.isNodeChanged(t,this.props.node)&&(t&&!this.props.activeNamespaces.map((function(e){return e.name})).includes(t.namespace.name)&&this.props.setActiveNamespaces([t.namespace].concat(Object(mt.a)(this.props.activeNamespaces))),this.props.setNode(t));var n=Ob();n!==(null===(e=this.props.trace)||void 0===e?void 0:e.traceID)&&this.props.setTraceId(n)}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=!this.state.graphData.timestamp,r=!bi(e.activeNamespaces,t.activeNamespaces,(function(e,t){return e.name===t.name}));r&&this.props.onNamespaceChange(),(n||r||e.boxByCluster!==t.boxByCluster||e.boxByNamespace!==t.boxByNamespace||e.duration!==t.duration||e.edgeLabels!==t.edgeLabels&&(t.edgeLabels.includes(De.RESPONSE_TIME_GROUP)||t.edgeLabels.includes(De.THROUGHPUT_GROUP))||e.graphType!==t.graphType||e.lastRefreshAt!==t.lastRefreshAt&&0===t.replayQueryTime||e.replayQueryTime!==t.replayQueryTime||e.showIdleEdges!==t.showIdleEdges||e.showOperationNodes!==t.showOperationNodes||e.showServiceNodes!==t.showServiceNodes||e.showSecurity!==t.showSecurity||e.showIdleNodes!==t.showIdleNodes||e.trafficRates!==t.trafficRates||a.isNodeChanged(e.node,t.node))&&this.loadGraphDataFromBackend(),this.focusSelector&&(this.focusSelector=void 0,q.deleteParam(P.FOCUS_SELECTOR,!0)),(e.layout.name!==t.layout.name||r)&&this.errorBoundaryRef.current.cleanError(),t.showLegend&&this.props.activeTour&&this.props.endTour()}},{key:"componentWillUnmount",value:function(){this.graphDataSource.removeListener("loadStart",this.handleGraphDataSourceStart),this.graphDataSource.removeListener("fetchError",this.handleGraphDataSourceError),this.graphDataSource.removeListener("fetchSuccess",this.handleGraphDataSourceSuccess),this.graphDataSource.removeListener("emptyNamespaces",this.handleGraphDataSourceEmpty)}},{key:"render",value:function(){var e=this,t=OR;Ab()&&(t=IR);var a=!(!(this.state.graphData.elements.nodes&&Object.keys(this.state.graphData.elements.nodes).length>0)||this.state.graphData.isError),n=this.props.replayActive&&!!this.props.replayQueryTime,i=this.cytoscapeGraphRef&&this.cytoscapeGraphRef.current?this.cytoscapeGraphRef.current.getCy():null;return r.createElement(r.Fragment,null,r.createElement(aT.a,{className:t,column:!0},r.createElement("div",null,r.createElement(CO,{cy:i,disabled:this.state.graphData.isLoading,onToggleHelp:this.toggleHelp})),r.createElement(aT.a,{grow:!0,className:"".concat(RR," ").concat(this.props.replayActive&&BT)},r.createElement(mT,{ref:this.errorBoundaryRef,onError:this.notifyError,fallBackComponent:r.createElement(LR,null)},this.props.showLegend&&r.createElement(wI,{className:PR,isMTLSEnabled:this.props.mtlsEnabled,closeLegend:this.props.toggleLegend}),a&&r.createElement(gr.a,{className:"".concat(xR," ").concat(this.props.replayActive?jR:NR),isOverflowChip:!0,isReadOnly:!0},this.props.replayActive&&r.createElement(co.a,{style:{marginRight:"4px"},isRead:!0},"Replay"),!n&&this.props.replayActive&&"click Play to start",!n&&!this.props.replayActive&&"".concat(this.displayTimeRange()),n&&"".concat(this.displayTimeRange())),(!this.props.replayActive||n)&&r.createElement(yb,Object.assign({containerClassName:wR,contextMenuGroupComponent:lg,contextMenuNodeComponent:lg,focusSelector:this.focusSelector,graphData:this.state.graphData,isMTLSEnabled:this.props.mtlsEnabled,onEmptyGraphAction:this.handleEmptyGraphAction,onNodeDoubleTap:this.handleDoubleTap,ref:function(t){return e.setCytoscapeGraph(t)}},this.props)),a&&r.createElement("div",{className:kR},r.createElement(dT,{cytoscapeGraphRef:this.cytoscapeGraphRef}))),this.props.summaryData&&r.createElement(AR,Object.assign({data:this.props.summaryData,duration:this.state.graphData.fetchParams.duration,graphType:this.props.graphType,injectServiceNodes:this.props.showServiceNodes,isPageVisible:this.props.isPageVisible,namespaces:this.props.activeNamespaces,queryTime:this.state.graphData.timestamp/1e3,trafficRates:this.props.trafficRates},Z(this.props.duration,30))))))}},{key:"setCytoscapeGraph",value:function(e){this.cytoscapeGraphRef.current=e}}],[{key:"getNodeParamsFromProps",value:function(e){var t,a,n=e.match.params.aggregate,r=n&&n!==it,i=e.match.params.aggregateValue,o=i&&i!==it,s=e.match.params.app,l=s&&s!==it,c=e.match.params.namespace,u=c&&c!==it,p=e.match.params.service,d=p&&p!==it,m=e.match.params.workload,h=m&&m!==it;if(r||o||l||u||d||h)return r?(t=Ze.AGGREGATE,a=""):l||h?(t=l?Ze.APP:Ze.WORKLOAD,a=e.match.params.version):(t=Ze.SERVICE,a=""),{aggregate:n,aggregateValue:i,app:s,namespace:{name:c},nodeType:t,service:p,version:a,workload:m}}},{key:"isNodeChanged",value:function(e,t){if(e===t)return!1;if(e&&!t||!e&&t)return!0;if(e&&t){var a=e.aggregate!==t.aggregate||e.aggregateValue!==t.aggregateValue,n=e.app!==t.app,r=e.service!==t.service,i=e.version!==t.version,o=e.nodeType!==t.nodeType,s=e.workload!==t.workload;return a||n||r||i||s||o}return!1}}]),a}(r.Component),FR=Object(h.b)((function(e){var t;return{activeNamespaces:hl(e),activeTour:e.tourState.activeTour,boxByCluster:e.graph.toolbarState.boxByCluster,boxByNamespace:e.graph.toolbarState.boxByNamespace,compressOnHide:e.graph.toolbarState.compressOnHide,duration:fl(e),edgeLabels:El(e),graphType:yl(e),isPageVisible:e.globalState.isPageVisible,lastRefreshAt:wl(e),layout:e.graph.layout,mtlsEnabled:Nl(e),node:e.graph.node,refreshInterval:Al(e),replayActive:Tl(e),replayQueryTime:Il(e),showIdleEdges:e.graph.toolbarState.showIdleEdges,showIdleNodes:e.graph.toolbarState.showIdleNodes,showLegend:e.graph.toolbarState.showLegend,showMissingSidecars:e.graph.toolbarState.showMissingSidecars,showOperationNodes:e.graph.toolbarState.showOperationNodes,showSecurity:e.graph.toolbarState.showSecurity,showServiceNodes:e.graph.toolbarState.showServiceNodes,showTrafficAnimation:e.graph.toolbarState.showTrafficAnimation,showVirtualServices:e.graph.toolbarState.showVirtualServices,summaryData:e.graph.summaryData,trace:null===(t=e.jaegerState)||void 0===t?void 0:t.selectedTrace,trafficRates:kl(e)}}),(function(e){return{endTour:Object(Ie.b)(yt.endTour,e),onNamespaceChange:Object(Ie.b)(Ke.onNamespaceChange,e),onReady:function(t){return e(TR.graphReady(t))},setActiveNamespaces:function(t){return e(ht.setActiveNamespaces(t))},setGraphDefinition:Object(Ie.b)(Ke.setGraphDefinition,e),setNode:Object(Ie.b)(Ke.setNode,e),setTraceId:function(t){return e(AC(t))},setUpdateTime:function(t){return e(Ke.setUpdateTime(t))},startTour:Object(Ie.b)(yt.startTour,e),toggleIdleNodes:Object(Ie.b)(st.toggleIdleNodes,e),toggleLegend:Object(Ie.b)(st.toggleLegend,e),updateSummary:function(t){return e(Ke.updateSummary(t))}}}))(DR),_R=Object(Jn.a)({margin:"0px 0 11px 0",$nest:{"& > ul > li > span":{float:"left",width:"125px",fontWeight:700}}}),MR=Object(Jn.a)({margin:"0 0 0 0",padding:"0 0 0 0",display:"inline-block",verticalAlign:"2px !important"}),HR=Object(Jn.a)({margin:"0px 0px 2px 10px",verticalAlign:"-5px !important"}),GR=Object(Jn.a)({marginLeft:"10px",verticalAlign:"-1px !important"}),VR=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).serviceInfoHandleTabClick=function(e,t){n.setState({serviceInfoTabKey:t})},n.state={serviceInfoTabKey:0},n}return Object(l.a)(a,[{key:"render",value:function(){var e,t=[],a=[];this.props.serviceDetails&&this.props.serviceDetails.workloads&&this.props.serviceDetails.workloads.sort((function(e,t){return e.name<t.name?-1:1})).forEach((function(e){if(e.labels){var n=e.labels[j.istioLabels.appLabelName];t.includes(n)||t.push(n)}a.push({workloadName:e.name,istioSidecar:e.istioSidecar})}));var n=!1;if(this.props.serviceDetails&&this.props.serviceDetails.service.labels&&this.props.serviceDetails.service.selectors)for(var i=Object.keys(this.props.serviceDetails.service.labels),o=0;o<i.length;o++){var s=i[o],l=this.props.serviceDetails.service.labels[s];if(this.props.serviceDetails.service.selectors[s]!==l){n=!0;break}}var c=r.createElement("div",{key:"properties-list",className:_R},r.createElement("ul",{style:{listStyleType:"none"}},this.props.serviceDetails&&r.createElement("li",null,r.createElement("span",null,"Created"),r.createElement("div",{style:{display:"inline-block"}},r.createElement(Rf,{time:this.props.serviceDetails.service.createdAt}))),this.props.serviceDetails&&r.createElement("li",null,r.createElement("span",null,"Version"),this.props.serviceDetails.service.resourceVersion),this.props.serviceDetails&&this.props.serviceDetails.additionalDetails&&this.props.serviceDetails.additionalDetails.map((function(e,t){return r.createElement("li",{key:"additional-details-"+t,id:"additional-details-"+t},r.createElement("span",null,e.title),e.icon&&ss(e.icon,void 0,t),r.createElement(kf,{text:e.value,urlTruncate:64}))})))),u=this.props.serviceDetails?this.props.serviceDetails.service.name:"Service";return r.createElement(Ef.a,{id:"ServiceDescriptionCard"},r.createElement(bf.a,null,r.createElement(Eo.a,{headingLevel:"h5",size:"lg"},r.createElement("div",{key:"service-icon",className:MR},r.createElement(pc,{badge:cc.Service,position:lo.b.top})),u,r.createElement(lo.a,{position:lo.b.right,content:r.createElement("div",{style:{textAlign:"left"}},c)},r.createElement(fi.Info,{className:HR})),r.createElement("span",{className:GR},r.createElement(Co,{id:u,health:this.props.serviceDetails?this.props.serviceDetails.health:void 0})))),r.createElement(yf.a,null,this.props.serviceDetails&&n&&r.createElement(Vh,{labels:this.props.serviceDetails.service.labels,tooltipMessage:"Labels defined on the Service"}),this.props.serviceDetails&&r.createElement(Vh,{labels:this.props.serviceDetails.service.selectors,tooltipMessage:"Labels defined on the "+(n?"Selector":"Service and Selector")}),r.createElement(Tf,{namespace:this.props.namespace,apps:t,workloads:a,health:null===(e=this.props.serviceDetails)||void 0===e?void 0:e.health})))}}]),a}(r.Component),UR=Object(Jn.a)({margin:"0px 0 11px 0",$nest:{"& > ul > li > span":{float:"left",width:"125px",fontWeight:700}}}),BR=Object(Jn.a)({margin:"0px 0px 2px 10px",verticalAlign:"-3px !important"}),WR=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"getPortOver",value:function(e){return r.createElement(_h,{checks:this.getPortChecks(e)})}},{key:"getPortChecks",value:function(e){return this.props.validations?this.props.validations.checks.filter((function(t){return t.path==="spec/ports["+e+"]"})):[]}},{key:"hasIssue",value:function(e){return this.getPortChecks(e).length>0}},{key:"getHostnames",value:function(e){var t=this,a=[];e.forEach((function(e){var n;null===(n=e.spec.hosts)||void 0===n||n.forEach((function(n){var r;"*"===n?null===(r=e.spec.gateways)||void 0===r||r.forEach((function(e){t.props.gateways.filter((function(t){return t.metadata.name===e})).forEach((function(e){var t;null===(t=e.spec.servers)||void 0===t||t.forEach((function(t){t.hosts.forEach((function(t){a.push({hostname:t,fromType:e.kind,fromName:e.metadata.name})}))}))}))})):a.push({hostname:n,fromType:e.kind,fromName:e.metadata.name})}))}));for(var n=0,r=a;n<r.length;n++){var i=r[n];if("*"===i.hostname)return[i]}return a}},{key:"render",value:function(){var e=this;return r.createElement(Ef.a,{isCompact:!0,id:"ServiceNetworkCard"},r.createElement(bf.a,null,r.createElement(Eo.a,{headingLevel:"h3",size:"2xl"},"Network")),r.createElement(yf.a,null,r.createElement("div",{key:"network-list",className:UR},r.createElement("ul",{style:{listStyleType:"none"}},r.createElement("li",null,r.createElement("span",null,"Type"),this.props.serviceDetails.service.type),r.createElement("li",null,r.createElement("span",null,"ExternalName"!==this.props.serviceDetails.service.type?"Service IP":"ExternalName"),"ExternalName"!==this.props.serviceDetails.service.type?this.props.serviceDetails.service.ip?this.props.serviceDetails.service.ip:"":this.props.serviceDetails.service.externalName?this.props.serviceDetails.service.externalName:""),r.createElement("li",null,r.createElement("span",null,"Endpoints"),r.createElement("div",{style:{display:"inline-block"}},(this.props.serviceDetails.endpoints||[]).map((function(e,t){return(e.addresses||[]).map((function(e,a){return r.createElement("div",{key:"endpoint_"+t+"_address_"+a},""!==e.name?r.createElement(lo.a,{position:lo.b.right,content:r.createElement("div",{style:{textAlign:"left"}},e.kind,": ",e.name)},r.createElement("span",null,e.ip," ",r.createElement(fi.Info,{className:BR}))):r.createElement(r.Fragment,null,e.name))}))})))),r.createElement("li",null,r.createElement("span",null,"Ports"),r.createElement("div",{style:{display:"inline-block"}},(this.props.serviceDetails.service.ports||[]).map((function(t,a){return r.createElement("div",{key:"port_"+a},r.createElement("span",{style:{marginRight:"10px"}},t.name," ",t.port,"/",t.protocol),e.hasIssue(a)?e.getPortOver(a):void 0)})))),this.props.serviceDetails.virtualServices.items.length>0&&r.createElement("li",null,r.createElement("span",null,"Hostnames"),r.createElement("div",{style:{display:"inline-block",width:"75%"}},this.getHostnames(this.props.serviceDetails.virtualServices.items).map((function(e,t){return r.createElement("div",{key:"hostname_"+t},r.createElement(lo.a,{position:lo.b.right,content:r.createElement("div",{style:{textAlign:"left"}},e.fromType," ",e.fromName,": ",e.hostname)},r.createElement("div",{style:{display:"flex"}},r.createElement("span",{style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}},e.hostname),r.createElement("span",null,r.createElement(fi.Info,{className:BR})))))}))))))))}}]),a}(r.Component),qR=Object(Jn.a)({height:"100%"}),KR=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).promises=new yr,n.graphDataSource=new Vf,n.goToMetrics=function(e){if(e.source!==e.target){var t="inbound"===(e.source===n.props.service?"outbound":"inbound")?"source_canonical_service":"destination_canonical_service",a=new URLSearchParams(U.location.search);a.set("tab","metrics"),a.set(P.BY_LABELS,t+"="+(e.source===n.props.service?e.target:e.source)),U.replace(U.location.pathname+"?"+a.toString())}},n.fetchBackend=function(){n.props.serviceDetails&&(n.promises.cancelAll(),n.graphDataSource.fetchForService(n.props.duration,n.props.namespace,n.props.service))},n.state={tabHeight:300},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.fetchBackend()}},{key:"componentDidUpdate",value:function(e){e.duration===this.props.duration&&e.serviceDetails===this.props.serviceDetails||this.fetchBackend()}},{key:"getServiceValidation",value:function(){if(this.props.validations&&this.props.validations.service&&this.props.serviceDetails)return this.props.validations.service[this.props.serviceDetails.service.name]}},{key:"render",value:function(){var e,t,a=this,n=(null===(e=this.props.serviceDetails)||void 0===e?void 0:e.virtualServices)?function(e,t){var a=[],n=Di.virtualservices,r=n.toLowerCase(),i=n.charAt(0).toLowerCase()+n.slice(1);return e.forEach((function(e){var n,o={namespace:e.metadata.namespace||"",type:r,name:e.metadata.name,creationTimestamp:e.metadata.creationTimestamp,resourceVersion:e.metadata.resourceVersion,validation:(n=e.metadata.name,t.virtualservice&&t.virtualservice[n]?t.virtualservice[e.metadata.name]:void 0)};o[i]=e,a.push(o)})),a}(this.props.serviceDetails.virtualServices.items,this.props.serviceDetails.validations):[],i=(null===(t=this.props.serviceDetails)||void 0===t?void 0:t.destinationRules)?function(e,t){var a=[],n=Di.destinationrules,r=n.toLowerCase(),i=n.charAt(0).toLowerCase()+n.slice(1);return e.forEach((function(e){var n,o={namespace:e.metadata.namespace||"",type:r,name:e.metadata.name,creationTimestamp:e.metadata.creationTimestamp,resourceVersion:e.metadata.resourceVersion,validation:(n=e.metadata.name,t.destinationrule&&t.destinationrule[n]?t.destinationrule[e.metadata.name]:void 0)};o[i]=e,a.push(o)})),a}(this.props.serviceDetails.destinationRules.items,this.props.serviceDetails.validations):[],o=n.concat(i),s=this.state.tabHeight?this.state.tabHeight-115:300,l=Object(Jn.a)({width:"100%",height:s});return r.createElement(r.Fragment,null,r.createElement(Zn,{onResize:function(e){return a.setState({tabHeight:e})}},r.createElement(Df.a,{gutter:"md",className:qR},r.createElement(Ff.a,{span:4},r.createElement(wh.a,{gutter:"md"},r.createElement(Rh.a,null,r.createElement(VR,{namespace:this.props.namespace,serviceDetails:this.props.serviceDetails})),this.props.serviceDetails&&r.createElement(WR,{serviceDetails:this.props.serviceDetails,gateways:this.props.gateways,validations:this.getServiceValidation()}),r.createElement(Rh.a,{style:{paddingBottom:"20px"}},r.createElement(jb,{name:this.props.service,items:o})))),r.createElement(Ff.a,{span:8},r.createElement(xb,{dataSource:this.graphDataSource,mtlsEnabled:this.props.mtlsEnabled,onEdgeTap:this.goToMetrics,graphContainerStyle:l})))))}}]),a}(r.Component),zR=Object(h.b)((function(e){return{duration:fl(e),lastRefreshAt:e.globalState.lastRefreshAt,mtlsEnabled:Nl(e)}}))(KR);!function(e){e[e.UP=0]="UP",e[e.DOWN=1]="DOWN"}(fR||(fR={}));var YR,QR,XR,JR=Object(Jn.a)({marginTop:15,color:nt.Red100}),ZR=Object(Jn.a)({marginTop:15,color:nt.Red100,textAlign:"center",width:"100%"}),$R=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).matchAllIndex=function(e){for(var t=-1,a=0;a<e.length;a++){if(0===e[a].matches.length){t=a;break}}return t},e.actionResolver=function(t,a){var n=a.rowIndex,r={title:"Remove Rule",onClick:function(t,a,n,r){return e.props.onRemoveRule(a)}},i={title:"Move Up",onClick:function(t,a,n,r){return e.props.onMoveRule(a,fR.UP)}},o={title:"Move Down",onClick:function(t,a,n,r){return e.props.onMoveRule(a,fR.DOWN)}},s=[];return e.props.rules.length>0&&s.push(r),n>0&&s.push(i),n+1<e.props.rules.length&&s.push(o),s},e}return Object(l.a)(a,[{key:"render",value:function(){var e=[{title:"Rule order",transforms:[Object(oo.a)(10)],props:{}},{title:"Request Matching",props:{}},{title:"Route To",props:{}}],t=!0,a=this.matchAllIndex(this.props.rules),n=this.props.rules.length>0?this.props.rules.map((function(e,n){var i,o;return t=-1===a||n<=a,{cells:[r.createElement(r.Fragment,null,n+1),r.createElement(r.Fragment,null,0===e.matches.length?"Any request":e.matches.map((function(e,t){return r.createElement("div",{key:"match_"+t},e)})),!t&&r.createElement("div",{className:JR},"Match 'Any request' is defined in a previous rule.",r.createElement("br",null),"This rule is not accessible.")),r.createElement(r.Fragment,null,r.createElement("div",{key:"ww_"+n},e.workloadWeights.filter((function(e){return!e.mirrored})).map((function(e,t){return r.createElement("div",{key:"wk_"+n+"_"+e.name+"_"+t},r.createElement(pc,{badge:cc.Workload,position:lo.b.top}),e.name," (",e.weight,"% routed traffic)")})),e.workloadWeights.filter((function(e){return e.mirrored})).map((function(e,t){return r.createElement("div",{key:"wk_mirrored_"+n+"_"+e.name+"_"+t},r.createElement(lo.a,{key:"mirrorred_"+e.name,position:lo.b.top,content:r.createElement(r.Fragment,null,"Mirrored Workload")},r.createElement(co.a,{className:"faultinjection_badge_definition"},"MI")),e.name," (",e.weight,"% mirrored traffic)")}))),e.delay&&r.createElement("div",{key:"delay_"+n},r.createElement(lo.a,{position:lo.b.top,content:r.createElement(r.Fragment,null,"Fault Injection: Delay")},r.createElement(co.a,{className:"faultinjection_badge_definition"},"FI")),null===(i=e.delay.percentage)||void 0===i?void 0:i.value,"% requests delayed (",e.delay.fixedDelay,")"),e.abort&&r.createElement("div",{key:"abort_"+n},r.createElement(lo.a,{position:lo.b.top,content:r.createElement(r.Fragment,null,"Fault Injection: Abort")},r.createElement(co.a,{className:"faultinjection_badge_definition"},"FI")),null===(o=e.abort.percentage)||void 0===o?void 0:o.value,"% requests aborted (HTTP Status ",e.abort.httpStatus,")"),e.timeout&&r.createElement("div",{key:"timeout_"+n},r.createElement(lo.a,{position:lo.b.top,content:r.createElement(r.Fragment,null,"Request Timeout")},r.createElement(co.a,{className:"faultinjection_badge_definition"},"RT")),"timeout (",e.timeout,")"),e.retries&&r.createElement("div",{key:"retries_"+n},r.createElement(lo.a,{position:lo.b.top,content:r.createElement(r.Fragment,null,"Request Retry")},r.createElement(co.a,{className:"faultinjection_badge_definition"},"RR")),e.retries.attempts," attempts with timeout (",e.timeout,")"))]}})):[{key:"rowEmpty",cells:[{title:r.createElement(Cu.a,{variant:Cu.b.full},r.createElement(Eo.a,{headingLevel:"h5",size:"lg"},"No Route Rules defined"),r.createElement(Su.a,{className:ZR},"A Request Routing scenario needs at least a Route Rule")),props:{colSpan:3}}]}];return r.createElement(r.Fragment,null,"Route Rules",Yp(id),r.createElement(Eu.b,{"aria-label":"Rules Created",cells:e,rows:n,actionResolver:this.actionResolver},r.createElement(bu.a,null),r.createElement(kp.a,null)))}}]),a}(r.Component),ek=a(1515),tk=["headers","uri","scheme","method","authority"],ak="is present",nk=["exact","prefix","regex"],rk=(YR={},Object(Ei.a)(YR,"headers","Header value..."),Object(Ei.a)(YR,"uri","Uri value..."),Object(Ei.a)(YR,"scheme","Scheme value..."),Object(Ei.a)(YR,"method","Method value..."),Object(Ei.a)(YR,"authority","Authority value..."),YR),ik=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).onMathOptionsToggle=function(){n.setState({isMatchDropdown:!n.state.isMatchDropdown})},n.onOperatorToggle=function(){n.setState({isOperatorDropdown:!n.state.isOperatorDropdown})},n.state={isMatchDropdown:!1,isOperatorDropdown:!1},n}return Object(l.a)(a,[{key:"render",value:function(){var e=this,t="headers"===this.props.category?[ak].concat(nk):nk;return r.createElement(ek.a,null,r.createElement(Ru.a,{toggle:r.createElement(ku.a,{onToggle:this.onMathOptionsToggle},this.props.category),isOpen:this.state.isMatchDropdown,dropdownItems:tk.map((function(t,a){return r.createElement(up.a,{key:t+"_"+a,value:t,component:"button",onClick:function(){e.props.onSelectCategory(t),e.onMathOptionsToggle()}},t)}))}),"headers"===this.props.category&&r.createElement(Ae.a,{id:"header-name-id",value:this.props.headerName,onChange:this.props.onHeaderNameChange,placeholder:"Header name..."}),r.createElement(Ru.a,{toggle:r.createElement(ku.a,{onToggle:this.onOperatorToggle},this.props.operator),isOpen:this.state.isOperatorDropdown,dropdownItems:t.map((function(t,a){return r.createElement(up.a,{key:t+"_"+a,value:t,component:"button",onClick:function(){e.props.onSelectOperator(t),e.onOperatorToggle()}},t)}))}),this.props.operator!==ak&&r.createElement(Ae.a,{id:"match-value-id",value:this.props.matchValue,onChange:this.props.onMatchValueChange,placeholder:rk[this.props.category]}),r.createElement(vr.a,{variant:"secondary",disabled:!this.props.isValid,onClick:this.props.onAddMatch},"Add Match"))}}]),a}(r.Component),ok=Object(Jn.a)({marginTop:20,height:40}),sk=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=this,t=this.props.matches.map((function(t,a){return r.createElement("span",{key:t+"-"+a},r.createElement(gr.a,{onClick:function(){return e.props.onRemoveMatch(t)},isOverflowChip:!0},t)," ")}));return r.createElement("div",{className:ok},r.createElement("span",{style:{marginRight:"32px"}},"Matching selected",Yp(ad)),t.length>0?t:r.createElement("b",null,"Match any request"))}}]),a}(r.Component),lk=a(1516),ck=Object(Jn.a)({marginBottom:10,color:nt.Red100,textAlign:"right"}),uk=Object(Jn.a)({width:"100%",textAlign:"right"}),pk=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).resetState=function(){0!==n.props.workloads.length&&n.setState((function(e){return{workloads:0===e.workloads.length&&n.props.initWeights.length>0?n.props.initWeights:om(n.props.workloads)}}),(function(){return n.props.onChange(n.checkTotalWeight(),n.state.workloads,!0)}))},n.onWeight=function(e,t){n.setState((function(a){for(var n=[],r=100,i=0;i<a.workloads.length;i++)a.workloads[i].locked&&(r-=a.workloads[i].weight);for(var o=0;o<a.workloads.length;o++)a.workloads[o].name===e?(a.workloads[o].weight=t,a.workloads[o].mirrored||(r-=t)):a.workloads[o].locked||a.workloads[o].mirrored||n.push(o);for(var s=0,l=0;l<n.length;l++)s+a.workloads[n[l]].weight>r&&(a.workloads[n[l]].weight=r-s),s+=a.workloads[n[l]].weight;return n.length>0&&s<r&&(a.workloads[n[n.length-1]].weight+=r-s),{workloads:a.workloads}}),(function(){return n.props.onChange(n.checkTotalWeight(),n.state.workloads,!1)}))},n.onLock=function(e,t){n.setState((function(a){for(var n=100,r=0;r<a.workloads.length;r++)a.workloads[r].name===e&&(a.workloads[r].locked=t),a.workloads[r].locked&&(n-=a.workloads[r].weight);for(var i=0;i<a.workloads.length;i++)a.workloads[i].locked||a.workloads[i].mirrored||(a.workloads[i].maxWeight=n);return{workloads:a.workloads}}))},n.onMirror=function(e,t){n.setState((function(a){for(var n=[],r=0;r<a.workloads.length;r++)a.workloads[r].mirrored=!1,a.workloads[r].locked=!1,t&&a.workloads[r].name===e&&(a.workloads[r].mirrored=t,a.workloads[r].locked=!1),a.workloads[r].mirrored||n.push(r);for(var i=0,o=0;o<n.length;o++)i+a.workloads[n[o]].weight>100&&(a.workloads[n[o]].weight=100-i),i+=a.workloads[n[o]].weight;return n.length>0&&i<100&&(a.workloads[n[n.length-1]].weight+=100-i),{workloads:a.workloads}}),(function(){return n.props.onChange(n.checkTotalWeight(),n.state.workloads,!1)}))},n.checkTotalWeight=function(){return 100===n.state.workloads.filter((function(e){return!e.mirrored})).map((function(e){return e.weight})).reduce((function(e,t){return e+t}),0)},n.state={workloads:[]},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.resetState()}},{key:"render",value:function(){var e=this,t=this.checkTotalWeight(),a=[{title:"Destination Workload",transforms:[Object(oo.a)(30)],props:{}},{title:"Traffic Weight",transforms:[Object(oo.a)(70)],props:{}}],n=this.state.workloads.filter((function(e){return!e.mirrored})).map((function(t){return{cells:[r.createElement(r.Fragment,null,r.createElement("div",null,r.createElement(pc,{badge:cc.Workload,position:lo.b.top}),t.name)),r.createElement(r.Fragment,null,r.createElement(UT,{id:"slider-"+t.name,key:"slider-"+t.name,tooltip:!0,input:!0,inputFormat:"%",value:t.weight,min:0,max:t.maxWeight,maxLimit:100,onSlide:function(a){e.onWeight(t.name,a)},onSlideStop:function(a){e.onWeight(t.name,a)},locked:!(e.state.workloads.length>1)||t.locked,showLock:e.state.workloads.length>2,onLock:function(a){return e.onLock(t.name,a)},mirrored:t.mirrored,showMirror:e.props.showMirror&&e.state.workloads.length>1,onMirror:function(a){return e.onMirror(t.name,a)}}))]}})),i=[{title:"Mirrored Workload",transforms:[Object(oo.a)(30)],props:{}},{title:"Mirror Percentage",transforms:[Object(oo.a)(70)],props:{}}],o=this.state.workloads.filter((function(e){return e.mirrored})).map((function(t){return{cells:[r.createElement(r.Fragment,null,r.createElement("div",null,r.createElement(lo.a,{key:"mirrorred_"+t.name,position:lo.b.top,content:r.createElement(r.Fragment,null,"Mirrored Workload")},r.createElement(co.a,{className:"faultinjection_badge_definition"},"MI")),t.name)),r.createElement(r.Fragment,null,r.createElement(UT,{id:"slider-"+t.name,key:"slider-"+t.name,tooltip:!0,input:!0,inputFormat:"%",value:t.weight,min:0,max:t.maxWeight,maxLimit:100,onSlide:function(a){e.onWeight(t.name,a)},onSlideStop:function(a){e.onWeight(t.name,a)},locked:!(e.state.workloads.length>1)||t.locked,showLock:e.state.workloads.length>2,onLock:function(a){return e.onLock(t.name,a)},mirrored:t.mirrored,showMirror:e.props.showMirror,onMirror:function(a){return e.onMirror(t.name,a)}}))]}}));return r.createElement(r.Fragment,null,r.createElement(Eu.b,{cells:a,rows:n,"aria-label":"weighted routing"},r.createElement(bu.a,null),r.createElement(kp.a,null)),o.length>0&&r.createElement(Eu.b,{cells:i,rows:o,"aria-label":"mirrors"},r.createElement(bu.a,null),r.createElement(kp.a,null)),this.props.workloads.length>1&&r.createElement("div",{className:uk},r.createElement(vr.a,{variant:"link",icon:r.createElement(lk.a,null),onClick:function(){return e.resetState()}},"Evenly distribute traffic")," "),this.props.showValid&&!t&&r.createElement("div",{className:ck},"The sum of all non-mirrored weights must be 100 %"))}}]),a}(r.Component),dk="Add a fixed delay before forwarding the request. Format: 1h/1m/1s/1ms. MUST be >=1ms.",mk=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e,t=this;return r.createElement(r.Fragment,null,r.createElement(mp.a,{label:"Add HTTP Delay",fieldId:"delaySwitch"},r.createElement(fp.a,{id:"delaySwitch",label:" ",labelOff:" ",isChecked:this.props.delayed,onChange:function(){return t.props.onDelay(!t.props.delayed,t.props.delay)}}),r.createElement("span",null,Yp(Zp))),this.props.delayed&&r.createElement(mp.a,{label:"Delay Percentage",fieldId:"delay-percentage",helperText:"Percentage of requests on which the delay will be injected."},r.createElement(Ae.a,{value:null===(e=this.props.delay.percentage)||void 0===e?void 0:e.value,type:"text",id:"delay-percentage",name:"delay-percentage",onChange:function(e){var a=Number(e||0);a=(a=Number.isNaN(a)?0:a)<0?0:a>100?100:a,t.props.onDelay(t.props.delayed,{percentage:{value:a},fixedDelay:t.props.delay.fixedDelay})}})),this.props.delayed&&r.createElement(mp.a,{label:"Fixed Delay",fieldId:"fixed-delay",helperText:dk,helperTextInvalid:dk,isValid:this.props.isValid},r.createElement(Ae.a,{value:this.props.delay.fixedDelay,id:"fixed-delay",name:"fixed-delay",isValid:this.props.isValid,onChange:function(e){return t.props.onDelay(t.props.delayed,{percentage:t.props.delay.percentage,fixedDelay:e})}})))}}]),a}(r.Component),hk="HTTP status code to use to abort the Http request.",fk=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e,t=this;return r.createElement(r.Fragment,null,r.createElement(mp.a,{label:"Add HTTP Abort",fieldId:"abortSwitch"},r.createElement(fp.a,{id:"abortSwitch",label:" ",labelOff:" ",isChecked:this.props.aborted,onChange:function(){return t.props.onAbort(!t.props.aborted,t.props.abort)}}),r.createElement("span",null,Yp(Jp))),this.props.aborted&&r.createElement(mp.a,{label:"Abort Percentage",fieldId:"abort-percentage",helperText:"Percentage of requests to be aborted with the error code provided."},r.createElement(Ae.a,{value:null===(e=this.props.abort.percentage)||void 0===e?void 0:e.value,id:"abort-percentage",name:"abort-percentage",onChange:function(e){var a=Number(e||0);a=(a=Number.isNaN(a)?0:a)<0?0:a>100?100:a,t.props.onAbort(t.props.aborted,{percentage:{value:a},httpStatus:t.props.abort.httpStatus})}})),this.props.aborted&&r.createElement(mp.a,{label:"HTTP Status Code",fieldId:"abort-status-code",helperText:hk,helperTextInvalid:hk,isValid:this.props.isValid},r.createElement(Ae.a,{value:this.props.abort.httpStatus,id:"abort-status-code",name:"abort-status-code",isValid:this.props.isValid,onChange:function(e){var a=Number(e||0);a=Number.isNaN(a)?0:a,t.props.onAbort(t.props.aborted,{percentage:t.props.abort.percentage,httpStatus:a})}})))}}]),a}(r.Component),gk=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).resetState=function(){n.setState({faultInjectionRoute:{workloads:n.props.initFaultInjectionRoute.workloads,delayed:n.props.initFaultInjectionRoute.delayed,delay:n.props.initFaultInjectionRoute.delay,aborted:n.props.initFaultInjectionRoute.aborted,abort:n.props.initFaultInjectionRoute.abort,isValidDelay:!n.props.initFaultInjectionRoute.delayed||Tp(n.props.initFaultInjectionRoute.delay.fixedDelay),isValidAbort:!n.props.initFaultInjectionRoute.aborted||Op(n.props.initFaultInjectionRoute.abort.httpStatus)}},(function(){return n.props.onChange(n.state.faultInjectionRoute.isValidDelay&&n.state.faultInjectionRoute.isValidAbort,n.state.faultInjectionRoute)}))},n.updateDelay=function(e,t){n.setState((function(a){return{faultInjectionRoute:{workloads:a.faultInjectionRoute.workloads,delayed:e,delay:t,isValidDelay:!e||Tp(t.fixedDelay),aborted:a.faultInjectionRoute.aborted,abort:a.faultInjectionRoute.abort,isValidAbort:a.faultInjectionRoute.isValidAbort}}}),(function(){return n.props.onChange(n.state.faultInjectionRoute.isValidDelay&&n.state.faultInjectionRoute.isValidAbort,n.state.faultInjectionRoute)}))},n.updateAbort=function(e,t){n.setState((function(a){return{faultInjectionRoute:{workloads:a.faultInjectionRoute.workloads,delayed:a.faultInjectionRoute.delayed,delay:a.faultInjectionRoute.delay,isValidDelay:a.faultInjectionRoute.isValidDelay,aborted:e,abort:t,isValidAbort:!e||Op(t.httpStatus)}}}),(function(){return n.props.onChange(n.state.faultInjectionRoute.isValidDelay&&n.state.faultInjectionRoute.isValidAbort,n.state.faultInjectionRoute)}))},n.state={faultInjectionRoute:{workloads:n.props.initFaultInjectionRoute.workloads,delayed:n.props.initFaultInjectionRoute.delayed,delay:n.props.initFaultInjectionRoute.delay,aborted:n.props.initFaultInjectionRoute.aborted,abort:n.props.initFaultInjectionRoute.abort,isValidDelay:!n.props.initFaultInjectionRoute.delayed||Tp(n.props.initFaultInjectionRoute.delay.fixedDelay),isValidAbort:!n.props.initFaultInjectionRoute.aborted||Op(n.props.initFaultInjectionRoute.abort.httpStatus)}},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.resetState()}},{key:"render",value:function(){var e=this;return r.createElement(r.Fragment,null,r.createElement(dp.a,{isHorizontal:!0,style:{paddingTop:10,paddingBottom:10}},r.createElement(mk,{delayed:this.state.faultInjectionRoute.delayed,delay:this.state.faultInjectionRoute.delay,isValid:this.state.faultInjectionRoute.isValidDelay,onDelay:function(t,a){return e.updateDelay(t,a)}}),r.createElement(fk,{aborted:this.state.faultInjectionRoute.aborted,abort:this.state.faultInjectionRoute.abort,isValid:this.state.faultInjectionRoute.isValidAbort,onAbort:function(t,a){return e.updateAbort(t,a)}})))}}]),a}(r.Component),vk="Timeout for HTTP requests. Format: 1h/1m/1s/1ms. MUST be >=1ms.",Ek=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=this;return r.createElement(r.Fragment,null,r.createElement(mp.a,{label:"Add HTTP Timeout",fieldId:"timeoutSwitch"},r.createElement(fp.a,{id:"timeoutSwitch",label:" ",labelOff:" ",isChecked:this.props.isTimeout,onChange:function(){return e.props.onTimeout(!e.props.isTimeout,e.props.timeout)}}),r.createElement("span",null,Yp(ed))),this.props.isTimeout&&r.createElement(mp.a,{label:"Timeout",fieldId:"timeout-value",helperText:vk,helperTextInvalid:vk,isValid:this.props.isValid},r.createElement(Ae.a,{value:this.props.timeout,type:"text",id:"timeout-value",name:"timeout-value",onChange:function(t){return e.props.onTimeout(e.props.isTimeout,t)}})))}}]),a}(r.Component),bk="Timeout per retry attempt for a given request. Format: 1h/1m/1s/1ms. MUST be >=1ms.",yk=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=this;return r.createElement(r.Fragment,null,r.createElement(mp.a,{label:"Add HTTP Retry",fieldId:"retrySwitch"},r.createElement(fp.a,{id:"retrySwitch",label:" ",labelOff:" ",isChecked:this.props.isRetry,onChange:function(){return e.props.onRetry(!e.props.isRetry,e.props.retries)}}),r.createElement("span",null,Yp($p))),this.props.isRetry&&r.createElement(r.Fragment,null,r.createElement(mp.a,{label:"Attempts",fieldId:"attempts",helperText:"Number of retries for a given request."},r.createElement(Ae.a,{value:this.props.retries.attempts,type:"text",id:"attempts",name:"attempts",onChange:function(t){var a=Number(t||0);a=Number.isNaN(a)?0:a,e.props.onRetry(e.props.isRetry,{attempts:a,perTryTimeout:e.props.retries.perTryTimeout,retryOn:e.props.retries.retryOn})}})),r.createElement(mp.a,{label:"Per Try Timeout",fieldId:"pre-try-timeout",helperText:bk,helperTextInvalid:bk,isValid:this.props.isValidRetry},r.createElement(Ae.a,{value:this.props.retries.perTryTimeout,id:"pre-try-timeout",name:"pre-try-timeout",isValid:this.props.isValidRetry,onChange:function(t){return e.props.onRetry(e.props.isRetry,{attempts:e.props.retries.attempts,perTryTimeout:t,retryOn:e.props.retries.retryOn})}}))))}}]),a}(r.Component),Ck=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).resetState=function(){n.setState({timeoutRetryRoute:{workloads:n.props.initTimeoutRetry.workloads,isTimeout:n.props.initTimeoutRetry.isTimeout,timeout:n.props.initTimeoutRetry.timeout,isValidTimeout:!n.props.initTimeoutRetry.isTimeout||Tp(n.props.initTimeoutRetry.timeout),isRetry:n.props.initTimeoutRetry.isRetry,retries:n.props.initTimeoutRetry.retries,isValidRetry:!n.props.initTimeoutRetry.isRetry||!!n.props.initTimeoutRetry.retries.perTryTimeout&&Tp(n.props.initTimeoutRetry.retries.perTryTimeout)}},(function(){return n.props.onChange(n.state.timeoutRetryRoute.isValidTimeout&&n.state.timeoutRetryRoute.isValidRetry,n.state.timeoutRetryRoute)}))},n.updateTimeout=function(e,t){n.setState((function(a){return{timeoutRetryRoute:{workloads:a.timeoutRetryRoute.workloads,isTimeout:e,timeout:t,isValidTimeout:!e||Tp(t),isRetry:a.timeoutRetryRoute.isRetry,retries:a.timeoutRetryRoute.retries,isValidRetry:a.timeoutRetryRoute.isValidRetry}}}),(function(){return n.props.onChange(n.state.timeoutRetryRoute.isValidTimeout&&n.state.timeoutRetryRoute.isValidRetry,n.state.timeoutRetryRoute)}))},n.updateRetry=function(e,t){n.setState((function(a){return{timeoutRetryRoute:{workloads:a.timeoutRetryRoute.workloads,isTimeout:a.timeoutRetryRoute.isTimeout,timeout:a.timeoutRetryRoute.timeout,isValidTimeout:a.timeoutRetryRoute.isValidTimeout,isRetry:e,retries:t,isValidRetry:!e||!!t.perTryTimeout&&Tp(t.perTryTimeout)}}}),(function(){n.props.onChange(n.state.timeoutRetryRoute.isValidTimeout&&n.state.timeoutRetryRoute.isValidRetry,n.state.timeoutRetryRoute)}))},n.state={timeoutRetryRoute:{workloads:n.props.initTimeoutRetry.workloads,isTimeout:n.props.initTimeoutRetry.isTimeout,timeout:n.props.initTimeoutRetry.timeout,isValidTimeout:Tp(n.props.initTimeoutRetry.timeout),isRetry:n.props.initTimeoutRetry.isRetry,retries:n.props.initTimeoutRetry.retries,isValidRetry:!!n.props.initTimeoutRetry.retries.perTryTimeout&&Tp(n.props.initTimeoutRetry.retries.perTryTimeout)}},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.resetState()}},{key:"render",value:function(){var e=this;return r.createElement(r.Fragment,null,r.createElement(dp.a,{isHorizontal:!0,style:{paddingTop:10,paddingBottom:10}},r.createElement(Ek,{isTimeout:this.state.timeoutRetryRoute.isTimeout,timeout:this.state.timeoutRetryRoute.timeout,isValid:this.state.timeoutRetryRoute.isValidTimeout,onTimeout:function(t,a){return e.updateTimeout(t,a)}}),r.createElement(yk,{isRetry:this.state.timeoutRetryRoute.isRetry,retries:this.state.timeoutRetryRoute.retries,isValidRetry:this.state.timeoutRetryRoute.isValidRetry,onRetry:function(t,a){return e.updateRetry(t,a)}})))}}]),a}(r.Component),Sk=Object(Jn.a)({width:"100%",textAlign:"right"}),Ak=Object(Jn.a)({marginRight:20,color:nt.Red100,display:"inline"}),Tk=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).onWorkloadsToggle=function(){n.setState({isWorkloadSelector:!n.state.isWorkloadSelector})},n.ruleHandleTabClick=function(e,t){n.setState({ruleTabKey:t})},n.state={isWorkloadSelector:!1,ruleTabKey:0},n}return Object(l.a)(a,[{key:"render",value:function(){return r.createElement(r.Fragment,null,r.createElement(ch.a,{isFilled:!0,activeKey:this.state.ruleTabKey,onSelect:this.ruleHandleTabClick},r.createElement(bh.a,{eventKey:0,title:"Request Matching"},r.createElement("div",{style:{marginTop:"20px"}},r.createElement(ik,this.props),r.createElement(sk,this.props))),r.createElement(bh.a,{eventKey:1,title:"Route To"},r.createElement("div",{style:{marginBottom:"10px"}},r.createElement(pk,{showValid:!1,workloads:this.props.workloads,initWeights:this.props.weights,showMirror:!0,onChange:this.props.onSelectWeights}))),r.createElement(bh.a,{eventKey:2,title:"Fault Injection"},r.createElement("div",{style:{marginTop:"10px"}},r.createElement(gk,{initFaultInjectionRoute:this.props.faultInjectionRoute,onChange:this.props.onSelectFaultInjection}))),r.createElement(bh.a,{eventKey:3,title:"Request Timeouts"},r.createElement("div",{style:{marginTop:"10px"}},r.createElement(Ck,{initTimeoutRetry:this.props.timeoutRetryRoute,onChange:this.props.onSelectTimeoutRetry})))),r.createElement("div",{className:Sk},r.createElement("span",null,this.props.validationMsg.length>0&&r.createElement("div",{className:Ak},this.props.validationMsg),r.createElement(vr.a,{variant:"secondary",isDisabled:!this.props.isValid,onClick:this.props.onAddRule},"Add Route Rule"))))}}]),a}(r.Component),Ok="A Rule with same matching criteria is already added.",Ik=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).isMatchesIncluded=function(e,t){for(var a=!1,n=0;n<e.length;n++){var r=e[n];if(r.matches.length===t.matches.length&&(a=r.matches.every((function(e){return t.matches.includes(e)}))))break}return a},n.isValid=function(e){if(0===e.length)return!1;for(var t=n.matchAllIndex(e),a=!0,r=0;r<n.state.rules.length;r++)if(!(a=-1===t||r<=t))return a;return a},n.onAddMatch=function(){n.setState((function(e){var t;return t=""!==n.state.matchValue?e.category+("headers"===e.category?" ["+e.headerName+"] ":" ")+e.operator+" "+e.matchValue:e.category+" ["+e.headerName+"] regex ^.*$",e.matches.includes(t)||e.matches.push(t),{matches:e.matches,headerName:"",matchValue:""}}))},n.onAddRule=function(){n.setState((function(e){var t=[];e.workloadWeights.forEach((function(e){return t.push({name:e.name,weight:e.weight,locked:e.locked,maxWeight:e.maxWeight,mirrored:e.mirrored})}));var a={matches:Object.assign([],e.matches),workloadWeights:t};return e.faultInjectionRoute.delayed&&e.faultInjectionRoute.isValidDelay&&(a.delay=e.faultInjectionRoute.delay),e.faultInjectionRoute.aborted&&e.faultInjectionRoute.isValidAbort&&(a.abort=e.faultInjectionRoute.abort),e.timeoutRetryRoute.isTimeout&&e.timeoutRetryRoute.isValidTimeout&&(a.timeout=e.timeoutRetryRoute.timeout),e.timeoutRetryRoute.isRetry&&e.timeoutRetryRoute.isValidRetry&&(a.retries=e.timeoutRetryRoute.retries),n.isMatchesIncluded(e.rules,a)?{matches:e.matches,headerName:e.headerName,matchValue:e.matchValue,rules:e.rules,validationMsg:Ok,faultInjectionRoute:e.faultInjectionRoute,timeoutRetryRoute:e.timeoutRetryRoute}:(e.rules.push(a),{matches:e.matches,headerName:e.headerName,matchValue:e.matchValue,rules:e.rules,validationMsg:"",faultInjectionRoute:e.faultInjectionRoute,timeoutRetryRoute:e.timeoutRetryRoute})}),(function(){return n.props.onChange(n.isValid(n.state.rules),n.state.rules)}))},n.onRemoveMatch=function(e){n.setState((function(t){return{matches:t.matches.filter((function(t){return e!==t})),validationMsg:t.validationMsg===Ok?"":t.validationMsg}}))},n.onRemoveRule=function(e){n.setState((function(t){return t.rules.splice(e,1),{rules:t.rules,validationMsg:""}}),(function(){return n.props.onChange(n.isValid(n.state.rules),n.state.rules)}))},n.onHeaderNameChange=function(e){var t="";""!==n.state.matchValue&&""===e&&(t="Header name must be non empty"),""===n.state.matchValue&&""!==e&&n.state.operator!==ak&&(t="Header value must be non empty"),n.setState({headerName:e,validationMsg:t})},n.onMatchValueChange=function(e){var t="";"headers"===n.state.category&&(""===n.state.headerName&&""!==e&&(t="Header name must be non empty"),""!==n.state.headerName&&""===e&&(t="Header value must be non empty")),""===e&&(t=""),n.setState({matchValue:e,validationMsg:t})},n.onSelectWeights=function(e,t){n.setState({workloadWeights:t,validationMsg:e?"":"The sum of all non-mirrored weights must be 100 %"})},n.onMoveRule=function(e,t){n.setState((function(a){var n=a.rules[e],r=t===fR.UP?e-1:e+1,i=a.rules[r];return a.rules[r]=n,a.rules[e]=i,{rules:a.rules}}),(function(){return n.props.onChange(n.isValid(n.state.rules),n.state.rules)}))},n.matchAllIndex=function(e){for(var t=-1,a=0;a<e.length;a++){if(0===e[a].matches.length){t=a;break}}return t},n.state={category:"headers",operator:ak,workloadWeights:om(n.props.workloads),faultInjectionRoute:{workloads:[],delayed:!1,delay:{percentage:{value:100},fixedDelay:"5s"},isValidDelay:!0,aborted:!1,abort:{percentage:{value:100},httpStatus:503},isValidAbort:!0},timeoutRetryRoute:{workloads:[],isTimeout:!1,timeout:"2s",isValidTimeout:!0,isRetry:!1,retries:{attempts:3,perTryTimeout:"2s",retryOn:"gateway-error,connect-failure,refused-stream"},isValidRetry:!0},matches:[],headerName:"",matchValue:"",rules:n.props.initRules,validationMsg:""},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.props.initRules.length>0&&this.setState({rules:this.props.initRules},(function(){return e.props.onChange(e.isValid(e.state.rules),e.state.rules)}))}},{key:"render",value:function(){var e=this;return r.createElement(r.Fragment,null,r.createElement(Tk,{category:this.state.category,operator:this.state.operator,headerName:this.state.headerName,matchValue:this.state.matchValue,isValid:""===this.state.validationMsg,onSelectCategory:function(t){e.setState((function(e){return{category:t,operator:e.operator===ak&&"headers"!==t?"exact":e.operator}}))},onHeaderNameChange:this.onHeaderNameChange,onSelectOperator:function(t){return e.setState({operator:t})},onMatchValueChange:this.onMatchValueChange,onAddMatch:this.onAddMatch,matches:this.state.matches,onRemoveMatch:this.onRemoveMatch,workloads:this.props.workloads,weights:this.state.workloadWeights,onSelectWeights:this.onSelectWeights,faultInjectionRoute:this.state.faultInjectionRoute,onSelectFaultInjection:function(t,a){e.setState((function(e){return{faultInjectionRoute:a,validationMsg:t?"":"Fault Injection not valid"}}))},timeoutRetryRoute:this.state.timeoutRetryRoute,onSelectTimeoutRetry:function(t,a){e.setState((function(e){return{timeoutRetryRoute:a,validationMsg:t?"":"Request Timeout not valid"}}))},validationMsg:this.state.validationMsg,onAddRule:this.onAddRule}),r.createElement($R,{rules:this.state.rules,onRemoveRule:this.onRemoveRule,onMoveRule:this.onMoveRule}))}}]),a}(r.Component);(XR=QR||(QR={}))[XR.SWITCH=0]="SWITCH",XR[XR.MESH=1]="MESH",XR[XR.GW_HOSTS=2]="GW_HOSTS",XR[XR.SELECT=3]="SELECT",XR[XR.GATEWAY_SELECTED=4]="GATEWAY_SELECTED",XR[XR.PORT=5]="PORT";var wk,Rk,kk=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).checkGwHosts=function(e){for(var t=e.split(","),a=0;a<t.length;a++)if("*"!==t[a]&&!t[a].includes("."))return!1;return!0},n.onFormChange=function(e,t){switch(e){case QR.SWITCH:n.setState((function(e){return{addGateway:!e.addGateway}}),(function(){return n.props.onGatewayChange(!0,n.state)}));break;case QR.MESH:n.setState((function(e){return{addMesh:!e.addMesh}}),(function(){return n.props.onGatewayChange(!0,n.state)}));break;case QR.GW_HOSTS:n.setState({gwHosts:t,gwHostsValid:n.checkGwHosts(t)},(function(){return n.props.onGatewayChange(n.state.gwHostsValid,n.state)}));break;case QR.SELECT:n.setState({newGateway:"true"===t},(function(){return n.props.onGatewayChange(!0,n.state)}));break;case QR.GATEWAY_SELECTED:n.setState({selectedGateway:t},(function(){return n.props.onGatewayChange(!0,n.state)}));break;case QR.PORT:n.setState({port:+t},(function(){return n.props.onGatewayChange(!0,n.state)}))}},n.state={addGateway:e.hasGateway,gwHosts:"*",gwHostsValid:!0,newGateway:0===e.gateways.length,selectedGateway:e.gateways.length>0?""!==e.gateway?e.gateway:e.gateways[0]:"",addMesh:e.isMesh,port:80},n}return Object(l.a)(a,[{key:"render",value:function(){var e=this;return r.createElement(dp.a,{isHorizontal:!0},r.createElement(mp.a,{label:"Add Gateway",fieldId:"gatewaySwitch"},r.createElement(fp.a,{id:"advanced-gwSwitch",label:" ",labelOff:" ",isChecked:this.state.addGateway,onChange:function(){return e.onFormChange(QR.SWITCH,"")}}),r.createElement("span",null,Yp(Xp))),this.state.addGateway&&r.createElement(r.Fragment,null,r.createElement(mp.a,{fieldId:"includeMesh"},r.createElement(PS.a,{id:"includeMesh",label:r.createElement(r.Fragment,null,"Include ",r.createElement("b",null,"mesh")," gateway"),isDisabled:!this.state.addGateway,isChecked:this.state.addMesh,onChange:function(){return e.onFormChange(QR.MESH,"")}})),r.createElement(mp.a,{fieldId:"selectGateway"},r.createElement(qp.a,{id:"existingGateway",name:"selectGateway",label:"Select Gateway",isDisabled:!this.state.addGateway||0===this.props.gateways.length,isChecked:!this.state.newGateway,onChange:function(){return e.onFormChange(QR.SELECT,"false")}}),r.createElement(qp.a,{id:"createGateway",name:"selectGateway",label:"Create Gateway",isDisabled:!this.state.addGateway,isChecked:this.state.newGateway,onChange:function(){return e.onFormChange(QR.SELECT,"true")}})),!this.state.newGateway&&r.createElement(mp.a,{fieldId:"selectGateway",label:"Gateway"},this.props.gateways.length>0&&r.createElement(ur.a,{id:"selectGateway",value:this.state.selectedGateway,isDisabled:!this.state.addGateway||this.state.newGateway||0===this.props.gateways.length,onChange:function(t){return e.onFormChange(QR.GATEWAY_SELECTED,t)}},this.props.gateways.map((function(e){return r.createElement(pr.a,{key:e,value:e,label:e})}))),0===this.props.gateways.length&&r.createElement(r.Fragment,null,"There are no gateways to select.")),this.state.newGateway&&r.createElement(r.Fragment,null,r.createElement(mp.a,{fieldId:"gwPort",label:"Port"},r.createElement(Ae.a,{id:"gwPort",name:"gwPort",type:"number",isDisabled:!this.state.addGateway||!this.state.newGateway,value:this.state.port,onChange:function(t){return e.onFormChange(QR.PORT,t)}})),r.createElement(mp.a,{fieldId:"gwHosts",label:"Gateway Hosts",helperText:"One or more hosts exposed by this gateway. Enter one or multiple hosts separated by comma.",helperTextInvalid:"Gateway hosts should be specified using FQDN format or '*' wildcard.",isValid:this.state.gwHostsValid},r.createElement(Ae.a,{id:"gwHosts",name:"gwHosts",isDisabled:!this.state.addGateway||!this.state.newGateway,value:this.state.gwHosts,onChange:function(t){return e.onFormChange(QR.GW_HOSTS,t)},isValid:this.state.gwHostsValid})))))}}]),a}(r.Component),xk=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=this,t=this.props.vsHosts.length>0?this.props.vsHosts.join(","):"";return r.createElement(dp.a,{isHorizontal:!0},r.createElement(mp.a,{label:"VirtualService Hosts",fieldId:"advanced-vshosts",helperText:"The destination hosts to which traffic is being sent. Enter one or multiple hosts separated by comma."},r.createElement(Ae.a,{value:t,id:"advanced-vshosts",name:"advanced-vshosts",onChange:function(t){return e.props.onVsHostsChange(!0,t.split(","))}})))}}]),a}(r.Component),Nk=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e,t,a=this;return r.createElement(r.Fragment,null,r.createElement(mp.a,{label:"Add Connection Pool",fieldId:"cpSwitch"},r.createElement(fp.a,{id:"cpSwitch",label:" ",labelOff:" ",isChecked:this.props.isConnectionPool,onChange:function(){return a.props.onConnectionPool(!a.props.isConnectionPool,a.props.connectionPool)}}),r.createElement("span",null,Yp(Qp))),this.props.isConnectionPool&&r.createElement(mp.a,{label:"Max Connections",fieldId:"maxConnections",helperText:"Maximum number of HTTP1 /TCP connections to a destination host"},r.createElement(Ae.a,{value:null===(e=this.props.connectionPool.tcp)||void 0===e?void 0:e.maxConnections,id:"maxConnections",name:"maxConnections",onChange:function(e){var t=Number(e||0);t=Number.isNaN(t)?0:t;var n=a.props.connectionPool;n.tcp||(n.tcp={}),n.tcp.maxConnections=t,a.props.onConnectionPool(a.props.isConnectionPool,n)}})),this.props.isConnectionPool&&r.createElement(mp.a,{label:"HTTP1 Max Pending Requests",fieldId:"http1MaxPendingRequests",helperText:"Maximum number of pending HTTP requests to a destination."},r.createElement(Ae.a,{value:null===(t=this.props.connectionPool.http)||void 0===t?void 0:t.http1MaxPendingRequests,id:"http1MaxPendingRequests",name:"http1MaxPendingRequests",onChange:function(e){var t=Number(e||0);t=Number.isNaN(t)?0:t;var n=a.props.connectionPool;n.http||(n.http={}),n.http.http1MaxPendingRequests=t,a.props.onConnectionPool(a.props.isConnectionPool,n)}})))}}]),a}(r.Component),jk=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=this;return r.createElement(r.Fragment,null,r.createElement(mp.a,{label:"Add Outlier Detection",fieldId:"odSwitch"},r.createElement(fp.a,{id:"odSwitch",label:" ",labelOff:" ",isChecked:this.props.isOutlierDetection,onChange:function(){return e.props.onOutlierDetection(!e.props.isOutlierDetection,e.props.outlierDetection)}}),r.createElement("span",null,Yp(nd))),this.props.isOutlierDetection&&r.createElement(mp.a,{label:"Consecutive Errors",fieldId:"consecutiveErrors",helperText:"Number of errors before a host is ejected from the connection pool."},r.createElement(Ae.a,{value:this.props.outlierDetection.consecutiveErrors,id:"consecutiveErrors",name:"consecutiveErrors",onChange:function(t){var a=Number(t||0);a=Number.isNaN(a)?0:a;var n=e.props.outlierDetection;n.consecutiveErrors=a,e.props.onOutlierDetection(e.props.isOutlierDetection,n)}})))}}]),a}(r.Component),Pk=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).resetState=function(){n.setState({addConnectionPool:n.props.hasConnectionPool,connectionPool:n.props.connectionPool,isValidConnectionPool:!n.props.hasConnectionPool||Ip(n.props.connectionPool),addOutlierDetection:n.props.hasOutlierDetection,outlierDetection:n.props.outlierDetection,isValidOutlierDetection:!n.props.hasOutlierDetection||wp(n.props.outlierDetection)})},n.state={addConnectionPool:n.props.hasConnectionPool,connectionPool:n.props.connectionPool,isValidConnectionPool:!n.props.hasConnectionPool||Ip(n.props.connectionPool),addOutlierDetection:n.props.hasOutlierDetection,outlierDetection:n.props.outlierDetection,isValidOutlierDetection:!n.props.hasOutlierDetection||wp(n.props.outlierDetection)},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.resetState()}},{key:"render",value:function(){var e=this;return r.createElement(dp.a,{isHorizontal:!0,style:{paddingTop:10,paddingBottom:10}},r.createElement(Nk,{isConnectionPool:this.state.addConnectionPool,connectionPool:this.state.connectionPool,onConnectionPool:function(t,a){e.setState((function(e){return a.tcp&&(e.connectionPool.tcp=a.tcp),a.http&&(e.connectionPool.http=a.http),{addConnectionPool:t,connectionPool:e.connectionPool,isValidConnectionPool:!t||Ip(e.connectionPool)}}),(function(){return e.props.onCircuitBreakerChange(e.state)}))}}),r.createElement(jk,{isOutlierDetection:this.state.addOutlierDetection,outlierDetection:this.state.outlierDetection,onOutlierDetection:function(t,a){e.setState((function(e){return a.consecutiveErrors&&(e.outlierDetection.consecutiveErrors=a.consecutiveErrors),{addOutlierDetection:t,isValidOutlierDetection:!t||wp(e.outlierDetection)}}),(function(){return e.props.onCircuitBreakerChange(e.state)}))}}))}}]),a}(r.Component),Lk=function(e){return{showWizard:!1,showAdvanced:!1,advancedTabKey:0,workloads:[],rules:[],faultInjectionRoute:{workloads:[],delayed:!1,delay:{percentage:{value:100},fixedDelay:"5s"},isValidDelay:!0,aborted:!1,abort:{percentage:{value:100},httpStatus:503},isValidAbort:!0},timeoutRetryRoute:{workloads:[],isTimeout:!1,timeout:"2s",isValidTimeout:!0,isRetry:!1,retries:{attempts:3,perTryTimeout:"2s",retryOn:"gateway-error,connect-failure,refused-stream"},isValidRetry:!0},valid:{mainWizard:!0,vsHosts:!0,tls:!0,lb:!0,gateway:!0,cp:!0,od:!0},advancedOptionsValid:!0,vsHosts:[e],trafficPolicy:{tlsModified:!1,mtlsMode:"UNSET",clientCertificate:"",privateKey:"",caCertificates:"",addLoadBalancer:!1,simpleLB:!1,consistentHashType:Fu.HTTP_HEADER_NAME,loadBalancer:{simple:"ROUND_ROBIN"},peerAuthnSelector:{addPeerAuthentication:!1,addPeerAuthnModified:!1,mode:Oo.UNSET},addConnectionPool:!1,connectionPool:{},addOutlierDetection:!1,outlierDetection:{}},gateway:void 0}},Dk=Object(Jn.a)({marginTop:10}),Fk=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).compareWorkloads=function(e,t){if(e.length!==t.length)return!1;for(var a=function(a){if(!t.some((function(t){return A.a.isEqual(t,e[a])})))return{v:!1}},n=0;n<e.length;n++){var r=a(n);if("object"===typeof r)return r.v}return!0},n.onClose=function(e){n.setState(Lk(am(n.props.serviceName,n.props.namespace))),n.props.onClose(e)},n.onCreateUpdate=function(){var e=[];switch(n.props.type){case"traffic_shifting":case"tcp_traffic_shifting":case"request_routing":case"fault_injection":case"request_timeouts":var t=rm(n.props,n.state),a=Object(T.a)(t,4),r=a[0],i=a[1],o=a[2],s=a[3];o&&e.push(pn(n.props.namespace,"gateways",JSON.stringify(o))),n.props.update?(e.push(un(n.props.namespace,"destinationrules",r.metadata.name,JSON.stringify(r))),e.push(un(n.props.namespace,"virtualservices",i.metadata.name,JSON.stringify(i))),n.handlePeerAuthnUpdate(s,r,e)):(e.push(pn(n.props.namespace,"destinationrules",JSON.stringify(r))),e.push(pn(n.props.namespace,"virtualservices",JSON.stringify(i))),s&&e.push(pn(n.props.namespace,"peerauthentications",JSON.stringify(s))))}n.setState((function(e){return e.valid.mainWizard=!1,{valid:e.valid}})),Promise.all(e).then((function(e){e.length>0&&Dn("Istio Config "+(n.props.update?"updated":"created")+" for "+n.props.serviceName+" service.","default",Te.SUCCESS),n.onClose(!0)})).catch((function(e){_n("Could not "+(n.props.update?"update":"create")+" Istio config objects.",e),n.onClose(!0)}))},n.handlePeerAuthnUpdate=function(e,t,a){e?n.state.trafficPolicy.peerAuthnSelector.addPeerAuthnModified?a.push(pn(n.props.namespace,"peerauthentications",JSON.stringify(e))):a.push(un(n.props.namespace,"peerauthentications",t.metadata.name,JSON.stringify(e))):n.state.trafficPolicy.peerAuthnSelector.addPeerAuthnModified&&a.push(cn(n.props.namespace,"peerauthentications",t.metadata.name))},n.onVsHosts=function(e,t){n.setState((function(a){return a.valid.vsHosts=e,a.gateway&&a.gateway.addGateway&&a.gateway.newGateway&&(a.gateway.gwHosts=t.join(",")),{valid:a.valid,vsHosts:t}}))},n.onTrafficPolicy=function(e,t){n.setState((function(a){return a.valid.tls=e,a.valid.lb=e,{valid:a.valid,trafficPolicy:t}}))},n.onCircuitBreaker=function(e){n.setState((function(t){return t.valid.cp=e.isValidConnectionPool,t.valid.od=e.isValidOutlierDetection,t.trafficPolicy.addConnectionPool=e.addConnectionPool,t.trafficPolicy.connectionPool=e.connectionPool,t.trafficPolicy.addOutlierDetection=e.addOutlierDetection,t.trafficPolicy.outlierDetection=e.outlierDetection,{valid:t.valid,trafficPolicy:t.trafficPolicy}}))},n.onGateway=function(e,t){n.setState((function(a){return a.valid.gateway=e,{valid:a.valid,gateway:t,vsHosts:t.addGateway&&t.newGateway&&t.gwHosts.length>0?t.gwHosts.split(","):a.vsHosts}}))},n.onWeightsChange=function(e,t){n.setState((function(a){return a.valid.mainWizard=e,{valid:a.valid,workloads:t}}))},n.onRulesChange=function(e,t){n.setState((function(a){return a.valid.mainWizard=e,{valid:a.valid,rules:t}}))},n.onFaultInjectionRouteChange=function(e,t){n.setState((function(a){return a.valid.mainWizard=e,{valid:a.valid,faultInjectionRoute:t}}))},n.onTimeoutRetryRouteChange=function(e,t){n.setState((function(a){return a.valid.mainWizard=e,{valid:a.valid,timeoutRetryRoute:t}}))},n.isValid=function(e){return e.valid.mainWizard&&e.valid.vsHosts&&e.valid.tls&&e.valid.lb&&e.valid.gateway&&e.valid.cp&&e.valid.od},n.advancedHandleTabClick=function(e,t){n.setState({advancedTabKey:t})},n.state=Lk(am(e.serviceName,e.namespace)),n}return Object(l.a)(a,[{key:"componentDidUpdate",value:function(e){if(e.show!==this.props.show||!this.compareWorkloads(e.workloads,this.props.workloads)){var t;switch(this.props.type){case"traffic_shifting":t=!0;break;case"request_routing":t=!1;break;case"fault_injection":case"request_timeouts":default:t=!0}var a=1===(C=this.props.virtualServices).items.length&&C.items[0]&&C.items[0].spec.hosts?C.items[0].spec.hosts:[],n=1===(y=this.props.destinationRules).items.length&&y.items[0].spec.trafficPolicy&&y.items[0].spec.trafficPolicy.tls?[y.items[0].spec.trafficPolicy.tls.mode||"",y.items[0].spec.trafficPolicy.tls.clientCertificate||"",y.items[0].spec.trafficPolicy.tls.privateKey||"",y.items[0].spec.trafficPolicy.tls.caCertificates||""]:["","","",""],r=Object(T.a)(n,4),i=r[0],o=r[1],s=r[2],l=r[3],c=function(e){if(1===e.items.length&&e.items[0].spec.trafficPolicy&&e.items[0].spec.trafficPolicy.loadBalancer)return e.items[0].spec.trafficPolicy.loadBalancer}(this.props.destinationRules),u=Fu.HTTP_HEADER_NAME;c&&c.consistentHash&&(c.consistentHash.httpHeaderName?u=Fu.HTTP_HEADER_NAME:c.consistentHash.httpCookie?u=Fu.HTTP_COOKIE:c.consistentHash.useSourceIp&&(u=Fu.USE_SOURCE_IP));var p=function(e,t){var a;if(1===e.items.length&&e.items[0].metadata.annotations&&e.items[0].metadata.annotations.kiali_wizard_related){var n=e.items[0].metadata.annotations.kiali_wizard_related.split("/");if(n.length>1){var r=t.find((function(e){return e.metadata.name===n[1]}));r&&(a=r.spec.mtls.mode)}}return a}(this.props.destinationRules,this.props.peerAuthentications),d=function(e){var t,a;if(1===e.items.length&&e.items[0].spec.trafficPolicy&&(null===(t=e.items[0].spec.trafficPolicy)||void 0===t?void 0:t.connectionPool))return null===(a=e.items[0].spec.trafficPolicy)||void 0===a?void 0:a.connectionPool}(this.props.destinationRules),m=function(e){var t,a;if(1===e.items.length&&e.items[0].spec.trafficPolicy&&(null===(t=e.items[0].spec.trafficPolicy)||void 0===t?void 0:t.outlierDetection))return null===(a=e.items[0].spec.trafficPolicy)||void 0===a?void 0:a.outlierDetection}(this.props.destinationRules),h={tlsModified:""!==i,mtlsMode:""!==i?i:"UNSET",clientCertificate:o,privateKey:s,caCertificates:l,addLoadBalancer:void 0!==c,simpleLB:void 0!==c&&void 0!==c.simple,consistentHashType:u,loadBalancer:c||{simple:"ROUND_ROBIN"},peerAuthnSelector:{addPeerAuthentication:void 0!==p,addPeerAuthnModified:!1,mode:p||Oo.UNSET},addConnectionPool:!!d,connectionPool:d||{tcp:{maxConnections:1},http:{http1MaxPendingRequests:1}},addOutlierDetection:!!m,outlierDetection:m||{consecutiveErrors:1}},f={addGateway:!1,gwHosts:"",gwHostsValid:!1,newGateway:!1,selectedGateway:"",addMesh:!1,port:80};if(pm(this.props.virtualServices)){var g=dm(this.props.virtualServices),v=Object(T.a)(g,2),E=v[0],b=v[1];f.addGateway=!0,f.selectedGateway=E,f.addMesh=b}this.setState({showWizard:this.props.show,workloads:[],rules:[],valid:{mainWizard:t,vsHosts:!0,tls:!0,lb:!0,gateway:!0,cp:!0,od:!0},vsHosts:a.length>1||1===a.length&&a[0].length>0?a:[am(this.props.serviceName,this.props.namespace)],trafficPolicy:h,gateway:f})}var y,C}},{key:"render",value:function(){var e=this,t=dm(this.props.virtualServices),a=Object(T.a)(t,2),n=a[0],i=a[1];return r.createElement(ih.a,{width:"75%",title:this.props.type.length>0?this.props.update?"Update "+tm[this.props.type]:"Create "+tm[this.props.type]:"",isOpen:this.state.showWizard,onClose:function(){return e.onClose(!1)},onKeyPress:function(t){"Enter"===t.key&&e.isValid(e.state)&&e.onCreateUpdate()},actions:[r.createElement(vr.a,{key:"cancel",variant:"secondary",onClick:function(){return e.onClose(!1)}},"Cancel"),r.createElement(vr.a,{isDisabled:!this.isValid(this.state),key:"confirm",variant:"primary",onClick:this.onCreateUpdate},this.props.update?"Update":"Create")]},"request_routing"===this.props.type&&r.createElement(Ik,{serviceName:this.props.serviceName,workloads:this.props.workloads,initRules:lm(this.props.workloads,this.props.virtualServices,this.props.destinationRules),onChange:this.onRulesChange}),"fault_injection"===this.props.type&&r.createElement(gk,{initFaultInjectionRoute:cm(this.props.workloads,this.props.virtualServices,this.props.destinationRules),onChange:this.onFaultInjectionRouteChange}),("traffic_shifting"===this.props.type||"tcp_traffic_shifting"===this.props.type)&&r.createElement(pk,{showValid:!0,workloads:this.props.workloads,initWeights:sm(this.props.workloads,this.props.virtualServices,this.props.destinationRules),showMirror:"traffic_shifting"===this.props.type,onChange:this.onWeightsChange}),"request_timeouts"===this.props.type&&r.createElement(Ck,{initTimeoutRetry:um(this.props.workloads,this.props.virtualServices,this.props.destinationRules),onChange:this.onTimeoutRetryRouteChange}),("request_routing"===this.props.type||"fault_injection"===this.props.type||"traffic_shifting"===this.props.type||"tcp_traffic_shifting"===this.props.type||"request_timeouts"===this.props.type)&&r.createElement(Nw.a,{className:Dk,isExpanded:this.state.showAdvanced,toggleText:(this.state.showAdvanced?"Hide":"Show")+" Advanced Options",onToggle:function(){e.setState({showAdvanced:!e.state.showAdvanced})}},r.createElement(ch.a,{isFilled:!0,activeKey:this.state.advancedTabKey,onSelect:this.advancedHandleTabClick},r.createElement(bh.a,{eventKey:0,title:"Destination Hosts"},r.createElement("div",{style:{marginTop:"20px"}},r.createElement(xk,{vsHosts:this.state.vsHosts,onVsHostsChange:this.onVsHosts}))),r.createElement(bh.a,{eventKey:1,title:"Gateways"},r.createElement("div",{style:{marginTop:"20px",marginBottom:"10px"}},r.createElement(kk,{serviceName:this.props.serviceName,hasGateway:pm(this.props.virtualServices),gateway:n,isMesh:i,gateways:this.props.gateways,onGatewayChange:this.onGateway}))),r.createElement(bh.a,{eventKey:2,title:"Traffic Policy"},r.createElement("div",{style:{marginTop:"20px",marginBottom:"10px"}},r.createElement(md,{mtlsMode:this.state.trafficPolicy.mtlsMode,clientCertificate:this.state.trafficPolicy.clientCertificate,privateKey:this.state.trafficPolicy.privateKey,caCertificates:this.state.trafficPolicy.caCertificates,hasLoadBalancer:this.state.trafficPolicy.addLoadBalancer,loadBalancer:this.state.trafficPolicy.loadBalancer,nsWideStatus:this.props.tlsStatus,hasPeerAuthentication:this.state.trafficPolicy.peerAuthnSelector.addPeerAuthentication,peerAuthenticationMode:this.state.trafficPolicy.peerAuthnSelector.mode,addConnectionPool:this.state.trafficPolicy.addConnectionPool,connectionPool:this.state.trafficPolicy.connectionPool,addOutlierDetection:this.state.trafficPolicy.addOutlierDetection,outlierDetection:this.state.trafficPolicy.outlierDetection,onTrafficPolicyChange:this.onTrafficPolicy}))),"tcp_traffic_shifting"!==this.props.type&&r.createElement(bh.a,{eventKey:3,title:"Circuit Breaker"},r.createElement("div",{style:{marginTop:"20px",marginBottom:"10px"}},r.createElement(Pk,{hasConnectionPool:this.state.trafficPolicy.addConnectionPool,connectionPool:this.state.trafficPolicy.connectionPool,hasOutlierDetection:this.state.trafficPolicy.addOutlierDetection,outlierDetection:this.state.trafficPolicy.outlierDetection,onCircuitBreakerChange:this.onCircuitBreaker}))))))}}]),a}(r.Component),_k=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).appLabelName=j.istioLabels.appLabelName,n.versionLabelName=j.istioLabels.versionLabelName,n.canCreate=function(){return n.props.virtualServices.permissions.create&&n.props.destinationRules.permissions.create},n.canUpdate=function(){return n.props.virtualServices.permissions.update&&n.props.destinationRules.permissions.update},n.canDelete=function(){return n.props.virtualServices.permissions.delete&&n.props.destinationRules.permissions.delete},n.hasTrafficRouting=function(){return n.props.virtualServices.items.length>0||n.props.destinationRules.items.length>0},n.hasSidecarWorkloads=function(){for(var e=!1,t=0;t<n.props.workloads.length;t++)if(n.props.workloads[t].istioSidecar){e=!0;break}return e},n.hideConfirmDelete=function(){n.setState({showConfirmDelete:!1})},n.getDeleteMessage=function(){var e=[];switch(n.state.deleteAction){case"delete_traffic_routing":var t=n.props.virtualServices.items.length>0?"VirtualService".concat(n.props.virtualServices.items.length>1?"s":"",": '").concat(n.props.virtualServices.items.map((function(e){return e.metadata.name})),"'"):"";e.push(r.createElement("div",null,t));var a=n.props.destinationRules.items.length>0?"DestinationRule".concat(n.props.destinationRules.items.length>1?"s":"",": '").concat(n.props.destinationRules.items.map((function(e){return e.metadata.name})),"'"):"";e.push(r.createElement("div",null,a));var i=n.props.destinationRules.items.length>0&&n.hasAnyPeerAuthn(n.props.destinationRules)?"PeerAuthentication".concat(n.props.destinationRules.items.length>1?"s":"",": '").concat(n.props.destinationRules.items.map((function(e){return e.metadata.name})),"'"):"";e.push(r.createElement("div",null,i))}return r.createElement(r.Fragment,null,r.createElement("div",{style:{marginBottom:5}},"Are you sure you want to delete ?"),e)},n.hasAnyPeerAuthn=function(e){return e.items.filter((function(e){return!!n.hasPeerAuthentication(e)})).length>0},n.hasPeerAuthentication=function(e){if(e.metadata&&e.metadata.annotations&&void 0!==e.metadata.annotations.kiali_wizard_related){var t=e.metadata.annotations.kiali_wizard_related.split("/");if(t.length>1)return t[1]}return""},n.getValidWorkloads=function(){return n.props.workloads.filter((function(e){return e.labels&&e.labels[n.appLabelName]&&(e.labels[n.versionLabelName]||1===n.props.workloads.length)}))},n.getVSWizardLabel=function(){return 1===n.props.virtualServices.items.length&&n.props.virtualServices.items[0].metadata.labels&&n.props.virtualServices.items[0].metadata.labels.kiali_wizard?n.props.virtualServices.items[0].metadata.labels.kiali_wizard:""},n.onAction=function(e){var t=n.getVSWizardLabel();switch(e){case"request_routing":case"fault_injection":case"traffic_shifting":case"tcp_traffic_shifting":case"request_timeouts":n.setState({showWizard:!0,wizardType:e,updateWizard:e===t});break;case"delete_traffic_routing":n.setState({showConfirmDelete:!0,deleteAction:e});break;default:console.log("Unrecognized key")}},n.onActionsSelect=function(){n.setState({isActionsOpen:!n.state.isActionsOpen})},n.onActionsToggle=function(e){n.setState({isActionsOpen:e})},n.onClose=function(e){n.setState({showWizard:!1}),e&&n.props.onChange()},n.onDelete=function(){n.setState({isDeleting:!0});var e=[];switch(n.state.deleteAction){case"delete_traffic_routing":n.props.virtualServices.items.forEach((function(t){e.push(cn(t.metadata.namespace||"","virtualservices",t.metadata.name))})),n.props.destinationRules.items.forEach((function(t){e.push(cn(t.metadata.namespace||"","destinationrules",t.metadata.name));var a=n.hasPeerAuthentication(t);a&&e.push(cn(t.metadata.namespace||"","peerauthentications",a))}))}n.hideConfirmDelete(),Promise.all(e).then((function(e){n.setState({isDeleting:!1}),n.props.onChange()})).catch((function(e){_n("Could not delete Istio config objects.",e),n.setState({isDeleting:!1})}))},n.renderTooltip=function(e,t,a,n){return r.createElement(lo.a,{key:"tooltip_"+e,position:t,content:r.createElement(r.Fragment,null,a)},r.createElement("div",{style:{display:"inline-block",cursor:"not-allowed"}},n))},n.renderDropdownItem=function(e,t){switch(e){case"request_routing":case"fault_injection":case"traffic_shifting":case"tcp_traffic_shifting":case"request_timeouts":var a=!n.hasTrafficRouting()||n.hasTrafficRouting()&&t===e,i=r.createElement(up.a,{key:e,component:"button",isDisabled:!a,onClick:function(){return n.onAction(e)}},tm[e]);return a?i:n.renderTooltip(e,lo.b.left,"Traffic routing already exists for this service",i);case"delete_traffic_routing":var o=r.createElement(up.a,{key:e,component:"button",onClick:function(){return n.onAction(e)},isDisabled:!n.hasTrafficRouting()||n.state.isDeleting},"Delete Traffic Routing");return n.hasTrafficRouting()?o:n.renderTooltip(e,lo.b.left,"Traffic routing doesn't exist for this service",o);default:return r.createElement(r.Fragment,null,"Unsupported")}},n.renderDropdownItems=function(){var e=[],t=n.getVSWizardLabel();return(n.canCreate()||n.canUpdate())&&(e=[r.createElement(cp.a,{key:"group_create",label:""===t?"Create":"Update",className:"kiali-group-menu",children:em.map((function(e){return n.renderDropdownItem(e,t)}))})]),e.push(r.createElement(BA.a,{key:"actions_separator"})),n.canDelete()&&e.push(n.renderDropdownItem("delete_traffic_routing","")),e},n.state={showWizard:e.show,wizardType:"",showConfirmDelete:!1,deleteAction:"",isDeleting:!1,updateWizard:!1,isActionsOpen:!1},n}return Object(l.a)(a,[{key:"render",value:function(){var e=this.canCreate()||this.canUpdate()||this.canDelete(),t=this.hasSidecarWorkloads(),a=e?t?"There are not Workloads with "+this.appLabelName+" and "+this.versionLabelName+" labels":"There are not Workloads with sidecar for this service":"User has not permissions on this Service",n=this.getValidWorkloads(),i=e&&t&&n,o=r.createElement(Ru.a,{position:pp.d.right,onSelect:this.onActionsSelect,toggle:r.createElement(ku.a,{onToggle:this.onActionsToggle,iconComponent:ZS.a},"Actions"),isOpen:this.state.isActionsOpen,dropdownItems:this.renderDropdownItems(),disabled:!i,style:{pointerEvents:i?"auto":"none"}});return r.createElement(r.Fragment,null,e&&t?o:this.renderTooltip("tooltip_wizard_actions",lo.b.top,a,o),r.createElement(Fk,{show:this.state.showWizard,type:this.state.wizardType,update:this.state.updateWizard,namespace:this.props.namespace,serviceName:this.props.serviceName,workloads:n,virtualServices:this.props.virtualServices,destinationRules:this.props.destinationRules,gateways:this.props.gateways,peerAuthentications:this.props.peerAuthentications,tlsStatus:this.props.tlsStatus,onClose:this.onClose}),r.createElement(ih.a,{isSmall:!0,title:"Confirm Delete Traffic Routing ?",isOpen:this.state.showConfirmDelete,onClose:this.hideConfirmDelete,actions:[r.createElement(vr.a,{key:"cancel",variant:"secondary",onClick:this.hideConfirmDelete},"Cancel"),r.createElement(vr.a,{key:"confirm",variant:"danger",onClick:this.onDelete},"Delete")]},this.getDeleteMessage()))}}]),a}(r.Component),Mk={info:0,traffic:1,metrics:2,traces:3},Hk=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).promises=new yr,n.fetchService=function(){n.promises.cancelAll(),n.promises.register("namespaces",tn()).then((function(e){var t=e.data;n.promises.registerAll("gateways",t.map((function(e){return ln(e.name,["gateways"],!1,"","")}))).then((function(e){n.setState({gateways:e.map((function(e){return e.data.gateways})).flat()})})).catch((function(e){_n("Could not fetch Gateways list.",e)}))})).catch((function(e){_n("Could not fetch Namespaces list.",e)})),Tn(n.props.match.params.namespace,n.props.match.params.service,!0,n.props.duration).then((function(e){n.setState({serviceDetails:e,validations:e.validations})})).catch((function(e){_n("Could not fetch Service Details.",e)})),ln(n.props.match.params.namespace,["peerauthentications"],!1,"","").then((function(e){n.setState({peerAuthentications:e.data.peerAuthentications})})).catch((function(e){_n("Could not fetch PeerAuthentications.",e)}))},n.state={currentTab:uh("tab","info"),gateways:[],validations:{},peerAuthentications:[]},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.fetchService()}},{key:"componentDidUpdate",value:function(e,t){var a=uh("tab","info");e.match.params.namespace===this.props.match.params.namespace&&e.match.params.service===this.props.match.params.service&&e.lastRefreshAt===this.props.lastRefreshAt||("info"===a&&this.fetchService(),a!==this.state.currentTab&&this.setState({currentTab:a}))}},{key:"getGatewaysAsList",value:function(){return this.state.gateways.map((function(e){return e.metadata.namespace+"/"+e.metadata.name}))}},{key:"renderTabs",value:function(){var e=[r.createElement(bh.a,{eventKey:0,title:"Overview",key:"Overview"},r.createElement(zR,{namespace:this.props.match.params.namespace,service:this.props.match.params.service,serviceDetails:this.state.serviceDetails,gateways:this.state.gateways,peerAuthentications:this.state.peerAuthentications,validations:this.state.validations})),r.createElement(bh.a,{eventKey:1,title:"Traffic",key:"traffic"},r.createElement(JS,{itemName:this.props.match.params.service,itemType:Cb.SERVICE,namespace:this.props.match.params.namespace})),r.createElement(bh.a,{eventKey:2,title:"Inbound Metrics",key:"Inbound Metrics"},r.createElement(Vy,{namespace:this.props.match.params.namespace,object:this.props.match.params.service,objectType:Cb.SERVICE,direction:"inbound"}))];return this.props.jaegerInfo&&this.props.jaegerInfo.enabled&&this.props.jaegerInfo.integration&&e.push(r.createElement(bh.a,{eventKey:3,title:"Traces",key:"Traces"},r.createElement(qS,{namespace:this.props.match.params.namespace,target:this.props.match.params.service,targetKind:"service"}))),e}},{key:"render",value:function(){var e=this,t=!1;switch(this.state.currentTab){case"info":case"traffic":t=!1;break;case"metrics":case"traces":t=!0}var a=this.state.serviceDetails?r.createElement(_k,{namespace:this.props.match.params.namespace,serviceName:this.state.serviceDetails.service.name,show:!1,workloads:this.state.serviceDetails.workloads||[],virtualServices:this.state.serviceDetails.virtualServices,destinationRules:this.state.serviceDetails.destinationRules,gateways:this.getGatewaysAsList(),peerAuthentications:this.state.peerAuthentications,tlsStatus:this.state.serviceDetails.namespaceMTLS,onChange:this.fetchService}):void 0;return r.createElement(r.Fragment,null,r.createElement(Qi,{location:this.props.location,rightToolbar:r.createElement(sA,{customDuration:t}),actionsToolbar:a}),r.createElement(ph,{id:"basic-tabs",onSelect:function(t){e.setState({currentTab:t})},tabMap:Mk,tabName:"tab",defaultTab:"info",activeTab:this.state.currentTab,mountOnEnter:!0,unmountOnExit:!0},this.renderTabs()))}}]),a}(r.Component),Gk=Object(h.b)((function(e){return{jaegerInfo:e.jaegerState.info,lastRefreshAt:e.globalState.lastRefreshAt}}))(Hk),Vk=[{id:"namespace",title:"Namespace",isNumeric:!1,param:"ns",compare:function(e,t){var a=e.namespace.localeCompare(t.namespace);return 0===a&&(a=e.name.localeCompare(t.name)),a}},{id:"name",title:"Name",isNumeric:!1,param:"wn",compare:function(e,t){return e.name.localeCompare(t.name)}},{id:"phase",title:"Phase",isNumeric:!1,param:"is",compare:function(e,t){return e.name.localeCompare(t.name)}},{id:"baseline",title:"Baseline",isNumeric:!1,param:"is",compare:function(e,t){return e.name.localeCompare(t.name)}},{id:"candidate",title:"Candidate",isNumeric:!1,param:"is",compare:function(e,t){return e.name.localeCompare(t.name)}}],Uk=function(e,t){var a,n=e,r=Oi(Bk,t);r.length>0&&(a=r,n=n.filter((function(e){var t=!0;if(a.length>0){t=!1;for(var n=0;n<a.length;n++)if(e.targetService.includes(a[n])){t=!0;break}}return t})));var i=Oi(Wk,t);i.length>0&&(n=function(e,t){return e.filter((function(e){var a=!0;if(t.length>0){a=!1;for(var n=0;n<t.length;n++)if(e.baseline.name.includes(t[n])){a=!0;break}}return a}))}(n,i));var o=Oi(Kk,t);return o.length>0?function(e,t){return e.filter((function(e){var a=!0;if(t.length>0){a=!1;for(var n=0;n<t.length;n++)if(e.phase.includes(t[n])){a=!0;break}}return a}))}(n,o):n},Bk={id:"targetService",title:"Service",placeholder:"Filter by Service Name",filterType:Ae.c.text,action:"append",filterValues:[]},Wk={id:"baselin",title:"Baseline",placeholder:"Filter by Baseline Name",filterType:Ae.c.text,action:"append",filterValues:[]},qk={id:"candidate",title:"Candidate",placeholder:"Filter by Candidate Name",filterType:Ae.c.text,action:"append",filterValues:[]},Kk={id:"phase",title:"Phase",placeholder:"Filter by Phase",filterType:Oe.select,action:"append",filterValues:[{id:"Initializing",title:"Initializing"},{id:"Progressing",title:"Progressing"},{id:"Pause",title:"Pause"},{id:"Completed",title:"Completed"}]},zk=[Bk,Wk,qk,Kk],Yk=a(1517),Qk=a(1518),Xk=Object(Jn.a)({padding:"20px 20px 20px 20px"}),Jk=Object(Jn.a)({fontSize:"1.0em",color:"green"}),Zk=Object(Jn.a)({fontSize:"1.0em",color:"red"}),$k=Object(Jn.a)({fontSize:"1.0em"}),ex=[{title:"Name",transforms:[io.a]},{title:"Namespace",transforms:[io.a]},{title:"Service",transforms:[io.a]},{title:"Phase",transforms:[io.a,Object(oo.a)(5)]},{title:"Baseline",transforms:[io.a]},{title:"Candidate",transforms:[io.a]}],tx=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;Object(s.a)(this,a),(n=t.call(this,e)).promises=new yr,n.fetchExperiments=function(e){xn().then((function(t){var a=t.data;if(a.enabled){if(!a.supportedVersion)return""!==a.analyticsImgVersion&&a.analyticsImgVersion.startsWith("2")?void _n("Iter8 v"+a.analyticsImgVersion+" is not supported, please use the supported version (v1.x)."):void _n("You are running an unsupported Iter8 version, please upgrade to supported version  (v0.2+) to take advantage of the full features of Iter8 .");e.length>0&&function(e){return Xa(K.GET,qa.iter8Experiments,{namespaces:e.join(",")},{})}(e).then((function(e){n.setState((function(t){return{iter8Info:a,experimentLists:Uk(e.data,xi.getSelected()),sortBy:t.sortBy}}))})).catch((function(e){_n("Could not fetch Iter8 Experiments.",e)}))}else _n("Kiali has Iter8 extension enabled but it is not detected in the cluster under namespace "+a.namespace)})).catch((function(e){_n("Could not fetch Iter8 Info.",e)}))},n.paramsAreSynced=function(e){var t=yi(e.activeNamespaces,n.props.activeNamespaces);return[t,t]},n.onSort=function(e,t,a){var r=n.state.experimentLists.sort((function(e,a){switch(t){case 0:return e.name<a.name?-1:e.name>a.name?1:0;case 1:return e.namespace<a.namespace?-1:e.namespace>a.namespace?1:0;case 2:return e.phase<a.phase?-1:e.phase>a.phase?1:0;case 3:return e.status<a.status?-1:e.status>a.status?1:0;case 4:return e.baseline<a.baseline?-1:e.baseline>a.baseline?1:0}return 0}));n.setState({experimentLists:a===Eu.a.asc?r:r.reverse(),sortBy:{index:t,direction:a}})},n.updateListItems=function(){n.promises.cancelAll();var e=n.props.activeNamespaces.map((function(e){return e.name}));0!==e.length?n.fetchExperiments(e):n.setState({experimentLists:[]})},n.goNewExperimentPage=function(){U.push("/extensions/iter8/new")},n.goNewExperimentFromFile=function(){U.push("/extensions/iter8/newfromfile")},n.actionsToolbar=function(){return r.createElement(Ru.a,{id:"actions",title:"Actions",toggle:r.createElement(ku.a,{onToggle:function(e){return n.setState({dropdownOpen:e})}},"Actions"),onSelect:function(){return n.setState({dropdownOpen:!n.state.dropdownOpen})},position:pp.d.right,isOpen:n.state.dropdownOpen,dropdownItems:[r.createElement(up.a,{key:"createExperiment",isDisabled:!n.state.iter8Info.enabled,onClick:function(){return n.goNewExperimentPage()}},"Create New Experiment"),r.createElement(up.a,{key:"createExperimentFromFile",isDisabled:!n.state.iter8Info.enabled,onClick:function(){return n.goNewExperimentFromFile()}},"Create New Experiment from YAML")]})},n.onFilterChange=function(){n.updateListItems()},n.toolbar=function(){return r.createElement(Li,{initialFilters:zk,onFilterChange:n.onFilterChange})},n.getStatusTooltip=function(e,t,a,n,i){var o="Status: In Progress",s=t;if(t.length>0){var l=t.split(":");l.length>1&&(s=l.slice(1)[0]),t.includes("Failed")?o="Status: Failed":t.includes("Completed")&&(o="Status: Completed",n===i&&(s="Traffic to Baseline"))}return r.createElement(Yk.a,{style:{color:nt.White}},r.createElement(Ro.a,null,r.createElement("h2",null,"Phase: ")," ",e),r.createElement(Ro.a,null,r.createElement("h2",null,o)," ",s),r.createElement(Ro.a,null,r.createElement("h2",null,"Winner Found: ",a?n:"False"),r.createElement(Ro.a,{component:Ro.b.p},"(Winning version as identified by iter8 analytics)")))},n.experimentStatusIcon=function(e,t,a,i,o){var s=Jk,l=n.getStatusTooltip(t,i,a.winning_version_found,a.name,o);switch(i.includes("Abort")?s=Jk:a.winning_version_found||(s=Zk),a.name===o&&(!0,s=Zk),t){case"Initializing":return r.createElement(lo.a,{key:"Initializing_"+e,"aria-label":"Status indicator",position:Cr.b.auto,className:"health_indicator",content:r.createElement(r.Fragment,null,l)},r.createElement(fi.InProgressIcon,{className:$k}));case"Progressing":return r.createElement(lo.a,{key:"Progressing_"+e,"aria-label":"Status indicator",position:Cr.b.auto,className:"health_indicator",content:r.createElement(r.Fragment,null,l)},r.createElement(fi.OnRunningIcon,{className:$k}));case"Pause":return r.createElement(lo.a,{key:"Pause_"+e,"aria-label":"Status indicator",position:Cr.b.auto,className:"health_indicator",content:r.createElement(r.Fragment,null,l)},r.createElement(fi.PauseCircle,{className:$k}));case"Completed":return i.includes("Abort")?r.createElement(lo.a,{key:"Completed_"+e,"aria-label":"Status indicator",position:Cr.b.auto,className:"health_indicator",content:r.createElement(r.Fragment,null,l)},r.createElement(Qk.a,{className:s})):r.createElement(lo.a,{key:"Completed_"+e,"aria-label":"Status indicator",position:Cr.b.auto,className:"health_indicator",content:r.createElement(r.Fragment,null,l)},r.createElement(Qr.a,{className:s}));default:return r.createElement(lo.a,{key:"default_"+e,"aria-label":"Status indicator",position:Cr.b.auto,className:"health_indicator",content:r.createElement(r.Fragment,null,l)},r.createElement(fi.OnRunningIcon,{className:$k}))}},n.rows=function(){return n.state.experimentLists.map((function(e){var t,a=[],i=Object($t.a)(e.candidates);try{for(i.s();!(t=i.n()).done;){var o=t.value;a.push(o.name)}}catch(s){i.e(s)}finally{i.f()}return{cells:[r.createElement(r.Fragment,null,r.createElement(pc,{key:"TooltipExtensionIter8Name_".concat(e.name),badge:cc.Iter8,position:lo.b.top}),r.createElement(pc,{badge:{badge:e.experimentKind}}),r.createElement(ar.a,{to:"/extensions/namespaces/".concat(e.namespace,"/iter8/").concat(e.name,"?target=").concat(e.targetService,"&startTime=").concat(e.startTime,"&endTime=").concat(e.endTime,"&baseline=").concat(e.baseline.name,"&candidates=").concat(a),key:"Experiment_"+e.namespace+"_"+e.namespace},e.name)),r.createElement(r.Fragment,null,r.createElement(pc,{key:"TooltipExtensionNamespace_".concat(e.namespace),badge:cc.Namespace,position:lo.b.top}),e.namespace),r.createElement(r.Fragment,null,"Deployment"===e.kind?n.redirectLink(e.namespace,e.targetService,"Service"):n.redirectLink(e.namespace,"",e.kind)),r.createElement(r.Fragment,null,n.experimentStatusIcon(e.name+"_"+e.namespace,e.phase,e.winner,e.status,e.baseline.name)),r.createElement(r.Fragment,null,n.redirectLink(e.namespace,e.baseline.name,e.kind),r.createElement("br",null)," ",e.baseline.weight,"%"),r.createElement(r.Fragment,null,e.candidates.map((function(t){return r.createElement(r.Fragment,null,n.redirectLink(e.namespace,t.name,e.kind),"\xa0",t.weight,"% ",r.createElement("br",null))})))]}}))};var i=Yn(Vk),o=Kn();return n.state={iter8Info:{enabled:!1,supportedVersion:!1,controllerImgVersion:"",analyticsImgVersion:"",namespace:"iter8"},experimentLists:[],sortBy:{},dropdownOpen:!1,listItems:[],currentSortField:i,isSortAscending:o,onFilterChange:!1},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.updateListItems()}},{key:"componentDidUpdate",value:function(e,t,a){var n=this.paramsAreSynced(e);Object(T.a)(n,1)[0]||(this.setState({currentSortField:this.props.currentSortField,isSortAscending:this.props.isSortAscending}),this.updateListItems())}},{key:"componentWillUnmount",value:function(){this.promises.cancelAll()}},{key:"redirectLink",value:function(e,t,a){if("Deployment"===a){var n="/namespaces/"+e+"/workloads/"+t;return r.createElement(r.Fragment,null,r.createElement(pc,{badge:{badge:"W"}}),r.createElement(ar.a,{to:n},t))}if(""!==t){var i="/namespaces/"+e+"/services/"+t;return r.createElement(r.Fragment,null,r.createElement(pc,{badge:{badge:"S"}}),r.createElement(ar.a,{to:i},t))}return"N/A"}},{key:"render",value:function(){return r.createElement(r.Fragment,null,r.createElement("div",{style:{backgroundColor:"#fff"}},r.createElement($u,{rightToolbar:r.createElement(Xl,{id:"exp_list_refresh",disabled:!1,hideLabel:!0,handleRefresh:this.updateListItems,manageURL:!0}),actionsToolbar:this.actionsToolbar()})),r.createElement(tr,null,r.createElement("div",{className:Xk},this.toolbar(),r.createElement(Eu.b,{"aria-label":"Sortable Table",sortBy:this.state.sortBy,cells:ex,rows:this.rows(),onSort:this.onSort},r.createElement(bu.a,null),this.state.experimentLists.length>0?r.createElement(kp.a,null):r.createElement("tr",null,r.createElement("td",{colSpan:ex.length},this.props.activeNamespaces.length>0?r.createElement(Cu.a,{variant:Cu.b.full},r.createElement(Eo.a,{headingLevel:"h5",size:"lg"},"No Iter8 Experiments found"),r.createElement(Su.a,null,"No Iter8 Experiments in namespace",1===this.props.activeNamespaces.length?" ".concat(this.props.activeNamespaces[0].name):"s: ".concat(this.props.activeNamespaces.map((function(e){return e.name})).join(", ")))):r.createElement(Cu.a,{variant:Cu.b.full},r.createElement(Eo.a,{headingLevel:"h5",size:"lg"},"No namespace is selected"),r.createElement(Su.a,null,"There is currently no namespace selected, please select one using the Namespace selector."))))))))}}]),a}(r.Component),ax=Object(h.b)((function(e){return{activeNamespaces:hl(e),duration:fl(e)}}))(tx),nx=a(739),rx={name:"",phase:"",targetService:"",targetServiceNamespace:"",status:"",baseline:{name:"",version:"",weight:0,winProbability:0,requestCount:0},candidates:[],namespace:"",initTime:"",startTime:"",endTime:"",winner:{name:"",winning_version_found:!1,current_best_version:"",probability_of_winning_for_best_version:0},experimentKind:"Canary",kind:"Deployment"},ix={experimentItem:rx,criterias:[],trafficControl:{strategy:"check_and_increment",maxIncrement:2,onTermination:"to_winner",match:{http:[]}},duration:{interval:"30s",intervalInSecond:30,maxIterations:100},networking:{id:"",hosts:[]},permissions:{create:!0,update:!0,delete:!0},experimentType:"C"},ox=[{title:"Metric Name",transforms:[Object(oo.a)(30)],props:{}},{title:"Threshold",transforms:[nx.a,Object(oo.a)(10)],props:{}},{title:"Threshold Type",transforms:[nx.a,Object(oo.a)(15)],props:{}},{title:"Stop on Failure",transforms:[nx.a],props:{}},{title:"Reward",transforms:[nx.a],props:{}},{title:"",props:{}}],sx=[{name:"absolute",value:"absolute"},{name:"relative",value:"relative"}],lx=Object(Jn.a)({marginTop:15,marginBottom:15,color:nt.Blue400,fontSize:"1.2em"}),cx=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).actionResolver=function(e,t){var a={title:"Remove Criteria",onClick:function(e,t){n.props.onRemove(vx.Criteria,t)}};return t.rowIndex<n.props.criterias.length?[a]:[]},n.onAddMetricName=function(e){n.setState((function(t){return{addCriteria:{metric:e.trim(),tolerance:t.addCriteria.tolerance,toleranceType:t.addCriteria.toleranceType,stopOnFailure:t.addCriteria.stopOnFailure,isReward:t.addCriteria.isReward},validName:!0}}))},n.onAddTolerance=function(e,t){n.setState((function(t){return{addCriteria:{metric:t.addCriteria.metric,tolerance:parseFloat(e.trim()),toleranceType:t.addCriteria.toleranceType,stopOnFailure:t.addCriteria.stopOnFailure,isReward:t.addCriteria.isReward},validName:!0}}))},n.onAddToleranceType=function(e,t){n.setState((function(t){return{addCriteria:{metric:t.addCriteria.metric,tolerance:t.addCriteria.tolerance,toleranceType:e.trim(),stopOnFailure:t.addCriteria.stopOnFailure,isReward:t.addCriteria.isReward},validName:!0}}))},n.onAddStopOnFailure=function(){n.setState((function(e){return{addCriteria:{metric:e.addCriteria.metric,tolerance:e.addCriteria.tolerance,toleranceType:e.addCriteria.toleranceType,stopOnFailure:!e.addCriteria.stopOnFailure,isReward:e.addCriteria.isReward},validName:!0}}))},n.onIsReward=function(){n.setState((function(e){return{addCriteria:{metric:e.addCriteria.metric,tolerance:e.addCriteria.tolerance,toleranceType:e.addCriteria.toleranceType,stopOnFailure:e.addCriteria.stopOnFailure,isReward:!e.addCriteria.isReward},validName:!0}}))},n.onAddCriteria=function(){n.props.onAdd(n.state.addCriteria,{name:"",gateway:""},null),n.setState({addCriteria:{metric:"",tolerance:200,toleranceType:"absolute",stopOnFailure:!1,isReward:!1}})},n.state={addCriteria:{metric:"",tolerance:200,toleranceType:"absolute",stopOnFailure:!1,isReward:!1},validName:!1},n}return Object(l.a)(a,[{key:"rows",value:function(){var e=this;return U.location.pathname.endsWith("/new")?this.props.criterias.map((function(e,t){return{key:"criteria"+t,cells:[r.createElement(r.Fragment,null,e.metric),r.createElement(r.Fragment,null,e.tolerance),r.createElement(r.Fragment,null,e.toleranceType),r.createElement(r.Fragment,null,e.stopOnFailure?"true":"false"),r.createElement(r.Fragment,null,e.isReward?"true":"false")]}})).concat([{key:"gwNew",cells:[r.createElement(r.Fragment,null,r.createElement(ur.a,{value:this.state.addCriteria.metric,id:"addMetricName",name:"addMetricName",onChange:this.onAddMetricName},this.props.metricNames.map((function(e,t){return r.createElement(pr.a,{isDisabled:!1,key:"p"+t,value:e,label:e})})))),r.createElement(mp.a,{fieldId:"addTolerance",isValid:this.state.addCriteria.tolerance>0},r.createElement(Ae.b,{id:"addTolerance",type:"number",value:this.state.addCriteria.tolerance,placeholder:"Tolerance",onChange:function(t){return e.onAddTolerance(t,"")},isValid:!isNaN(Number(this.state.addCriteria.tolerance))})),r.createElement(r.Fragment,null,r.createElement(ur.a,{value:this.state.addCriteria.toleranceType,id:"addPortProtocol",name:"addPortProtocol",onChange:this.onAddToleranceType},sx.map((function(e,t){return r.createElement(pr.a,{isDisabled:!1,key:"p"+t,value:e.name,label:e.value})})))),r.createElement(r.Fragment,null,r.createElement(PS.a,{label:"YES",id:"stopOnFailure",name:"stopOnFailure","aria-label":"Stop On Failure",isChecked:this.state.addCriteria.stopOnFailure,onChange:this.onAddStopOnFailure})),r.createElement(r.Fragment,null,r.createElement(PS.a,{label:"YES",id:"isReward",name:"isReward","aria-label":"Reward",isChecked:this.state.addCriteria.isReward,onChange:this.onIsReward})),r.createElement(r.Fragment,null,r.createElement(vr.a,{id:"addServerBtn",variant:"secondary",isDisabled:0===this.state.addCriteria.metric.length,onClick:this.onAddCriteria},"Add this Criteria"))]}]):this.props.criterias.map((function(e,t){return{key:"criteria"+t,cells:[r.createElement(r.Fragment,null,e.metric),r.createElement(r.Fragment,null,e.tolerance),r.createElement(r.Fragment,null,e.toleranceType),r.createElement(r.Fragment,null,e.stopOnFailure?"true":"false")]}}))}},{key:"renderCriteriaForm",value:function(){var e=this;return r.createElement(r.Fragment,null,r.createElement("div",null,0===this.props.criterias.length&&r.createElement("span",{className:lx},"(At least one criteria is needed)"),r.createElement("p",null,"\xa0\xa0"),r.createElement(dp.a,{isHorizontal:!0},r.createElement(mp.a,{fieldId:"name",label:"Metric",isRequired:!0},r.createElement(ur.a,{value:this.state.addCriteria.metric,id:"addMetricName",name:"addMetricName",onChange:this.onAddMetricName,style:{width:"auto"}},this.props.metricNames.map((function(e,t){return r.createElement(pr.a,{isDisabled:!1,key:"p"+t,value:e,label:e})})))),r.createElement(mp.a,{label:"Tolerance",fieldId:"addTolerancef",isValid:this.state.addCriteria.tolerance>0},r.createElement(Ae.b,{id:"addTolerance",type:"number",value:this.state.addCriteria.tolerance,placeholder:"Tolerance",onChange:function(t){return e.onAddTolerance(t,"")},isValid:!isNaN(Number(this.state.addCriteria.tolerance)),style:{width:"auto"}})),r.createElement(mp.a,{label:"Protocol",fieldId:"addPortProtocol",isValid:this.state.addCriteria.tolerance>0},r.createElement(ur.a,{value:this.state.addCriteria.toleranceType,id:"addPortProtocol",name:"addPortProtocol",onChange:this.onAddToleranceType,style:{width:"auto"}},sx.map((function(e,t){return r.createElement(pr.a,{isDisabled:!1,key:"p"+t,value:e.name,label:e.value})})))),r.createElement(mp.a,{label:"Protocol",fieldId:"addPortProtocol",isValid:this.state.addCriteria.tolerance>0},r.createElement(PS.a,{label:"Stop On Failure",id:"stopOnFailure",name:"stopOnFailure","aria-label":"Stop On Failure",isChecked:this.state.addCriteria.stopOnFailure,onChange:this.onAddStopOnFailure})),r.createElement(r.Fragment,null,r.createElement(vr.a,{style:{paddingLeft:"6px"},id:"addServerBtn",variant:"primary",isDisabled:0===this.state.addCriteria.metric.length,onClick:this.onAddCriteria},"Add this Criteria")))))}},{key:"render",value:function(){return r.createElement(r.Fragment,null,r.createElement(Eu.b,{"aria-label":"Success Criterias",cells:ox,rows:this.rows(),actionResolver:this.actionResolver},r.createElement(bu.a,null),r.createElement(kp.a,null)),U.location.pathname.endsWith("/new")?"":this.renderCriteriaForm())}}]),a}(r.Component),ux=[{title:"Gateway name",transforms:[nx.a],props:{}},{title:"Host name",transforms:[nx.a],props:{}},{title:"",props:{}}],px=function(e){return{addHost:{name:"",gateway:e},validName:!1}},dx=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).actionResolver=function(e,t){var a={title:"Remove Host",onClick:function(e,t){n.props.onRemove(vx.Host,t)}};return t.rowIndex<n.props.hosts.length?[a]:[]},n.loadHostName=function(e){n.setState((function(t){return{addHost:{name:t.addHost.name,gateway:e},validName:!0}}))},n.onAddName=function(e){n.setState((function(t){return{addHost:{name:e.trim(),gateway:t.addHost.gateway},validName:!0}}))},n.onAddGateway=function(e,t){n.setState((function(t){return{addHost:{name:t.addHost.name,gateway:e.trim()},validName:!0}}))},n.onAddHost=function(){n.props.onAdd({metric:"",tolerance:200,toleranceType:"absolute",stopOnFailure:!1,isReward:!1},n.state.addHost,null),n.setState({addHost:{name:"",gateway:""}})},n.props.gateways.length>0?n.state=px(n.props.gateways[0]):n.state=px(""),n}return Object(l.a)(a,[{key:"rows",value:function(){var e=this,t=[];return t.push("-- select hostname --"),this.props.hostsOfGateway.length>0&&this.props.hostsOfGateway.forEach((function(a){""!==e.state.addHost.gateway?a.gateway===e.state.addHost.gateway&&t.push(a.name):a.gateway===e.props.gateways[0]&&t.push(a.name)})),this.props.hosts.map((function(e,t){return{key:"host"+t,cells:[r.createElement(r.Fragment,null,e.gateway),r.createElement(r.Fragment,null,e.name),""]}})).concat([{key:"hostNew",cells:[r.createElement(r.Fragment,null,r.createElement(ur.a,{id:"gateway",value:this.state.addHost.gateway,placeholder:"Baseline Deployment",onChange:function(t){return e.loadHostName(t)}},this.props.gateways.map((function(e,t){return r.createElement(pr.a,{label:e,key:"gateway"+t,value:e})})))),r.createElement(r.Fragment,null,r.createElement(ur.a,{id:"name",value:this.state.addHost.name,placeholder:"Host",onChange:function(t){return e.onAddName(t)}},t.map((function(e,t){return r.createElement(pr.a,{label:e,key:"host"+t,value:e})})))),r.createElement(r.Fragment,null,r.createElement(vr.a,{id:"addHostBtn","aria-label":"slider-text",variant:"secondary",isDisabled:0===this.state.addHost.gateway.length||0===this.state.addHost.name.length,onClick:this.onAddHost},"Add this Host"))]}])}},{key:"render",value:function(){return r.createElement(r.Fragment,null,r.createElement(Eu.b,{"aria-label":"Host / Gateway",cells:ux,rows:this.rows(),actionResolver:this.actionResolver},r.createElement(bu.a,null),r.createElement(kp.a,null)))}}]),a}(r.Component),mx=["uri","headers"],hx=["exact","prefix","regex"],fx=(wk={},Object(Ei.a)(wk,"headers","Header value..."),Object(Ei.a)(wk,"uri","Uri value..."),wk),gx=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).onMacthOptionsToggle=function(){n.setState({isMatchDropdown:!n.state.isMatchDropdown})},n.onOperatorToggle=function(){n.setState({isOperatorDropdown:!n.state.isOperatorDropdown})},n.state={isMatchDropdown:!1,isOperatorDropdown:!1},n}return Object(l.a)(a,[{key:"render",value:function(){var e=this;return r.createElement(ek.a,null,r.createElement(Ru.a,{toggle:r.createElement(ku.a,{onToggle:this.onMacthOptionsToggle},this.props.category),isOpen:this.state.isMatchDropdown,dropdownItems:mx.map((function(t,a){return r.createElement(up.a,{key:t+"_"+a,value:t,component:"button",onClick:function(){e.props.onSelectCategory(t),e.onMacthOptionsToggle()}},t)}))}),"headers"===this.props.category&&r.createElement(Ae.a,{id:"header-name-id",value:this.props.headerName,onChange:this.props.onHeaderNameChange,placeholder:"Header name..."}),r.createElement(Ru.a,{toggle:r.createElement(ku.a,{onToggle:this.onOperatorToggle},this.props.operator),isOpen:this.state.isOperatorDropdown,dropdownItems:hx.map((function(t,a){return r.createElement(up.a,{key:t+"_"+a,value:t,component:"button",onClick:function(){e.props.onSelectOperator(t),e.onOperatorToggle()}},t)}))}),"is present"!==this.props.operator&&r.createElement(Ae.a,{id:"match-value-id",value:this.props.matchValue,onChange:this.props.onMatchValueChange,placeholder:fx[this.props.category]}),r.createElement(vr.a,{variant:"secondary",disabled:!this.props.isValid,onClick:this.props.onAddMatch},"Add Match"))}}]),a}(r.Component);!function(e){e[e.UP=0]="UP",e[e.DOWN=1]="DOWN"}(Rk||(Rk={}));var vx,Ex=Object(Jn.a)({marginTop:15,color:nt.Red100}),bx=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).matchAllIndex=function(e){for(var t=-1,a=0;a<e.length;a++){if(0===e[a].matches.length){t=a;break}}return t},e.actionResolver=function(t,a){var n=a.rowIndex,r={title:"Remove Rule",onClick:function(t,a,n,r){return e.props.onRemoveRule(a)}},i={title:"Move Up",onClick:function(t,a,n,r){return e.props.onMoveRule(a,Rk.UP)}},o={title:"Move Down",onClick:function(t,a,n,r){return e.props.onMoveRule(a,Rk.DOWN)}},s=[];return e.props.rules.length>0&&s.push(r),n>0&&s.push(i),n+1<e.props.rules.length&&s.push(o),s},e}return Object(l.a)(a,[{key:"render",value:function(){var e=[{title:"Rule order",transforms:[Object(oo.a)(10)],props:{}},{title:"Request Matching",props:{}},{title:"Route To",props:{}}],t=!0,a=this.matchAllIndex(this.props.rules),n=this.props.rules.length>0?this.props.rules.map((function(e,n){var i,o;return t=-1===a||n<=a,{cells:[r.createElement(r.Fragment,null,n+1),r.createElement(r.Fragment,null,0===e.matches.length?"Any request":e.matches.map((function(e,t){return r.createElement("div",{key:"match_"+t},e)})),!t&&r.createElement("div",{className:Ex},"Match 'Any request' is defined in a previous rule.",r.createElement("br",null),"This rule is not accessible.")),r.createElement(r.Fragment,null,r.createElement("div",{key:"ww_"+n},e.workloadWeights.filter((function(e){return!e.mirrored})).map((function(e,t){return r.createElement("div",{key:"wk_"+n+"_"+e.name+"_"+t},r.createElement(pc,{badge:cc.Workload,position:lo.b.top}),e.name," (",e.weight,"% routed traffic)")})),e.workloadWeights.filter((function(e){return e.mirrored})).map((function(e,t){return r.createElement("div",{key:"wk_mirrored_"+n+"_"+e.name+"_"+t},r.createElement(lo.a,{key:"mirrorred_"+e.name,position:lo.b.top,content:r.createElement(r.Fragment,null,"Mirrored Workload")},r.createElement(co.a,{className:"faultinjection_badge_definition"},"MI")),e.name," (",e.weight,"% mirrored traffic)")}))),e.delay&&r.createElement("div",{key:"delay_"+n},r.createElement(lo.a,{position:lo.b.top,content:r.createElement(r.Fragment,null,"Fault Injection: Delay")},r.createElement(co.a,{className:"faultinjection_badge_definition"},"FI")),null===(i=e.delay.percentage)||void 0===i?void 0:i.value,"% requests delayed (",e.delay.fixedDelay,")"),e.abort&&r.createElement("div",{key:"abort_"+n},r.createElement(lo.a,{position:lo.b.top,content:r.createElement(r.Fragment,null,"Fault Injection: Abort")},r.createElement(co.a,{className:"faultinjection_badge_definition"},"FI")),null===(o=e.abort.percentage)||void 0===o?void 0:o.value,"% requests aborted (HTTP Status ",e.abort.httpStatus,")"),e.timeout&&r.createElement("div",{key:"timeout_"+n},r.createElement(lo.a,{position:lo.b.top,content:r.createElement(r.Fragment,null,"Request Timeout")},r.createElement(co.a,{className:"faultinjection_badge_definition"},"RT")),"timeout (",e.timeout,")"),e.retries&&r.createElement("div",{key:"retries_"+n},r.createElement(lo.a,{position:lo.b.top,content:r.createElement(r.Fragment,null,"Request Retry")},r.createElement(co.a,{className:"faultinjection_badge_definition"},"RR")),e.retries.attempts," attempts with timeout (",e.timeout,")"))]}})):[{key:"rowEmpty",cells:[{title:r.createElement(Cu.a,{variant:Cu.b.full},r.createElement(Eo.a,{headingLevel:"h5",size:"lg"},"No Rules Defined")),props:{colSpan:3}}]}];return r.createElement(r.Fragment,null,"Rules defined:",r.createElement(Eu.b,{"aria-label":"Rules Created",cells:e,rows:n,actionResolver:this.actionResolver},r.createElement(bu.a,null),r.createElement(kp.a,null)))}}]),a}(r.Component),yx=Object(Jn.a)({width:"100%",textAlign:"right"}),Cx=Object(Jn.a)({marginRight:20,color:nt.Red100,display:"inline"}),Sx=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).isMatchesIncluded=function(e,t){return e.some((function(e){return e.matches.length===t.matches.length&&e.matches.every((function(e){return t.matches.includes(e)}))}))},n.onHeaderNameChange=function(e){var t="";""!==n.state.matchValue&&""===e&&(t="Header name must be non empty"),""===n.state.matchValue&&""!==e&&"is present"!==n.state.operator&&(t="Header value must be non empty"),n.setState({headerName:e,validationMsg:t})},n.onMatchValueChange=function(e){var t="";"headers"===n.state.category&&(""===n.state.headerName&&""!==e&&(t="Header name must be non empty"),""!==n.state.headerName&&""===e&&(t="Header value must be non empty")),""===e&&(t=""),n.setState({matchValue:e,validationMsg:t})},n.httpMatchesToRules=function(e){return e.map((function(e){var t={matches:[],workloadWeights:[]};return e.uri&&e.uri.match&&e.uri.stringMatch&&t.matches.push(n.matchToIstioMatchString("uri",e.uri.match,e.uri.stringMatch)),e.headers&&e.headers.forEach((function(e){t.matches.push(n.matchToIstioMatchString("headers",e.match,e.stringMatch,e.key))})),t}))},n.matchToIstioMatchString=function(e,t,a,n){return""!==a?e+("headers"===e?" ["+n+"] ":" ")+t+" "+a:e+" ["+n+"] regex ^.*$"},n.getIstioMatchStrings=function(){var e=Object.keys(n.state.matchStringToHeaderMatch);return n.state.uriMatchString&&e.push(n.state.uriMatchString),e},n.onAddMatch=function(){n.setState((function(e){var t=n.matchToIstioMatchString(e.category,e.operator,e.matchValue,e.headerName),a={};if("uri"===e.category&&e.matchValue.length>0)a.uriMatchString=t,a.uriMatch={match:e.operator,stringMatch:e.matchValue};else if("headers"===e.category){var r={key:e.headerName,match:e.operator,stringMatch:e.matchValue};e.matchStringToHeaderMatch[t]=r}return Object(C.a)(Object(C.a)({},a),{},{matchStringToHeaderMatch:e.matchStringToHeaderMatch,headerName:"",matchValue:""})}))},n.onRemoveMatch=function(e){n.setState((function(t){var a={};return t.uriMatchString?(a.uriMatchString=void 0,a.uriMatch=void 0):e in t.matchStringToHeaderMatch&&delete t.matchStringToHeaderMatch[e],Object(C.a)(Object(C.a)({},a),{},{matchStringToHeaderMatch:t.matchStringToHeaderMatch,validationMsg:"A Rule with same matching criteria is already added."===t.validationMsg?"":t.validationMsg})}))},n.onAddRule=function(e){var t,a;if((null===(t=n.state.uriMatch)||void 0===t?void 0:t.match)&&(null===(a=n.state.uriMatch)||void 0===a?void 0:a.stringMatch)){var r={matches:n.getIstioMatchStrings(),workloadWeights:[]},i={uri:{match:n.state.uriMatch.match,stringMatch:n.state.uriMatch.stringMatch},headers:Object.values(n.state.matchStringToHeaderMatch)};n.isMatchesIncluded(e,r)||n.props.onAdd({metric:"",tolerance:200,toleranceType:"absolute",stopOnFailure:!1,isReward:!1},{name:"",gateway:""},i)}},n.state={matchStringToHeaderMatch:{},focusElementName:"Unknown",validName:!1,validationMsg:"",category:"uri",operator:"exact",headerName:"",matchValue:"",isValid:!0},n}return Object(l.a)(a,[{key:"componentDidUpdate",value:function(){if(""!==this.state.focusElementName){var e=document.getElementById(this.state.focusElementName);e&&e.focus()}}},{key:"render",value:function(){var e=this,t=this.httpMatchesToRules(this.props.matches),a=this.getIstioMatchStrings();return r.createElement(r.Fragment,null,r.createElement("div",{style:{marginTop:"20px"}},r.createElement(gx,{category:this.state.category,operator:this.state.operator,headerName:this.state.headerName,matchValue:this.state.matchValue,isValid:""===this.state.validationMsg,onSelectCategory:function(t){e.setState((function(e){return{category:t,operator:"is present"===e.operator&&"headers"!==t?"exact":e.operator}}))},onHeaderNameChange:this.onHeaderNameChange,onSelectOperator:function(t){return e.setState({operator:t})},onMatchValueChange:this.onMatchValueChange,onAddMatch:this.onAddMatch}),r.createElement(sk,{matches:a,onRemoveMatch:this.onRemoveMatch})),r.createElement("div",{className:yx},r.createElement("span",null,this.state.validationMsg.length>0&&r.createElement("div",{className:Cx},this.state.validationMsg),r.createElement(vr.a,{variant:"secondary",isDisabled:!this.state.isValid,onClick:function(){e.onAddRule(t)}},"Add Rule"))),r.createElement(bx,{rules:t,onRemoveRule:function(t){e.props.onRemove(vx.Match,t)},onMoveRule:this.props.onMoveMatchRule}))}}]),a}(r.Component);!function(e){e[e.Criteria=0]="Criteria",e[e.Host=1]="Host",e[e.Match=2]="Match"}(vx||(vx={}));var Ax,Tx,Ox=Object(Jn.a)({padding:"20px 20px 20px 20px"}),Ix=/^[a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[-a-z0-9]([-a-z0-9]*[a-z0-9])?)*$/,wx=Object(Jn.a)({padding:"30px 20px 30px 20px"}),Rx=Object(Jn.a)({paddingTop:8,color:nt.Blue400}),kx=["progressive","top_2","uniform"],xx=["to_winner","to_baseline","keep_last"],Nx=[{value:"Deployment",label:"WORKLOAD"},{value:"Service",label:"SERVICE"}],jx=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).promises=new yr,n.fetchNamespaces=function(){n.promises.register("namespaces",tn()).then((function(e){var t=e.data.map((function(e){return e.name}));n.setState((function(e){var a=e.experiment;return a.baseline="",a.candidates=[],a.namespace=t[0],{experiment:a,namespaces:t,reloadService:!U.location.pathname.endsWith("/new")}}))}))},n.fetchIter8Info=function(){n.promises.register("iter8Metrics",xn()).then((function(e){var t=e.data;n.setState((function(e){return{iter8Info:t,experiment:e.experiment,reloadService:e.reloadService,metricNames:e.metricNames}}))})).catch((function(e){e.isCanceled||_n("Could not fetch Iter8 Info Detail.",e)}))},n.fetchMetrics=function(){n.promises.register("iter8Metrics",Xa(K.GET,qa.iter8Metrics,{},{})).then((function(e){var t=["-- select one ---"];t=t.concat(e.data),n.setState((function(e){return{iter8Info:e.iter8Info,experiment:e.experiment,reloadService:e.reloadService,metricNames:t}}))})).catch((function(e){e.isCanceled||_n("Could not fetch Iter8 Metric  Detail.",e)}))},n.fetchServices=function(e){var t="";""!==e?t=e:""!==n.state.experiment.namespace&&(t=n.state.experiment.namespace),t.length>0&&(n.promises.has("servicesByNamespace")||n.promises.register("servicesByNamespace",dn(t)).then((function(e){var a=e.data.services.map((function(e){return e.name}));a.length>0&&n.promises.register("firstServiceDetails",Tn(t,a[0],!1)).then((function(e){var t=[];e.workloads&&(t=e.workloads.map((function(e){return e.name}))),n.setState((function(e){return e.experiment.service=a[0],t.length>0&&(e.experiment.baseline=t[0]),{services:a,workloads:t,experiment:e.experiment,reloadService:!1}})),n.promises.cancel("firstServiceDetails")})).catch((function(e){e.isCanceled||_n("Could not fetch Service Detail.",e)})),n.promises.cancel("servicesByNamespace")})).catch((function(e){e.isCanceled||_n("Could not fetch Services list.",e)})))},n.fetchGateways=function(e){n.promises.register("gateways",ln(e,["gateways"],!1,"","")).then((function(e){var t=[],a=[];a.push("-- select gateway --"),e.data.gateways.forEach((function(e){var n;null===(n=e.spec.servers)||void 0===n||n.forEach((function(n){a.push(e.metadata.name),n.hosts.forEach((function(a){t.push({name:a,gateway:e.metadata.name})}))}))})),n.setState((function(e){return{services:e.services,workloads:e.workloads,gateways:a,hostsOfGateway:t,experiment:e.experiment,reloadService:!1,hostState:px(a[0])}}))}))},n.fetchWorkloads=function(e,t){n.promises.register("serviceDetails",Tn(e,t,!1)).then((function(e){var t=[];e.workloads&&(t=e.workloads.map((function(e){return e.name}))),n.setState((function(e){return t.length>0&&(e.experiment.baseline=t[0]),{workloads:t,experiment:e.experiment}}))})).catch((function(e){e.isCanceled||_n("Could not fetch Service Detail.",e)}))},n.onExperimentChange=function(e){n.setState({experiment:e})},n.onExperimentKindChange=function(e,t){n.setState((function(t){var a=t.experiment;return a.experimentKind=e,{experiment:a}}))},n.goExperimentsPage=function(){U.push("/extensions/iter8")},n.createExperiment=function(){var e=n.state.experiment.namespace;n.promises.register("Create Iter8 Experiment",jn(e,JSON.stringify(n.state.experiment),{})).then((function(e){return n.goExperimentsPage()})).catch((function(e){return _n("Could not create Experiment.",e)}))},n.changeExperiment=function(e,t){n.setState((function(a){var r=a.reloadService,i=a.experiment;switch(e){case"name":i.name=t.trim();break;case"namespace":i.namespace=t.trim(),r=!0;break;case"service":i.service=t.trim();break;case"algorithm":"progressive"===t.trim()?n.setState({showMaxIncrement:!0}):n.setState({showMaxIncrement:!1}),i.trafficControl.strategy=t.trim();break;case"onTermination":i.trafficControl.onTermination=t.trim();break;case"baseline":i.baseline=t.trim();break;case"candidate":var o=t.trim().split(",");o=o.map((function(e){return e.trim()})),i.candidates=o;break;case"kubernets":i.apiversion="v1";break;case"knative":i.apiversion="serving.knative.dev/v1alpha1";break;case"metricName":i.criterias[0].metric=t.trim();break;case"toleranceType":i.criterias[0].toleranceType=t.trim();break;case"routerID":i.routerID=t.trim()}return{experiment:i,reloadService:r}}),(function(){U.location.pathname.endsWith("/new")?n.onExperimentChange(n.state.experiment):n.props.onChange(n.isMainFormValid(),n.state.experiment)}))},n.changeExperimentNumber=function(e,t){n.setState((function(a){var n=a.experiment;switch(e){case"maxIteration":n.duration.maxIterations=t;break;case"maxIncrement":n.trafficControl.maxIncrement=t;break;case"tolerance":n.criterias[0].tolerance=t;break;case"interval":n.duration.intervalInSecond=t,n.duration.interval=n.duration.intervalInSecond+"s"}var r=n.duration.maxIterations*n.duration.intervalInSecond,i=Math.floor(r/60/60);return{experiment:n,totalDuration:i+" hours "+(Math.floor(r/60)-60*i)+" minutes "+r%60+" seconds"}}),(function(){U.location.pathname.endsWith("/new")?n.onExperimentChange(n.state.experiment):n.props.onChange(n.isMainFormValid(),n.state.experiment)}))},n.isMainFormValid=function(){return""!==n.state.experiment.name&&0===n.state.experiment.name.search(Ix)&&("Deployment"===n.state.experiment.experimentKind&&""!==n.state.experiment.service||"Service"===n.state.experiment.experimentKind)&&""!==n.state.experiment.namespace&&""!==n.state.experiment.baseline&&0!==n.state.experiment.candidates.length},n.isTCFormValid=function(){return""!==n.state.experiment.duration.interval&&n.state.experiment.duration.maxIterations>0},n.isSCFormValid=function(){return 0!==n.state.experiment.criterias.length},n.onAddToList=function(e,t,a){n.setState((function(n){return null!=t&&""!==t.name?n.experiment.hosts.push(t):null!=e&&""!==e.metric?n.experiment.criterias.push(e):null!=a&&n.experiment.trafficControl.match.http.push(a),{iter8Info:n.iter8Info,experiment:{name:n.experiment.name,namespace:n.experiment.namespace,service:n.experiment.service,apiversion:n.experiment.apiversion,baseline:n.experiment.baseline,candidates:n.experiment.candidates,trafficControl:n.experiment.trafficControl,criterias:n.experiment.criterias,hosts:n.experiment.hosts,duration:n.experiment.duration,experimentKind:n.experiment.experimentKind,routerID:n.experiment.routerID}}}))},n.onRemoveFromList=function(e,t){n.setState((function(a){return e===vx.Criteria?a.experiment.criterias.splice(t,1):e===vx.Host?a.experiment.hosts.splice(t,1):e===vx.Match&&a.experiment.trafficControl.match.http.splice(t,1),{iter8Info:a.iter8Info,experiment:{name:a.experiment.name,namespace:a.experiment.namespace,service:a.experiment.service,apiversion:a.experiment.apiversion,baseline:a.experiment.baseline,candidates:a.experiment.candidates,trafficControl:a.experiment.trafficControl,criterias:a.experiment.criterias,hosts:a.experiment.hosts,duration:a.experiment.duration,experimentKind:a.experiment.experimentKind,routerID:a.experiment.routerID}}}))},n.onMoveMatchRule=function(e,t){n.setState((function(a){var n=a.experiment.trafficControl.match.http,r=n[e],i=t===Rk.UP?e-1:e+1,o=n[i];return n[i]=r,n[e]=o,Object(C.a)({},a)}))},n.onChangeHostGateway=function(){n.setState((function(e){return{addHostGateway:!e.addHostGateway}}))},n.onChangeShowTrafficControl=function(){n.setState((function(e){return{showTrafficControl:!e.showTrafficControl}}))},n.onChangeShowDurationControl=function(){n.setState((function(e){return{showDurationControl:!e.showDurationControl}}))},n.state={iter8Info:{enabled:!1,supportedVersion:!1,analyticsImgVersion:"",controllerImgVersion:"",namespace:"iter8"},experiment:{name:"",namespace:n.props.namespace,apiversion:"v1",service:n.props.serviceName,baseline:"",candidates:[],experimentKind:"Deployment",trafficControl:{strategy:"progressive",maxIncrement:10,onTermination:"to_winner",match:{http:[]}},duration:{interval:"30s",intervalInSecond:30,maxIterations:10},criterias:[],hosts:[],routerID:""},namespaces:[],services:[],workloads:[],gateways:[],hostsOfGateway:[],metricNames:[],showAdvanced:!!U.location.pathname.endsWith("/new")||n.props.showAdvanced,showMaxIncrement:!0,reloadService:!1,totalDuration:"5 mins",hostState:px(""),value:"",filename:"",addHostGateway:!1,showTrafficControl:!1,showDurationControl:!1},n}return Object(l.a)(a,[{key:"componentWillUnmount",value:function(){this.promises.cancelAll()}},{key:"componentDidMount",value:function(){var e=this;0===this.state.namespaces.length&&void 0===this.props.namespace?this.promises.register("namespaces",tn()).then((function(t){var a=t.data.map((function(e){return e.name}));e.setState((function(e){var t=e.experiment;return t.namespace=a[0],{experiment:t,namespaces:a,reloadService:!1}}))})).then((function(){e.fetchIter8Info()})).then((function(){e.fetchServices(e.state.experiment.namespace)})).then((function(){e.fetchGateways(e.state.experiment.namespace)})).then((function(){e.fetchMetrics()})).catch((function(e){e.isCanceled||_n("Could not fetch namespace list",e)})):void 0!==this.props.namespace&&void 0!==this.props.serviceName&&(this.fetchWorkloads(this.props.namespace,this.props.serviceName),this.fetchGateways(this.props.namespace),this.fetchMetrics())}},{key:"componentDidUpdate",value:function(e,t){this.state.reloadService&&this.fetchServices("")}},{key:"renderBaselineSelect",value:function(){var e=this,t="Deployment"===this.state.experiment.experimentKind,a=t?this.state.workloads:this.state.services;return[r.createElement(mp.a,{fieldId:"baseline",label:t?"Deployment Baseline":"Service Baseline",isRequired:!0,isValid:""!==this.state.experiment.baseline,helperText:t?"The baseline deployment of the target service (i.e. reviews-v1)":"The baseline service (i.e. reviews)",helperTextInvalid:t?"Baseline deployment cannot be empty":"Baseline service cannot be empty"},r.createElement(ur.a,{id:"baseline",value:this.state.experiment.baseline,placeholder:t?"Baseline Deployment":"Baseline Service",onChange:function(t){return e.changeExperiment("baseline",t)}},a.map((function(e,t){return r.createElement(pr.a,{label:e,key:"workloadBaseline"+t,value:e})}))))]}},{key:"renderCandidateSelect",value:function(){var e=this,t="Deployment"===this.state.experiment.experimentKind,a="Deployment"===this.state.experiment.experimentKind?this.state.workloads:this.state.services;return[r.createElement(mp.a,{fieldId:"candidates",label:t?"Deployment Candidate(s)":"Service Candidate(s)",isRequired:!0,isValid:0!==this.state.experiment.candidates.length,helperText:t?"Name or a List of names of candidate deployment of the target service (i.e. reviews-v2, or reviews-v2,reviews-v3)":"Name or a List of names of candidate service (i.e. reviews)",helperTextInvalid:t?"Candidate deployment cannot be empty":"Candidate service cannot be empty"},r.createElement(Ae.b,{id:"candidate",value:this.state.experiment.candidates.join(","),placeholder:"Select from list or enter a new one",onChange:function(t){return e.changeExperiment("candidate",t)},list:"candidateName",autoComplete:"off"}),r.createElement("datalist",{id:"candidateName"},a.map((function(t,a){return t!==e.state.experiment.baseline?r.createElement("option",{label:t,key:"workloadCandidate"+a,value:t},t):""}))))]}},{key:"renderFullGeneral",value:function(){var e=this;return r.createElement(r.Fragment,null,r.createElement(mp.a,{fieldId:"name",label:"Experiment Name",isRequired:!0,isValid:""!==this.state.experiment.name&&0===this.state.experiment.name.search(Ix),helperTextInvalid:"Name cannot be empty and must be a DNS subdomain name as defined in RFC 1123."},r.createElement(Ae.b,{id:"name",value:this.state.experiment.name,placeholder:"Experiment Name",onChange:function(t){return e.changeExperiment("name",t)}})),r.createElement(mp.a,{fieldId:"experimentKind",label:"Kind of Target",isRequired:!0,helperTextInvalid:"Kind of experiment target"},r.createElement(ur.a,{value:this.state.experiment.experimentKind,onChange:this.onExperimentKindChange,id:"targetKind",name:"targetKinde"},Nx.map((function(e,t){return r.createElement(pr.a,{key:t,value:e.value,label:e.label})})))),U.location.pathname.endsWith("/new")?r.createElement(r.Fragment,null,r.createElement(mp.a,{label:"Namespaces",isRequired:!0,fieldId:"namespaces",helperText:"Select namespace where this configuration will be applied",isValid:!1},r.createElement(ur.a,{id:"namespaces",value:this.state.experiment.namespace,placeholder:"Namespace",onChange:function(t){e.changeExperiment("namespace",t),e.fetchServices(t),e.fetchGateways(t)}},this.state.namespaces.map((function(e,t){return r.createElement(pr.a,{label:e,key:"namespace"+t,value:e})})))),"Deployment"===this.state.experiment.experimentKind?r.createElement(r.Fragment,null,r.createElement(mp.a,{fieldId:"service",label:"Target Service",isRequired:!0,isValid:""!==this.state.experiment.service,helperText:"Target Service specifies the reference to experiment targets (i.e. reviews)",helperTextInvalid:"Target Service cannot be empty"},r.createElement(ur.a,{id:"service",value:this.state.experiment.service,placeholder:"Target Service",onChange:function(t){e.changeExperiment("service",t);var a=e.state.experiment.namespace;e.fetchWorkloads(a,t)}},this.state.services.map((function(e,t){return r.createElement(pr.a,{label:e,key:"service"+t,value:e})}))))):r.createElement(r.Fragment,null)):"",this.renderBaselineSelect(),this.renderCandidateSelect())}},{key:"renderDuration",value:function(){var e=this;return r.createElement(r.Fragment,null,r.createElement(Df.a,{gutter:"md"},r.createElement(Ff.a,{span:12},r.createElement("div",{className:Rx},"Total Experiment Duration: ",this.state.totalDuration)),r.createElement(Ff.a,{span:6},r.createElement(mp.a,{fieldId:"interval",label:"Interval (seconds)",isValid:""!==this.state.experiment.duration.interval,helperText:"Frequency with which the controller calls the analytics service",helperTextInvalid:"Interval cannot be empty"},r.createElement(Ae.b,{id:"interval",value:this.state.experiment.duration.intervalInSecond,placeholder:"Time interval i.e. 30s",onChange:function(t){return e.changeExperimentNumber("interval",Number(t))}}))),r.createElement(Ff.a,{span:6},r.createElement(mp.a,{fieldId:"maxIteration",label:"Maximum Iteration",isValid:this.state.experiment.duration.maxIterations>0,helperText:"Maximum number of iterations for this experiment",helperTextInvalid:"Maximun Iteration cannot be empty"},r.createElement(Ae.b,{id:"maxIteration",type:"number",value:this.state.experiment.duration.maxIterations,placeholder:"Maximum Iteration",onChange:function(t){return e.changeExperimentNumber("maxIteration",Number(t))}})))))}},{key:"renderTraffic",value:function(){var e=this;return r.createElement(r.Fragment,null,r.createElement(Df.a,{gutter:"md"},r.createElement(Ff.a,{span:6},r.createElement(mp.a,{fieldId:"algorithm",label:"Algorithm",helperText:"Strategy used to analyze the candidate and shift the traffic"},r.createElement(ur.a,{value:this.state.experiment.trafficControl.strategy,id:"algorithm",name:"Algorithm",onChange:function(t){return e.changeExperiment("algorithm",t)}},kx.map((function(e,t){return r.createElement(pr.a,{isDisabled:!1,key:"p"+t,value:e,label:e})}))))),r.createElement(Ff.a,{span:6},r.createElement(mp.a,{fieldId:"onTermination",label:"onTermination",helperText:"The traffic split behavior after the termination of the experiment."},r.createElement(ur.a,{value:this.state.experiment.trafficControl.onTermination,id:"onTermination",name:"On Termination",onChange:function(t){return e.changeExperiment("onTermination",t)}},xx.map((function(e,t){return r.createElement(pr.a,{isDisabled:!1,key:"ot"+t,value:e,label:e})}))))),r.createElement(Ff.a,{span:12},r.createElement(mp.a,{style:this.state.showMaxIncrement?{}:{display:"none"},fieldId:"maxIncrement",label:"Max Increment",isValid:this.state.experiment.trafficControl.maxIncrement>0,helperText:"Maximum possible increase in traffic for a candidate in a single iteration (measured in percent). Default value: 2 (percent)",helperTextInvalid:"Max Increment must be > 0"},r.createElement(Ae.b,{id:"maxIncrement",value:this.state.experiment.trafficControl.maxIncrement,placeholder:"Max Increment",onChange:function(t){return e.changeExperimentNumber("maxIncrement",Number(t))}}))),r.createElement(Ff.a,{span:12},r.createElement(Ro.a,{component:Ro.b.a},"Number of Match Rules: ",this.state.experiment.trafficControl.match.http.length,r.createElement(Cr.a,{position:"right",hideOnOutsideClick:!0,maxWidth:"40rem",headerContent:r.createElement("div",null,"Match Rules"),bodyContent:r.createElement("div",null,r.createElement("p",null,"Specifies the portion of traffic which can be routed to candidates during the experiment. Traffic that does not match this clause will be sent to baseline and never to a candidate during an experiment. By default, if this field is left unspecified, all traffic is used for an experiment."),r.createElement("p",null,"Currently, only http trafic is controlled. For each match rule, please specify one or both of"," ",r.createElement("b",null,"uri")," and one or multiple ",r.createElement("b",null,"headers"),". Use ",r.createElement("b",null,"Add this Header")," to add header to the rule, and use ",r.createElement("b",null,"Add Match Rule")," to add match rule."))},r.createElement(vr.a,{variant:"link"},r.createElement(Br.a,{noVerticalAlign:!0}))))),r.createElement(Ff.a,{span:12},r.createElement(Sx,{matches:this.state.experiment.trafficControl.match.http,onRemove:this.onRemoveFromList,onAdd:this.onAddToList,onMoveMatchRule:this.onMoveMatchRule}))))}},{key:"renderCriteria",value:function(){return r.createElement(r.Fragment,null,"Assessment Criteria:",r.createElement(cx,{iter8Info:this.state.iter8Info,criterias:this.state.experiment.criterias,metricNames:this.state.metricNames,onAdd:this.onAddToList,onRemove:this.onRemoveFromList}))}},{key:"renderHost",value:function(){var e=this;return r.createElement(r.Fragment,null,r.createElement(Df.a,{gutter:"md"},r.createElement(Ff.a,{span:12},r.createElement(mp.a,{fieldId:"routerID",label:"Router ID",isValid:""!==this.state.experiment.routerID,helperText:"Refers to the id of router used to handle traffic for the experiment. Default value: first entry of effective host."},r.createElement(Ae.b,{id:"routerID",value:this.state.experiment.routerID,placeholder:"ID of router",onChange:function(t){return e.changeExperiment("routerID",t)}}))),r.createElement(Ff.a,{span:12},r.createElement(dx,{hosts:this.state.experiment.hosts,hostsOfGateway:this.state.hostsOfGateway,gateways:this.state.gateways,onAdd:this.onAddToList,onRemove:this.onRemoveFromList}))))}},{key:"renderFullPage",value:function(){return r.createElement(r.Fragment,null,this.renderCriteria(),r.createElement(dp.a,null,r.createElement(mp.a,{label:"Show Duration",fieldId:"showDuration"},r.createElement(fp.a,{id:"showDuration",label:" ",labelOff:" ",isChecked:this.state.showDurationControl,onChange:this.onChangeShowDurationControl})),this.state.showDurationControl&&r.createElement(mp.a,{label:"Experiment Duration",fieldId:"drationControall"},this.renderDuration()),r.createElement(mp.a,{label:"Show Traffic Control",fieldId:"showTrafficControl"},r.createElement(fp.a,{id:"showTrafficControl",label:" ",labelOff:" ",isChecked:this.state.showTrafficControl,onChange:this.onChangeShowTrafficControl})),this.state.showTrafficControl&&r.createElement(r.Fragment,null,r.createElement(mp.a,{fieldId:"trafficControl",label:r.createElement(Cr.a,{position:"right",hideOnOutsideClick:!0,maxWidth:"40rem",headerContent:r.createElement("div",null,"Traffic Control"),bodyContent:r.createElement("div",null,r.createElement("p",null,"Configuration that affect how application traffic is split across different versions of the service during and after the experiment.")," ",r.createElement("b",null,"Traffic Control Strategies:")," (reference"," ",r.createElement("a",{href:"https://iter8.tools/reference/algorithms/#traffic-control-strategies",target:"_blank",rel:"noopener noreferrer"},"here")," ","for detail )",r.createElement("table",null,r.createElement("tr",{className:"tr"},r.createElement("td",null,"Progressive:\xa0"),r.createElement("td",null,"Progressively shift all traffic to the winner.")),r.createElement("tr",null,r.createElement("td",null,"top_2:\xa0"),r.createElement("td",null,"Converge towards a 50-50 traffic split between the best two versions")),r.createElement("tr",null,r.createElement("td",null,"uniform:\xa0"),r.createElement("td",null,"Converge towards a uniform traffic split across all versions.")))," ",r.createElement("b",null,"On Termination: "),r.createElement("table",null,r.createElement("tr",null,r.createElement("td",{valign:"top"},"to_winner:\xa0"),r.createElement("td",null,"If a winning version is found at the end of the experiment, all traffic will flow to this version after the experiment terminates.")),r.createElement("tr",null,r.createElement("td",{valign:"top"},"to_baseline:\xa0"),r.createElement("td",null,"All traffic will flow to the baseline version, after the experiment terminates.")),r.createElement("tr",null,r.createElement("td",{valign:"top"},"keep_last:\xa0"),r.createElement("td",null,"Ensure that the traffic split used during the final iteration of the experiment continues even after the experiment has terminated"))))},r.createElement(vr.a,{variant:"link"},"Traffic Control ",r.createElement(Br.a,{noVerticalAlign:!0})))},this.renderTraffic())),r.createElement(mp.a,{label:"Show Networking Control",fieldId:"addHostGateway"},r.createElement(fp.a,{id:"addHostGateway",label:" ",labelOff:" ",isChecked:this.state.addHostGateway,onChange:this.onChangeHostGateway})),this.state.addHostGateway&&r.createElement(mp.a,{label:"Networking",fieldId:"hostsGateways"},this.renderHost())))}},{key:"render",value:function(){var e=this,t=this.isMainFormValid()&&this.isSCFormValid();return r.createElement(r.Fragment,null,r.createElement("div",{style:{backgroundColor:"#fff"}},r.createElement($u,null)),r.createElement(tr,null,r.createElement("div",{className:Ox},r.createElement(dp.a,{className:wx,isHorizontal:!0},this.renderFullGeneral(),this.renderFullPage(),r.createElement(hp.a,null,r.createElement("span",{style:{float:"left",paddingTop:"10px",paddingBottom:"10px",width:"100%"}},r.createElement("span",{style:{float:"right",paddingRight:"5px"}},r.createElement(vr.a,{variant:vr.b.primary,isDisabled:!t,onClick:function(){return e.createExperiment()}},"Create")),r.createElement("span",{style:{float:"right",paddingRight:"5px"}},r.createElement(vr.a,{variant:vr.b.secondary,onClick:function(){e.goExperimentsPage()}},"Cancel"))))))))}}]),a}(r.Component),Px=Object(h.b)((function(e){return{activeNamespaces:hl(e)}}),null)(jx),Lx=["Pause","Resume","Terminate"],Dx=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).onSelect=function(e){n.setState({dropdownOpen:!n.state.dropdownOpen})},n.onToggle=function(e){n.setState({dropdownOpen:e})},n.actionConfirmModal=function(e,t,a){switch(e){case"Delete":n.setState({showDeleteConfirmModal:t});break;case"Pause":n.setState({showPauseConfirmModal:t});break;case"Resume":n.setState({showResumeConfirmModal:t});break;case"Terminate":a&&n.setState({warning:"",workloadWeights:n.props.manualOverride}),n.setState({showTerminateConfirmModal:t})}},n.onAction=function(e){switch(n.actionConfirmModal(e,!1,!1),e){case"Delete":n.props.onDelete();break;case"Pause":n.props.onPause();break;case"Resume":n.props.onResume();break;case"Terminate":n.setState({warning:""}),n.props.doTrafficSplit(n.state.workloadWeights),n.props.onTerminate()}},n.onSelectWeights=function(e,t){n.setState({workloadWeights:t})},n.checkTotalWeight=function(){return!n.state.showTerminateConfirmModal||100===n.state.workloadWeights.map((function(e){return e.weight})).reduce((function(e,t){return e+t}),0)},n.trafficSplitRules=function(){var e=[];return n.props.manualOverride.forEach((function(t){e.push({name:t.name,type:"Workload",istioSidecar:!1,labels:{},resourceVersion:"v",createdAt:""})})),r.createElement(dp.a,{isHorizontal:!0},r.createElement(pk,{workloads:e,initWeights:n.props.manualOverride,onChange:n.onSelectWeights,showMirror:!1,showValid:!0}))},n.GenConfirmModal=function(e,t,a){var i="Confirm "+e;return r.createElement(ih.a,{title:i,isSmall:!0,isOpen:a,onClose:function(){return n.actionConfirmModal(e,!1,!0)},actions:[r.createElement(vr.a,{key:"cancel",variant:"secondary",onClick:function(){return n.actionConfirmModal(e,!1,!0)}},"Cancel"),r.createElement(vr.a,{key:"confirm",variant:"danger",isDisabled:!n.checkTotalWeight(),onClick:function(){return n.onAction(e)}},e)]},r.createElement(Ro.a,{component:Ro.b.p},"Are you sure you want to ",e.toLowerCase().split(" ",3)[0],' the Iter8 experiment "',n.props.experimentName,'"',t),"Terminate"===e?r.createElement(r.Fragment,null,n.trafficSplitRules()):"")},n.canAction=function(e,t){switch(e){case"Terminate":return""!==n.props.startTime&&""===n.props.endTime}return""!==n.props.startTime&&n.props.phase===t},n.renderTooltip=function(e,t,a,n){return r.createElement(lo.a,{key:e,position:t,content:r.createElement(r.Fragment,null,a)},r.createElement("div",{style:{cursor:"not-allowed"}},n))},n.renderDropdownItem=function(e){var t=e.split(" "),a=t[0]+"Experiment",i="Pause"===e?"Progressing":"Pause",o=""===n.props.startTime?'. Action "'+e+'" can only be done once experiment is started. ':""!==n.props.endTime?'. Action "'+e+'" can only be done while experiment is running. ':"",s=r.createElement(up.a,{key:a,onClick:function(){return n.actionConfirmModal(e,!0,!0)},isDisabled:!n.canAction(t[0],i)},e);return n.canAction(t[0],i)?s:n.renderTooltip(a,lo.b.left,"Experiment is in state "+n.props.phase+o,s)},n.renderDropdownItems=function(){var e=[];return n.props.canDelete&&(e=e.concat(r.createElement(up.a,{key:"deleteExperiment",onClick:function(){return n.actionConfirmModal("Delete",!0,!1)},isDisabled:!n.props.canDelete},"Delete"))),e=e.concat(Lx.map((function(e){return n.renderDropdownItem(e)})))},n.state={dropdownOpen:!1,showDeleteConfirmModal:!1,showPauseConfirmModal:!1,showResumeConfirmModal:!1,showTerminateConfirmModal:!1,workloadWeights:[],warning:""},n}return Object(l.a)(a,[{key:"render",value:function(){return r.createElement(r.Fragment,null,r.createElement(Ru.a,{id:"actions",title:"Actions",toggle:r.createElement(ku.a,{onToggle:this.onToggle},"Actions"),onSelect:this.onSelect,position:pp.d.right,isOpen:this.state.dropdownOpen,dropdownItems:this.renderDropdownItems()}),this.GenConfirmModal("Delete","? It cannot be undone. Make sure this is something you really want to do!",this.state.showDeleteConfirmModal),this.GenConfirmModal("Resume","? ",this.state.showResumeConfirmModal),this.GenConfirmModal("Pause",'? Once it is paused, please select "resume" to resume the experiment. Or use terminate to stop the experiment. ',this.state.showPauseConfirmModal),this.GenConfirmModal("Terminate","? Please specify traffic split rule ",this.state.showTerminateConfirmModal))}}]),a}(r.Component),Fx=a(1522),_x=a(1524),Mx=a(1525),Hx=a(839),Gx=a(1519),Vx=a(1520),Ux=a(1521),Bx=a(584),Wx=a.n(Bx),qx=a(838),Kx=a.n(qx),zx=a(318),Yx=a.n(zx),Qx=a(1523),Xx=Object(Jn.a)({margin:"0px 16px 2px 4px"}),Jx=Object(Jn.a)({padding:"20px"}),Zx=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).getRows=function(){var e,t,a,i=[];return null===(e=n.props.trafficControl)||void 0===e||null===(t=e.match)||void 0===t||null===(a=t.http)||void 0===a||a.map((function(e,t){var a,n,o=[];null===(a=e.headers)||void 0===a||a.map((function(e){o.push("headers ["+e.key+"] "+e.match+" "+e.stringMatch+" ")})),(null===(n=e.uri)||void 0===n?void 0:n.match)&&o.push("uri "+e.uri.match+" "+e.uri.stringMatch),i.push({cells:[{title:r.createElement(r.Fragment,null," ",t+1," ")},{title:r.createElement(r.Fragment,null,o.map((function(e,t){return r.createElement("div",{key:"match_"+t},e)})))}]})})),i},n.state={columns:[{title:"Rule order"},"Request Matching"],rows:[]},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.setState((function(){return{rows:e.getRows()}}))}},{key:"componentDidUpdate",value:function(e){var t=this;Yx()(this.props.trafficControl,e.trafficControl)||this.setState((function(){return{rows:t.getRows()}}))}},{key:"render",value:function(){var e=this.state,t=e.columns,a=e.rows;return r.createElement(Df.a,null,r.createElement(Ff.a,{span:12},r.createElement(Ef.a,null,r.createElement(yf.a,null,r.createElement(Hx.a,{"aria-label":"detailTraffic"},r.createElement(Gx.a,{"aria-labelledby":"altorighm"},r.createElement(Vx.a,null,r.createElement(Ux.a,{dataListCells:r.createElement(Fx.a,{key:"strategy"},r.createElement(Ro.a,null,r.createElement("b",null,"Traffic Strategy"),r.createElement(lo.a,{key:"winnerTooltip","aria-label":"Winner Tooltip",position:Cr.b.auto,maxWidth:"30rem",content:r.createElement("table",null,r.createElement("tr",{className:"tr"},r.createElement("td",{style:{verticalAlign:"top"}},r.createElement("div",{style:{width:"100px"}},"progressive:")),r.createElement("td",null,"Progressively shift all traffic to the winner.")),r.createElement("tr",null,r.createElement("td",null,"top_2:\xa0"),r.createElement("td",null,"Converge towards a 50-50 traffic split between the best two versions")),r.createElement("tr",null,r.createElement("td",null,"uniform:\xa0"),r.createElement("td",null,"Converge towards a uniform traffic split across all versions.")))},r.createElement(fi.Info,{className:Xx})),": ",this.props.trafficControl.strategy?this.props.trafficControl.strategy:"progressive"))}),r.createElement(Ux.a,{dataListCells:r.createElement(Fx.a,{key:"strategy"},r.createElement(Ro.a,null,r.createElement("b",null,"Max Increment "),r.createElement(lo.a,{key:"winnerTooltip","aria-label":"Winner Tooltip",position:Cr.b.auto,content:r.createElement(r.Fragment,null,"Specifies the maximum percentage by which traffic routed to a candidate can increase during a single iteration of the experiment. Default value: 2 (percent)")},r.createElement(fi.Info,{className:Xx})),": ",this.props.trafficControl.maxIncrement," ","%"))}),r.createElement(Ux.a,{dataListCells:r.createElement(Fx.a,{key:"strategy"},r.createElement(Ro.a,null,r.createElement("b",null,"On Termination "),r.createElement(lo.a,{key:"winnerTooltip","aria-label":"Winner Tooltip",position:Cr.b.auto,maxWidth:"30rem",content:r.createElement("table",null,r.createElement("tr",{className:"tr"},r.createElement("td",{style:{verticalAlign:"top"}},r.createElement("div",{style:{width:"100px"}},"to_winner:")),r.createElement("td",null,"ensures that, if a winning version is found at the end of the experiment, all traffic will flow to this version after the experiment terminates.")),r.createElement("tr",null,r.createElement("td",null,"to_baseline:"),r.createElement("td",null," ","F ensure that all traffic will flow to the baseline version, after the experiment terminates")),r.createElement("tr",null,r.createElement("td",null,"keep_last:"),r.createElement("td",null,"ensure that the traffic split used during the final iteration of the experiment continues even after the experiment has terminated.")))},r.createElement(fi.Info,{className:Xx})),":"," ",this.props.trafficControl.onTermination?this.props.trafficControl.onTermination:"to_winner"))})))),r.createElement(Qx.a,null,r.createElement("div",{className:Jx},r.createElement(Eo.a,{headingLevel:"h6",size:"lg"},"Match Rules",r.createElement(lo.a,{key:"winnerTooltip","aria-label":"Winner Tooltip",position:Cr.b.auto,content:r.createElement(r.Fragment,null,"Match rules used to filter out inbound traffic. With protocol name as a key, its value is an array of Istio matching clauses. Currently, only http is supported")},r.createElement(fi.Info,{className:Xx}))),r.createElement(Eu.b,{"aria-label":"Compound expandable table",rows:this.getRows(),cells:t},r.createElement(bu.a,null),a.length>0?r.createElement(kp.a,null):r.createElement("tr",null,r.createElement("td",{colSpan:t.length},r.createElement(Cu.a,{variant:Cu.b.full},r.createElement(Eo.a,{headingLevel:"h5",size:"lg"},"No Match Rule found"),r.createElement(Su.a,null,"No Match Rules is defined in Experiment")))))))))))}}]),a}(r.Component),$x=a(1563),eN=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"alert",value:function(){return r.createElement(Ef.a,null,r.createElement(yf.a,null,r.createElement($x.a,{variant:"warning",title:this.props.message||"Something went wrong rendering this component"}," ")))}},{key:"render",value:function(){return r.createElement(mT,{fallBackComponent:this.alert()},this.props.children)}}]),a}(r.Component),tN=Object(Jn.a)({margin:"0px 16px 2px 4px"}),aN=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).onDownloadClick=function(){var e,t;(e=n.props.namespace,t=n.props.experimentDetails.experimentItem.name,Xa(K.GET,qa.iter8ExperimentYAML(e,t),{},{})).then((function(e){return e.data})).then((function(e){var t,a=window.URL.createObjectURL(new Blob([Kx.a.stringify(Wx.a.safeLoad(JSON.stringify(e,null,2)))],{type:"application/json"})),r=document.createElement("a");r.href=a,r.setAttribute("download",n.props.experimentDetails.experimentItem.name+".yaml"),document.body.appendChild(r),r.click(),null===(t=r.parentNode)||void 0===t||t.removeChild(r)}))},n.onGraphActionsToggle=function(e){n.setState({isKebabOpen:e})},n.showFullGraph=function(){var e=Xe.WORKLOAD,t="/graph/namespaces?graphType=".concat(e,"&injectServiceNodes=true&namespaces=").concat(n.props.namespace,"&idleNodes=false&edges=requestsPercentage&");U.push(t)},n.showFullMetric=function(){var e,t,a="/namespaces/".concat(n.props.namespace,"/services/").concat(n.props.target,"?tab=metrics&bylbl=destination_version");if(t=[],null===(e=n.props.experimentDetails)||void 0===e||e.experimentItem.candidates.map((function(e){t.push(e.version)})),void 0!==n.props.experimentDetails){var r="=".concat(n.props.experimentDetails.experimentItem.baseline.version,",").concat(t.join());U.push(a+encodeURIComponent(r))}else U.push(a)},n.state={isKebabOpen:!1,isUpdated:!1},n}return Object(l.a)(a,[{key:"serviceLink",value:function(e,t){return"/namespaces/"+e+"/services/"+t}},{key:"serviceInfo",value:function(){return[r.createElement(Fx.a,{key:"service-icon",isIcon:!0},r.createElement(pc,{badge:{badge:"S"}})),r.createElement(Fx.a,{key:"targetService"},r.createElement(Ro.a,{component:Ro.b.h3},"Service"))]}},{key:"serviceLinkCell",value:function(e,t){return[r.createElement(Fx.a,{key:t},r.createElement(Ro.a,{component:Ro.b.h3},r.createElement(ar.a,{to:this.serviceLink(e,t)},t)))]}},{key:"renderDeployments",value:function(e,t){var a="/namespaces/"+this.props.namespace+"/workloads/"+e;return"Service"===t&&(a="/namespaces/"+this.props.namespace+"/services/"+e),r.createElement(_x.a,{key:"AppService_".concat(e)},r.createElement(ar.a,{to:a},e))}},{key:"baselineInfo",value:function(e,t,a){var n=this.renderDeployments(t,a),i="Deployment"===a?"W":"S";return[r.createElement(Fx.a,{key:"workload-icon",isIcon:!0},r.createElement(pc,{badge:{badge:i}})),r.createElement(Fx.a,{key:e},r.createElement(Ro.a,{component:Ro.b.h3},e),r.createElement(Mx.a,null,n))]}},{key:"candidatesInfo",value:function(){var e,t=this;null===(e=this.props.experimentDetails)||void 0===e||e.experimentItem.candidates.map((function(e){var a,n,r=(null===(a=t.props.experimentDetails)||void 0===a?void 0:a.experimentItem.kind)?null===(n=t.props.experimentDetails)||void 0===n?void 0:n.experimentItem.kind:"Deployment";return t.baselineInfo("Candidate",e.name,r)}))}},{key:"percentageInfo",value:function(e,t){return[r.createElement(Fx.a,{key:e},r.createElement(Ro.a,{component:Ro.b.h3},"Weight"),r.createElement(Ro.a,null,t," %"))]}},{key:"defaultTab",value:function(){return"trafficControl"}},{key:"gatewayInfo",value:function(e,t,a){var n="/namespaces/"+t+"/istio/gateways/"+a;return[r.createElement(Fx.a,{key:"workload-icon",isIcon:!0},r.createElement(pc,{badge:{badge:e}})),r.createElement(Fx.a,{key:"gateway"},r.createElement(Ro.a,null,"Gateway"),r.createElement(Ro.a,{component:Ro.b.h3},r.createElement(ar.a,{to:n},a)))]}},{key:"getConclusionList",value:function(e){return r.createElement("ul",null,e.map((function(e,t){return r.createElement("li",{key:t},e)})))}},{key:"renderCardHead",value:function(){var e=[r.createElement(up.a,{key:"viewGraph",onClick:this.showFullMetric},"Show service inbound metrics"),r.createElement(up.a,{key:"viewGraph",onClick:this.showFullGraph},"Show traffic graph"),r.createElement(up.a,{key:"viewGraph",onClick:this.onDownloadClick},"Download Experiment YAML")];return[r.createElement(Uf.a,null,r.createElement(Bf.a,null,r.createElement(Ru.a,{toggle:r.createElement(Wf.a,{onToggle:this.onGraphActionsToggle}),dropdownItems:e,isPlain:!0,isOpen:this.state.isKebabOpen,position:"right"})),r.createElement(bf.a,null,r.createElement(Eo.a,{style:{float:"left"},headingLevel:"h3",size:"2xl"},r.createElement(pc,{badge:{badge:this.props.experimentDetails.experimentType}}),"\xa0\xa0",this.props.experimentDetails.experimentItem.name)))]}},{key:"componentDidUpdate",value:function(e){Yx()(this.props.experiment,e.experiment)?Yx()(this.props.experiment,e.experiment)&&this.state.isUpdated&&this.setState({isUpdated:!1}):this.setState({isUpdated:!0})}},{key:"render",value:function(){var e,t,a,n=this,i=this.props.experimentDetails?this.props.experimentDetails.experimentItem.targetServiceNamespace:this.props.namespace,o=this.props.experimentDetails?this.props.experimentDetails.experimentItem.targetService:this.props.target,s=this.props.experimentDetails?this.props.experimentDetails.experimentItem.status:"";""!==this.props.actionTaken&&(s='Waiting for result of action "'+this.props.actionTaken+'" ');var l=!!this.props.experimentDetails&&(!(!this.props.experimentDetails.networking||!this.props.experimentDetails.networking.hosts)&&this.props.experimentDetails.networking.hosts.length>0),c="",u="";return this.props.experimentDetails.experimentItem.status.indexOf("Abort")>0&&(c=" (Tentative)",u=" at the time of Termination(Abort)."),r.createElement(r.Fragment,null,r.createElement(Zn,null,r.createElement(Df.a,{gutter:"md"},r.createElement(Ff.a,{span:12},r.createElement(Df.a,{gutter:"md"},r.createElement(Ff.a,{span:6},r.createElement(Ef.a,{style:{height:"100%"}},"Deployment"===(null===(e=this.props.experimentDetails)||void 0===e?void 0:e.experimentItem.kind)?this.renderCardHead():"",r.createElement(yf.a,null,r.createElement(Hx.a,{"aria-label":"baseline and candidate"},"Deployment"===(null===(t=this.props.experimentDetails)||void 0===t?void 0:t.experimentItem.kind)?r.createElement(Gx.a,{"aria-labelledby":"target"},r.createElement(Vx.a,null,r.createElement(Ux.a,{dataListCells:this.serviceInfo()}),r.createElement(Ux.a,{dataListCells:this.serviceLinkCell(i,o)}))):"",r.createElement(Gx.a,{"aria-labelledby":"Baseline"},r.createElement(Vx.a,null,r.createElement(Ux.a,{dataListCells:this.baselineInfo("Baseline",this.props.experimentDetails?this.props.experimentDetails.experimentItem.baseline.name:"",this.props.experimentDetails?this.props.experimentDetails.experimentItem.kind:"")}),r.createElement(Ux.a,{dataListCells:this.percentageInfo("Baseline",this.props.experimentDetails?this.props.experimentDetails.experimentItem.baseline.weight:0)}))),null===(a=this.props.experimentDetails)||void 0===a?void 0:a.experimentItem.candidates.map((function(e){var t,a,i=(null===(t=n.props.experimentDetails)||void 0===t?void 0:t.experimentItem.kind)?null===(a=n.props.experimentDetails)||void 0===a?void 0:a.experimentItem.kind:"Deployment";return r.createElement(Gx.a,{"aria-labelledby":"Candidate"},r.createElement(Vx.a,null,r.createElement(Ux.a,{dataListCells:n.baselineInfo("Candidate",e.name,i)}),r.createElement(Ux.a,{dataListCells:n.percentageInfo("Candidate",e.weight)})))})),l?r.createElement(Gx.a,{"aria-labelledby":"Gateway"},r.createElement(Vx.a,null,r.createElement(Ux.a,{dataListCells:this.gatewayInfo("H",this.props.namespace,this.props.experimentDetails.networking?this.props.experimentDetails.networking.hosts[0].gateway:"")}),r.createElement(Ux.a,{dataListCells:r.createElement(Fx.a,{key:"gateway"},r.createElement(Ro.a,null,"Name"),r.createElement(Ro.a,{component:Ro.b.h3},this.props.experimentDetails.networking?this.props.experimentDetails.networking.hosts[0].name:""))}))):r.createElement(r.Fragment,null))))),r.createElement(Ff.a,{span:6},r.createElement(Ef.a,{style:{height:"100%"}},r.createElement(yf.a,null,r.createElement(wh.a,{gutter:"md",style:{marginTop:"10px"}},r.createElement(Rh.a,{id:"Status"},r.createElement(Ro.a,{component:Ro.b.h3}," Status: "),s),r.createElement(Rh.a,{id:"Status"},r.createElement(Ro.a,{component:Ro.b.h3}," Phase: "),this.props.experimentDetails?this.props.experimentDetails.experimentItem.phase:""),r.createElement(Rh.a,{id:"Winner"},""!==this.props.experimentDetails.experimentItem.endTime?r.createElement(Df.a,null,r.createElement(Ff.a,{span:12},r.createElement(Rh.a,null,this.props.experimentDetails.experimentItem.winner.winning_version_found?r.createElement(r.Fragment,null,r.createElement(Ro.a,{component:Ro.b.h3}," Winner Found: ",c),this.props.experimentDetails.experimentItem.winner.name,r.createElement(lo.a,{key:"winnerTooltip","aria-label":"Winner Tooltip",position:Cr.b.auto,className:"health_indicator",content:r.createElement(r.Fragment,null,"Winning version identified by iter8 analytics",u)},r.createElement(fi.Info,{className:tN}))):r.createElement(Ro.a,{component:Ro.b.h3}," Winner not Found ")))):r.createElement(Df.a,null,r.createElement(Ff.a,{span:6},r.createElement(Rh.a,null,r.createElement(Ro.a,{component:Ro.b.h3}," ",""===this.props.experimentDetails.experimentItem.endTime?"Current Best Version":"Winner Version"," "),this.props.experimentDetails.experimentItem.winner.name)),r.createElement(Ff.a,{span:6},r.createElement(Rh.a,null,r.createElement(Ro.a,{component:Ro.b.h3}," Probability of Winning: "),this.props.experimentDetails.experimentItem.winner.probability_of_winning_for_best_version)))),r.createElement(Rh.a,null,r.createElement(Df.a,null,r.createElement(Ff.a,{span:4},r.createElement(Rh.a,{id:"started_at"},r.createElement(Ro.a,{component:Ro.b.h3}," Created at "),r.createElement(Rf,{time:this.props.experimentDetails&&this.props.experimentDetails.experimentItem.initTime?this.props.experimentDetails.experimentItem.initTime:""}))),r.createElement(Ff.a,{span:4},r.createElement(Rh.a,{id:"started_at"},r.createElement(Ro.a,{component:Ro.b.h3}," Started at "),r.createElement(Rf,{time:this.props.experimentDetails&&this.props.experimentDetails.experimentItem.startTime?this.props.experimentDetails.experimentItem.startTime:""}))),r.createElement(Ff.a,{span:4},r.createElement(Rh.a,{id:"ended_at"},r.createElement(Ro.a,{component:Ro.b.h3}," Ended at "),r.createElement(Rf,{time:this.props.experimentDetails&&this.props.experimentDetails.experimentItem.endTime?this.props.experimentDetails.experimentItem.endTime:""}))))))))))),r.createElement(Ff.a,{span:12},r.createElement(ch.a,{isFilled:!1,activeKey:0},r.createElement(bh.a,{title:"Traffic Control",eventKey:0,style:{backgroundColor:nt.White}},r.createElement(eN,{message:"Something went wrong"},r.createElement(Zx,{trafficControl:this.props.experimentDetails.trafficControl}))))))))}}]),a}(r.Component),nN=a(15),rN=a(43),iN=a.n(rN),oN=["trRef","className","rowProps","row"],sN=Object(Jn.a)({fontSize:"2.0em"}),lN=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).getRows=function(){var e=[];return n.props.criterias.map((function(t){var a=[{cells:[{title:r.createElement(r.Fragment,null,"Numerator")},{title:r.createElement(r.Fragment,null,t.metric.numerator.name)},{title:r.createElement(r.Fragment,null,t.metric.numerator.query_template)}]},{cells:[{title:r.createElement(r.Fragment,null,"Denominator")},{title:r.createElement(r.Fragment,null,t.metric.denominator.name)},{title:r.createElement(r.Fragment,null,t.metric.denominator.query_template)}]}],i=e.push({isOpen:!1,cells:[{title:r.createElement(r.Fragment,null,t.name)},{title:r.createElement(r.Fragment,null,t.criteria.toleranceType)},{title:r.createElement(r.Fragment,null,t.criteria.tolerance)},{title:r.createElement(r.Fragment,null,t.criteria.isReward?"YES":"-")},{title:r.createElement(r.Fragment,null,t.criteria.stopOnFailure?"True":"False")},{title:r.createElement(r.Fragment,null,t.metric.preferred_direction)}]});return e.push({parent:i-1,fullWidth:!0,cells:[r.createElement(r.Fragment,null,r.createElement(Eu.b,{"aria-label":"Simple Table",cells:n.columns(),rows:a},r.createElement(bu.a,null),r.createElement(kp.a,null)))]}),e})),e},n.columns=function(){return[{title:"Type",transforms:[Object(oo.a)(15)]},{title:"Name",transforms:[Object(oo.a)(15)]},{title:"Template"}]},n.getIcon=function(e){switch(String(e)){case"true":return r.createElement(lo.a,{content:r.createElement(r.Fragment,null,e)},r.createElement(fi.Ok,{className:sN}));case"false":return r.createElement(lo.a,{content:r.createElement(r.Fragment,null,e)},r.createElement(fi.Error,{className:sN}));default:return r.createElement(lo.a,{content:r.createElement(r.Fragment,null,e)},r.createElement(fi.Ok,{className:sN}))}},n.customRowWrapper=function(e){var t=e.trRef,a=e.className,n=(e.rowProps,e.row),i=n.isExpanded,o=n.isHeightAuto,s=Object(uo.a)(e,oN);return r.createElement("tr",Object.assign({},s,{ref:t,className:Object(nN.b)(a,"custom-static-class",void 0!==i&&iN.a.tableExpandableRow,i&&iN.a.modifiers.expanded,o&&iN.a.modifiers.heightAuto),hidden:void 0!==i&&!i,style:{borderLeft:"3px solid var(--pf-global--primary-color--100)"}}))},n.onCollapse=function(e,t,a){var r=n.state.rows;r[t].isOpen=a,n.setState({rows:r})},n.state={criteriaExpanded:[],columns:[{title:"Metric Name"},"Threshold Type:","Threshold ","Is Reward","Stop On Failure","Preferred Direction"],rows:n.getRows()},n}return Object(l.a)(a,[{key:"render",value:function(){var e=this,t=this.state,a=t.columns,n=t.rows;return r.createElement(Zn,null,r.createElement(Df.a,{gutter:"md"},r.createElement(Ff.a,{span:12},r.createElement(Eu.b,{"aria-label":"SpanTable",className:"spanTracingTagsTable",onCollapse:this.onCollapse,rows:n,cells:a,rowWrapper:function(t){return e.customRowWrapper(Object(C.a)({trRef:t.trRef,className:t.className,rowProps:t.rowProps,row:t.row},t))}},r.createElement(bu.a,null),n.length>0?r.createElement(kp.a,null):r.createElement("tr",null,r.createElement("td",{colSpan:a.length},r.createElement(Cu.a,{variant:Cu.b.full},r.createElement(Eo.a,{headingLevel:"h5",size:"lg"},"No Criteria found"),r.createElement(Su.a,null,"Experiment has not been started"))))))))}}]),a}(r.Component),cN=a(1547),uN=a(615),pN=a(349),dN=["trRef","className","rowProps","row"],mN=Object(Jn.a)({fontSize:"2.0em"}),hN=Object(Jn.a)({margin:"0px 16px 2px 4px"}),fN=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).fetchAssesment=function(){var e=n.props.namespace,t=n.props.name;Nn(e,t).then((function(e){n.setState({experimentItem:e.data.experimentItem,rows:n.getRows()})})).catch((function(e){_n("Could not fetch Iter8 Experiment",e)}))},n.getRows=function(){var e,t,a=[];return a.push(n.renderRow("Baseline",null===(e=n.props.experimentItem)||void 0===e?void 0:e.baseline)),null===(t=n.props.experimentItem)||void 0===t||t.candidates.map((function(e){return a.push(n.renderRow("Candidate",e)),a})),a},n.getMaxThreshold=function(e){var t,a=0;return null===(t=n.props.experimentItem.baseline.criterionAssessment)||void 0===t||t.map((function(t,n){t.metric_id===e&&(a=t.statistics.value)})),n.props.experimentItem.candidates.map((function(t){return void 0!==t.criterionAssessment&&t.criterionAssessment.map((function(t,n){return t.metric_id===e&&t.statistics.value>a&&(a=t.statistics.value),a})),a})),a},n.columns=function(){return[{title:"Name",transforms:[Object(oo.a)(15)]},{title:"Template"}]},n.getIcon=function(e){switch(e){case 1:return r.createElement(lo.a,{content:r.createElement(r.Fragment,null,e)},r.createElement(fi.Ok,{className:mN}));case 0:return r.createElement(lo.a,{content:r.createElement(r.Fragment,null,e)},r.createElement(fi.Error,{className:mN}));default:return e}},n.customRowWrapper=function(e){var t=e.trRef,a=e.className,n=(e.rowProps,e.row),i=n.isExpanded,o=n.isHeightAuto,s=Object(uo.a)(e,dN);return r.createElement("tr",Object.assign({},s,{ref:t,className:Object(nN.b)(a,"custom-static-class",void 0!==i&&iN.a.tableExpandableRow,i&&iN.a.modifiers.expanded,o&&iN.a.modifiers.heightAuto),hidden:void 0!==i&&!i,style:{borderLeft:"3px solid var(--pf-global--primary-color--100)"}}))},n.state={experimentItem:rx,columns:[{title:"Type",cellFormatters:[pN.b],transforms:[Object(oo.a)(10)]},"Assessment","Statistics"],rows:n.getRows()},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.setState({experimentItem:this.props.experimentItem,rows:this.getRows()})}},{key:"componentDidUpdate",value:function(e){this.props.experimentItem===e.experimentItem&&e.lastRefreshAt===this.props.lastRefreshAt||this.renderRows()}},{key:"renderRows",value:function(){this.setState({experimentItem:this.props.experimentItem,rows:this.getRows()})}},{key:"getLegend",value:function(e,t){return t===e-1?"{[{ name: 'Current Measurement'}]}":"{}"}},{key:"renderTresholdBar",value:function(e,t,a,n){var i,o,s,l,c,u,p=n.value;if(void 0===p)return r.createElement(r.Fragment,null,0===t?"":r.createElement(wu.a,null),r.createElement(Df.a,{gutter:"md"},r.createElement(Ff.a,{span:4},a,":"),r.createElement(Ff.a,{span:2},p),r.createElement(Ff.a,{span:6})));var d=p.toFixed(2),m=this.props.metricInfo.get(a);if(void 0===m)return r.createElement(r.Fragment,null);var h,f=1;"relative"===m.thresholdType&&(null===(h=this.props.experimentItem.baseline.criterionAssessment)||void 0===h||h.map((function(e,t){e.metric_id===a&&(f=e.statistics.value)})));var g,v=Number((m.threshold*f).toFixed(2)),E=1.5*v;0===m.threshold&&(E=Number((1.1*Number((this.getMaxThreshold(a)*f).toFixed(2))).toFixed(0))),E=Number(p>E?p.toFixed(2):E.toFixed(2));var b=0,y=v;void 0!==m.preferred_direction&&"lower"===m.preferred_direction?g=p>=v?iy.q.orange:iy.q.blue:(b=v,y=E,g=p>=v?iy.q.blue:iy.q.orange);var C="Lower limit",S="Range";0===b&&(C="",0!==m.threshold&&(S="Upper Limit"));var A=t===e-1?null!=(null===(i=n.ratio_statistics)||void 0===i?void 0:i.credible_interval.upper)?120:100:0,T=t===e-1?20:110,O=null!=(null===(o=n.ratio_statistics)||void 0===o?void 0:o.credible_interval.upper)?[{name:"Credible Lower Range",y:n.ratio_statistics.credible_interval.lower}]:[],I=null!=(null===(s=n.ratio_statistics)||void 0===s?void 0:s.credible_interval.upper)?[{name:"Credible Upper Range",y:n.ratio_statistics.credible_interval.upper}]:[],w=null!=(null===(l=n.ratio_statistics)||void 0===l?void 0:l.credible_interval.upper)?[{name:"Credible Lower Range",symbol:{type:"minus"}},{name:"Credible Higher Range",symbol:{type:"minus"}},{name:"Exception"},{name:"Threshold"},{name:"Measurement inside threshold"},{name:"Measurement outside threshold"}]:[{name:"Exception"},{name:"Threshold"},{name:"Measurement inside threshold"},{name:"Measurement outside threshold"}],R=null!=(null===(c=n.ratio_statistics)||void 0===c?void 0:c.credible_interval.upper)?["#ec7a08","#c9190a","#ededed","#d2d2d2","#0466cc","#ec7a08"]:["#ededed","#d2d2d2","#0466cc","#ec7a08"],k=null!=(null===(u=n.ratio_statistics)||void 0===u?void 0:u.credible_interval.upper)?60:40;return r.createElement(r.Fragment,null,0===t?"":r.createElement(wu.a,null),r.createElement(Df.a,{gutter:"md"},r.createElement(Ff.a,{span:4},a),r.createElement(Ff.a,{span:2},d),r.createElement(Ff.a,{span:6},r.createElement("div",{style:{marginTop:-50,marginBottom:A}},r.createElement(cN.a,{qualitativeRangeData:[{name:C,y:b},{name:S,y:y}],maxDomain:{y:Number(E)},comparativeWarningMeasureData:O,comparativeErrorMeasureData:I,primarySegmentedMeasureData:[{name:"Current ",y:d}],constrainToVisibleArea:!0,themeColor:g,themeVariant:iy.r.dark,padding:{bottom:0,left:0,right:0,top:0},height:T,standalone:!0,labels:function(e){var t=e.datum;return"".concat(t.name,": ").concat(t.y)},legendPosition:"bottom"})),t===e-1?r.createElement(r.Fragment,null,r.createElement(uN.a,{data:w,style:{labels:{fontSize:12}},colorScale:R,itemsPerRow:2,height:k})):r.createElement(r.Fragment,null))))}},{key:"renderRow",value:function(e,t){var a,n,i=this;return{cells:[{title:r.createElement(r.Fragment,null,e)},{title:r.createElement(r.Fragment,null,(null===(a=this.props.experimentItem)||void 0===a?void 0:a.winner.winning_version_found)&&(null===(n=this.props.experimentItem)||void 0===n?void 0:n.winner.name)===t.name?r.createElement(Df.a,{gutter:"md"},r.createElement(Ff.a,{span:6},"Winner",r.createElement(lo.a,{key:"winnerTooltip","aria-label":"Winner Tooltip",position:Cr.b.auto,className:"health_indicator",content:r.createElement(r.Fragment,null,"Winning version identified by iter8 analytics")},r.createElement(fi.Info,{className:hN}))),r.createElement(Ff.a,{span:6}," ",r.createElement(fi.Ok,{className:mN}))):r.createElement(r.Fragment,null),r.createElement(Df.a,{gutter:"md"},r.createElement(Ff.a,{span:6},"Name:"),r.createElement(Ff.a,{span:6},t.name)),r.createElement(Df.a,{gutter:"md"},r.createElement(Ff.a,{span:6},"Weight:"),r.createElement(Ff.a,{span:6},t.weight)),r.createElement(Df.a,{gutter:"md"},r.createElement(Ff.a,{span:6},"Win Probability:"),r.createElement(Ff.a,{span:6},t.winProbability)),r.createElement(Df.a,{gutter:"md"},r.createElement(Ff.a,{span:6},"Request Count:"),r.createElement(Ff.a,{span:6},t.requestCount)))},{props:{nonPadding:!0},title:r.createElement(r.Fragment,null,t.criterionAssessment&&t.criterionAssessment.map((function(e,a){return r.createElement(Df.a,{gutter:"md"},i.renderTresholdBar(t.criterionAssessment.length,a,e.metric_id,e.statistics))})))}]}}},{key:"render",value:function(){var e=this,t=this.state,a=t.columns,n=t.rows;return r.createElement(r.Fragment,null,r.createElement(Zn,null,r.createElement(Df.a,{gutter:"md"},r.createElement(Ff.a,{span:12},r.createElement(Eu.b,{"aria-label":"SpanTable",className:"spanTracingTagsTable",rows:n,cells:a,rowWrapper:function(t){return e.customRowWrapper(Object(C.a)({trRef:t.trRef,className:t.className,rowProps:t.rowProps,row:t.row},t))}},r.createElement(bu.a,null),n.length>0?r.createElement(kp.a,null):r.createElement("tr",null,r.createElement("td",{colSpan:a.length},r.createElement(Cu.a,{variant:Cu.b.full},r.createElement(Eo.a,{headingLevel:"h5",size:"lg"},"No Criteria found"),r.createElement(Su.a,null,"Experiment has not been started")))))))))}}]),a}(r.Component),gN=Object(h.b)((function(e){return{duration:fl(e),lastRefreshAt:wl(e)}}),null)(fN),vN={info:0,assessment:1,criteria:2},EN=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n,i;Object(s.a)(this,a),(i=t.call(this,e)).initTrafficSplit=function(e){if(0!==i.state.manualOverride.length)return i.state.manualOverride;var t=[];return t.push({name:e.experimentItem.baseline.name,weight:0,maxWeight:100,locked:!1,mirrored:!1}),e.experimentItem.candidates.forEach((function(e){t.push({name:e.name,weight:0,maxWeight:100,locked:!1,mirrored:!1})})),t},i.fetchExperiment=function(){var e=i.props.match.params.namespace,t=i.props.match.params.name;xn().then((function(a){var n=a.data;n.enabled?Nn(e,t).then((function(e){var t=i.initTrafficSplit(e.data);i.state.resetActionFlag?i.setState({iter8Info:n,actionTaken:"",experiment:e.data,canDelete:e.data.permissions.delete,resetActionFlag:!1,manualOverride:t,lastRefreshAt:Date.now()}):i.setState({experiment:e.data,canDelete:e.data.permissions.delete,resetActionFlag:!0,manualOverride:t,lastRefreshAt:Date.now()})})).catch((function(e){_n("Could not fetch Iter8 Experiment",e)})):_n("Kiali has Iter8 extension enabled but it is not detected in the cluster")})).catch((function(e){_n("Could not fetch Iter8 Info.",e)}))},i.backToList=function(){U.push("/extensions/iter8?namespaces=".concat(i.props.match.params.namespace))},i.doRefresh=function(){i.fetchExperiment()},i.doDelete=function(){var e,t;(e=i.props.match.params.namespace,t=i.props.match.params.name,Xa(K.DELETE,qa.iter8Experiment(e,t),{},{})).then((function(){return i.backToList()})).catch((function(e){_n("Could not delete Iter8 Experiment.",e)}))},i.doTrafficSplit=function(e){i.setState((function(t){return{manualOverride:e}}))},i.doIter8Action=function(e){var t,a,n,r="Could not"+e+" Iter8 Experiment",o={action:e,trafficSplit:[]};if("terminate"===e){var s=new Map;i.state.manualOverride.forEach((function(e,t){s.set(e.name,String(e.weight))})),o.trafficSplit=Array.from(s)}i.setState({actionTaken:e}),(t=i.props.match.params.namespace,a=i.props.match.params.name,n=JSON.stringify(o),Xa(K.PATCH,qa.iter8Experiment(t,a),{},n)).then((function(){return i.doRefresh()})).catch((function(e){i.setState({actionTaken:""}),_n(r,e)}))},i.renderRightToolbar=function(){return r.createElement(Dx,{experimentName:i.props.match.params.name,manualOverride:i.state.manualOverride,canDelete:i.state.canDelete,startTime:i.state.experiment?i.state.experiment.experimentItem.startTime:"",endTime:i.state.experiment?i.state.experiment.experimentItem.endTime:"",phase:i.state.experiment?i.state.experiment.experimentItem.phase:" ",onDelete:i.doDelete,onResume:function(){return i.doIter8Action("resume")},onPause:function(){return i.doIter8Action("pause")},onTerminate:function(){return i.doIter8Action("terminate")},doTrafficSplit:i.doTrafficSplit})};var o=new URLSearchParams(U.location.search),l=o.get("baseline")||"",c=(null===(n=o.get("candidates"))||void 0===n?void 0:n.split(","))||[],u=new Map;return u.set(l,0),c.forEach((function(e){u.set(e,0)})),i.state={iter8Info:{enabled:!1,supportedVersion:!1,analyticsImgVersion:"",controllerImgVersion:"",namespace:"iter8"},experiment:ix,canDelete:!1,currentTab:uh("tab","overview"),target:o.get("target")||"",baseline:l,actionTaken:"",resetActionFlag:!1,manualOverride:[],lastRefreshAt:Date.now()},i}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.fetchExperiment()}},{key:"componentDidUpdate",value:function(e){this.state.currentTab===uh("tab","overview")&&e.lastRefreshAt===this.props.lastRefreshAt||this.setState({currentTab:uh("tab","overview")})}},{key:"render",value:function(){var e,t=this,a=r.createElement(bh.a,{eventKey:0,title:"Overview",key:"Overview"},r.createElement(aN,{namespace:this.props.match.params.namespace,experiment:this.props.match.params.name,target:this.state.target,experimentDetails:this.state.experiment,actionTaken:this.state.actionTaken})),n=new Map,i=Object($t.a)(this.state.experiment.criterias);try{for(i.s();!(e=i.n()).done;){var o=e.value;n.set(o.name,{name:o.name,threshold:o.criteria.tolerance,thresholdType:o.criteria.toleranceType,preferred_direction:o.metric.preferred_direction,isReward:o.criteria.isReward,unit:o.metric.numerator.unit})}}catch(l){i.e(l)}finally{i.f()}var s=[a,r.createElement(bh.a,{eventKey:1,title:"Assessment",key:"Assessment"},r.createElement(gN,{lastRefreshAt:this.state.lastRefreshAt,iter8Info:this.state.iter8Info,name:this.props.match.params.name,namespace:this.props.match.params.namespace,experimentItem:this.state.experiment.experimentItem,metricInfo:n,fetchOp:function(){return t.fetchExperiment()}})),r.createElement(bh.a,{eventKey:2,title:"Criteria",key:"Criteria"},r.createElement(lN,{iter8Info:this.state.iter8Info,criterias:this.state.experiment?this.state.experiment.criterias:[]}))];return r.createElement(r.Fragment,null,r.createElement(Qi,{location:this.props.location,rightToolbar:r.createElement(Xl,{id:"time_range_refresh",hideLabel:!0,handleRefresh:this.doRefresh,manageURL:!0}),actionsToolbar:this.renderRightToolbar()}),r.createElement(ph,{id:"basic-tabs",onSelect:function(e){t.setState({currentTab:e})},tabMap:vN,tabName:"tab",defaultTab:"overview",postHandler:this.fetchExperiment,activeTab:this.state.currentTab,mountOnEnter:!0,unmountOnExit:!0},s))}}]),a}(r.Component),bN=Object(h.b)((function(e){return{duration:fl(e),lastRefreshAt:e.globalState.lastRefreshAt}}),null)(EN),yN=a(1548),CN=Object(Jn.a)({padding:"20px 20px 20px 20px"}),SN=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).aceEditorRef=void 0,n.promises=new yr,n.handleFileChange=function(e,t,a){return n.setState({experimentYaml:e,filename:t})},n.handleFileReadStarted=function(){return n.setState({isLoading:!0})},n.handleFileReadFinished=function(){return n.setState({isLoading:!1})},n.goExperimentsPage=function(){U.push("/extensions/iter8")},n.onEditorChange=function(e){n.setState({isModified:!0,yamlModified:!1,experimentYaml:e})},n.createExperiment=function(){var e=n.props.activeNamespaces[0].name,t={type:"json"},a=$m.safeLoad(n.state.experimentYaml);n.promises.register("Create Iter8 Experiment",jn(e,JSON.stringify(a),t)).then((function(e){return n.goExperimentsPage()})).catch((function(e){return _n("Could not create Experiment.",e)}))},n.renderEditor=function(){var e=n.state.experimentYaml,t=rh(e);return r.createElement(r.Fragment,null,r.createElement(Df.a,{style:{margin:"10px"},gutter:"md"},r.createElement(Ff.a,{span:12},r.createElement(Zm.a,{ref:n.aceEditorRef,mode:"yaml",theme:"eclipse",onChange:n.onEditorChange,width:"100%",height:"calc(var(--kiali-details-pages-tab-content-height) - 340px)",className:"istio-ace-editor",wrapEnabled:!0,readOnly:!1,setOptions:Qm,value:e,annotations:t.annotations,markers:t.markers}))))},n.updateValue=function(e){n.setState({yamlFilename:e})},n.loadFromURL=function(){n.setState({isLoading:!0});var e=new AbortController;setTimeout((function(){return e.abort()}),5e3),fetch(n.state.yamlFilename,{signal:e.signal}).then((function(e){if(!e.ok)throw _n("Response :"+e.status),n.setState({isLoading:!1}),e;return e.text()})).then((function(e){n.setState((function(t){return{experimentYaml:e,isLoading:!t.isLoading}}))})).catch((function(e){if("AbortError"===e.name)return _n("Request took more than 5 seconds. Automatically cancelled.",e),void n.setState({isLoading:!1});_n("Invalid fetch URL",e),n.setState({isLoading:!1})}))},n.clearURL=function(){n.setState({yamlFilename:"",experimentYaml:""})},n.isFormValid=function(){return 1===n.props.activeNamespaces.length&&""!==n.state.experimentYaml},n.isURL=function(){return""!==n.state.yamlFilename},n.state={filename:"",yamlFilename:"",experimentYaml:"",isLoading:!1,isModified:!1,yamlModified:!1},n.aceEditorRef=r.createRef(),n}return Object(l.a)(a,[{key:"componentWillUnmount",value:function(){this.promises.cancelAll()}},{key:"render",value:function(){var e=this,t=this.state,a=t.filename,n=t.isLoading,i=t.experimentYaml;return r.createElement(r.Fragment,null,r.createElement("div",{style:{backgroundColor:"#fff"}},r.createElement($u,null)),r.createElement(Df.a,{style:{margin:"10px"},gutter:"md"},r.createElement(Ff.a,{span:12},r.createElement(dp.a,{isHorizontal:!0,className:CN},r.createElement(mp.a,{fieldId:"title",label:"Load from Local",isRequired:!0},r.createElement(yN.a,{id:"text-file-with-edits-allowed",type:"text",value:i,filename:a,onChange:this.handleFileChange,onReadStarted:this.handleFileReadStarted,onReadFinished:this.handleFileReadFinished,isLoading:n,hideDefaultPreview:!0,isReadOnly:!1})),r.createElement(mp.a,{fieldId:"title",label:"Load from Github",isRequired:!0,helperText:"example: https://raw.githubusercontent.com/iter8-tools/iter8/master/test/data/bookinfo/canary/canary_reviews-v2_to_reviews-v3.yaml",helperTextInvalid:"Name cannot be empty and must be a DNS subdomain name as defined in RFC 1123."},r.createElement(ek.a,null,r.createElement(Rp.TextInputBase,{id:"url",value:this.state.yamlFilename,onChange:function(t){return e.updateValue(t)},onKeyPress:function(t){"Enter"===t.key&&e.loadFromURL()}}),r.createElement(vr.a,{style:{paddingLeft:"29px",paddingRight:"29px"},variant:vr.b.primary,isDisabled:""===this.state.yamlFilename,onClick:function(){e.loadFromURL()}},"Load"),r.createElement(vr.a,{variant:vr.b.primary,isDisabled:""===this.state.yamlFilename,onClick:function(){e.clearURL()}},"Clear"))))),r.createElement(Ff.a,{span:2}),r.createElement(Ff.a,{span:7},1===this.props.activeNamespaces.length?r.createElement(Ro.a,null,"Experiment will be created at namespace: ",wT(this.props.activeNamespaces)):r.createElement(Ro.a,{style:{color:nt.Red100}},"namespace missing")),r.createElement(Ff.a,{span:3},r.createElement(hp.a,null,r.createElement("span",{style:{float:"left",paddingTop:"10px",paddingBottom:"10px",width:"100%"}},r.createElement("span",{style:{float:"right",paddingRight:"20px"}},r.createElement(vr.a,{variant:vr.b.primary,isDisabled:!this.isFormValid(),onClick:function(){return e.createExperiment()}},"Create")),r.createElement("span",{style:{float:"right",paddingRight:"5px"}},r.createElement(vr.a,{variant:vr.b.secondary,onClick:function(){e.goExperimentsPage()}},"Cancel"))))),r.createElement(Ff.a,null," ",this.renderEditor())))}}]),a}(r.Component),AN=Object(h.b)((function(e){return{activeNamespaces:hl(e)}}),null)(SN),TN=a(1527),ON=function(){var e=r.useState(null),t=Object(T.a)(e,2),a=t[0],n=t[1],i=r.useState({index:0,direction:Eu.a.asc}),o=Object(T.a)(i,2),s=o[0],l=o[1],c=Object(Jn.a)({padding:"20px"}),u=[{title:"Cluster Name",transforms:[io.a,Object(oo.a)(20)]},{title:"Network",transforms:[io.a,Object(oo.a)(10)]},{title:"Kiali",transforms:[Object(oo.a)(20)]},{title:"API Endpoint",transforms:[io.a,Object(oo.a)(20)]},{title:"Secret name",transforms:[io.a,Object(oo.a)(30)]}];function p(e){return e.kialiInstances&&0!==e.kialiInstances.length?e.kialiInstances.map((function(t){return 0!==t.url.length?r.createElement(lo.a,{content:"Go to this Kiali instance: ".concat(t.url)},r.createElement("p",{key:e.name+"/"+t.namespace+"/"+t.serviceName},r.createElement("img",{alt:"kiali-icon",src:"kiali_icon_lightbkg_16px.png"})," ",r.createElement("a",{href:t.url,target:"_blank",rel:"noopener noreferrer"},t.namespace," "," / "," ",t.serviceName))):r.createElement("p",{key:e.name+"/"+t.namespace+"/"+t.serviceName},r.createElement("img",{alt:"kiali-icon",src:"kiali_icon_lightbkg_16px.png"})," ","".concat(t.namespace," / ").concat(t.serviceName))})):"N / A"}function d(){return m.apply(this,arguments)}function m(){return(m=Object(Zt.a)(Jt.a.mark((function e(){var t;return Jt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Ln();case 3:t=e.sent,n(t.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),_n("Could not fetch the list of clusters that are part of the mesh.",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}var h=r.useMemo((function(){if(null===a)return[];var e=["name","apiEndpoint","network","secretName"][s.index],t=Array.from(a).sort((function(t,a){return t[e].localeCompare(a[e],void 0,{sensitivity:"base"})})).map((function(e){return{cells:[r.createElement(r.Fragment,null,e.isKialiHome?r.createElement(TN.a,null):null," ",e.name),e.network,r.createElement(r.Fragment,null,p(e)),e.apiEndpoint,e.secretName]}}));return s.direction===Eu.a.asc?t:t.reverse()}),[a,s]);return r.useEffect((function(){d()}),[]),r.createElement(r.Fragment,null,r.createElement("div",{style:{backgroundColor:"#fff"}},r.createElement($u,{hideNamespaceSelector:!0,rightToolbar:r.createElement(zl,{key:"Refresh",handleRefresh:d})})),r.createElement(tr,null,r.createElement("div",{className:c},r.createElement($x.a,{isInline:!0,variant:"warning",title:"This feature is experimental."})),r.createElement("div",{className:c},r.createElement(Eu.b,{"aria-label":"Sortable Table",cells:u,onSort:function(e,t,a){l({index:t,direction:a})},rows:h,sortBy:s},r.createElement(bu.a,null),r.createElement(kp.a,null)),0===h.length?r.createElement(Cu.a,{variant:Cu.b.full},r.createElement(Eo.a,{headingLevel:"h2",size:"lg"},"No Clusters"),r.createElement(Su.a,null,"No clusters were discovered in your mesh.")):null)))},IN=[{title:"Overview",to:"/overview",pathsActive:[/^\/overview\/(.*)/]},{title:"Graph",to:"/graph/namespaces/",pathsActive:[/^\/graph\/(.*)/]},{title:"Applications",to:"/"+ce.APPLICATIONS,pathsActive:[new RegExp("^/namespaces/(.*)/"+ce.APPLICATIONS+"/(.*)")]},{title:"Workloads",to:"/"+ce.WORKLOADS,pathsActive:[new RegExp("^/namespaces/(.*)/"+ce.WORKLOADS+"/(.*)")]},{title:"Services",to:"/"+ce.SERVICES,pathsActive:[new RegExp("^/namespaces/(.*)/"+ce.SERVICES+"/(.*)")]},{title:"Istio Config",to:"/"+ce.ISTIO,pathsActive:[new RegExp("^/namespaces/(.*)/"+ce.ISTIO+"/(.*)"),new RegExp("/"+ce.ISTIO+"/new/(.*)")]},{title:"Distributed Tracing",to:"/jaeger"},{title:"Mesh",to:"/mesh"}],wN=[{title:"Iter8 Experiments",to:"/extensions/iter8",pathsActive:[/^\/extensions\/iter8/,new RegExp("^/extensions/namespaces/(.*)/iter8")]}],RN=[{path:"/overview",component:eT},{path:"/graph/node/namespaces/:namespace/"+ce.AGGREGATES+"/:aggregate/:aggregateValue",component:FR},{path:"/graph/node/namespaces/:namespace/"+ce.APPLICATIONS+"/:app/versions/:version",component:FR},{path:"/graph/node/namespaces/:namespace/"+ce.APPLICATIONS+"/:app",component:FR},{path:"/graph/node/namespaces/:namespace/"+ce.SERVICES+"/:service",component:FR},{path:"/graph/node/namespaces/:namespace/"+ce.WORKLOADS+"/:workload",component:FR},{path:"/graph/namespaces",component:FR},{path:"/namespaces/:namespace/"+ce.SERVICES+"/:service",component:Gk},{path:"/namespaces/:namespace/"+ce.ISTIO+"/:objectType/:object",component:vf},{path:"/"+ce.SERVICES,component:op},{path:"/"+ce.APPLICATIONS,component:jA},{path:"/namespaces/:namespace/"+ce.APPLICATIONS+"/:app",component:VA},{path:"/"+ce.WORKLOADS,component:tp},{path:"/namespaces/:namespace/"+ce.WORKLOADS+"/:workload",component:xA},{path:"/"+ce.ISTIO+"/new/:objectType",component:qm},{path:"/"+ce.ISTIO,component:Ym},{path:"/"+ce.JAEGER,component:void 0},{path:"/"+ce.MESH,component:ON}],kN=[{path:"/extensions/namespaces/:namespace/iter8/:name",component:bN},{path:"/extensions/iter8/new",component:Px},{path:"/extensions/iter8/newFromFile",component:AN},{path:"/extensions/iter8",component:ax}],xN=Object(Jn.a)({marginLeft:0,marginRight:0}),NN=Object(Jn.a)({padding:"0 20px 0 20px"}),jN=Object(Jn.a)({background:nt.Black150}),PN=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"renderPaths",value:function(e){return e.map((function(e,t){return i.a.createElement(f.c,{key:t,path:e.path,component:e.component,render:e.render})}))}},{key:"renderPathRoutes",value:function(){var e=RN.concat(kN.filter((function(e){return!(!e.path.includes("iter8")||!j.extensions.iter8.enabled)})));return this.renderPaths(e)}},{key:"render",value:function(){var e=i.a.createElement("div",{className:"".concat(xN," ").concat(this.props.isGraph&&NN)},i.a.createElement(b,{fallBackComponent:function(){return i.a.createElement("h2",null,"Sorry, there was a problem. Try a refresh or navigate to a different page.")}},this.renderPathRoutes(),i.a.createElement(f.b,{from:"/",to:"/overview"})));return i.a.createElement(i.a.Fragment,null,this.props.isGraph?e:i.a.createElement("div",{className:jN},e))}}]),a}(i.a.Component),LN=a(1533),DN=new Map([[gs.ENABLED,{message:"Mesh-wide mTLS is enabled",icon:wo.LOCK_FULL,showStatus:!0}],[gs.PARTIALLY,{message:"Mesh-wide TLS is partially enabled",icon:wo.LOCK_HOLLOW,showStatus:!0}],[gs.NOT_ENABLED,bs]]),FN=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).fetchStatus=function(){nn().then((function(t){return e.props.setMeshTlsStatus(t.data)})).catch((function(t){e.props.namespaces&&e.props.namespaces.length<1?_n("Mesh-wide mTLS status feature disabled.",t,"default",Te.INFO):_n("Error fetching Mesh-wide mTLS status.",t,"default",Te.ERROR)}))},e}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.fetchStatus()}},{key:"componentDidUpdate",value:function(e){this.props.lastRefreshAt!==e.lastRefreshAt&&this.fetchStatus()}},{key:"iconStyle",value:function(){return Object(Jn.a)({marginRight:10,marginLeft:10,width:13})}},{key:"render",value:function(){return r.createElement(ys,{className:this.iconStyle(),status:this.props.status,statusDescriptors:DN})}}]),a}(r.Component),_N=Object(h.b)((function(e){return{status:xl(e),lastRefreshAt:wl(e),namespaces:Sl(e)}}),(function(e){return{setMeshTlsStatus:Object(Ie.b)(At.setinfo,e)}}))(FN);!function(e){e.Healthy="Healthy",e.Unhealthy="Unhealthy",e.Unreachable="Unreachable",e.NotFound="NotFound",e.NotReady="NotReady"}(Ax||(Ax={}));var MN,HN={color:nt.Danger,icon:ea.a},GN={color:nt.Warning,icon:ta.a},VN={color:nt.Info,icon:aa.a},UN={color:nt.Success,icon:na.a},BN={"false-false":GN,"false-true":HN,"true-false":UN,"true-true":UN},WN=(Tx={},Object(Ei.a)(Tx,Ax.NotFound,"Not found"),Object(Ei.a)(Tx,Ax.NotReady,"Not ready"),Object(Ei.a)(Tx,Ax.Unhealthy,"Not healthy"),Object(Ei.a)(Tx,Ax.Unreachable,"Unreachable"),Tx),qN=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).renderIcon=function(e,t){var a=BN["".concat(e===Ax.Healthy,"-").concat(t)];e===Ax.NotReady&&(a=VN);var n=a.icon;return r.createElement(n,{style:{color:a.color,marginTop:5}})},e.renderCells=function(){var t=e.props.componentStatus;return[r.createElement(Bh.a,{key:"cell-status-icon-"+t.name,gutter:"md"},r.createElement(Wh.a,null,e.renderIcon(e.props.componentStatus.status,e.props.componentStatus.is_core)),r.createElement(Wh.a,{isFilled:!0},t.name),r.createElement(Wh.a,null,WN[t.status]))]},e}return Object(l.a)(a,[{key:"render",value:function(){return this.renderCells()}}]),a}(r.Component),KN=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).nonhealthyComponents=function(){return e.props.status.filter((function(e){return e.status!==Ax.Healthy}))},e.coreComponentsStatus=function(){return e.nonhealthyComponents().filter((function(e){return e.is_core}))},e.addonComponentsStatus=function(){return e.nonhealthyComponents().filter((function(e){return!e.is_core}))},e.renderComponentList=function(){var t={core:e.coreComponentsStatus,addon:e.addonComponentsStatus};return["core","addon"].map((function(e){return r.createElement(r.Fragment,{key:"status-"+e},t[e]().map((function(t){return r.createElement(qN,{key:"status-".concat(e,"-").concat(t.name),componentStatus:t})})))}))},e}return Object(l.a)(a,[{key:"render",value:function(){return r.createElement(Yk.a,{style:{color:nt.White}},r.createElement(Ro.a,{component:Ro.b.h4},"Istio Components Status"),r.createElement(Mx.a,{id:"istio-status","aria-label":"Istio Component List"},this.renderComponentList()))}}]),a}(r.Component),zN=(a(1320),a(1528)),YN={"true-true-true":nt.Danger,"true-true-false":nt.Danger,"true-false-true":nt.Danger,"true-false-false":nt.Danger,"false-true-true":nt.Warning,"false-true-false":nt.Warning,"false-false-true":nt.Info,"false-false-false":nt.Success},QN=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).fetchStatus=function(){rn().then((function(t){return e.props.setIstioStatus(t.data)})).catch((function(t){e.props.namespaces&&e.props.namespaces.length<1?_n("Istio deployment status disabled.",t,"default",Te.INFO):_n("Error fetching Istio deployment status.",t,"default",Te.ERROR)}))},e.tooltipContent=function(){return r.createElement(KN,{status:e.props.status})},e.tooltipColor=function(){var t=!1,a=!1,n=!1;return Object.keys(e.props.status||{}).forEach((function(r){var i=e.props.status[r],o=i.status,s=i.is_core,l=o===Ax.NotReady,c=o!==Ax.Healthy&&!l;s?t=t||c:a=a||c,n=n||l})),YN["".concat(t,"-").concat(a,"-").concat(n)]},e.healthyComponents=function(){return e.props.status.reduce((function(e,t){return e&&t.status===Ax.Healthy}),!0)},e}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.props.refreshNamespaces(),this.fetchStatus()}},{key:"componentDidUpdate",value:function(e){this.props.lastRefreshAt!==e.lastRefreshAt&&this.fetchStatus()}},{key:"render",value:function(){return this.healthyComponents()?null:r.createElement(lo.a,{position:lo.b.left,enableFlip:!0,content:this.tooltipContent(),maxWidth:"25rem"},r.createElement(zN.a,{color:this.tooltipColor(),style:{verticalAlign:"-0.3em",marginRight:8}}))}}]),a}(r.Component),XN=Object(h.b)((function(e){return{status:jl(e),lastRefreshAt:wl(e),namespaces:Sl(e)}}),(function(e){return{setIstioStatus:Object(Ie.b)(It.setinfo,e),refreshNamespaces:function(){e(Nu.fetchNamespacesIfNeeded())}}}))(QN),JN=a(1526),ZN=Object(h.b)((function(e){return{isLoading:e.globalState.loadingCounter>0}}),null)((function(e){return e.isLoading?i.a.createElement(JN.a,{id:"loading_kiali_spinner",size:"lg"}):i.a.createElement(i.a.Fragment,null)})),$N=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).textForAuthStrategy=function(t){var a=e.props.timeOutCountDown<=0?"Your session has expired.":"Your session will expire in ".concat(e.props.timeOutCountDown.toFixed()," seconds.");return r.createElement(r.Fragment,null,a,r.createElement("br",null),"You will need to re-login. Please save your changes, if any.")},e}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props.onDismiss,t=[r.createElement(vr.a,{key:"confirm",variant:"link",onClick:this.props.onLogout},"Log Out"),r.createElement(vr.a,{autoFocus:!0,variant:"primary",onClick:this.props.onDismiss},"OK")];return r.createElement(ih.a,{isOpen:this.props.show,onClose:e,actions:t,title:"Session Timeout",width:"40%"},r.createElement("span",null,r.createElement(li.a,{size:"xl",color:nt.Warning})),r.createElement("span",{style:{float:"right",width:"80%"},className:"lead"},this.textForAuthStrategy(Q.strategy)))}}]),a}(r.Component),ej=function(){function e(){Object(s.a)(this,e)}return Object(l.a)(e,[{key:"prepare",value:function(){var e=Object(Zt.a)(Jt.a.mark((function e(t){return Jt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",W.CONTINUE);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"perform",value:function(){var e=Object(Zt.a)(Jt.a.mark((function e(t){return Jt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{status:W.FAILURE,session:{username:"anonymous",expiresOn:TE()().add(1,"d").toISOString()}});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),tj=function(){function e(){Object(s.a)(this,e)}return Object(l.a)(e,[{key:"prepare",value:function(){var e=Object(Zt.a)(Jt.a.mark((function e(t){return Jt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",W.CONTINUE);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"perform",value:function(){var e=Object(Zt.a)(Jt.a.mark((function e(t){var a;return Jt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ja({username:"",password:"",token:t.data.password});case 2:return a=e.sent.data,e.abrupt("return",{status:W.SUCCESS,session:a});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),aj=function(){function e(){Object(s.a)(this,e)}return Object(l.a)(e,[{key:"prepare",value:function(){var e=Object(Zt.a)(Jt.a.mark((function e(t){return Jt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",W.CONTINUE);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"perform",value:function(){var e=Object(Zt.a)(Jt.a.mark((function e(t){var a;return Jt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ja({username:"",password:"",token:""});case 2:return a=e.sent.data,e.abrupt("return",{status:W.SUCCESS,session:a});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),nj=function(){function e(){Object(s.a)(this,e)}return Object(l.a)(e,[{key:"prepare",value:function(){var e=Object(Zt.a)(Jt.a.mark((function e(t){return Jt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.authorizationEndpoint){e.next=2;break}return e.abrupt("return",W.FAILURE);case 2:if(!/[#&](access_token|id_token)=/.test(window.location.hash)){e.next=7;break}return e.abrupt("return",W.CONTINUE);case 7:return e.abrupt("return",W.HOLD);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"perform",value:function(){var e=Object(Zt.a)(Jt.a.mark((function e(t){var a;return Jt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,en(window.location.hash.substring(1));case 2:return a=e.sent.data,window.history.replaceState("",document.title,window.location.pathname+window.location.search),e.abrupt("return",{status:W.SUCCESS,session:a});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),rj=new(function(){function e(){Object(s.a)(this,e),this.strategyMapping=void 0,this.info=void 0,this.strategyMapping=new Map,this.strategyMapping.set(B.anonymous,new ej),this.strategyMapping.set(B.openshift,new nj),this.strategyMapping.set(B.token,new tj),this.strategyMapping.set(B.openid,new nj),this.strategyMapping.set(B.header,new aj)}return Object(l.a)(e,[{key:"prepare",value:function(){var e=Object(Zt.a)(Jt.a.mark((function e(){var t,a,n,r;return Jt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Q,a=this.strategyMapping.get(t.strategy),e.prev=2,n=function(){var e=Object(Zt.a)(Jt.a.mark((function e(){var t,a=arguments;return Jt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:3e3,e.abrupt("return",new Promise((function(e){return setTimeout(e,t)})));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),e.next=6,a.prepare(t);case 6:if((r=e.sent)!==W.HOLD){e.next=13;break}return e.next=10,n();case 10:return e.abrupt("return",Promise.reject({status:W.FAILURE,error:"Failed to redirect user to authentication page."}));case 13:return e.abrupt("return",r);case 14:e.next=19;break;case 16:return e.prev=16,e.t0=e.catch(2),e.abrupt("return",Promise.reject({status:W.FAILURE,error:e.t0}));case 19:case"end":return e.stop()}}),e,this,[[2,16]])})));return function(){return e.apply(this,arguments)}}()},{key:"perform",value:function(){var e=Object(Zt.a)(Jt.a.mark((function e(t){var a;return Jt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.strategyMapping.get(Q.strategy),e.prev=1,e.next=4,a.perform(t);case 4:return e.abrupt("return",e.sent);case 7:return e.prev=7,e.t0=e.catch(1),e.abrupt("return",Promise.reject({status:W.FAILURE,error:e.t0}));case 10:case"end":return e.stop()}}),e,this,[[1,7]])})));return function(t){return e.apply(this,arguments)}}()}]),e}()),ij=function(){var e=Object(Zt.a)(Jt.a.mark((function e(t,a){return Jt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t(Fe.loginSuccess(a));case 1:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),oj=function(e,t,a){var n=function(t){Y()?e(Fe.loginFailure(t.error)):e(a?Fe.loginFailure(t.error):Fe.logoutSuccess())};rj.prepare().then((function(r){r===W.CONTINUE?rj.perform({dispatch:e,state:t,data:a}).then((function(t){return ij(e,t.session)}),(function(e){return n(e)})):n({status:W.FAILURE,error:"Preparation for login failed, try again."})}))},sj={authenticate:function(e,t){return function(a,n){a(Fe.loginRequest()),oj(a,n(),{username:e,password:t})}},checkCredentials:function(){return function(e,t){var a=t();e(Fe.loginRequest()),!function(e){return!e||!e.session||TE()(e.session.expiresOn).diff(TE()())>0}(a.authentication)?ij(e,a.authentication.session):oj(e,a)}},extendSession:function(e){return function(t){t(Fe.loginExtend(e))}},logout:function(){return function(){var e=Object(Zt.a)(Jt.a.mark((function e(t){return Jt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Za();case 3:204===e.sent.status&&t(Fe.logoutSuccess()),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),_n("Logout failed",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()}},lj=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).timeLeft=function(){var e=TE()(n.props.session.expiresOn);return e<=TE()()&&n.props.logout(),e.diff(TE()())},n.checkSession=function(){n.timeLeft()<fe.session.timeOutforWarningUser&&n.setState({showSessionTimeOut:!0})},n.handleLogout=function(){Q.logoutEndpoint?Za().then((function(e){document.getElementById("openshiftlogout").submit()})).catch((function(e){var t=e.response&&e.response.data.error?e.response.data.error:e.message;console.error('Logout failed. "kiali-token" cookie may need to be cleared manually: '.concat(t)),document.getElementById("openshiftlogout").submit()})):n.props.logout()},n.extendSession=function(e){n.props.extendSession(e),n.setState({showSessionTimeOut:!1})},n.onDropdownToggle=function(e){n.setState({isDropdownOpen:e})},n.onDropdownSelect=function(e){n.setState({isDropdownOpen:!n.state.isDropdownOpen})},n.dismissHandler=function(){n.setState({isSessionTimeoutDismissed:!0})},n.state={showSessionTimeOut:!1,timeCountDownSeconds:n.timeLeft()/1e3,isSessionTimeoutDismissed:!1,isDropdownOpen:!1},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=setInterval((function(){e.checkSession()}),3e3),a=setInterval((function(){e.setState({timeCountDownSeconds:e.timeLeft()/1e3})}),1e3);this.setState({checkSessionTimerId:t,timeLeftTimerId:a})}},{key:"componentWillUnmount",value:function(){this.state.checkSessionTimerId&&clearInterval(this.state.checkSessionTimerId),this.state.timeLeftTimerId&&clearInterval(this.state.timeLeftTimerId)}},{key:"render",value:function(){var e=this.state.isDropdownOpen,t=Q.strategy!==B.anonymous&&Q.strategy!==B.header,a=r.createElement(up.a,{key:"user_logout_option",onClick:this.handleLogout,isDisabled:!t},"Logout");return r.createElement(r.Fragment,null,r.createElement($N,{onLogout:this.props.logout,onExtendSession:this.extendSession,onDismiss:this.dismissHandler,show:this.state.showSessionTimeOut&&!this.state.isSessionTimeoutDismissed,timeOutCountDown:this.state.timeCountDownSeconds}),this.props.session&&!t&&r.createElement(r.Fragment,null,this.props.session.username),this.props.session&&t&&r.createElement(Ru.a,{isPlain:!0,position:"right",onSelect:this.onDropdownSelect,isOpen:e,toggle:r.createElement(ku.a,{id:"user-dropdown-toggle",onToggle:this.onDropdownToggle},this.props.session.username),dropdownItems:[a]}),Q.strategy===B.openshift&&Q.logoutEndpoint&&r.createElement("form",{id:"openshiftlogout",action:Q.logoutEndpoint,method:"post"},r.createElement("input",{type:"hidden",name:"then",value:Q.logoutRedirect})))}}]),a}(r.Component),cj=Object(h.b)((function(e){return{session:e.authentication.session}}),(function(e){return{logout:function(){return e(sj.logout())},extendSession:function(t){return e(sj.extendSession(t))}}}))(lj),uj=a(1529),pj=a(1552),dj=a(1530);!function(e){e.KIALI_CORE_COMMIT_HASH="Kiali core commit hash",e.KIALI_CORE_VERSION="Kiali core version",e.KIALI_CONSOLE_VERSION="Kiali console version",e.KIALI_CONTAINER_VERSION="Kiali container version",e.KIALI_STATE="Kiali state"}(MN||(MN={}));var mj,hj=Object(Jn.a)({marginRight:"10px"}),fj=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).open=function(){n.setState({showModal:!0})},n.close=function(){n.setState({showModal:!1})},n.renderComponent=function(e){var t=e.version?e.name:"".concat(e.name," URL"),a=n.additionalComponentInfoContent(e);return r.createElement(r.Fragment,{key:t+a},r.createElement(uj.a,{component:"dt"},t),r.createElement(uj.a,{component:"dd"},a))},n.additionalComponentInfoContent=function(e){if(!e.version&&!e.url)return"N/A";var t=e.version?e.version:"",a=e.url?r.createElement("a",{href:e.url,target:"_blank",rel:"noopener noreferrer"},e.url):"";return r.createElement(r.Fragment,null,t," ",a)},n.renderWebsiteLink=function(){return fe.about&&fe.about.website?r.createElement(vr.a,{component:"a",href:fe.about.website.url,variant:"link",target:"_blank"},r.createElement(fi.Website,{className:hj}),fe.about.website.linkText):null},n.renderProjectLink=function(){return fe.about&&fe.about.project?r.createElement(vr.a,{component:"a",href:fe.about.project.url,variant:"link",target:"_blank"},r.createElement(fi.Repository,{className:hj}),fe.about.project.linkText):null},n.state={showModal:!1},n}return Object(l.a)(a,[{key:"render",value:function(){var e="".concat("1.39.0"," (").concat("8472ae9bffc67f697342f368f1a722f2d52f323c",")"),t=""===this.props.status[MN.KIALI_CORE_COMMIT_HASH]||"unknown"===this.props.status[MN.KIALI_CORE_COMMIT_HASH]?this.props.status[MN.KIALI_CORE_VERSION]:"".concat(this.props.status[MN.KIALI_CORE_VERSION]," (").concat(this.props.status[MN.KIALI_CORE_COMMIT_HASH],")"),a=this.props.status[MN.KIALI_CONTAINER_VERSION];return r.createElement(pj.a,{isOpen:this.state.showModal,onClose:this.close,productName:"",brandImageSrc:Ce.a,brandImageAlt:"Kiali Logo"},r.createElement(Yk.a,null,r.createElement(dj.a,{component:"dl"},r.createElement(uj.a,{key:"kiali-ui-name",component:"dt"},"Kiali UI"),r.createElement(uj.a,{key:"kiali-ui-version",component:"dd"},e),r.createElement(uj.a,{key:"kiali-name",component:"dt"},"Kiali Server"),r.createElement(uj.a,{key:"kiali-version",component:"dd"},t),r.createElement(uj.a,{key:"kiali-container-name",component:"dt"},"Kiali Container"),r.createElement(uj.a,{key:"kiali-container-version",component:"dd"},a)),r.createElement(Eo.a,{size:"xl",style:{padding:"20px 0px 20px"}},"Components"),r.createElement(dj.a,{component:"dl"},this.props.components&&this.props.components.map(this.renderComponent)),this.renderWebsiteLink(),this.renderProjectLink()))}}]),a}(r.Component),gj=a(605),vj=a.n(gj),Ej=a(1531);!function(e){e[e.NOT_COPIED=0]="NOT_COPIED",e[e.COPIED=1]="COPIED",e[e.OLD_COPY=2]="OLD_COPY"}(mj||(mj={}));var bj=Object(Jn.a)({width:"100%",height:"200px",minHeight:"200px",resize:"vertical"}),yj={message:"We failed to automatically copy the text, please use: #{key}, Enter\t"},Cj=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).textareaRef=void 0,n.open=function(){n.setState({show:!0,copyStatus:mj.NOT_COPIED})},n.close=function(){n.setState({show:!1})},n.copyCallback=function(e,t){n.textareaRef.current.select(),n.setState({copyStatus:t?mj.COPIED:mj.NOT_COPIED})},n.hideAlert=function(){n.setState({copyStatus:mj.NOT_COPIED})},n.renderHealthConfig=function(e){if(Array.isArray(e)){var t,a=[],r=Object($t.a)(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;a.push(n.renderHealthConfig(i))}}catch(d){r.e(d)}finally{r.f()}return a}for(var o={},s=0,l=Object.entries(e);s<l.length;s++){var c=Object(T.a)(l[s],2),u=c[0],p=c[1];p.constructor.toString().includes("RegExp")?o[u]=p.toString():o[u]="object"!==typeof p?p:n.renderHealthConfig(p)}return o},n.textareaRef=r.createRef(),n.state={show:!1,copyStatus:mj.NOT_COPIED},n}return Object(l.a)(a,[{key:"componentDidUpdate",value:function(e,t){this.props.appState!==e.appState&&this.state.copyStatus===mj.COPIED&&this.setState({copyStatus:mj.OLD_COPY})}},{key:"render",value:function(){var e=this,t=function(t,a){return["cyRef","summaryTarget","token","username"].includes(t)?null:"healthConfig"===t?e.renderHealthConfig(a):a},a=vj()({healthConfig:j.healthConfig},t,2),n=A.a.memoize((function(){var a={backendConfigs:{authenticationConfig:Q,computedServerConfig:j},currentURL:window.location.href,reduxState:e.props.appState};return vj()(a,t,2)}));return this.state.show?r.createElement(ih.a,{isSmall:!0,isOpen:this.state.show,onClose:this.close,title:"Debug information",actions:[r.createElement(vr.a,{onClick:this.close},"Close"),r.createElement(Yy.CopyToClipboard,{onCopy:this.copyCallback,text:n(),options:yj},r.createElement(vr.a,{variant:vr.b.primary},"Copy"))]},this.state.copyStatus===mj.COPIED&&r.createElement($x.a,{style:{marginBottom:"20px"},title:"Debug information has been copied to your clipboard.",variant:$x.b.success,isInline:!0,action:r.createElement(Ej.a,{onClose:this.hideAlert})}),this.state.copyStatus===mj.OLD_COPY&&r.createElement($x.a,{style:{marginBottom:"20px"},title:"Debug information was copied to your clipboard, but is outdated now. It could be caused by new data received by auto refresh timers.",variant:$x.b.warning,isInline:!0,action:r.createElement(Ej.a,{onClose:this.hideAlert})}),r.createElement("span",null,"Health Config"),r.createElement("textarea",{className:bj,readOnly:!0,value:a}),r.createElement("span",null,"Please include this information when opening a bug."),r.createElement(Yy.CopyToClipboard,{onCopy:this.copyCallback,text:n(),options:yj},r.createElement("textarea",{ref:this.textareaRef,className:bj,readOnly:!0,value:n()}))):null}}]),a}(r.PureComponent),Sj=Object(h.b)((function(e){return{appState:e}}),null,null,{forwardRef:!0})(Cj),Aj=a(1532),Tj=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).about=void 0,n.debugInformation=void 0,n.openAbout=function(){n.about.current.open()},n.openDebugInformation=function(){n.debugInformation.current.open()},n.onDropdownToggle=function(e){n.setState({isDropdownOpen:e})},n.onDropdownSelect=function(){n.setState({isDropdownOpen:!n.state.isDropdownOpen})},n.state={isDropdownOpen:!1},n.about=r.createRef(),n.debugInformation=r.createRef(),n}return Object(l.a)(a,[{key:"buildDocumentationLink",value:function(){var e=new URL(fe.documentation.url),t=this.props.status[MN.KIALI_CORE_VERSION]||"unknown";return e.searchParams.append("utm_source","kiali"),e.searchParams.append("utm_medium","app"),e.searchParams.append("utm_campaign",t),e.searchParams.append("utm_content","?-menu"),e.toString()}},{key:"render",value:function(){var e=this.state.isDropdownOpen,t=r.createElement(ku.a,{onToggle:this.onDropdownToggle,iconComponent:null,style:{marginTop:3}},r.createElement(Aj.a,null)),a=[r.createElement(up.a,{component:"a",key:"view_documentation",href:this.buildDocumentationLink(),target:"_blank"},"Documentation"),r.createElement(up.a,{component:"span",key:"view_debug_info",onClick:this.openDebugInformation},"View Debug Info"),r.createElement(up.a,{component:"span",key:"view_about_info",onClick:this.openAbout},"About")];return r.createElement(r.Fragment,null,r.createElement(fj,{ref:this.about,status:this.props.status,components:this.props.components}),r.createElement(Sj,{ref:this.debugInformation}),r.createElement(Ru.a,{isPlain:!0,position:"right",onSelect:this.onDropdownSelect,isOpen:e,toggle:t,dropdownItems:a}))}}]),a}(r.Component),Oj=Object(h.b)((function(e){return{status:e.statusState.status,components:e.statusState.components,warningMessages:e.statusState.warningMessages}}))(Tj),Ij={toggleMessageCenter:function(){return function(e,t){return t().messageCenter.hidden?(e(je.showMessageCenter()),e(je.expandGroup("default"))):e(je.hideMessageCenter()),Promise.resolve()}},toggleSystemErrorsCenter:function(){return function(e,t){return t().messageCenter.hidden?(e(je.showMessageCenter()),e(je.expandGroup("systemErrors"))):e(je.hideMessageCenter()),Promise.resolve()}},markGroupAsRead:function(e){return function(t,a){var n=a().messageCenter.groups.find((function(t){return t.id===e}));return n&&t(je.markAsRead(n.messages.map((function(e){return e.id})))),Promise.resolve()}},clearGroup:function(e){return function(t,a){var n=a().messageCenter.groups.find((function(t){return t.id===e}));return n&&t(je.removeMessage(n.messages.map((function(e){return e.id})))),Promise.resolve()}}},wj=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).renderSystemErrorBadge=function(){return 0===e.props.systemErrorsCount?null:r.createElement(vr.a,{id:"icon_warning","aria-label":"SystemError",onClick:e.props.toggleSystemErrorsCenter,variant:vr.b.plain},r.createElement(fi.Warning,null),e.props.systemErrorsCount,1===e.props.systemErrorsCount?" Open Issue":" Open Issues")},e.renderMessageCenterBadge=function(){var t=Object(Jn.a)({position:"relative",right:"5px",top:"2px"});return r.createElement(vr.a,{id:"bell_icon_warning","aria-label":"Notifications",onClick:e.props.toggleMessageCenter,variant:vr.b.plain},r.createElement(fi.Bell,{className:t}),e.props.newMessagesCount>0&&r.createElement(co.a,{className:"pf-badge-bordered"+(e.props.badgeDanger?" badge-danger":"")},e.props.newMessagesCount>0?e.props.newMessagesCount:" "))},e}return Object(l.a)(a,[{key:"render",value:function(){return r.createElement(r.Fragment,null,this.renderSystemErrorBadge(),this.renderMessageCenterBadge())}}]),a}(r.PureComponent),Rj=Object(h.b)((function(e){var t=[Te.ERROR,Te.WARNING],a=0,n=e.messageCenter.groups.find((function(e){return"systemErrors"===e.id}));return n&&(a=n.messages.length),e.messageCenter.groups.reduce((function(e,t){return e.concat(t.messages.reduce((function(e,t){return t.seen||e.push(t),e}),[]))}),[]).reduce((function(e,a){return e.newMessagesCount++,e.badgeDanger=e.badgeDanger||t.includes(a.type),e}),{newMessagesCount:0,systemErrorsCount:a,badgeDanger:!1})}),(function(e){return{toggleMessageCenter:function(){return e(Ij.toggleMessageCenter())},toggleSystemErrorsCenter:function(){return e(Ij.toggleSystemErrorsCenter())}}}))(wj),kj=Object(Jn.a)({position:"absolute",left:210,top:28}),xj=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e;return r.createElement(dr.a,null,r.createElement(ir.a,{className:kj},r.createElement(ZN,null)),r.createElement(ir.a,null,!!(null===(e=j.clusterInfo)||void 0===e?void 0:e.name)&&r.createElement(or.a,null,r.createElement("div",{style:{paddingRight:"1em"}},r.createElement(lo.a,{entryDelay:0,position:"bottom",content:r.createElement("div",null,"Kiali home cluster: ",j.clusterInfo.name)},r.createElement(Ph.a,null,r.createElement(LN.a,null)," ",j.clusterInfo.name)))),r.createElement(or.a,null,r.createElement(XN,null)),r.createElement(or.a,null,r.createElement(_N,null)),r.createElement(or.a,null,r.createElement(Rj,null)),r.createElement(or.a,null,r.createElement(Oj,null)),r.createElement(or.a,null,r.createElement(cj,null))))}}]),a}(r.Component),Nj=a(1534),jj=a(319),Pj=a(1564),Lj=a(1535),Dj=function(e){var t=e.href,a=e.name;return r.createElement(Nj.a,{isActive:!1,key:a,className:"external_link"},r.createElement("a",{className:"pf-c-nav__link",href:t,target:"_blank",rel:"noopener noreferrer"},a," ",r.createElement(Jf.a,{style:{margin:"-4px 0 0 5px"}})))},Fj=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).renderMenuItems=function(){var e=n.props.location,t=IN.concat(wN),a=t.find((function(t){var a=!!Object(f.g)(e.pathname,{path:t.to,exact:!0,strict:!1});return!a&&t.pathsActive&&(a=A.a.filter(t.pathsActive,(function(t){return t.test(e.pathname)})).length>0),a}));return t.filter((function(e){return"Iter8 Experiments"===e.title?j.extensions.iter8.enabled:"Mesh"!==e.title||void 0!==(null===(t=j.clusterInfo)||void 0===t?void 0:t.name);var t})).map((function(e){return"Distributed Tracing"===e.title?n.props.jaegerUrl&&r.createElement(Dj,{key:e.to,href:n.props.jaegerUrl,name:"Distributed Tracing"}):r.createElement(Nj.a,{isActive:a===e,key:e.to},r.createElement(ar.a,{id:e.title,to:e.to,onClick:function(){return U.push(e.to)}},e.title))}))},n.state={activeItem:"Overview"},n}return Object(l.a)(a,[{key:"componentDidUpdate",value:function(e){e.isNavOpen!==this.props.isNavOpen&&setTimeout((function(){window.dispatchEvent(new Event("resize"))}),200)}},{key:"render",value:function(){var e=this.props.isNavOpen,t=r.createElement(jj.a,{onSelect:function(){},onToggle:function(){},"aria-label":"Nav",theme:"dark"},r.createElement(Pj.a,null,this.renderMenuItems()));return r.createElement(Lj.a,{isNavOpen:e,nav:t,theme:"dark"})}}]),a}(r.Component);Fj.contextTypes={router:function(){return null}};var _j=Fj,Mj=a(1542),Hj=a(1543),Gj=a(379),Vj=a(1544),Uj=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).ttlTimer=void 0,e.getAction=function(){return e.props.onClose?r.createElement(Ej.a,{onClose:e.props.onClose}):r.createElement(r.Fragment,null)},e}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.props.onTtl&&(this.ttlTimer=setInterval((function(){e.props.onTtl()}),this.props.ttlms?this.props.ttlms:8e3))}},{key:"componentWillUnmount",value:function(){this.ttlTimer&&clearInterval(this.ttlTimer)}},{key:"render",value:function(){return r.createElement($x.a,{style:this.props.style?this.props.style:{},key:this.props.message.id,variant:this.props.variant,title:this.props.message.content,action:this.getAction()})}}]),a}(r.Component),Bj=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=this;return r.createElement(r.Fragment,null,this.props.messages.map((function(t,a){var n;switch(t.type){case Te.SUCCESS:n=$x.b.success;break;case Te.WARNING:n=$x.b.warning;break;default:n=$x.b.danger}var i=e.props.onDismiss?function(){e.props.onDismiss(t,!0)}:void 0;return r.createElement(Uj,{key:"toast_"+t.id,style:{width:"30em",right:"0",top:"".concat(5*a,"em"),position:"absolute"},message:t,variant:n,title:t.content,onClose:i,onTtl:i})})))}}]),a}(r.PureComponent),Wj=a(1538),qj=a(1539),Kj=a(1540),zj=a(1541),Yj=a(1536),Qj=a(1537),Xj=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=this;return r.createElement(Ef.a,null,r.createElement(yf.a,{className:a.body},function(e){switch(e){case Te.ERROR:return r.createElement(fi.Error,null);case Te.INFO:return r.createElement(fi.Info,null);case Te.SUCCESS:return r.createElement(fi.Ok,null);case Te.WARNING:return r.createElement(fi.Warning,null);default:throw Error("Unexpected type")}}(this.props.message.type)," ",this.props.message.seen?this.props.message.content:r.createElement("b",null,this.props.message.content),this.props.message.detail&&r.createElement(Nw.a,{toggleText:this.props.message.showDetail?"Hide Detail":"Show Detail",onToggle:function(){return e.props.toggleMessageDetail(e.props.message)},isExpanded:this.props.message.showDetail},r.createElement("pre",{style:{whiteSpace:"pre-wrap"}},this.props.message.detail)),this.props.message.count>1&&r.createElement("div",null,this.props.message.count," ",TE()().from(this.props.message.firstTriggered)),r.createElement("div",null,r.createElement("span",{className:a.left},this.props.message.created.toLocaleDateString()),r.createElement("span",{className:a.right},this.props.message.created.toLocaleTimeString()))))}}]),a}(r.PureComponent);Xj.body=Object(Jn.a)({paddingTop:0}),Xj.left=Object(Jn.a)({float:"left"}),Xj.right=Object(Jn.a)({float:"right"});var Jj=Object(h.b)(null,(function(e){return{markAsRead:function(t){return e(je.markAsRead(t.id))},toggleMessageDetail:function(t){return e(je.toggleMessageDetail(t.id))}}}))(Xj),Zj=r.createElement(r.Fragment,null,r.createElement(Yj.a,null),"No Messages Available"),$j=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).getMessages=function(){return e.props.reverseMessageOrder?Object(mt.a)(e.props.group.messages).reverse():e.props.group.messages},e}return Object(l.a)(a,[{key:"render",value:function(){var e=this,t=this.props.group;return r.createElement(Ef.a,null,r.createElement(yf.a,{className:a.body,style:{paddingTop:0}},0===t.messages.length&&Zj,this.getMessages().map((function(e){return r.createElement(Jj,{key:e.id,message:e})}))),t.showActions&&t.messages.length>0&&r.createElement(Qj.a,{className:a.footer},r.createElement(vr.a,{className:a.left,variant:"link",onClick:function(){return e.props.markGroupAsRead(t)}},"Mark All Read"),r.createElement(vr.a,{className:a.right,variant:"link",onClick:function(){return e.props.clearGroup(t)}},"Clear All")))}}]),a}(r.PureComponent);$j.body=Object(Jn.a)({padding:0}),$j.footer=Object(Jn.a)({paddingBottom:5,paddingTop:5}),$j.left=Object(Jn.a)({float:"left"}),$j.right=Object(Jn.a)({float:"right"});var eP=Object(h.b)(null,(function(e){return{clearGroup:function(t){return e(Ij.clearGroup(t.id))},markGroupAsRead:function(t){return e(Ij.markGroupAsRead(t.id))}}}))($j),tP=function(e){return e.reduce((function(e,t){return t.seen?e:e+1}),0)},aP=r.createElement(r.Fragment,null,r.createElement(Yj.a,null),"No Messages Available"),nP=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){var e=this,t=Object(Jn.a)({position:"absolute",right:"0",width:this.props.isExpanded?"80%":"30em"});return!this.props.isHidden&&r.createElement(Ef.a,{className:t,hidden:this.props.isHidden},r.createElement(Uf.a,{className:a.head},r.createElement(Bf.a,null,this.props.isExpanded?r.createElement(vr.a,{id:"alert_drawer_collapse",variant:"plain",onClick:this.props.expandDrawer},r.createElement(fi.AngleDoubleRight,null)):r.createElement(vr.a,{id:"alert_drawer_expand",variant:"plain",onClick:this.props.expandDrawer},r.createElement(fi.AngleDoubleLeft,null)),r.createElement(vr.a,{id:"alert_drawer_close",variant:"plain",onClick:this.props.hideDrawer},r.createElement(Lr.a,null))),r.createElement(bf.a,null,this.props.title)),r.createElement(yf.a,{className:a.body},0===this.props.groups.length?aP:r.createElement(ju,{className:a.wrapper,maxHeight:{type:Oc.VIEWPORT_HEIGHT_MINUS_TOP,margin:a.wrapperMarginBottom}},r.createElement(Wj.a,{className:a.groups},this.props.groups.map((function(t){return function(e){return e.hideIfEmpty&&0===e.messages.length}(t)?null:r.createElement(qj.a,{key:t.id+"_item"},r.createElement(Kj.a,{id:t.id+"_toggle",isExpanded:t.id===e.props.expandedGroupId,onClick:function(){e.props.toggleGroup(t)}},t.title," ",(a=t.messages,1===tP(a)?"1 Unread Message":"".concat(tP(a)," Unread Messages"))),r.createElement(zj.a,{id:t.id+"_content",isHidden:t.id!==e.props.expandedGroupId},r.createElement(eP,{key:t.id,group:t})));var a}))))))}}]),a}(r.PureComponent);nP.head=Object(Jn.a)({paddingBottom:0}),nP.body=Object(Jn.a)({paddingLeft:0,paddingRight:0}),nP.wrapper=Object(Jn.a)({overflow:"auto"}),nP.wrapperMarginBottom=10,nP.groups=Object(Jn.a)({paddingTop:0,paddingBottom:0});var rP=Object(h.b)((function(e){return{expandedGroupId:e.messageCenter.expandedGroupId,groups:e.messageCenter.groups,isExpanded:e.messageCenter.expanded,isHidden:e.messageCenter.hidden}}),(function(e){return{expandDrawer:function(){return e(je.toggleExpandedMessageCenter())},hideDrawer:function(){return e(je.hideMessageCenter())},toggleGroup:function(t){return e(je.toggleGroup(t.id))}}}))(nP),iP=Object(Jn.a)({position:"relative",zIndex:500}),oP=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).getNotificationMessages=function(e){return e.reduce((function(e,t){return e.concat(t.messages.filter((function(e){return e.show_notification})).map((function(e){return Object(C.a)(Object(C.a)({},e),{},{groupId:t.id})})))}),[])},e}return Object(l.a)(a,[{key:"render",value:function(){return r.createElement("div",{className:iP},r.createElement(rP,{title:this.props.drawerTitle}),r.createElement(Bj,{messages:this.getNotificationMessages(this.props.groups),onDismiss:this.props.onDismissNotification}))}}]),a}(r.Component),sP=Object(h.b)((function(e){return{groups:e.messageCenter.groups}}),(function(e){return{onDismissNotification:function(t,a){e(a?je.markAsRead(t.id):je.hideNotification(t.id))}}}))(oP),lP={setNavCollapsed:function(e){return function(t){return t(vt.navCollapse(e))}}},cP=Object(Jn.a)({display:"flex",flexDirection:"column"}),uP=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).setControlledState=function(e){"navCollapsed"in e&&n.props.setNavCollapsed(n.props.navCollapsed)},n.isGraph=function(){return n.props.location.pathname.startsWith("/graph")},n.onNavToggleDesktop=function(){n.setState({isNavOpenDesktop:!n.state.isNavOpenDesktop}),n.props.setNavCollapsed(!n.props.navCollapsed)},n.onNavToggleMobile=function(){n.setState({isNavOpenMobile:!n.state.isNavOpenMobile})},n.onPageResize=function(e){var t=e.mobileView;e.windowSize<1e3&&(t=!0),n.setState({isMobileView:t})},n.state={isMobileView:!1,isNavOpenDesktop:!0,isNavOpenMobile:!1},n}return Object(l.a)(a,[{key:"goTojaeger",value:function(){window.open(this.props.jaegerUrl,"_blank")}},{key:"componentDidMount",value:function(){var e,t=j.installationTag?j.installationTag:"Kiali";(null===(e=j.clusterInfo)||void 0===e?void 0:e.name)&&(t+=" [".concat(j.clusterInfo.name,"]")),document.title=t}},{key:"render",value:function(){var e=this.state,t=e.isNavOpenDesktop,a=e.isNavOpenMobile,n=e.isMobileView,i=r.createElement(Mj.a,{logo:r.createElement(Hj.a,{src:Ce.a,alt:"Kiali Logo"}),toolbar:r.createElement(xj,null),showNavToggle:!0,onNavToggle:n?this.onNavToggleMobile:this.onNavToggleDesktop,isNavOpen:n?a:t||!this.props.navCollapsed,role:"kiali_header"}),o=r.createElement(_j,{isNavOpen:n?a:t||!this.props.navCollapsed,location:this.props.location,jaegerUrl:this.props.jaegerUrl});return r.createElement(Gj.a,{header:i,sidebar:o,onPageResize:this.onPageResize},r.createElement(sP,{drawerTitle:"Message Center"}),r.createElement(Vj.a,{className:cP,variant:"light"},r.createElement(PN,{isGraph:this.isGraph()})))}}]),a}(r.Component);uP.contextTypes={router:function(){return null}};var pP,dP=Object(h.b)((function(e){return{navCollapsed:e.userSettings.interface.navCollapse,jaegerUrl:e.jaegerState.info&&e.jaegerState.info.url?e.jaegerState.info.url:void 0}}),(function(e){return{setNavCollapsed:function(t){return e(lP.setNavCollapsed(t))}}}))(uP),mP=a(851),hP=a.n(mP),fP=Object(Jn.a)({$nest:{"& > textarea":{display:"none"},"& > p:last-of-type":{marginTop:"3em"}}}),gP=Object(Jn.a)({$nest:{"& > p:last-of-type":{display:"none"},"& > textarea":{width:"100%",whiteSpace:"pre",marginTop:"3em"}}}),vP=Object(Jn.a)({position:"relative",top:"10em",textAlign:"center",$nest:{"& > img":{marginBottom:"3em"},"& > div":{width:"40em",marginLeft:"auto",marginRight:"auto",textAlign:"left"}}}),EP=function(e){var t=r.createRef();return document.documentElement&&(document.documentElement.className=Ab()?"kiosk":""),r.createElement("div",{className:vP},r.createElement("img",{alt:"Kiali Logo",src:hP.a,width:"200"}),e.errorMsg?r.createElement("div",{ref:t,className:fP},r.createElement($x.a,{variant:"danger",title:e.errorMsg}),e.errorDetails?r.createElement(r.Fragment,null,r.createElement("p",null,r.createElement(vr.a,{variant:"link",onClick:function(e){e.preventDefault(),t.current&&t.current.setAttribute("class",gP)}},"Show details")),r.createElement("textarea",{readOnly:!0,rows:10},e.errorDetails)):null):r.createElement("h1",null,"Loading..."))};!function(e){e[e.LOGIN=0]="LOGIN",e[e.POST_LOGIN=1]="POST_LOGIN",e[e.LOGGED_IN=2]="LOGGED_IN",e[e.LOGGED_IN_AT_LOAD=3]="LOGGED_IN_AT_LOAD"}(pP||(pP={}));var bP=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).doPostLoginActions=Object(Zt.a)(Jt.a.mark((function e(){var t,a,r;return Jt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=Xa(K.GET,qa.status,{},{}).then((function(e){return n.props.setServerStatus(e.data)})).catch((function(e){_n("Error fetching server status.",e,"default",Te.WARNING)})),a=Xa(K.GET,qa.jaeger,{},{}).then((function(e){return n.props.setJaegerInfo(e.data)})).catch((function(e){n.props.setJaegerInfo(null),_n("Could not fetch Jaeger info. Turning off Jaeger integration.",e,"default",Te.INFO)})),e.next=5,Promise.all([tn(),Xa(K.GET,qa.serverConfig,{},{}),t,a]);case 5:r=e.sent,n.props.setNamespaces(r[0].data,new Date),F(r[1].data),n.applyUIDefaults(),n.checkConfiguredRemoteKialis(r[1].data),n.props.landingRoute&&(U.replace(n.props.landingRoute),n.props.setLandingRoute(void 0)),n.setState({stage:pP.LOGGED_IN}),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(0),console.error("Error on post-login actions.",e.t0),n.setState({isPostLoginError:!0});case 18:case"end":return e.stop()}}),e,null,[[0,14]])}))),n.setDocLayout=function(){document.documentElement&&(document.documentElement.className=Ab()?"kiosk":"")},n.state={stage:n.props.authenticated?pP.LOGGED_IN_AT_LOAD:pP.LOGIN,isPostLoginError:!1},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){if(this.state.stage===pP.LOGGED_IN_AT_LOAD)this.doPostLoginActions();else{var e=!1;if(Q.strategy!==B.anonymous&&Q.strategy!==B.header||(e=!0),Y()){e=/[#&](access_token|id_token)=/.test(window.location.hash)}e?(this.props.checkCredentials(),this.setState({stage:pP.LOGGED_IN_AT_LOAD})):this.props.setLandingRoute(U.location.pathname+U.location.search)}this.setDocLayout()}},{key:"componentDidUpdate",value:function(e,t){!e.authenticated&&this.props.authenticated?(this.setState({stage:pP.POST_LOGIN}),this.doPostLoginActions()):e.authenticated&&!this.props.authenticated&&this.setState({stage:pP.LOGIN}),!e.isLoginError&&this.props.isLoginError&&this.setState({stage:pP.LOGIN}),this.setDocLayout()}},{key:"render",value:function(){return this.state.stage===pP.LOGGED_IN?this.props.protectedAreaComponent:this.state.stage===pP.LOGGED_IN_AT_LOAD?this.state.isPostLoginError?r.createElement(EP,{errorMsg:a.PostLoginErrorMsg}):r.createElement(EP,null):this.state.stage===pP.POST_LOGIN?!this.state.isPostLoginError&&Y()?r.createElement(EP,null):this.state.isPostLoginError?this.props.publicAreaComponent(!1,a.PostLoginErrorMsg):this.props.publicAreaComponent(!0):this.props.publicAreaComponent(!1)}},{key:"applyUIDefaults",value:function(){var e=j.kialiFeatureFlags.uiDefaults;if(e){if(e.metricsPerRefresh){for(var t=R(j,"",""),a=0,n=0,r=Object.entries(t);n<r.length;n++){var i=Object(T.a)(r[n],2),o=i[0];if(i[1]===e.metricsPerRefresh){a=Number(o);break}}a>0?(this.props.setDuration(a),console.debug("Setting UI Default: metricsPerRefresh [".concat(e.metricsPerRefresh,"=").concat(a,"s]"))):console.debug("Ignoring invalid UI Default: metricsPerRefresh [".concat(e.metricsPerRefresh,"]"))}var s=-1;if(e.refreshInterval){for(var l=0,c=Object.entries(fe.toolbar.refreshInterval);l<c.length;l++){var u=Object(T.a)(c[l],2),p=u[0];if(u[1].toLowerCase().endsWith(e.refreshInterval.toLowerCase())){s=Number(p);break}}s>=0?(this.props.setRefreshInterval(s),console.debug("Setting UI Default: refreshInterval [".concat(e.refreshInterval,"=").concat(s,"ms]"))):console.debug("Ignoring invalid UI Default: refreshInterval [".concat(e.refreshInterval,"]"))}if(e.namespaces&&e.namespaces.length>0){var d,m=Yt.getState().namespaces.items,h=m?m.map((function(e){return e.name})):[],f=[],g=Object($t.a)(e.namespaces);try{for(g.s();!(d=g.n()).done;){var v=d.value;h.includes(v)?f.push({name:v}):console.debug("Ignoring invalid UI Default: namespace [".concat(v,"]"))}}catch(S){g.e(S)}finally{g.f()}f.length>0&&(this.props.setActiveNamespaces(f),console.debug("Setting UI Default: namespaces ".concat(JSON.stringify(f.map((function(e){return e.name}))))))}var E=function(e){switch(e){case"received":return ze.GRPC_RECEIVED;case"requests":case"request":return ze.GRPC_REQUEST;case"sent":return ze.GRPC_SENT;case"total":return ze.GRPC_TOTAL;default:return}}(e.graph.traffic.grpc),b=function(e){switch(e){case"requests":case"request":return ze.HTTP_REQUEST;default:return}}(e.graph.traffic.http),y=function(e){switch(e){case"received":return ze.TCP_RECEIVED;case"sent":return ze.TCP_SENT;case"total":return ze.TCP_TOTAL;default:return}}(e.graph.traffic.tcp),C=[];E&&C.push(ze.GRPC_GROUP,E),b&&C.push(ze.HTTP_GROUP,b),y&&C.push(ze.TCP_GROUP,y),this.props.setTrafficRates(C)}}},{key:"checkConfiguredRemoteKialis",value:function(e){if(e.clusters){var t=[];for(var a in e.clusters){var n,r;if(a!==(null===(n=e.clusterInfo)||void 0===n?void 0:n.name))if(e.clusters.hasOwnProperty(a))(null===(r=e.clusters[a].kialiInstances)||void 0===r?void 0:r.find((function(e){return 0!==e.url.length})))||t.push(a)}t.length>0&&Vn("Not all remote clusters have reachable Kiali instances.",void 0,void 0,"Context menus are disabled for remote cluster nodes if a Kiali instance is not discovered, or if the remote Kiali is not configured with an external URL.")}}}]),a}(r.Component);bP.PostLoginErrorMsg="You are logged in, but there was a problem when fetching some required server configurations. Please, try refreshing the page.";var yP=Object(h.b)((function(e){return{authenticated:e.authentication.status===ke.loggedIn,isLoginError:e.authentication.status===ke.error,landingRoute:e.authentication.landingRoute}}),(function(e){return{checkCredentials:function(){return e(sj.checkCredentials())},setActiveNamespaces:Object(Ie.b)(ht.setActiveNamespaces,e),setDuration:Object(Ie.b)(vt.setDuration,e),setJaegerInfo:Object(Ie.b)(kt.setInfo,e),setLandingRoute:Object(Ie.b)(Fe.setLandingRoute,e),setMeshTlsStatus:Object(Ie.b)(At.setinfo,e),setNamespaces:Object(Ie.b)(ht.receiveList,e),setRefreshInterval:Object(Ie.b)(vt.setRefreshInterval,e),setServerStatus:function(t){return function(e,t){e(Be.statusRefresh(t.status,t.externalServices,t.warningMessages)),t.warningMessages.forEach((function(t){e(je.addMessage(t,"","systemErrors",Te.WARNING))}))}(e,t)},setTrafficRates:Object(Ie.b)(st.setTrafficRates,e)}}))(bP),CP=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).fetchAuthenticationConfig=Object(Zt.a)(Jt.a.mark((function e(){var t,a,r;return Jt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,$a();case 3:t=e.sent,Q.authorizationEndpoint=t.data.authorizationEndpoint,Q.logoutEndpoint=t.data.logoutEndpoint,Q.logoutRedirect=t.data.logoutRedirect,Q.strategy=t.data.strategy,t.data.sessionInfo.expiresOn&&t.data.sessionInfo.username&&n.props.setInitialAuthentication({username:t.data.sessionInfo.username,expiresOn:t.data.sessionInfo.expiresOn}),n.props.onInitializationFinished(),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(0),e.t0.request&&(r=e.t0.request.responseText).trim().length>0&&(a=r),n.setState({errorMsg:On(e.t0),errorDetails:a});case 16:case"end":return e.stop()}}),e,null,[[0,12]])}))),n.state={},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e;this.fetchAuthenticationConfig(),e=document.documentElement,rt={Black100:getComputedStyle(e).getPropertyValue("--pf-global--palette--black-100"),Black200:getComputedStyle(e).getPropertyValue("--pf-global--palette--black-200"),Black400:getComputedStyle(e).getPropertyValue("--pf-global--palette--black-400"),Black500:getComputedStyle(e).getPropertyValue("--pf-global--palette--black-500"),Black600:getComputedStyle(e).getPropertyValue("--pf-global--palette--black-600"),Black1000:getComputedStyle(e).getPropertyValue("--pf-global--palette--black-1000"),Blue50:getComputedStyle(e).getPropertyValue("--pf-global--palette--blue-50"),Blue300:getComputedStyle(e).getPropertyValue("--pf-global--palette--blue-300"),Blue600:getComputedStyle(e).getPropertyValue("--pf-global--palette--blue-600"),Gold400:getComputedStyle(e).getPropertyValue("--pf-global--palette--gold-400"),Green400:getComputedStyle(e).getPropertyValue("--pf-global--palette--green-400"),Purple200:getComputedStyle(e).getPropertyValue("--pf-global--palette--purple-200"),White:getComputedStyle(e).getPropertyValue("--pf-global--palette--white"),Danger:getComputedStyle(e).getPropertyValue("--pf-global--danger-color--100"),Success:"#3E8635",Warning:getComputedStyle(e).getPropertyValue("--pf-global--warning-color--100")}}},{key:"render",value:function(){return r.createElement(EP,{errorMsg:this.state.errorMsg,errorDetails:this.state.errorDetails})}}]),a}(r.Component),SP=Object(h.b)(null,(function(e){return{setInitialAuthentication:function(t){return e(Fe.loginSuccess(t))}}}))(CP),AP=a(1545),TP=a(1546),OP=a(1553),IP=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).handlePasswordChange=function(e){n.setState({password:e})},n.handleSubmit=function(e){if(e.preventDefault(),Y())window.location.href=Q.authorizationEndpoint;else if(Q.strategy===B.header)window.location.href=window.WEB_ROOT?window.WEB_ROOT:"/";else if(Q.strategy===B.token)if(0!==n.state.password.trim().length&&n.props.authenticate)n.props.authenticate("",n.state.password),n.setState({showHelperText:!1,errorInput:"",isValidToken:!0,filledInputs:!0});else{n.setState({showHelperText:!0,errorInput:"Please, provide a Service Account token.",isValidToken:!1,filledInputs:!1})}},n.renderMessage=function(e,t,a){if(!e)return"";var r=t||(n.props.status===ke.error||n.state.filledInputs?"danger":"warning"),o="danger"===r?i.a.createElement(ea.a,null):i.a.createElement(ta.a,null);return i.a.createElement("span",{key:a,style:{color:"danger"===r?"#c00":"#f0ab00",fontWeight:"bold",fontSize:16}},o,"\xa0 ",e)},n.getHelperMessage=function(){var e=[];n.state.showHelperText&&e.push(n.renderMessage(n.state.errorInput,void 0,"helperText")),n.props.status===ke.expired&&e.push(n.renderMessage("Your session has expired or was terminated in another window.","warning","sessionExpired")),n.props.status===ke.error&&e.push(n.props.message),n.props.postLoginErrorMsg&&e.push(n.renderMessage(n.props.postLoginErrorMsg,void 0,"postLoginError"));var t=window.location.search,a=new URLSearchParams(t);return a.get("error")&&(a.get("error_description")?e.push(n.renderMessage("Authentication error: ".concat(a.get("error_description")),"danger","idp-err")):e.push(n.renderMessage("The OpenID provider returned the following error code: ".concat(a.get("error")),"danger","idp-err"))),a.get("openid_error")&&e.push(n.renderMessage("Authentication failed: ".concat(a.get("openid_error")),"danger","openid-err")),e},n.state={username:"",password:"",isValidUsername:!0,isValidPassword:!0,isValidToken:!0,filledInputs:!1,showHelperText:!1,errorInput:""},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=document.getElementById("pf-login-username-id");e&&e.focus()}},{key:"render",value:function(){var e="Log In";Q.strategy===B.openshift?e="Log In With OpenShift":Q.strategy===B.openid&&(e="Log In With OpenID");var t,a=this.getHelperMessage(),n=this.props.isPostLoginPerforming||this.props.status===ke.logging||void 0!==this.props.postLoginErrorMsg&&0!==this.props.postLoginErrorMsg.length,r=i.a.createElement(i.a.Fragment,null,i.a.createElement(_x.a,null,i.a.createElement(AP.a,{href:"https://www.kiali.io/"},"Documentation")),i.a.createElement(_x.a,null,i.a.createElement(AP.a,{href:"https://github.com/kiali/kiali"},"Contribute")));return t=Q.strategy===B.token?i.a.createElement(dp.a,null,i.a.createElement(TP.a,{isError:!this.state.isValidToken||this.props.status===ke.error,isHidden:!this.state.showHelperText&&""===this.props.message&&0===a.length},a),i.a.createElement(mp.a,{fieldId:"token",label:"Token",isRequired:!0},i.a.createElement(Ae.a,{id:"token",type:"password",onChange:this.handlePasswordChange,isRequired:!0})),i.a.createElement(hp.a,null,i.a.createElement(vr.a,{type:"submit",onClick:this.handleSubmit,isDisabled:n,style:{width:"100%"},variant:"primary"},"Log In"))):i.a.createElement(dp.a,null,i.a.createElement(TP.a,{isError:this.props.status===ke.error,isHidden:this.props.status!==ke.error&&""===this.props.message&&0===a.length},a),i.a.createElement(hp.a,null,i.a.createElement(vr.a,{type:"submit",onClick:this.handleSubmit,style:{width:"100%"},variant:"primary"},e))),i.a.createElement(OP.a,{footerListVariants:Mx.b.inline,brandImgSrc:Ce.a,brandImgAlt:"Kiali logo",footerListItems:r,textContent:"Service mesh management for Istio.",loginTitle:"Log in Kiali"},t)}}]),a}(i.a.Component);IP.contextTypes={store:function(){return null}};var wP=Object(h.b)((function(e){return{status:e.authentication.status,message:e.authentication.message}}),(function(e){return{authenticate:function(t,a){return e(sj.authenticate(t,a))}}}))(IP);a(1327),a(1328),a(1329);g.change((function(e,t){"visible"===t?Yt.dispatch(E.setPageVisibilityVisible()):Yt.dispatch(E.setPageVisibilityHidden())})),g.hidden()?Yt.dispatch(E.setPageVisibilityHidden()):Yt.dispatch(E.setPageVisibilityVisible());var RP=function(){(function(){var e=Yt.getState();return e&&e.globalState.loadingCounter>0})()&&Yt.dispatch(E.decrementLoadingCounter())};d.a.interceptors.request.use((function(e){return Yt.dispatch(E.incrementLoadingCounter()),e}),(function(e){return console.log(e),Promise.reject(e)})),d.a.interceptors.response.use((function(e){return RP(),e}),(function(e){return RP(),401===e.response.status&&Yt.dispatch(Fe.sessionExpired()),Promise.reject(e)}));var kP=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;Object(s.a)(this,a),(n=t.call(this,e)).protectedArea=void 0,n.initializationFinishedHandler=function(){n.setState({isInitialized:!0})},n.state={isInitialized:!1};var i=Object(f.h)(dP);return n.protectedArea=r.createElement(f.d,{history:U},r.createElement(i,null)),n}return Object(l.a)(a,[{key:"render",value:function(){return r.createElement(h.a,{store:Yt},r.createElement(m.PersistGate,{loading:r.createElement(EP,null),persistor:Qt},this.state.isInitialized?r.createElement(yP,{publicAreaComponent:function(e,t){return r.createElement(wP,{isPostLoginPerforming:e,postLoginErrorMsg:t})},protectedAreaComponent:this.protectedArea}):r.createElement(SP,{onInitializationFinished:this.initializationFinishedHandler})))}}]),a}(r.Component);a(1330);o.render(r.createElement(kP,null),document.getElementById("root"))},396:function(e,t,a){},414:function(e,t,a){},434:function(e,t,a){e.exports=a.p+"static/media/mtls-status-full.ea15b9d8.svg"},435:function(e,t,a){e.exports=a.p+"static/media/mtls-status-partial.68b7350f.svg"},436:function(e,t,a){e.exports=a.p+"static/media/mtls-status-full-dark.376ee97a.svg"},437:function(e,t,a){e.exports=a.p+"static/media/mtls-status-partial-dark.9e0f1723.svg"},634:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAngAAAOTCAMAAAAbvY79AAAAM1BMVEVMaXE2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjbqSzSUAAAAEHRSTlMAEJBQ8CCwwIDgQGBwoDDQbwPq7gAAAAlwSFlzAAALEgAACxIB0t1+/AAAFwpJREFUeJzt3Qly4koWhlEP2Nh46v2vtqNfV70q+zKkpJuSMvOcDTgi+QPQJ8B3N90/PhwP/4FCh+PD4+1Z3XL6cN5M93G6MazrHl+dOfMc50/v6ejMme/4FCZV5M07OxY5vM3ZnTd3LPYRZmV3rGHy8uyOFBOXZ3ckeQjjuuLNqZNlQk1+cj1LmsN9GNgl+h2Jni/MLDg5dTKV3sPwhEeqY5jYWZ9OnVxl986kFJKVJRWXtCR7DSM7w6UF6T7jzoIXx0629zCz6Nmpk63kjq2YQrqSoOLUSXcIM4ucOvnCzCKnTr4ws8ipky/MLHLq5Aszi5w6+cLMIqdOvjCzyKmTL8wscurkCzOLnDr5wswip06+MLPIqZMvzCxy6uQLM4ucOvnCzCKnTr4ws8ipky/MLHLq5Aszi5w6+cLMIqdOvjCzyKmTL8wscurkCzOLnDr5wswip06+MLPIqZMvzCxy6uQLM4ucOvnCzCKnTr4ws8ipky/MLHLq5Aszi5w6+cLMIqdOvjCzyKmTL8wscurkCzOLnDr5wswip06+MLPIqZMvzCxy6uQLM4ucOvnCzCKnTr4ws8ipky/MLHLq5Aszi5w6+cLMIqdOvjCzyKmTL8wscurkCzOLnDr5wswip06+MLPIqZMvzCxy6uQLM4ucOvnCzCKnTr4ws8ipky/MLHLq5Aszi5w6+cLMIqdOvjCzyKmTL8wscurkCzOLnDr5wswip06+MLPIqZMvzCxy6uQLM4ucOvnCzCKnTr4ws8ipky/MLHLq5Aszi5w6+cLMIqdOvjCzyKmTL8wscurkCzOLnDr5wswip06+MLPIqZMvzCxy6uQLM4ucOvnCzCKnTr4ws8ipky/MLHLq5Aszi5w6+cLMIqdOvjCzyKmTL8wscurkCzOLnDr5wswip06+MLPIqZMvzCxy6uQLM4ucOvnCzCKnTr4ws8ipky/MLHLq5Aszi5w6+cLMIqdOvjCzyKmTL8wscurkCzOLnDr5wswip06+MLPIqZMvzCxy6uQLM4ucOvnCzCKnTr4ws8ipky/MLHLq5Aszi5w6+cLMIqdOvjCzyKmTL8wscurkCzOLnDr5wswip06+MLPIqZMvzCxy6uQLM4ucOvnCzCKnTr4ws8ipky/MLHLq5Aszi5w6+cLMIqdOvjCzyKmTL8wscurkCzOLnDr5wswip06+MLPIqZMvzCxy6uQLM4ucOvnCzCKnTr4ws8ipky/MLHLq5Aszi5w6+cLMIqdOvjCzyKmTL8wscurkCzOLnDr5wswip06+MLPIqZMvzCxy6qQ7hJlFR8dOtmOYWfTs1Mn2EWYWvTh1sr2HmUUnp062zzCzMw6OnVyvcWVnfDh1cj3ElZ3x6dTJ9RRXdo6gQqqSmHLn8oJspzCxCzzlkej5/MrOeHJhS5rDfVzYJW+OnSyPF0Z2lqRCkrKU8i/LI0XJXVrLI9vk3VkeCWbs7u7uzbUtixzewqiKPOl5LHAsvFN2xuOrg2eeY/H9irNO3uoxw8ey2f3P/ePD0bs9ih2OD5Oa8R6dTu/eZ87y/H5a/pwzNpc40z3Pf1vPH++tPe5bm1kx+MlnFiaxuzQPDT3sm3vp5EHfg3s9sVjZN7oo421eMS+0mZ4aedR3YMLnfbnta/Q9lfoyplRiXqHSrxJSxvAKuabNZXiFDC+X4RUyvFyGV8jwchleIcPLZXiFDC+X4RUyvFyGV8jwchleIcPLZXiFDC+X4RUyvFyGV8jwchleIcPLZXiFDC+X4RUyvFyGV8jwchleIcPLZXiFDC+X4RUyvFyGV8jwchleIcPLZXiFDC+X4RUyvFyGV8jwchleIcPLZXiFDC+X4RUyvFyGV8jwchleIcPLZXiFDC+X4RUyvFyGV8jwchleIcPLZXiFDC+X4RUyvFyGV8jwchleIcPLZXiFDC+X4RUyvFyGV8jwchleIcPLZXiFDC+X4RUyvFyGV8jwchleIcPLZXiFDC+X4RUyvFyGV8jwchleIcPLZXiFDC+X4RUyvFyGV8jwchleIcPLZXiFDC+X4RUyvFyGV8jwchleIcPLZXiFDC+X4RUyvFyGV8jwchleIcPLZXiFDC+X4RUyvFyGV8jwchleIcPLZXiFDC+X4RUyvFyGV8jwchleIcPLZXiFDC+X4RUyvFyGV8jwchleIcPLZXiFDC+X4RUyvFyGV8jwchleIcPLZXiFDC+X4RUyvFyGV8jwchleIcPLZXiFDC+X4RUyvFyGV8jwchleIcPLZXiFDC+X4RUyvFyGV8jwchleIcPLZXiFDC+X4RUyvFyGV8jwchleIcPLZXiFDC+X4RUyvFyGV8jwchleIcPLZXiFDC+X4RUyvFyGV8jwchleIcPLZXiFDC+X4RUyvFyGV8jwchleIcPLZXiFDC+X4RUyvFyGV8jwchleoYeeHvUdMLxCx9GXkuzQxKO+A69dPeyb+xx9T+WeBp9Kro9WHvbteZOX6Gn0NU1w8JSX56uZh30HXF6k8UI7yUcnD/vWnqSUiY73Yy8mx4uSMtnB/Yul3l4be8x34vWx7cd9Y59eZWc7fg49nSXuXVQs8uCt3izv3twtdHhv8GHf2km7S/B1GntFk3mVzfLh9XYCr7J5Dm/NPOxbcy2b6+jubYn7l54e9H3Qk287KcYVuMi44f6hu8d8J0S9azzd1fPqSe8ST3d1edI7z9NdbZ70zvB0twZPej95ulvHq8+sfKPdrUbT++PTBwJW9OVGxi9v7syuyt3bf9w/D/SY74SPrNzdfbqq2IBrDFcVGxn7w8n3PgC1meeBX25Prio2NO7L7fuwj/lOjPly62p2eyNe3YrGe/A13MutaLwPh8F+6sJHUXZjpHu3KsqejNNV3KzYl1He6D16e7czhyE+maze7dAARc+PouxS77+bfK/e7VTfv5usGu9Xz5cYny4rduzQ7fLeRn9od67Xj8S7nN29LpfncrYB/V3c+m3ZNvS2PBmlFX1lFbtrx1dHy5PvWtLP8uS7tvQS9OyuNX0sz+7a08PyfPquRe0vz22yNrX+JSC7a1bTt8/srmENL8/umtbs8uyucY0uz+6a1+Ty7K4DDS7P7rrQXFV5HP0R60RrJdl9sl60tTy760dLy7O7nrSzPLvry6GRT4b6nHtv2vhMst31p4Xl2V2PjuFx3h3fn+3S7r9va3ed2vny/D5Kt3Z929YN2o7teHmfoz82XdtvSBaO+7bX5d379xWd22nOE/C6t8ucJ6QMYIdR5WX0x2QMu/tPLD5xPIidfRbeBe0o9nVp64J2HLu6tPX/ZwfyHB7+zfh/20PZzf/0dod2MDu5wHBhMZp9XGC4sBjPLi4wnkd/FEa0gwsMdyyGtPkdjNPoj8CoNn6bd+/CYlCv277NU46HtenbPG/wBrbh2zxv8Ia22ds8BW9sm73NU/AGt9HbPF/eHt4mX7V1i5bDU5hFfb5Uxn++1t+dksIWn81TUvjHyk1FSeH/Vm4qPuzOLw9hHBX5Fi3/Oq23O59J4Y8VX2zdsuAvq73YeqHlm5VebL3Q8t1KL7auaPlhlRdb6ZhghRdb6ZjoNewknXu0nFH9nq3/KMBZte/Z+jAUZ1X+XW6fOuaCqp9GlvC4pOr/8XavjIsq/isCCY8r6sU8CY8rqn0BQ8Ljqko/auHKgusqXV/4Z2XcUOX6wpUFN9W4f+Gn8Lipwv0L/8yCAun/AsOnoSiR/vkoKYUiyZ+PklIok5xUpBQKpX7/4smpUyrzN/OkFIolVmTtmAnyPqXiCY8J0iqyJzwmyXrK046ZJOkpz80yJsq5ceYJj4lSbpx5wmOyjO86esJjsoSnPE94zLD8Kc8THjMsfsrzhMcsS5/yPOExy8KnPE94zLSs5XnCY6ZFty/8YwFmW3LH1sdSmG3BU56PpbDA/Kc8T3gsMPujyL5pwSJzv33hq2UsMvMpzxMey8z8jq0fD2ChWT8r4McDWGrWfTN3y1hszkcF3C1jsRm/xy0ek2B6RPa/VEgwuahoKaSYGpG1FFJMLSpaCikmFhUthSTTPonscykkeQ7jusKlBWmmXF48OHayTLm8cGlBmgmXFy4tSFR+eeGuBYmKLy9cWpCq9POg7lqQqvQ/d/tAFKkKPxz16dTJVfb/k325jGRl/99MxCPZIYzsDD/UQ7qSlCfika7gg8j3Tp10Ba+1bpdRwe3vOXqlpYKbt8280lLFrdtmXmmp4tZrrVdaqrjxWuuVlkquv9Z6paWS66+1Xmmp5GpD9kpLLVcbsvu0VHPtfq1PRFHNtddan4iimitfc/RjjFR0+XPIfkCAii7/pIBv+VDRxe/8+D4tVV36+Z53x05Nl25euG1BVZc+KODUqerCzQsxhcrO/9cLMYXKzgeVL8dOXWeDik+mUN25T4P6DCjVnfuEik+mUN25X+9xv4zqzrzJc7+MFcQ3ed7isYL4Js9bPFYQ3+R5i8cKwps8FY9V/HyT5/tlrOLnmzw3alnFz9u1/kEtqzj+GJ5TZx3fd+ezeKzk+5ccfd2ClXz/x2a+bsFKvv+ShXzMSr4lZPmY1fydkF1bsJq/v/HjXyOzmr8TsmsLVvP317pdW7Cav34nz7UFK3JtwSb+XF24tmBFf+5d+Ng7K/rz8Xc/XsGK/nwyyqmzpt+7+3TqrOn3T9L6vgWrOrmoZQu/b5q5Ycaqfn8kzxd9WNXRRS1b+PUj3H4nipXdu1PLFv5/WesbZqzsTU1hCy8uatnCs48IsIWjmsImfO6dTagpbOLksyls4aSmsIUXw2MLLzIeW3g2PLbwv5B3cPKs7VU/ZhP6MZvQj9nEyfDYwsnHQNnCo37MFl4Mjy28+DY3W3hx44ItPBseW/jwjQu28OKOGVswPDbxZnhs4WR4bMHH8djC0QeQ2cL73d2Dg2d1T3d3b06dtT37BQu2cPKb72zg6Jdo2cKT/zbABn7/fxVPeazpzz9vVFRYz+v9v8O799Eo1nL4vPvjyX0z1vFtd3d3n5bHGr6e7r779GpLfR/3dz/dfzh36np9DLP7p6q8OnfqObyEyf32JiVTyfEtzO1vT+/PnvdIdnx4i+/tuvJ5evvo9Pr88PF4+nlFyJ7c9/hjMIeXzp8yuvDZ3buFr88BHrYO3Hf2cvvq6a4Rn+Gxa5rnu2Z09T7vcv9ib7r6IokX2oZ09EWS59Efy6Z09JPi15M/+/IUHr9mycZN6ablfY3+SDamm++RPIz+SDamm394fxr9kWxNeATbdBj9cWxOJ0FFTGlNJ0FFTGlNJ0FFTGlOF0FFTGlPF0FFTGlPF0FFTGlQeBTbI6a0qIOgIqa0qIOgIqa0qIOgIqY0qfmgIqa0qfmgIqa0qfmgIqY0KjySbRFTWtV4UBFTWtV4UBFTWtV4UBFTmtV0UBFT2tV0UBFT2tV0UBFTGhYezXaIKS1rOKiIKS1rOKiIKS1rOKiIKU1rNqiIKW1rNqiIKW1rNqiIKY0Lj2gbxJTWNRpUxJTWNRpUxJTWNRpUxJTmNRlUxJT2NRlUxJT2NRlUxJQOhEd1/8SUHjQYVMSUHjQYVMSUHjQYVMSULjQXVMSUPjQXVMSUPjQXVMSUToRHdt/ElF40FlTElF40FlTElF40FlTElG40FVTElH40FVTElH40FVTElI6ER3e/xJSeNBRUxJSeNBRUxJSeNBRUxJSuNBNUxJS+NBNUxJS+NBNUxJTOhEd4n8SU3jQSVMSU3jQSVMSU3jQSVMSU7jQRVMSU/jQRVMSU/jQRVMSUDoVHeX/ElB41EFTElB41EFTElB41EFTElC7tPqiIKX3afVARU/q0+6AipnQqPNL7Iqb0audBRUzp1c6DipjSq50HFTGlW7sOKmJKv3YdVMSUfu06qIgpHQuP9n6IKT3bcVARU3q246AipvRsx0FFTOnaboOKmNK33QYVMaVvuw0qYkrnwiO+D2JK73YaVMSU3u00qIgpvdtpUBFTurfLoCKm9G+XQUVM6d8ug4qYMoDwqG9PTBnBDoOKmDKCHQYVMWUEOwwqYsoQdhdUxJQx7C6oiClj2F1QEVMGER75bYkpo9hZUBFTRrGzoCKmjGJnQUVMGcaugoqYMo5dBRUxZRy7CipiykDCo78dMWUkOwoqYspIdhRUxJSR7CioiClD2U1QEVPGspugIqaMZTdBRUwZTFjANsSU0ewkqIgpo9lJUBFTRrOToCKmDGcXQUVMGc8ugoqYMp5dBBUxZUBhBesTU0a0g6AipoxoB0FFTBnRDoKKmDKkzYOKmDKmzYOKmDKmzYOKmDKosIR1iSmj2jioiCmj2jioiCmj2jioiCnD2jSoiCnj2jSoiCnj2jSoiCkDC2tYj5gysg2Dipgysg2Dipgysg2DipgytM2Cipgyts2Cipgyts2CipgyuLCIdYgpo9soqIgpo9soqIgpo9soqIgpw9skqIgpbBJUxBQ2CSpiClsEFTGFTYKKmMImQUVMYZOgIqawRVARU7jbIqiIKdxtEVTEFP4RllHX8DGFX1YOKsPHFH5ZOagMH1P4ZeWgMnxM4bdVg4qYwm+rBhUxhd9WDSpiCv8K66hHTOGPFYOKmMIfKwYVMYU/VgwqYgp/WS2oiCn8bbWgIqbwt9WCipjCN2EhdYgpfLdSUBFT+G6loCKm8N1KQUVM4YdVgoqYwk+rBBUxhZ9WCSpiCkFYST4xhWiFoCKmEK0QVMQUohWCipjCGdWDipjCOdWDipjCOdWDipjCWWEpucQUzqscVMQUzqscVMQUzqscVMQULqgaVMQULqkaVMQULqkaVMQULgprySOmcFnFoCKmcFnFoCKmcFnFoCKmcEW1oCKmcM1HWEwSMYVrqgWVxyt/FO7DYpIMf7Jcd6yzOzGF6yoFlferfxQ+w2ZSiCncUCWovF7/m1AnqIgp3FIlqIgp3FIlqNz4m1AlqIgp3FYhqIgp3FYhqIgpFEgPKmIKJdKDiphCifSgIqZQIj2oOHWKJAcVMYUyyUFFTKFMclARUyiUGlTEFEqlBhUxhVKpQUVMoVRqUHHqFEsMKmIK5RKDiphCucSgIqYwQVpQEVOYIi2oiClMkRZUxBSmSAsqTp1JkoKKmMI0SUFFTGGapKAipjBRSlARU5gqJaiIKUyVElTEFKZKCSpOnckSgoqYwnQJQUVMYbqEoCKmMMPioCKmMMfioCKmMMfioCKmMMfioOLUmWVhUBFTmGdhUBFTmGdhUBFTmGlRUBFTmGtRUBFTmGtRUBFTmGtRUHHqzLYgqIgpzLcgqIgpzLcgqIgpLDA7qIgpLDE7qIgpLDE7qIgpLDE7qDh1FpkZVMQUlpkZVMQUlpkZVMQUFpoVVMQUlpoVVMQUlpoVVMQUlpoVVJw6i80IKmIKy80IKmIKy80IKmIKCSYHFTGFDJODiphChslBRUwhw+Sg4tRJMTGoiCnkmBhUxBRyTAwqYgpJJgUVMYUsk4KKmEKWSUFFTCHLpKDi1EkzIaiIKeSZEFTEFPJMCCpiComKg4qYQqbioCKmkKk4qIgpZCoOKk6dVIVBRUwhV2FQEVPIVRhUxBSSFQUVMYVsRUFFTCFbUVARU8hWFFScOukKgoqYQr6CoCKmkK8gqIgpVHAzqIgp1HAzqIgp1HAzqIgp1HAzqDh1qrgRVMQU6rgRVMQU6rgRVMQUKrkaVMQUarkaVMQUarkaVMQUarkaVJw61VwJKmIK9VwJKmIK9VwJKmIKFV0MKmIKNV0MKmIKNV0MKmIKNV0MKk6dqi4EFTGFui4EFTGFui4EFTGFys4GFTGF2s4GFTGF2s4GFTGF2s4FlYNTp7ozr7UfTp3qnsLuXNOyhpefu3tx7Kzhx4utF1pW8iClsInTv7dsjyePACt6en85Hl/eXFbMcXd391+XwToXocWxKwAAAABJRU5ErkJggg=="},635:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAngAAAOTCAMAAAAbvY79AAAAM1BMVEVMaXE2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjbqSzSUAAAAEHRSTlMAIGCggBDgwEDwkLAw0HBQMYVGbAAAAAlwSFlzAAALEgAACxIB0t1+/AAAHXJJREFUeJzt3eta2zoQhWECCUk45v6vdj+bFgpMDj6s0WhG3/u7tERZla1l2b67aff+tD+egImO+6f327G65fDAeGO+h8ONYF33/siYY5n98uht9ow5lttvTKQmuefMDqsc75fkjpM7rPZgYkXu0MLs5JE7SMxMHrmDyJMJ1xX3jDpUZrTJG9azkDnuTMAuob+D0POFmBkHRh1KU69hMOFBam8idtYLow6tadfOqFIgNq1SYUkLsUcTsjNYWkDuxebM2DLsUHszMbOeGXWoTbliS5kCuSmFCqMOuaOJmcWoQ8/EzGLUoWdiZjHq0DMxsxh16JmYWYw69EzMLEYdeiZmFqMOPRMzi1GHnomZxahDz8TMYtShZ2JmMerQMzGzGHXomZhZjDr0TMwsRh16JmYWow49EzOLUYeeiZnFqEPPxMxi1KFnYmYx6tAzMbMYdeiZmFmMOvRMzCxGHXomZhajDj0TM4tRh56JmcWoQ8/EzGLUoWdiZjHq0DMxsxh16JmYWYw69EzMLEYdeiZmFqMOPRMzi1GHnomZxahDz8TMYtShZ2JmMerQMzGzGHXomZhZjDr0TMwsRh16JmYWow49EzOLUYeeiZnFqEPPxMxi1KFnYmYx6tAzMbMYdeiZmFmMOvRMzCzBv3nco5Cj+YLnMzGzBP/KlLeTIg3FG4wJHmYjeAhB8EDwriJ4pRA8hCB4IHhXEbxSCB5CEDwQvKsIXikEDyEIHgjeVQSvFIKHEAQPBO8qglcKwUMIggeCdxXBK4XgIQTBA8G7iuCVQvAQguCB4F1F8EoheAhB8EDwriJ4pRA8hCB4IHhXEbxSCB5CEDwQvKsIXikEDyEIHgjeVQSvFIKHEHmCJ33PxdN2+3Y4mF8TFxwOb9vtkxnGFfK858LDcf/0RvyuOrw9SULi4drv/Venv/kfr0/vO/Mb4273/vRqBqsn2YP3v9e3F/NLD+1l23foTnVeovf4tDG/96Benh7N8HSoSPD+n/fuOebe7d76n+v+ML+6ZX6mV8eHwae9l4c031W199XuB17nHhT1WjPm17cyfZxxo5crdiXf0D1i9LLFruir4Z8HO9fbPJsh6J75EFa+D3U6bs2nqGu3NZ8/gZrBO50ehzneHlLUdob5HJb5mRyehqj1dk9Jvx7zSSzzM0k8DnAhLel0Vzt4p1P5M72UZ3d/mM9imZ/J47n04XaXrkP5xnway/xMIpUPty9pD7On+sE7Hd/N5ynivtctntNUD97pdG8+UAlv5oPmUj94pwfziQpItA/lvAGCVzF56XM3RPDqJS9/7sYIXrXkFcjdIMGrlbwKuRsleJWSVyJ3wwSvzuWzrLsCfjGfyzI/k1ORPu++yNdhPphlfiapElfPDlW+DfPJLPMzSR0LbIjf5L5O9o35aJb5maxezUfLZpfldu3bRgre6cl8tmRqLGg/DBW8U/KtKlUWFqfhgpf7NK/OCd5wwcv9TNzMG44N8+ks8zOZvZmPl0b2HXg/jRa8vAfbUgfa8YJ3ejafL4lSB9oBg3dK+oiBd/NBcjMf0Cr2iR/NB0wh9S1lZ4wXvJzri8S3bp9nPqF19ucSOya8y3tXa2UxZvAybs0rN+ENGbx8U169CW/I4OWb8upNeGMGL9uUV3DCGzN42Ra2BSe8o/mQVrHK/JSvy6vW4U3crZHwkeI3pdqYV2kb3qcpt5sWnOhzXbEteMiZdLJT5sam7xJtUtmYX76ASbf8FVxTZVpeVDziTDvJLnSLyZdEy4uCS4uJt129mJ8rIM3t3SVHf+KZTsWz2zRXL4o8K+WHqbe+VFxepLm7u+KRdvJm3IpTXpJ1bcU17fQyq9iNJh+SPD2q1r1lH+ZcKi9YnifpkAteN5p12ahepTLlMnUH6h1rZj7Bpl7yUhQq9cqU2Q8FLpe8FCd55U7xFjyMulryUjyPm0HP/9q231I0eXWexPi/48KjzKZWn2c+X4fML53Zfnl3+l6pR0+wuqh0zWi/7uEhhzpnHQm2IdfpTx/WP7Nm9/60L3G2l2CfQIm9eMf9U/rXVR8Ob7rzzATP4tYdXp7fDkmfk9UN2RInwXNpVR/1ucA7PjogalUTBE/UphR9PX57onPu/j+o+ZUXIXcymm25/X9O8ysvUebFlR3YSfrE/j+n+ZUXSPoI1E5JTvO6f3aPpD/mQKsk2RHefb8gCV7CB6D2TLHeGyJ4+d9Z2RdFwzVE8FK/RatDBG8i1rRaBI/ghSB4BC8EwSN4IQgewQtB8AheCIJH8EIQPIIXguARvBAEj+CFIHgELwTBI3ghCB7BC0HwCF4IgkfwQhA8gheC4BG8EASP4IUgeAQvBMEjeCEIHsELQfAIXgiCR/BCEDyCF4LgEbwQBI/ghSB4BC8EwSN4IQgewQtB8AheCIJH8EIQPIIXguARvBAEj+CFIHgELwTBI3ghCB7BC0HwCF4IgkfwQhA8gheC4BG8EASP4IUgeAQvBMEjeCEIHsELQfAIXgiCR/BCEDyCF4LgEbwQBI/ghSB4BC8EwSN4IQgewQtB8AheCIJH8EIQPIIXguARvBAEj+CFIHgELwTBI3ghCB7BC0HwCF4IgkfwQhA8gheC4BG8EASP4IUgeAQvBMEjeCEIHsELQfAIXgiCR/BCEDyCF4LgEbwQBI/ghSB4BC8EwSN4IQgewQtB8AheCIJH8EIQPIIXguARvBAEj+CFIHgELwTBI3ghCB7BC0HwCF4IgkfwQhA8gheC4BG8EASP4IUgeAQvBMEjeCEIHsELQfAIXgiCR/BCEDyCF4LgEbwQBI/ghSB4BC8EwSN4IQgewQtB8AheCIJH8EIQPIIXguARvBAEj+CFIHgELwTBI3ghCN5ET+ZvxRoEb6K9+VuxxpHgTfNo/las8CL4SsYI3mlj/los92DGd4Hux1/y34uTPKGNGd6Swbszv/ICR6Y8nVeCNx3LCxnJgTbDabf5nRd5MH8vltgoqpQcM4Hqk+7M34zZtoom5TRU8E5Hrl+sdf9oRnWpBF/Gk+zDPr6bvxzTvaimgP+99T/wW/NLL7d/MX89ptlpFhWfuu+PRQ3ylydO9RZ5U53c/ZXga9D0lV+OCSb57hw03d23byHDpza/9UqvCab5roiPsqcsvarynPaPB463M6iPsqcsOyR1y9ovx3vzr+A86Vr2S4p+4d782gJ7rt5OsVN2Ct+kOOSIVxef6JNvO+ga4x9ee//gf3h9ehYZ1+0cTnL+SLJNTb+o+vz8LDKu8Jruspzi3d29m19c5ZFJ7xK/6S7FZrwPO/OL6zDpnec43Z1Oz2f/yQ65rOj/YtI7w3W6O53SlFlv5ldXYtL7zXW6y1Km3PkVKp8e2bPyg1N39yXNkdb3WHui0/vhRb0hwEh02cjl4sV3r1zI+Ove4crsTyl2pvy18x8Nrt7+b/dsRkYu1U3Obh3yP2xZubt7cV5VfEh1cJE8T+AG1hjeq4oPyW5x9l5efBh7c/KuyRhnuNviO/flxYfngQ+3B/fz6A/pntzV4uxj5MOtb0n/T7pFXJspb9TDbYvV7IeEjypsM+WNubr1L40/JWytWk15p9fhDrf+pfHX2Jp/O4FWU97pONijLny3ovyQciuQ9pECV4107bZRi/Ih0faA71qO0DAnek0uVnxKekXceXfUD6Oc6L03O73LfCBpcknnr+MQO5NbtXcf8r71YdfysDBCo9dg78U3if8rN1xfDPDc5F2z9u5D6nc+NFz5l39ucrvW+EPKCu9L4/+klZcYLy2XFafTMflQttiYV2i4Lmt2Ieiv9Du8m67D6m6JbzyMFc6X267ECvxXPaf1IOY+wfuj8WlexcWtw7NlrzuWWKVt2p4V10te8/+6Vc6UG6/HqtUqzXOXuTn+qfWK7PRaKHmN67taZ8kkb7Hmh4taq7PmyeM0ZalirQDJW4TcrUbyFmi6++5DwRaU5M3WfshK3r3S7t6oIsPIf1URTlhmaV8FlH3o4IZKarrmuat8Z3yzJy98SZu85rkrfudA6+09WZPXOnf1n37U9L7QU9bktc7dCK9waL7Hh+fO3DLKS2ta16LpWhW/l8GdNc4ba5zfgPRbtnqqbe20H+phW4emxUqu5DXN3eNwr224b7nIyJS8lrk7bgd8quVu23KE0ySvZe5GfVXIpuH6NsvtKw33ue8HfgFrw1O9HHuS2+Vu9HdyvbV7nG+C5LXLHS/katcnJ3g3UquxeOU15y2Pt93fb9sod0de9/tXqyeHdp68Rhso9rzr98um0XO6uz6hbnOB9jj2mweNRouMjpPX5oFuTHe/tZn0+i2SmxTHTHfnNJn0ek1ek+eUM92d12TS67TOa7CyZ7q7rMWk12Wd16BIGe9dg3O0eDRSh6VKgz4p9csDWmiwR7S7Q47/juMx3nu0ToN37Xe2F95/QVv7BSAq/jff9rW09V/QcolsIvdrR10tbb3X8hxmp3O/+bajNwB7n9RymJ3D/XDbzdHH+woth9mZvBuGThYYzguLmg+88+W8uu1jgeG8sKA0XsL5oWZdLDB8zyieOb1bxHlXfAcLDN/zCU7vFvPtVcKvYLi+wHz028jW8X2+T/AZ0M7zw9V9c28bro3eY+w5kGdzXOmlWjFcbzUNPc3zPMFjWbGe6xIj8DTP8wSv3it7Q3heVAo7E/Js8NhqLOJ4WSnsNM+xwWM5K+P4UqCg0zy/oojNKEqOlzRD5ge/z0ONouX4TUXc8+e2VCd3an61ymv7D+PWpFDf6fklr/k1Tbcmhdx58Ete48OTW5NC7ny4Ja9xp+LVS5I7L24XMZre7ex1Fy25c+SVvIbdl9eeFHLnyil5DQ+2TpcsyJ0zp+Q1O9g6HWjJnTun5DU62DodaMldAz7Ja3Sw9VnRkrsmfFqVJgdbn+qY3LXh1Oc1ONj6VMfkrhWf5D36//Yu12izvB+wAp/kuV+zdXmjAPtRWvI5Znl/hR7/XchdWy7785yfy+2y65j9xo25JM91N7JLhcf9Fc15XAJwPU/3uFZG7gJ43HvmeEOqR4XH/bMhPMoJv1Mmh+VQRw/UHYvDxTO3GzAc/pdQHIdx6Cec7sJ3WFlQHMdxKJKdvk795EyBF8mhVHE5YXdYWbCgDeXwjXrMJPpH4fGc2WD6UsXh+oX+l2RBG05/9iR/N4T+yjIL2g7IFxjy/VHyKiXkeS/4Rd9UiM+f9L8g7+vpgnybm7hSkZ8MsLDohHy/kfT+i43561dy3r2F6eRzivIcSl2lBL8kAd/Ir2AIW2R508gVi47Ir2DodqmoJzwe6d4VdUUrO49ST3g0x51Rn+appjxxd8yWlN6orw6Ipjz1TMy9Pd1Rt3maklb834EGr0PiC1OSC2fiCS/gAfW4Tbx+VGx40054XKLt00bbqQimPPGER5PSKfGttuunPO2Ex6WybmnvmV495WknPJqUfok3IK2d8rQTHnuhOqY92K6c8rQTHpcsuqY92K6bZKQTHgfavmkPtqtO57WzL3czdk77da+5QiWtFVnRdk96sF3xfUu3pVAd9097sF0+5UknPKrjBKR3YCzeiiy904JrtClI55qlxzjp/kB2u6cg3SC1cMqTTnhNX6eL5ZQvDFvYnyn3aFHhZSHdjbxo76V0hUOFl4ayzFt03Ux5tYwKLxHl+mLJhKOccllZJKJcXyzoMpTlMa8USEW5vphfIguvnrCyyEV5dj97zlF2KdxXlozy+sXcElnYpTR4iS60hOf3c2cd4WxLlZKOsFKZOe0IuxSqlISElcq8ncjCf5gnViQk7DRm3e8gXFow4aUkLDXmLC+ETQ7bP1MSTj1zlhe6pQXdcVK6PXEzlhfCpQUTXlLCKW/68kJ3gGfCS0s35U1eXgjDzoSXljAFUy+Z6q5aMOElppvypt7npbtgwoSXmG7Km7g5SrcfiwkvNd2UN20/pu7fY8JLTTflTbvVS1biMeElJ5uCjlPGQbczgQkvOd2UN6XKk5V4THjpyaa8CVnYmR9aim0p6cnWmROOtbLLZWxLKUC2Pe72bmDZkZbnHRcg25d387KZ7EjLnRYlyC4m3LpsJjvScqdFCc3yoDrSci9tEapW98axVnak5V7aImQ7Rq7PRLKZlfK4CFmJfP1YqzrS3phYkYeqRL7aIcuOtJTHZagalasdsuo6LV1KIa/m613mWrGrmlZ5tUAhqvP+a8da1dr5+goGqaieWnblMKg6nF/LNtJRHQcv70NWPUCApUUpqj0ql/chiy7MXZlTkZEoFxfv+VF1hSwtilE9IfTSVQXvvx9JqerdSxcvRJctuGpRjnMyzB9c5lKukZaoyrtw8UJUprAhqiBRlXe+7hCVKZR4BYmqvPOb5UTX5K5dkkNSoov4ZwsV0dLlwnEcuYmqvHOnYaITSI60JYnOw84dDkWH8csX5JCY6LLZuatmmsmUy2VFaeJx5iRPdL3sXKRRgOhYa0/yRKd45w7iKEB0rLX50JzisaYtS9Mh2yOi5hjOmrYszcxkTvJELZ6dSVGEqEP+fZIn+mtJWV2aY+3vqUmzaLm07wUFaPZG/b5cq3kCHzuiCtP0Hr+f12n+wCLsPS5M1PT+HCDNXjyzZEElmu1LP6+pam63OO5RmGZ18fNWMOGbwIFrfla9uvfmAVf9OB/TvdwCuOF7hSx7qjxwy/c7fnSvRgZu+F4hs7ZAM98vb7G2QDPfNqmztkBDrC0Q4t/qgrUFGvp37UL2Plzgtn/b31UPlAcm+LczitFCS5+5k70AHJjic9um6n0+wCQHFrWI8HnRjAtmaOpzS57mRh9goj2LWkT4+6AT2TuYgWl2XKlFhD/LWtULfYCJ7mlTEGHLohYRntkigAh72hSEYN87QtCmIMSBvSmIcKBNQYQtwUOELTUeIjwTPETY6976DUz3SH+MEPTHCEF/jBAHgocIB7aBIsI7/TEibAkeImy5mxsRtly4QIRngocID9xxgQhbrpghAsFDiHuChwgHgocIbMdDhD0bkBHh7e7uiYFHc5u7u3tGHa098wQLRDjwzHcE2PMkWkTY8LYBBPh8vwpTHlr69/JGGhW087j7Ct6OrVFo5fhy98+G62Zo40fu7u5eSB5aeN3c/fTC0Rb+HnZ3v+0eGHf4enw3sftoVR4Zd/g5bk3kPt1TJcPJ/t7E7bvN2zPzHsT2T/f23K6Ul8P9Q9H1+fHh/fB7RYie7Co+DOa4LT5llPBS7mzh9WWAr62AXbHD7SPTXRIv5rtLjfkujVLneZf7L/Sm1I0kHGgTKXQjyfPo32UqhR4pfr3yR1825vtLi9o4lTJd3uvo32QyZe4jeRr9m0ymzAvvD6N/k9mYbzCn4+jfYzpFChXKlGyKFCqUKdkUKVQoU9IpUahQpuRTolChTMmnRKFCmZKQ+RbzoUzJqEChQpmSUYFChTIlowKFCmVKSukLFcqUnNIXKpQpOaUvVChTkjLfZC6UKVklL1QoU7JKXqhQpmSVvFChTEkrdaFCmZJX6kKFMiWv1IUKZUpi5tvMgzIls8SFCmVKZokLFcqUzBIXKpQpqaUtVChTcktbqFCm5Ja2UKFMSc58ozlQpmSXtFChTMkuaaFCmZJd0kKFMiW9lIUKZUp+KQsVypT8UhYqlCkFmG+1f5QpFSQsVChTKkhYqFCmVJCwUKFMKSFdoUKZUkO6QoUypYZ0hQplShHmm+0bZUoVyQoVypQqkhUqlClVJCtUKFPKSFWoUKbUkapQoUypI1WhQplSiPl2+0WZUkmiQoUypZJEhQplSiWJChXKlFLSFCqUKbWkKVQoU2pJU6hQphRjvuE+UaZUk6RQoUypJkmhQplSTZJChTKlnBSFCmVKPSkKFcqUelIUKpQpBZlvuT+UKRUlKFQoUypKUKhQplSUoFChTCmp+0KFMqWm7gsVypSaui9UKFOKMt90XyhTquq8UKFMqarzQoUyparOCxXKlLK6LlQoU+rqulChTKmr60KFMqUw8233gzKlso4LFcqUyjouVChTKuu4UKFMKa3bQoUypbZuCxXKlNq6LVQoU4oz33gfKFOq67RQoUyprtNChTKluk4LFcqU8rosVChT6uuyUKFMqa/LQoUyZQDmW49HmTKCDgsVypQRdFioUKaMoMNChTJlCN0VKpQpY+iuUKFMGUN3hQplyiDMNx+LMmUUnRUqlCmj6KxQoUwZRWeFCmXKMLoqVChTxtFVoUKZMo6uChXKlIGYbz8OZcpIOipUKFNG0lGhQpkyko4KFcqUoXRTqFCmjKWbQoUyZSzdFCqUKYMxCYhBmTKaTgoVypTRdFKoUKaMppNChTJlOF0UKpQp4+miUKFMGU8XhQplyoBMCtqjTBlRB4UKZcqIOihUKFNG1EGhQpkypPBChTJlTOGFCmXKmMILFcqUQZkktEWZMqrgQoUyZVTBhQplyqiCCxXKlGGFFiqUKeMKLVQoU8YVWqhQpgzMpKEdypSRBRYqlCkjCyxUKFNGFlioUKYMLaxQoUwZW1ihQpkytrBChTJlcCYRbVCmjC6oUKFMGV1QoUKZMrqgQoUyZXghhQplCkIKFcoUhBQqlCmIKFQoUxBSqFCmIKRQoUxBSKFCmYKIQoUyBXcRhQplCu4iChXKFHwwyfA1fJmCvxoXKsOXKfircaEyfJmCvxoXKsOXKfjUtFChTMGnpoUKZQo+NS1UKFPwxaTDD2UK/mlYqFCm4J+GhQplCv5pWKhQpuCbZoUKZQq+a1aoUKbgu2aFCmUKfjAJ8UGZgp8aFSqUKfipUaFCmYKfGhUqlCn4pUmhQpmC35oUKpQp+K1JoUKZAsOkRI8yBVaDQoUyBVaDQoUyBVaDQoUyBWe4FyqUKTjHvVChTME57oUKZQrOMknRokzBec6FCmUKznMuVChTcJ5zoUKZggtcCxXKFFziWqhQpuAS10KFMgUXmbToUKbgsr1f8ChTcJljoUKZgsteTF5kKFNwhVuhQpmCax5MYkQoU3CNW6HyfuUfBXYmMSLDjyyucypUKFNwnVOh8nb1HwWcChXKFNzgUqg8Xv83AZ9ChTIFt7gUKpQpuMWlULnxbwIuhQplCm5zKFQoU3CbQ6FCmYIJ5IUKZQqmkBcqlCmYQl6oUKZgCnmhwqhjEnGhQpmCacSFCmUKphEXKpQpmEhaqFCmYCppoUKZgqmkhQplCqaSFiqMOiYTFiqUKZhOWKhQpmA6YaFCmYIZZIUKZQrmkBUqlCmYQ1aoUKZgDlmhwqhjFlGhQpmCeUSFCmUK5hEVKpQpmElSqFCmYC5JoUKZgrkkhQplCuaSFCqMOmYTFCqUKZhPUKhQpmA+QaFCmYIFVhcqlClYYnWhQpmCJVYXKpQpWGJ1ocKoY5GVhQplCpZZWahQpmCZlYUKZQoWWlWoUKZgqVWFCmUKllpVqFCmYKlVhQqjjsVWFCqUKVhuRaFCmYLlVhQqlClYYXGhQpmCNRYXKpQpWGNxoUKZgjUWFyqMOlZZWKhQpmCdhYUKZQrWWVioUKZgpUWFCmUK1lpUqFCmYK1FhQplCtZaVKgw6lhtQaFCmYL1FhQqlClYb0GhQpkCgdmFCmUKFGYXKpQpUJhdqFCmQGF2ocKoQ2JmoUKZAo2ZhQplCjRmFiqUKRCZVahQpkBlVqFCmQKVWYUKZQpUZhUqjDpkZhQqlCnQmVGoUKZAZ0ahQpkCocmFCmUKlCYXKpQpUJpcqFCmQGlyocKoQ2pioUKZAq2JhQplCrQmFiqUKRCbVKhQpkBtUqFCmQK1SYUKZQrUJhUqjDrkJhQqlCnQm1CoUKZAb0KhQpkCBzcLFcoUeLhZqFCmwMPNQoUyBR5uFiqMOlzcKFQoU+DjRqFCmQIfNwoVyhQ4uVqoUKbAy9VChTIFXq4WKpQp8HK1UGHU4eZKoUKZAj9XChXKFPi5UqhQpsDRxUKFMgWeLhYqlCnwdLFQoUyBp4uFCqMOVxcKFcoU+LpQqFCmwNeFQoUyBc7OFiqUKfB2tlChTIG3s4UKZQq8nStUjow63J051j4w6nC3MbljTYsWtr9zt2XY0cKvgy0HWjTyRJWCEIevS7b7A98AGtq8bff77T3LiiXu7u7+A6EfRSam3lcaAAAAAElFTkSuQmCC"},636:function(e,t,a){e.exports=a.p+"static/media/logo-alt.d72af897.svg"},755:function(e,t,a){e.exports=a.p+"static/media/grpc-logo.cbb40752.svg"},756:function(e,t,a){e.exports=a.p+"static/media/rest-logo.3953eeb6.svg"},757:function(e,t,a){e.exports=a.p+"static/media/graphql-logo.5bf8a3ca.svg"},758:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEEAAAATCAYAAADPsWC5AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAA3XAAAN1wFCKJt4AAAAB3RJTUUH4wIMDjkMYb7DzwAABM5JREFUWMPVmGtsFUUUx38zRYFWwFp5aEL8ohXZIvURV3DVGKPRmCCCiUS8FNbwMF3w8cEYRUyMBiGSGLkxwZqVCirE4AeNn0wwtQt2K2CTskUeESM+CAFsq2Ll0rl+6GwzrLu3UK4fOMnmds45O3P2P+f850yFtOyxwHUMSKSisI8SIi27FhgDnARG66eUHAHGAten2ArAQVUUh+lqi+d3gHGcm/QsrM51Atcm1/QD71jS2XXyY4DahPpHIS27BvgFGAksUlG4sQQAlcDPQDXwFNAI1A0R6DPAZcBrGfYi0AosUVG4X1r2LuCWcwRhd0N1zhHQBkw39J2A7Qfe37Gi4Y4NokIUPgceSmxQvVRReAL4RCsXU3d7qUXnagD+BD6iPCKAu4BAWvY15/vy+4HXB8wDThnqacBa069CFJYnAOgHcn7gnZRa8Z7+nSmLxfSdra8HWKpHW1QU9hrWZcCIjGe94fdVwnYF0AD0AFcCbwB2yhyxJG02gB943wPPJiL2XCc/S5fBdGBNwr7WD7wW4gXUJf+0yMLIfcANwJMpEyILI6cCM/Xw3YRZqSjsL1FGg6mf8Psd+EBatgA2ArOAChWFpzPe789cp1hsQogHgdmG1ned/AzgY2CUoW8HXhmcH4CODjMbFkjLHpWyzGKdut8Jpb6lvLJd/1YCk4Yzgb9jeVHH+KuhrgF2682N5Q9gvh94hbNBGJBmoE+n6JzETowCFsRZ0L+v3Bgw2SDJ7uFO4gfecWAhoAz1mITbCj/wDpmKwXpTUXhCWvY2YL5G1CS+ORqcLELMScu+NSO25iGO3HEGibUluGY4QHzpOvm3gOdSzFv9wPvP6TciMW7SINwtLbtWReEBg/gAtmYEead+0qQt8dEPaDIEqAIcfeL0AyvLlFkv6TVqDN1Pxndkg6CisEVadkyQLvCCtOwpOlCADRmLtgL7Mmz7gauNcZU+0kzpBpaqKNxeJhAWJwA4AzzhB173kCAYx+U6YJG07FXAEk2IHSCyyGCTisKmEil/zyDQorhNFkWTDhTgbWCVisKecny96+RvTPYIwGo/8FpdJ18F1PuBt+Os+DJquA+YADwK5OIsUFHbhUe5tx0QHhBozWPn0SYPAcD6ypTj8BvgVQPwba6Tn1QSBN1BfqqH7+gm5q8ydoioqO207j6PABOBz6RlV5Wh+VwHTDUUvboMzrhOfq4u8YlAs+vkZalyiJuhx40d2jIEawvd8GTdDVKACI9Jy54NfK37/k2yzp6r9obFYZbBIynE1+gH3g+ukx+d4LP79enxZty3p9TwbQJEFzAlbldVFLan1HrneV6gtqsovDcxxzydZQJ4XUXhypR1iprcJjdU53rFwCl2H/AFsEyhChL5my7hWDb3V4hcc0tjDNIa4HnDfhqY4QfeHpm+S+1Fo4PsUKKinf9JVBRuAVbr4YsalDTZpaLwqICndZaO143Rso3BCqVvt7EcBhpjAAbSUawETGK/FPjQdfJVI0rE1wQcBA6xd2eWz3L9v4KSVAhU6Ovt8Yx6eVnATu13StbejDqwx3R5GDiq/56QeP2qOPUNW5cfeL1n3zYbC7pkktf0cYKLTFwnP03zyOXACWCmH3gHLvQuz0UIxHjgJmCXH3gnL3S+fwF6wJSS3cCkGQAAAABJRU5ErkJggg=="},759:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADEAAAAeCAYAAACFZvb/AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAA3XAAAN1wFCKJt4AAAAB3RJTUUH4wIMCDkWmFFGBwAABRdJREFUWMPtmGtsVEUUx39z93a3tAglAY3lEROlPEqsMiLwBYyaSEh4RDSYgCltI5ZQn0hoqESCETW+agNxCa5N5KEJCYpERJAEAhEjOYvgC5QAFUJtgFJot+0+7h0/cEuWZfsASmgT/192Z+bMzPnPmTmP6+M2Q2s9Ozc3tzI3N/dQbW1t3Y2sYXH74QceBw5qrUNa68zeSCJZl2IgrzeTuCn2/5PoCbDTeAs/MEREjnd1kZe+nBeIRmOBYOHGS9fhlQLGmPh1erI7gfMi4rRrCa31DOB34JjWeq3WelBnC7+2dc7TgYB1xLbskyVrn1n4bPBJuyP5sWPHKq11IXBCKXUIeKwLyt+htX4bqAFEaz05eVx5QvlApefqktEIrACqRCSWPLBg55QCv8msCjjZk1Q0k1irS1NTK0qp35SlXllTtOGHNMqMB6qAhzvQuUBEDgMUFBQo27YLgZXA3Slym4DFIlKjtNYfAS928j7+BuaIyIFZVdP8A/PilbbflNpOpgok+qKimcSihpaWGIm4g+2zsHzqm7ONF4s2lW2t11oP8JSf24VbUyAih7XWI4B1wLgOZFuAlRbwcgoBBziTIjwcmAlgWSqv5by9AHXZilfdTZ/CNQbHdWlujU6vu9TwiDc0Kw2BWCdkZqchcD6l3QdYnnr6h4AHgXuAxSljBkBlGNXaqHCi6Q1nlCHhuPx76UJHCm4BRgDjgV+6+K7fKCjOn9F3aNZU72a0od5qU87DVyLyq4jEReT99CRcVIZL0zmVngSGi60REsbFtnztKbRMRE6KyM/Aqq4wGFf2wA5/Vsa+UTPyFnmHYIAQMMa+Xp+sMlwwcO5slD5ZFoE+18okjIPfZ2Ms0+4y7fxvF7FIrM6f7d8PbAeOABtF5GDaONEBrlgi1urS3BLnzKlmBgzvn9Yaccch299uLrdZa10ODAaWd2XzQ9V/bAMWici2ziL2xZT2pWtI2G7kYv3lN9kYidPQ0Jr+5BJxYk682WumCt3ruchKICdlLOr9Nqf0jwS+1Vp/p7UemUrCeN6o0BhTmTIxH9iQ3LHxqZ3HEzF3IgoBqDlzAdc1KXdFnVCWmrVt0Y7tAMaYL4AyoL6Dwz4GzBSRo96cSuCFNHOmAIe11h8mkygH8kTk83A4fJW0iJwWkbnABODHtv7d5Xt/UndZDymL4pZYvO7chSsGiyilKgIBe/Tu8j2bAcrWPafC4bAjIqs9V73Kc+NtaAKWAGNEZEtbZzgcTojIKuA+L8bEU+LWzut6VB3h0fcm9ctQdsXIIcMGJZxExeo562sBSqtLJgAfAP2A9ShTGZz3WdSL3KOBd4CzwFIR6bSi867QMmAvsDY5f7ppEqkorS4ZDLzrKb8ITA2oMmAOsCJYFNrS3Xt2G4kFa+Zh/L4KL7K/HiwKfZ9CbhDwlhdI5wMDgOxgUWhft6fiNwrj940GJmOY6LomUVpdMs5nRw84icATwDDgaKSheX52TtZM4FVgF9Af6DkkgEygLlgcSjwfKraAT5xEYBNwP7AHWJKdkzUKCAP+7rxWNrcWNjDQS9SqgT+BrN5Wnm4D3vSC3TTPu/S6GnshMB04BRy/VZt0J4kIMLi0uiQzyekt9NL7ccBpoMRLOVpv6YeCG4UbiR61sgNfA/uVxUHgn2BRKNqWtpRWlwwFPgUCXiXZ8+JEUjzI8XKugV5h/5dXYE0FlgaLQrt6bLBLQyYf+BjIBVYDwWBRyLkVe/0HjKngArPVC4sAAAAASUVORK5CYII="},760:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGUAAAATCAMAAAC+2TMhAAAA51BMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAACg8AUHqOzwBVfgIECg4ADhUADRMABQgCFx0mOAGJyAAALEN5sQEAEhwnOQBDYAIAOVYfIxZRbw86TwoAJjodKgAAP2AMKBtkkwKIxgA4WQaBvAE8VgAAGSYUQy0RERFxpAJTegEACxBypQAqPgAADxdaggMRERFEYwA6VAAAGSYADhUzSgBsnQAAITEABQcADBMABgoZGRkAExwkNAAkJCQmOAAAAACS1AAAiM4Ad7QAZpoAXY35uqjsAAAAR3RSTlMAgEDAECDxYOCgUNCxMJBw8vn38tOyavr59u7t6Mx2/Pj49/f18/Dw8PDv7ezr6Ojn5uLi3NjW087JxMS4raimnpeUgoJkPZ4xoKIAAAG6SURBVDjL3ZLXktwgEEUbaFoChcmzu97gnHPOOaCx/f/f426Y0axcy5NrHrznAVQ0dY9ogHMNpmmnufj+FewG+/EDWkicdDMNO+LN+PMcgcGTbnrdruUqUoCO3iKOXrlRrEvFytzwIFtUgteaAgQlEduj+AYWe/QEuX5wu+umz3BjcaVYVNxreETDCzVJSnBtFTzPJUanWEKymGCBCSwP0KOfj5dvr4U54r0u8rqvGBm3FlNLpJeUoLlgeDau35IyLdXtX5bEcm88nuwv9IVkmTZnWxpCEFydLIVYLPmhxTlNZ1oAjy/9+n2j7tboocVpplKSmpYrzhj5lpRkjQhPW5AslEVvGbKYrFb301muXpwPLaVhSLFuvUycUZWbLFNvLemAymQs8PVw9XPWRY4y9+IriHgjHbNBpyzu2SlLaZRywWYssDxc3bwVLbPMvVhKrayUWPo/5p61vUWTYqo2Z4FPkwd3ouUxZt6YEg3WJUYLUpGSwYTeUscvT1kLHO/fjZZ3kLHAiKgKBmH9xgiTxdLGYoMFoSySRYAh9qCLfIM8jUb4R348fXTl6MXlhwg75stLwO8I/yN/AM9mMqSdVVsbAAAAAElFTkSuQmCC"},761:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAATCAYAAADWOo4fAAAP6npUWHRSYXcgcHJvZmlsZSB0eXBlIGV4aWYAAHjarZlpchuxEUb/4xQ5ArZuAMfBWpUb5Ph5DQ4ly7YcJxXRFqnhEEsv3wK6/a9/HvcPfnIO1WUpVZuq5ye33GLnRfWvn9dz8Pn+vj/peYu/v1x34f1O5FL6vFP3c3/nunx+oOTn+vh63ZX5jFOfgZ433gMmmzny4rmvPgOl+Loenr9dez7X8w/bef6fGe/bMl5v/fx3LgRjCeOl6OJO7I7f1WZJrCC11HlO93eIdiXwOiS5V/LvY+c+Xv4UPJXfx8735470NRTO63OD/hSj53qQ38fuRuhL1t4v49c34nx/8jexO6ues1+761mJlLpnU/4Z4r7iRsKZ0/2Y8ij8F16X+2g8KlucZGyRzcFjutBCJNon5LBCDyfs+zzDZIk57lh4jnHGdK/VVGKL8yYl2yOcWEjPcqmSq0nWEpfjx1rCnbfd+WaozLwCd8bAYIFP/PJwv7v4vzw+BjrHSjcEC6bKjRXrilbTLMMyZ7+5i4SE88RUbnzvw/mfkvMkNpFBuWGubLD78RpiSPisrXTznLhPfHb+1RqhrGcAQsTcwmKo6By8UtJBgy8xlhCIYyU/nZXHlOMgA0EkruAOuUlJSU6NNjefKeHeGyW+LgMtJEKSpkJqaCCSlbNQPyVXaqhLkuxERKVIlSZdk2YVVS1qGNVLKrlI0VJKLa30mmquUrWWWmurvcWWgDBp2oprtbXWO5N2hu58unNH7yOONPKQoaOMOtrok/KZecrUWWadbfYVV1q0/9JV3Kqrrb7DppR23rJ1l1132/1QayedfOToKaeedvpH1p6sfs1a+Clzf85aeLJmGcv3vvKZNS6X8h4iGJyI5YyMxRzIeLEMUNDRcuZryDla5ixnvkWaQiJZC2LJWcEyRgbzDlFO+MjdZ+b+mDcn+b/KW/wuc85S9//InLPUPZn7NW+/ydrql1HSTZB1ocXUpwOwcVOPlX/g8V88b8gky0668sh1lb516trOj6zctcbIs9Ypo4kvDeQ60pfWFdpi83F67icrLDSo7xa3serY5wR/CHdwLbFuqgQOnbHYc5A87ZmQnp7s1TxDWPc6vlFOIqW1NPvcVkSdRBHL6HYnVofIK6Hq44xOzCbRLtDhLAsI2mX1M84+NduwO/b660Tu60x88N48EiMxL8i76tx77M186bCvtO8wJ21m/NyJu1v50+xjjl2Z+TU2C9WjKQ3uYkFIBsstd7pzVzgZivXduVjguQtmiYXYrpW7Ljk5UE97cP9SaaXoDqHGgCqKqU6CvZvsvHRGPpDC1taonSpzdm7p3J476aCY6Cjy2/vupcSjpYtsWVlDHjM5n2al/TrslltoZ/bRVhxjRJYvUQIVTViEz+sRmnAoFZ6V96jjmUPRFadUt6amLHFMeLTOYeWzCc+N6gi2RaKqJKfMm6EDRM+1++gomj62DXhkRjd1xDkYG0mTo/HMTjGfLoU7EwVI3+5TGLaUMNh1Wq2fPtIp/Swp/B0sm+67dP5lNmnIPXcP2ynl8vfV8v3w7i+qRUG9RBdq6Ef2WH31iZYAIEJDHzSRjBoBXAsguIAcRgPxqIS9C0WzyuhDcm1rITFMtdSYFQQvIwRqhsS3sSl+0ZPECdglLa49Z8wLZKPJJQzgXS3u5BygSP20MgHC0RllD6WHZjcIBkfIRSrLMXhdWQLCnR0tWjHYX0jXIDXtuJ4Frtjj5wqhgvcKOyOzE0eeg6EINWMd0o6+qmfscBulWiV3xmQQTXMFVF8aSN+u0NsSqoE97uN2BTKYfcvN0p8GTH8qU7i/kyIQ78QEmIDyvqx1LiQ941uVPuN7/8xwx2eAj/HdneAZ3qolnY9qeQ3vzyYT4ZRySqD0LJi3om4x8TErplmcVRPXX7D3J0gJh2jImTX9sOw0qC8yMryjWjIsBisprWTuYkKes/cO88fhycgBfcPIttFF8iTwb0vdRm2UoHmLANOm1SXTs0Y4ffldfiUhJK0vZ4M8K7EVOsnkL8sE5/MlmaOusMwPdEJPP+Dk+RgB6jAwq+9ZFvRPPyaaILSNFF97AEXdrxYFieRi7vRn9HX6WhElyI+0Zj3A4tUSIJinxemyCe5A2nUwJ2NUc1y2kzA3uXSZQuvr1KEWVHoyGtmDsqsFEzWmcwhV4mN1b4uXekK2reT2lJIywU5L3VwDkd0XtF/LDGPT3E/AAJWp39F3KmNGlrCGUvV9ukGxYIlHT9MryhmF3mZTee9PgOQB6nPbQvxCI0UaQgrkHDnXa34bu3Nsj9s9yKOs1kCLcFt16rolmiGPgnBtRiHUMVIApNptUH2mwOeyjPru8jpgYzW4+pqG77NAmZ83X3/IAlvRQ4YR1KF3lLeGZUYHgmwtEic35P1LyG1nu6octOhZWx3SCmFolQyCUv6lGFS0Ukd50FUbNf0Jr6l+wKsXSrQ2Y7DkTByN5alufAIRHwY4wAL392b/93rRrQEeyjG9kS+wDBBTITmfRnWwOk5C69YaJSeF+rTnkbwpXM17e3i8wl6H7NH235Wo+7VGCTK4El/Khyzo7X+4/8qx7tMy+VM8NWnAwx0I1u1igd3m1mVEdzb0in0WwP5LWVK/0EuIuxgfISmGlNoA8pTMmbbo3bX75GPzpjEhcXtBbXtD7XpBbetpB8OqStR5SyCNc3owcq+CO5I6pgK4JtgUWD95oXOYsExMwCIJ8Mbe5z8gu/s7aEeBjDdCHsr/EyPDswv33TYYFn3/DHvSHXaN17DpTf8fiH22+0vExowckKYFypdBbNj6ZTL3y2zEDku4F4C58IOICE9jdtN/vXlTdc0gYqJioPUwydgBYF1Dyait5+e13qW+lEobKCqJjZyjM+UHRRpGhbWrbI+DnJqtCnulF5aI6bk5ZKXRgtEDlIKmQRRK2QjQNFA8u09JF+HGmJgI4AwYQT+G1DFnh8ZBVyBSVkdfUn1qRVdT8bkauxTrkm+Qyz3QFbF8hgvLNHApacnsyVPmZJ4a73s2SihkVRN/qDcsFR03UCtilDQREZhRA69Grz8Y663fkNndFmsqxDzmxOKRzzQT2IKO783knZEZqv5UmhYMh9apc4i9o3SSDD8QQBXjNBLmaZIlIlFJgecz9IaImUDbHMgKMuLaXH56mpln4gahpBpSxNCvHi5hPQWnDFgnoZUbizkvYbZSOI0OtyqvjtraWfyVKnphtxuqzrIR/pYIRZordptEEMcDMiDwA+65QXzgaMyNRExHFeER0AjWuK3T2gM3CyxX9CLOAd2HTQcaiHQxCDcxcQjOWh9YifNFQ8q+jVcz/U4d1peAYgn5o3VyJMQ3BPmCGbFZb9UtzASsM9A233lbM1kfLTEiPvQlxoFdl3rW30zm/jRbvnP9MNX9TXDZHFxzLhJ681RoSDMCuO/BZ7uRHbqHTsUHDMzEf0RuM2yHumvNmSm2DmUD/gaPQsZvFSTqRwlDHO1VwkPnNxXs+hi9nwoTIOvoj6ZTd/SDWtDIS2ohmsXEIFJY5I3uqhEYNitIe87JYiEVJ1snE0EhodD0gi1DmRnPUAwYiHl1E9qZhZMKfBprpxyMW0zF10qx4t9oEULRd6mrbjt+p4RrEphR7NAktHlepWN5g/luTdu5+tfnogQb63KF5rjw2oG7C7Oesl6Z0o7wijmgkuuoOuDVNmZH6diB00JyViRzRUTQOkw47NDDsG+ZKrXDIH7iPbxo45Ski0KrRX2CkEsGy+Y14ngmGpdgIxmAjJqC+ALJglqF9/eZw46+Pm0TOVX671ZORA738tKc7R4f7Oo8eMbok6iGHSN7MGVADeUFXQ80acuIC/qcz1bN2Ks2tQzDkxVoxgSo47RpEaQLe6mUeqgK7EnK3MOvlOeO+woAXDd0g/rZwHs7XrWTMQDAm09JlIIzbN7T6ryGHSrG4AXN9RdoRncaOF9kht461qOJITMRNHnM+CMbnxk040gwzQiz+pIiAFfa7z/sW5ivz5Zv6yJ6yK1Xwb2a6EP8oMS66QrjFiVS1K43Yo+IWaqeGVJF0kyMbNeBHphOLu4hQdnVRubRJyduj0lHyy0ESWLufCiE3bMpo8aqKagz4h6jXbtI4ajrhES5hv1uBV2ZwhPePEFob+oNmLGzuURFcgEe/mxGhH+lVbrpIxzX+3CFcuiTZJJVRWLPCaNGEtdtSqw2YgZCEP+7Ezj3eTAWXl6bPF0BtR9rnB79dHAsRrTPYUW7pfl5FuL8Q+EV4nrIHHc37fBIACYmMWhZBfEI26EsIQ08yxYgg6wl6iUZhTqhHrRFup3YosfZC1wDaiG6reqhLxzn3bU5zLztyECok9mlmZZmioiWds1P+iXRNT3jYskSvpHBJSrA9WpL9ArSu5vH/nb77kf9WM+jH+2k53XOY3wjMGsJ1777k6i0a+BtKRj4t9tw/4XduG4Do0VXrGhZLZomLnyzeHX8MsOO/3pBf0f+UyHo0SjTxDnTYCpOiHaSozmqRJvATou8nRbxz1LjMCXcUCk4RVAtuHsEFCRiP5o/xvWH5o3X0Z7VhDrxhGdMgCTjSjZD6AQLQTINogs0iAsiR2AmcAIDFVwn3YxEaw9TbSXQ8bfA7eyFAOy1firAx/fMo5/e/CUBuzefZWega9+w4v8T2IbxA4GBQsQWijOHjMijM5vpC6gS4lwUZ+ui9lXpJGUVgCbcQwCdgNyECeo9ZEEok3fgIVkgNkhkx+G0WspIGzTpDtHkTbsWyixEfvWCpJZ/wCcH59g3fmhzJdISYSeAaPGDs3hTSIEr3xziqR1YCwG2IENvM1bEgrOD9w6OgMElk8Bl1v4scDEzOOOiZvc9IrATAqB1pI8jArXvTATpW3xyfBCpnveCFjC16BCp09qbuBrHQWFUGZwGOoHxTFPUQrbgABxwSRsC1kCvmTGm4APCBqFJshcyBOOegx2T2OFuXyaSMooxhGRfUUfE7UYciB2TPKjs/haWG5AVQFMIaV2ARFbC4RMWT/wlrhTsxuweUI7FvnMpI9VkFEhLqhgqN0ItcqB/isfqm6zDV+VFw3YIT3u59+lltmPqqHbQUISFAWLQP2gClGHmh2GJHZZCpC0xQ6GMgn35ayfIOBwHFUwAnx0dShhPJNAJbUrDRUb8EP8QLf0XTMORd73e9kd16l5ysn+cUptMm/B/RlPVH+mJKV5hAE4/2KnhBtAfsYqzpKA/Ti8zqH15CpKBjXD/YDGFkppSX7VsPdDmN6zr/F/Q8W/Z2AI9DnFEIJzaHKxEMhZUg0WQRzmc3x1HBfuKT80aI8vgtEQbAtqWFHy1O5sePc/aEf8z/7JEuD1Z2ExipSJvTQqrBX2dc9YtjkJDiWG/un1ZH685KObWawPi5i4wSkEeYhionHllfX05hfSo1MXWcNlgZ6bK7JBCrEnW48bQm8irH87JHyd0VnP/BiR+ZualOXRYAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAC4jAAAuIwF4pT92AAAAB3RJTUUH4wMBCg8ELnqDOQAAAyZJREFUSMfVl9+LVVUUxz/73vmhhA+GET5EDNRShNKGHJRMYyKUhLFFWBiEmjZTlPrQX9BDFghCgamNED4qxXb0QSplwKSaIcEMFPcwlONAEhklONI4c1cPsweO2zN3zp17X1wvh7PW+p691l4/jzMzHmRqatSHlvUNcaViXcDrwGqgLYr+Ac4DR0ylr9o3nA9PAV3As8BjkT0B/AQcM5Uf78M0IgLOhzXAYWDZLKrfOdhSUbmZ4NuBT4E1s+BPAT2m8kfDHHA+9AAHAVcQ8ouD5yoqtzP4A0C5IP4a8IKp/A5QqtP4HcChGowHWG7wScR3R3y5BvzjwMmyDy25EXA+rAV6qtWNgx02leODwLxEfhk4AvwAPAN0x2eWLgHbY243J7Ih4CgwACwCXgM0x453TeVQngNtwMNVHLhlKkPOh3PA84mstwTvT6qMTzNafCjdhS+AFuA00G8qN5wPF4D2BH+wDLsnVCYSm3YBnyW6/abS6cwM58OeAgUIYKbyjvOhI95Qlr4xlQ0FU+9F4ExaoKbSVQUzCKzMsMZNpbWprW+I2ObOFzh7LD435cg+zhy2DuivsTY+mkV+NnGgZb4PpabfNj0JcCHH45XAzoT9PXAFWJHqz4dzmdcPazT+X1MZmEVnMmUscFi1QfZ3LKYsTfffR+8LjYplevq6GhvaWAGdjuR99M9XZGYHTGUYGJ5B/FdOxJ42lUvA3ZyC2wI8UsW4xc6HJaZydYb8XwW8lBZxPavERWB9wtvX7MPLpvIrsCdzeHeO8Xemsu4eOlD2YeOkyn8568XxHBsOz3kSOx9Wxz6f0iCwFxgFFsZe/0ZOurwHfDnDxeyNs2ABsBl4O2fWfGUqm+taJZwP3+aEtQhtM5WjzoezQOcc8MMO2isqt+pdJd4CRmrEfGAq041h2xzwl4HOaePrcsBURuMk/rmA+k3gVVPZn8Ffj/iBIscBnzvoMJWRhq7TD/ngxqZyfXuyDlvcdb520Ju9tXvaz4nADeNNYGtMqez8CMBJoNdUQm4qN/KPrNmH8gQ8AYzPg2t3VCq14Ft9KI3DUsCV4Wq6E+XR/4Y8Io8a0dGLAAAAAElFTkSuQmCC"},762:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAUCAYAAADskT9PAAAG83pUWHRSYXcgcHJvZmlsZSB0eXBlIGV4aWYAAHjarVhZliQnDPznFD4CmxAch03v+QY+vkNA1t7dM2MXXUUmRYIUIYWoNvOfv8X8hZcnm00kzqmkZPGKJRZfcZHtfu3e2bg+18ufr3D/NG5ctNcMZwP6sG/TPPMrxun+AJ/5rj2PG+5nnXwWcvZp66A76/WZl89Cwe/xyxBTznM1Prhz3r6fZS+3Xu4jA4xBWC9442dwweIz6y4BFoQSKvqATx8KJtmQcR3Pp/uMnbldvoBX7WfsbD0zwjMUxqYzIb1gdMYdvYyHG2v+mbXr0j9/0dItCN6wExlZZG7vakxAKpnj1AXhusLEBijDeiyhMd4IOvTaClqGix2MDbDZ0LpxxXmgLS664aoTN1ffXYeJ0U/P6L3vPqyxHNgX3xcpUZsTz6BnGHDhQwdrAcP+Zotb+5a1X3cZOw+Hmd5hMYcn3pr5NPgn7baQiIaucwpm3VjBLq8xDTOUOf3ELBDi5GBKC9/VzI3W+0uJDWCQFswZDlbb9hKN3D22wuI5YB7ZaOxODcfjLACIsDfBGBfAgE0ukEvOsvfsHHDM4KfCch+ib2DAEfnhjICbEBLIyV73xjPs1lxPfg9DWkAEhRQY1CCBQFaMhPjhmBFDlQJFQ0SJmDIVqimkmCilxEk1qnLgyMSJmTMXrjnkmCmnzDnnkmvxJUDCqKTCpuRSSq3YtGLpiqcrZtTafAstNmqpccuttNoRPj126qlzz730OvwIA+k/0mAz8iijTjcRSjNOmmnyzLPMKog1CRKFJAlLliL1xtph9Zk198Lc96y5w5oyFtc8vrOGYeZrCadyQsoZGPPRgXFWBhDQXjmz2cXolTnlzBaPpCAP1hwpOcMpY2AwTudJ3I27O3Pf8mYo/hZv/ivmjFL3fzBnlLrD3DtvH1gbdVWUsAjSLFRMbRAIGybMXH2uWpPe+zZbXUuG3mXW0NucAqxI6lBTS5iTaRrHts0xMVqheIQ/VLoi0e4bFW3xHlYz0OTaigIo5Cas5NJKHfCpkZheRBXOAWx4kDCa4CDVbQwcK2LXjcrLN735acKHPqizayMB0hMM4Np8hKapTVJnPRdlOuBcGPGtpwJABWhK0WKiACsKehoZsUyIk8IzAKLyxjorInLGAImpCUJgJOj86LNB4SFfbWAQgBwQkCJSH4yX4tLiKVYh9r2DJDA1DlNtMSWLKcR8swNEDSUKp5E8NlljFgnzRtYP/aZRn5tUGQGZaX1l7VuPLUArjesidMQOMPKIzjkGXNeSFqQ5hO0wB2EAGnq1jwjrBbVc8BgNFgWlulknFcTJRDxuGxBmnbdrT/sOBV+c1717A1dIM4kBadXCHNKBuz34Uhb8AVQ1xVSYiLv4n4IIMWO+CCL1tk1Y4Tt8AGNtdLQ0SxpVkB8NzEiunRgmQ3FM2+jSxMEhuxcne+M3Jwd9dNJQfjXp8vr3nDZfe60r70VBqQghECFSat+MmivKvrQo6iUswtnhvtIm4p5qpdDiuyBXkDDtJAxrwvBOGMhlcm00Ay1pSqI/8dRgFPctZ3qfkSYQNYgje2mto/FsrKkRG2Ixukwd3xjImgryVrTcIP2lJMQ/FBoJhgxuHKFLLIFGVtmqklwaCO/tyGW9SRk7bo6x7uKYF8dDOc5a0GgpKAG8sQkmN9LaVeWCtoKaIWoDRGPZMLYNtGzwtPRGQUB9AALY5wBAAPyNtQcNUXx9gY7YtrUej6rWe/AJVRcEX/Gz4yyVltYDHFg+L2ErUcvjthUhyQMCj8zcAt+2wHsV+D4UGZaNFATej3RicpgYij0lZ8fMKjyI3WWMUqXG0DKmwhiaCzW1haBuN1UyL7Xnkq1tnspWjQx9OSrlNHPuBYrEAmAVFjJu0rFflv1t25+Dbct+3vbfJNhnmKtxtTK57UxGfEJGZlSaob/t0t9Xakec3zKLM6lK7QowbH3BtlD79Vp9SrWRy4QlHCu+W9rlCPvz2V90/7T3J7Zjbc8P23eDo0z3O3g01lcJ2pyNw1lbnMniTEvQ4mwoZ+6h/Jj5U515LTNOYduqXwtu8n7QrOPGJ1lcoojj53ey+KCK5nOZt3YV+vcyf7e3NzfbvQqaPyuHL9Xw5Vjzneb6n7gwP5AxHw5u3yJpfg3Kn3oca34L6svW24HqHhZGcb6Syp1D1tZsPpotcUW1avY6ZCGLENgRMKkFV8kyyDgZMEbqPtiVXVldqG0VLfivZUvWv2uO2xUMvrpt/hdVg6iZjyfqSz3Eog52HIxQ91ljq6gQIMfVwnjqEYQq1WYm9Bniht8T8SI+4jfx09oLYDkVb1XcuStuXBU3oOIijrTcAD80/HzJX5abXzhE/PIRS/CTpph/ARscK+mV17rfAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAC4jAAAuIwF4pT92AAAAB3RJTUUH4wMdBzApIWyOBAAAAnhJREFUSMe91U2IVWUcBvDfueeW6QiVjnMknaAWgQXFmM7ChWAgHFEq04VUm9m4GtrU0KbcCJZBixgGoSG/CNq4cUDmtJSBaFcOpWUafUwOZ0ArEYTuPU4L3wuX6zn3MkPTu3rP839enof/14n0OEWWPIlDGMBP+CJO89v+oxP1ED+As1jTBs9hb5zmsytqoMiSQVzG2pLw9xiK07xR8u5hjGAbvsVknOb/VOnUupg7WCEOz2G4E2xOJ/AZPkQf3sfnjfv4kg0M9sjepgfSGdkc+mUkTvPX8TIO1CJPLcfAjR4Gfi7BHkGMopWUoFGVSfUuAr91iX2Hb0rwP/A3ThVZMoXd4fvKcgz81SV2OU7zogTvC1m4h9fwKO4EneZSSzDQdv8Vb2MfTuOFIkseKnnzapicZ/AEPgimXlnOGJ4M4zSD/XGa3wx4hElcaRaLH6/au9Dir8PFwL3WmoooMoEdGC4b26hCfBN+QB4e3uqIr8eP+Ajj6MeZUJrRDu7jgTsep/nRniUIs3wsbL+RTnEI2fgKx8O0XMUunC/h/okTOFJkyVtFltQrDTSzJIoih/EmphcXzXTpkdZ2eyw0HsxXcKdDI36CS0WWjIWNeX8KiixJMIo9GArGLtT35N32QH8JtqaCu7rt/mwoXT/erRVZsjGk8z282JaV5hIX0V38XsEdKsHeKLKkVsM7eLpi33c7RzDbJj4Wp3lVCRplvd7qga3L+RfEaT4XMrYFg3GaT3Shn8NCB/ZpnOb36vil4tFcr395nObNMK69ePNFluzEGDZgCqcgKrLkeXzd0Si3sT1O86tW+NSu32jM4iV8GVbuBez6P8ThX8xswVVToYXTAAAAAElFTkSuQmCC"},763:function(e,t,a){e.exports=a.p+"static/media/java-logo.a5a69ee8.png"},798:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJ8AAACgCAYAAAASN76YAAAAiHpUWHRSYXcgcHJvZmlsZSB0eXBlIGV4aWYAAHjaVY7dDcQwCIPfmeJGcIDwM05VNdJtcOMfUVpF/R7AssAyXb/voM+kgUm7h6UZCk1NPkoEFgI0Rpu75uLe0krxtkl4Cctw6D7U23/oYmHD1d26nXZypfMlLFGz/mimYtbIHZLjafT2j3c26A9OiiyFi3p6tAAACgZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+Cjx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IlhNUCBDb3JlIDQuNC4wLUV4aXYyIj4KIDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+CiAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgIHhtbG5zOmV4aWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vZXhpZi8xLjAvIgogICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iCiAgIGV4aWY6UGl4ZWxYRGltZW5zaW9uPSIxNTkiCiAgIGV4aWY6UGl4ZWxZRGltZW5zaW9uPSIxNjAiCiAgIHRpZmY6SW1hZ2VXaWR0aD0iMTU5IgogICB0aWZmOkltYWdlSGVpZ2h0PSIxNjAiCiAgIHRpZmY6T3JpZW50YXRpb249IjEiLz4KIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAKPD94cGFja2V0IGVuZD0idyI/PuccJD4AAAAEc0JJVAgICAh8CGSIAAAOzElEQVR42u2daUxUVxuAX9SOITA4LLIopcgA0kGhgKCgBKhFVIjUGDYX1Iq21CrGoE1/t1EbQxWLLbRVKVBQU0WhQKEgtBhMUUNBHVlEoVAYFlEWAUF4vx/9SoC5w9xZnBlm3ie5P7hzzrmHe567nXPue/UQEYEg1MAc2gUEyUeQfARB8hEkH0GQfATJRxAkH0HyEQTJR5B8BEHyESQfQZB8BMlHECQfQfIRJB9BkHwEyUcQJB9B8hEEyUeQfARB8hEkH0GQfATJRxAkH0HyEQTJR5B8BEHyESQfQfIRBMlH6ADztPmfGx8fh87OTgAAMDc3hzlzZtex1t7eDu3t7dDd3Q08Hg8sLS3BxsZGexoItYyxsTFMTU3FwMBA5HK5CAAIAMjlcjEwMBBTU1NxbGxMY+vf1NSEhw8fRmdn54m6T17s7OwwNjYW79+/P+vbSqvka2hoQA8PD8ZGm7ysWLECGxsbNaruL1++xPj4eOTxeFLrDwBoYGCAMTEx2NfXR/Kpm6qqKly0aBGrhgMAXLx4MVZXV2tE3UUiEfr6+rKu++TF1dVV4w4knZKvo6MD+Xy+zA1nb2+PXV1daq378+fPcfny5XKJ999ia2uLra2tJJ86+Oijj+RuuP3796v1/nTjxo0KifffsnLlShwaGiL5VEl3dzcaGhrK3WhcLhefPu1RS91TU1Ml1svOzg5PnDiBlZWV2NTUhFVVVZiUlCTxQQQA8Pjx4ySfKsnIyFD4rPHTTz+p5QFD0q1CVFQUDg4OMuYbHR3FTz75hDGfhYWF2g4keZj1ncy1tbUKl1FXV6fyepeWlkJjY6PY+o0bN0JGRgbo6+szd8zOmwdff/017Ny5U+y3jo4OyMm5TiMcqqK3t1fhMp4/f67yeufl5Ymt43K5cPbsWVad4adOnQYLCwux9fn5+SSfqjA2NtaIMmRFKBSKrfPx8QFbW1uWdebB+vXrxdY/fPiQ5FMVb7/9tsJlOCmhDFnp6uoSWycQCGQqY/ny5azKJfleE0FB64HL5cqd38jICDYwnEFeNy9fvmS8n5OFN954Q2zdyMgIyae6yy4PoqOj5c6/e/duWLBggcrrzePxxNb9/fffMpXx+PETsXVmZmY0sUCVdHV1oYODg8xdLEuXLsXu7m611HnXrl1i9bGyspLYxcLUQS0QCMTKCAgIoK4WVWJmZgZXr14Fa2tr1nlsbGzg6tWrYGpqqpY6+/n5ia1rb2+HL7/8klX+77//nvGh5b333qMznzpobm5mNUDv5+eHLS0taq1rX18fmpiYiNVNX18fs7KyZsxbVFSExsbGYnk5HA4KhUIa4VAn165dw7CwMLS2tkYOh4McDgetra0xLCwMr127pjH1PHr0KOPBweFwcO/evVhfXz8lfWtrKx45ckTicOK2bdtmVTvpISKCFjM6OirxyVDdpKenS31YsrOzA1NTU+jr64MnT55IfJo1NzeHP//8k3U/oSag9fJJ4/bt25CdnQ0mJiawbds2sLKyUsl2r1+/Djt27ID+/n6FyzIwMICff/6ZsdOZ7vk0lJycHNTX15+4bFlbW0ucYDo8PIyPHz/GmpoarK6uxsbGRrmnMOXm5qKRkZFSplLxeDxMT0+nyaSzDT8/P8bul97eXhSJRJiSkoJRUVvR0dFxiqST7834fD6Gh4djcnIytrW1Sd1mXl4e66ny0hY7Ozu8efPmrN3/Oi2fu7s7Y6M6ODiggYGBzDIYGhpiZGQk3rp1i3F7BQUFM4q3fv16PHfuHONBMXl566238NixY6z7BOmBQwOJj4+HhISE11K2v78/JCUlgbOzMwAAFBUVQWRkJDx79owx/dq1ayE3N3diKtWjR4/g999/h7q6Oujv7594ddLb2xs8PT1BT09v9jeALp/5nj7tQTs7O6VcApkWIyMj/Pzzz7GgoICxX25yv+PAwIDO7X+dPvMNDw9DaGgoFBUVqa0Ovr6+kJ+fD4aGhjq3/3VWvp6eZxAauglu3ryptjp4e3vDr7/+CkZGRjp58OukfENDQxAUFATl5eVqq4OnpycUFhaBsTFPZ/tYdTJQ0AcffKBW8dzd3aGgoECnxQPQ8kBBTPzwww9w8eJFuUcSTExMQE9PD54+fQovXryQq5ywsDC1zaahy66aEIlE4OLiItNUczc3N4iKioLg4GBwcnKaeLlnfHwcamtrIS8vDzIzM+Gvv/5iXaa5uTnU1NQwvgCkU+jSo/2+fftkiuVy4cIFVhGtxsbG8Pz58zLFitmzZw/qOjojX3NzM+vIBi4uLvjo0SOZt1FfXz9jRAGYFimhvb1dp+XTmQeOb7/9FgYGBqSmc3JygpKSEuDz+TJvw8HBAUpLS8HBwUFq2v7+frhw4QJddnWBJUuWSD0bmZqaKiXoYnV1NeMs5emLo6Mjnfm0naqqKnjy5InUdB9//PHEWKwiuLi4wIcffig1XX19PdTX11M/nzZz48YNVk+g8fHxStvmp59+Cubm5lLT/fHHHySfNnP//n2paQICApQ6zLVgwQLGN9Smo87hPZJPBTQ0NEhNExgYqPTtrlu3TmqatrY2kk+bkTSHbjJLlixR+nbZlNnT00PyaTNsuljY3J/JCpsyST4th81rk0yBexRleHgYCB2Xj00Uq46ODqVvl02ZBgYGJJ82w2YGiSwTA9jCpsw333yT5NNm3NzcpKYpLCxU+nbZTM93cnIi+bSZlatWSU1z+/ZtuHfvntK2WVNTA3fu3JGabs2aNTor36yaz1dXVwcPHjyY+Aqjo6MjvPPOOzPmqayshO3bt7Pq63v//fchOztbKXXdtGkT5ObmSk0nEol0d16fpg8+j4+PY1paGi5btoxxcJ7P52NiYiKOjIyI5R0aGpL5s1jnz59XuM7fffcd62lV2dnZNJ9PE+nr68Pg4GBWDbl69WoUiURT8peVlckV+6S0tFTuOhcXF8sch2XXrl3Y29tL8mkKw8PDuGbNGpkaUSAQYE/Ps4kyKisr5Q6+k5GRIXOdf/zxR7kDAPH5fCwuLib5NIHY2Fi5GjE0NHTK9PZ169bJHXEgIiICGxoaWM1gDg8PVzjCAYfDwYMHD876GCyzOmKBUCgELy8vud8OKy4uhrVr1wLAv8Eh09LSQCgUgoeHB3z11Vdw9+5d1mUZGhqCt7c3bNiwAQQCAVhaWgIiQkdHBwiFQigoKIBbt26xGsJjy7JlyyA3N3dWBXrUmqfdw4cPw6lTp+TOHxkZCVlZWYy/3b17F/z9/ZUqiywYGBjAli1b4MqVKzMeXO7u7nDnzh2JAYHGx8ehoqICfvvtN2htbYXR0VGwtLQEHx8fCAwMnB0jJ5p4OpYUuoztYmVlNWP5SUlJry04kLTl2LFjiIhYUVHB+CmDyYukQJWFhYXo6uo64/+fkJDA6s07uuebhrm5ucKNLC3qU1xcnMrF27NnD46Pj0/UYXBwEA8ePIgcDocxfU1NjVi9jx8/LjH99CUkJAT7+/tJPlmYKZwY24XN5+vj4g6pTLzdu3dLPBOVlJSgvb291I+5nDlzRubthoSEaOwZUCPlm94QIEeE0MlnGGmXYC6X+9qk09fXZ/UF8IGBATxz5gzu3bsXT548iX19fVN+v3fvntxfVD958iTJxxZFuy18fX1l2l5lZSW6ubkpXTyBQIBlZWVK2SebN29W6B5YEy+/GinfpUuXFGr0hIQEmbc5MjKCiYmJaGNjo7B0VlZW+MUXXyitv663t1fhs/Oly5dJPjaMjY3J/cRra2urUKMPDg5iamoq+vv7yxwUfOXKlXj69GmlD5UVFhYqfEDExcWRfGyprq5GMzMzme/1SkpKlFaH7u5uPHDggMRoAyEhIXjgwAFMT0/Hpqam17YvUlNTFZYvIiJC49pYY+Pzubi4QGZmJmzfvh06OzulpufxeHD27Fl49913lToDWtJLQMnJyRAQEKCSfTF37lzFJ27OmatxbazRk0kDAwPhxo0b4O/vP2M6Dw8PyM/Ph61btyq9DiKRiHG9Kqe/L168WOEyFi2y0rj21fjIpM7OzlBaWgrl5eVw/fp1ePjwIfT09ICRkRHY29tDSEgIBAUFTQRtVCZtbW0SZzfL8m1fRVm1ahUYGxuzev9YEtIOYBpe0xBqa2txy5YtjJ+8+u/esqioSKV1io6Olvt+z9bWVu7vxOnkA4e6yLp4EU1NTVlNf4qLO6Sy0YPHjx+zCrvGtJw7d446mTWdK1euyNy9cvToUdX1f16+zHpcd/KwHo3tajjNzc2MExqcnJxw586duG/fPly9ejVjA2ddvKiyemZmZrIe+46NjcXR0VGST9OJiYkRm0qfnJwsNkZcUVEhNvbM5/NV2shCoRA3b94s8Z7Uw8MDc3JyNH6f6/yXxgH+jamyaNGiKU+TaWlpsGPHDsb0jY2N4OPjM6X/8ZdffoHg4GCV1ruzsxPKysqgpaUFXr16BRYWFuDt7Q1Lly6lVydnC9PfcvPw8JCa57PPPpuS58iRI7QjZWQOENDS0jLl7zVrfKXmmT660draSjtSm0Y4VMWrV6+m/D1/Pkdqnvnz589YBkHysWL6+O2DBw+k5qmpqZmxDILkY8WKFSsmPi8PAFBWVjZjEPGRkRFISUmZss7T05N2JMkn35nPy8tr4u8XL15AREQENDc3M4oXHR09RU4ejwcbNmygHSkj1NXyf4qLi8Ui0ltYWEBMTAwEBAQAh8OB6upqSElJETsrHjp0SKH3jEk+Avbv3w/ffPONTHlcXV2hvLycVehdgi67EklMTISIiAjW6QUCAWRnZ5N4JJ/izJs3D7KysuDEiROwcOFCiek4HA5ERW2F8vKbr+X7HXTZ1XG6urrg8uXLUFJSAv/88w+MjIzAwoULwcvLC8LDw8HFxYV2EslH0GWXIEg+guQjCJKPIPkIguQjSD6C5KNdQJB8BMlHECQfQfIRBMlHkHwEQfIRJB9BkHwEyUcQJB9B8hEEyUeQfARB8hEkH0HyEQTJR5B8BEHyESQfQZB8BMlHECQfQfIRBMlHkHwEQfIRJB9BkHwEyUcQJB9B8hE6yP8AjuR+xmzo2WUAAAAASUVORK5CYII="},799:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAIAAAABc2X6AAAAhnpUWHRSYXcgcHJvZmlsZSB0eXBlIGV4aWYAAHjadY7BDcQwCAT/VJESMOAFyjlFiXQdXPnBciy/bh6wWsECXb/vTcegsZB1DyTAhaWlfEoET5S5CbfRq07erq2UbJtUpkCGs+1Be/1FVwRuN3d0nDil0uVS0ahah2ik8ngjd0hf2/rHX188QkksHsBDWKMAAAoCaVRYdFhNTDpjb20uYWRvYmUueG1wAAAAAAA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/Pgo8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJYTVAgQ29yZSA0LjQuMC1FeGl2MiI+CiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAgICB4bWxuczpleGlmPSJodHRwOi8vbnMuYWRvYmUuY29tL2V4aWYvMS4wLyIKICAgIHhtbG5zOnRpZmY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vdGlmZi8xLjAvIgogICBleGlmOlBpeGVsWERpbWVuc2lvbj0iODAiCiAgIGV4aWY6UGl4ZWxZRGltZW5zaW9uPSI4MCIKICAgdGlmZjpJbWFnZVdpZHRoPSI4MCIKICAgdGlmZjpJbWFnZUhlaWdodD0iODAiCiAgIHRpZmY6T3JpZW50YXRpb249IjEiLz4KIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAKPD94cGFja2V0IGVuZD0idyI/Pla/pxoAAAADc0JJVAgICNvhT+AAAAXWSURBVHja7dr5UxNXHADwqCHZg1wokABJliSQhASDjlURQUAtGFS8RusN2tbpTx2nnf4r7XSmteIFBbylWFtqGSpjjyly5ACSzBBQkNzZJJtsSPoDMwzj1dzZyL6fdnbfe9lP9n3f972dXRUOhykrqaymrLBCgkkwCSbBJJgEk2ASTIJJMAkmwSSYBFMoFGq6fhjDsPl5y+zcnM1m8/sD/kAgHA7TaTQ6nc5kMgp4vLy8XAiCMh4cCoXsdvukwTgxMTk6ptHq9FNms8fj9Xg8oVAoG4ZhGOZy8xVlcoWiTFpaIhaJcnPXrVmzJlE3sCqVr3hcLpdOPz44+PSXvj6NVudyud9RGYah0pKSutqa6u1VcrlsbU5OhoGtVltP78Pbd+4NPRt2uVwRtoJhWKmQ721Sq/c0CPj8jAG/eDHb/mPX1es3pqbMMTTncvP3720613pWLCrOAPDc3Msf2q5+/c23Hq835k4AOv3E8WOfXfgEQYSETksOp/P+g57vLl2OR0uhUDC/v+vm7fbOrpfz88SdpVHU098/cO1Gh91ujzxoc9eto9FoOB6wWG1ut3v5nHfn7n0el9u8r4nNZhMOHAqFjCZTe0fnyOhYhE14PG59Xe3GDRUwBPl8vmfDI7/2PTZPTy9VmJw0dHXfKkaEVdsqY8tVSQS7XK6nT//86+9/IqwvEPBPHj929MjhoqLCxTM76+sQRHjl6nWD0bRUbUyj+ePJoFRamp+XR6wYnjKbex7+7HA6IxvJkLqxofXsmSXt4gM/deKjA837s7Ozl0663ehvv/drtDpiTVp+v1+nHx8aGo448XCVyjIO59XIZLFYijL58n+BQqHo9RMjI6Mo6iEQ2OF0/jv0DEXRiLMOAL9l5QyCIASCy894vd4xjXZmZoZAYKfTqdFEMeqCQTwQwN94CcfxAP7qJYPBNPP8OYHAXq8vqht6OW8Z02otVusr5212u0arm52dfa3+vN3uIBA4GAyibjTy+na7vbf3UW/vo+VR4PF4+/oe33/QY7FYX/tDvRjmJ1BawvGgG0WjajI+MXHpcpsbdZeUSAAa3R8IGI3Gm3fujo5p3jSCvJgfI1QejmWJPjwyOmWe5vOLIBDwYf6ZmRmr1fbm3sPh2HYByQJnZWUxmUyLxRL19O5wOBz/H5wQBAEAQKAYptFobDYreasaCAIBOp1AYBAAuPn5yQPn5ea+vkpJJzibkS0qRpIHlkjERYWFRAHjOG612mLLkxEOH5lUWlDAIwQYx3GD0XT9Rkf/wECSwAgiLJPLGAxG+sGL2rYr1zq7bzmdrqQ8XhCo2lYpk5Wmf7e0XBtJaok1eiU7aqoLCwrSDE6Ndm1OTsPuXRWq9VRqjCsIaqK0+vGJ7y9dvnvvgdPlSpKWTqer1Y1HDh/gcmNPeAkAB4PBFGghCGr8cHfL6VNikSiefqjxa40mU7K1BTze7l31rS1nFGXyOLuiJkLbljwtCIJiUXGTes/hQ83FSAJWMtT4td03bydDCwCAQMCv3LJ5R031pk0beVxuQrqlxq+N8L3k2yKTyWB4fT6fzxcKhUAQBEEwh8NGEKFMWlquVKpU5UWFhTHPyYkBJ0oLw3BNddXOuloM83t9vnA4BIIgCIAcDhtBhIhQwGIlfr9FTZcWAIAtmzd9fK5le9W21atT9+VFdOCFhYWEaDkcduXWrUePHNqy+YNUaqMDLywsmKenY9ZKJOKDzfsXj3M47IoKlUxaSo9pE58isM+H9fz0MOZnWyIRf/XlRUq6SxTDCUXR9o7OeEYyEUoU4AAe0Or0lAwvKZowYAjiJmjlkM6lZYSFxWLtrK892LzvfQYXI8LzrS2LxwwmY0OFSi6Tvs9gHo934dPzKzeGSXAmgLOyskSRfQgHgqBAwM94MJvF+uLi5+XlyndXYzIY6saG0yePExMc3aeHGIYNPBk0TBrfuemDVKr15UrF+wAmJy0STIJJMAkmwSSYBJNgEkyCSfBKKf8BEfG23zC8dc4AAAAASUVORK5CYII="},809:function(e,t,a){e.exports=a.p+"static/media/node.dccadd33.svg"},810:function(e,t,a){e.exports=a.p+"static/media/app.9ec64d89.svg"},811:function(e,t,a){e.exports=a.p+"static/media/service.375ffc55.svg"},812:function(e,t,a){e.exports=a.p+"static/media/aggregate.56dffc43.svg"},813:function(e,t,a){e.exports=a.p+"static/media/service-entry.de03727d.svg"},814:function(e,t,a){e.exports=a.p+"static/media/node-color-normal.c0960c99.svg"},815:function(e,t,a){e.exports=a.p+"static/media/node-color-warning.d5ed83bc.svg"},816:function(e,t,a){e.exports=a.p+"static/media/node-color-danger.3a4beb92.svg"},817:function(e,t,a){e.exports=a.p+"static/media/node-color-idle.646e5a26.svg"},818:function(e,t,a){e.exports=a.p+"static/media/external-namespace.be426a04.svg"},819:function(e,t,a){e.exports=a.p+"static/media/restricted-namespace.e8b74ad2.svg"},820:function(e,t,a){e.exports=a.p+"static/media/edge-success.1dea78b6.svg"},821:function(e,t,a){e.exports=a.p+"static/media/edge-danger.d1a20ffb.svg"},822:function(e,t,a){e.exports=a.p+"static/media/edge-warn.bc7ebfc6.svg"},823:function(e,t,a){e.exports=a.p+"static/media/edge-idle.2aa814c5.svg"},824:function(e,t,a){e.exports=a.p+"static/media/edge-tcp.c166737d.svg"},825:function(e,t,a){e.exports=a.p+"static/media/mtls-badge.179d78ff.svg"},826:function(e,t,a){e.exports=a.p+"static/media/traffic-normal-request.a157e754.svg"},827:function(e,t,a){e.exports=a.p+"static/media/traffic-failed-request.c03d686a.svg"},828:function(e,t,a){e.exports=a.p+"static/media/traffic-tcp.763abd3d.svg"},829:function(e,t,a){e.exports=a.p+"static/media/node-badge-circuit-breaker.e0b83aeb.svg"},830:function(e,t,a){e.exports=a.p+"static/media/node-badge-fault-injection.b36ad4cc.svg"},831:function(e,t,a){e.exports=a.p+"static/media/node-badge-gateways.4bb752b7.svg"},832:function(e,t,a){e.exports=a.p+"static/media/node-badge-missing-sidecar.0f8f59d4.svg"},833:function(e,t,a){e.exports=a.p+"static/media/node-badge-request-timeout.cd82af94.svg"},834:function(e,t,a){e.exports=a.p+"static/media/node-badge-traffic-shifting.b8092c0b.svg"},835:function(e,t,a){e.exports=a.p+"static/media/node-badge-traffic-source.d3f77add.svg"},836:function(e,t,a){e.exports=a.p+"static/media/node-badge-virtual-services.218275b5.svg"},851:function(e,t,a){e.exports=a.p+"static/media/logo-lightbkg.ebc0da8d.svg"},885:function(e,t,a){e.exports=a(1331)},945:function(e,t,a){}},[[885,1,2]]]);